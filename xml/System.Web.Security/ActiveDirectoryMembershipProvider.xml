<Type Name="ActiveDirectoryMembershipProvider" FullName="System.Web.Security.ActiveDirectoryMembershipProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="59d37d8780727c4317d0b457ab6c797389edf62f" /><Meta Name="ms.sourcegitcommit" Value="0084afad1b3b1cb2c8ad2c142ae3597d08bad4a7" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="10/31/2019" /><Meta Name="ms.locfileid" Value="73379888" /></Metadata><TypeSignature Language="C#" Value="public class ActiveDirectoryMembershipProvider : System.Web.Security.MembershipProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ActiveDirectoryMembershipProvider extends System.Web.Security.MembershipProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.ActiveDirectoryMembershipProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class ActiveDirectoryMembershipProvider&#xA;Inherits MembershipProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class ActiveDirectoryMembershipProvider : System::Web::Security::MembershipProvider" />
  <TypeSignature Language="F#" Value="type ActiveDirectoryMembershipProvider = class&#xA;    inherit MembershipProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.MembershipProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="102c4-101">Управляет памятью информации о членстве для приложений ASP.NET в Active Directory и серверах Active Directory Application Mode.</span><span class="sxs-lookup"><span data-stu-id="102c4-101">Manages storage of membership information for an ASP.NET application in Active Directory and Active Directory Application Mode servers.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-102">Этот класс используется классами <xref:System.Web.Security.Membership> и <xref:System.Web.Security.MembershipUser> для предоставления служб членства в приложении ASP.NET с помощью сервера Active Directory (AD) или Active Directory режима приложений (ADAM).</span><span class="sxs-lookup"><span data-stu-id="102c4-102">This class is used by the <xref:System.Web.Security.Membership> and <xref:System.Web.Security.MembershipUser> classes to provide membership services for an ASP.NET application using an Active Directory (AD) or Active Directory Application Mode (ADAM) server.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-103">Для использования сервера ADAM требуется определенная конфигурация.</span><span class="sxs-lookup"><span data-stu-id="102c4-103">Using an ADAM server requires specific configuration.</span></span> <span data-ttu-id="102c4-104">Дополнительные сведения см. в разделе конфигурации ADAM ниже.</span><span class="sxs-lookup"><span data-stu-id="102c4-104">For more information, see the ADAM Configuration section below.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-105">Экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> работает только в конфигурации политики полного доверия по умолчанию для ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="102c4-105">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance works only in the full-trust policy default configuration of ASP.NET.</span></span> <span data-ttu-id="102c4-106">Чтобы использовать экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> на любом уровне частичного доверия, необходимо внести изменения в соответствующий файл политики доверия для приложения или создать сборку "песочницы", развернутую в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="102c4-106">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance at any partial-trust level, either you must make changes to the appropriate trust policy file for your application or you must create a "sandbox" assembly that is deployed in the GAC.</span></span>  
>   
>  <span data-ttu-id="102c4-107">Для запуска класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider> требуется неограниченное разрешение <xref:System.DirectoryServices.DirectoryServicesPermission>.</span><span class="sxs-lookup"><span data-stu-id="102c4-107">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission to run.</span></span> <span data-ttu-id="102c4-108">Это разрешение не добавляется ни в один из файлов политики с частичным доверием, предоставленных с помощью ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="102c4-108">This permission is not added to any of the partial-trust policy files supplied with ASP.NET.</span></span> <span data-ttu-id="102c4-109">Несмотря на то что добавление разрешения <xref:System.DirectoryServices.DirectoryServicesPermission> в файл политики с частичным доверием позволит использовать класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, это делает классы <xref:System.DirectoryServices> пространства имен доступными для любого кода, выполняемого на страницах ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="102c4-109">Although adding the <xref:System.DirectoryServices.DirectoryServicesPermission> permission to a partial-trust policy file will enable use of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class, doing so makes the <xref:System.DirectoryServices> namespace classes available to any code running in your ASP.NET pages.</span></span> <span data-ttu-id="102c4-110">Этот параметр не рекомендуется использовать для веб-серверов, которые должны работать в безопасном заблокированном режиме.</span><span class="sxs-lookup"><span data-stu-id="102c4-110">This option is not recommended for any Web servers that need to run in a secure, locked-down mode.</span></span>  
>   
>  <span data-ttu-id="102c4-111">В качестве альтернативы можно создать сборку "песочницы", которая вызывает класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-111">As an alternative, you can create a "sandbox" assembly that calls the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="102c4-112">Эта сборка может содержать либо класс-оболочку, который перенаправляет вызовы метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider> классу, либо класс, производный от класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-112">This assembly can contain either a wrapper class that forwards method calls to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class or a class that derives from the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="102c4-113">В любом случае класс-оболочка должен утверждать неограниченное <xref:System.DirectoryServices.DirectoryServicesPermission> разрешение.</span><span class="sxs-lookup"><span data-stu-id="102c4-113">In either case, the wrapper class must assert unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission.</span></span> <span data-ttu-id="102c4-114">Разверните сборку песочницы в глобальном кэше сборок и пометьте сборку атрибутом <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA).</span><span class="sxs-lookup"><span data-stu-id="102c4-114">Deploy the sandbox assembly in the GAC and mark the assembly with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute.</span></span> <span data-ttu-id="102c4-115">Это позволит ASP.NET коду с частичным доверием вызывать ваш класс-оболочку, а так как класс-оболочка выполняет внутреннее утверждение неограниченного <xref:System.DirectoryServices.DirectoryServicesPermission> разрешения, ваш класс-оболочка сможет успешно вызвать поставщик</span><span class="sxs-lookup"><span data-stu-id="102c4-115">This will enable your partially trusted ASP.NET code to call your wrapper class, and since the wrapper class internally asserts the unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission, your wrapper class will be able to successfully call the provider</span></span>  
  
 <span data-ttu-id="102c4-116">В файле Web. config необходимо создать запись [ConnectionString (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) , определяющую Active Directory сервер, домен Active Directory или раздел приложения ADAM для использования.</span><span class="sxs-lookup"><span data-stu-id="102c4-116">You must create a [connectionStrings Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) entry in the Web.config file that identifies the Active Directory server, Active Directory domain, or ADAM application partition to use.</span></span> <span data-ttu-id="102c4-117">Поставщик будет действовать только в области домена или в подобласти внутри домена.</span><span class="sxs-lookup"><span data-stu-id="102c4-117">The provider will only operate at domain scope, or in a subscope within a domain.</span></span> <span data-ttu-id="102c4-118">В следующей таблице перечислены допустимые строки подключения и используемая область.</span><span class="sxs-lookup"><span data-stu-id="102c4-118">The following table lists allowed connection strings and the scope used.</span></span>  
  
|<span data-ttu-id="102c4-119">Строка подключения</span><span class="sxs-lookup"><span data-stu-id="102c4-119">Connection string</span></span>|<span data-ttu-id="102c4-120">Область</span><span class="sxs-lookup"><span data-stu-id="102c4-120">Scope</span></span>|  
|-----------------------|-----------|  
|<span data-ttu-id="102c4-121">LDAP://\<домена или сервера >: [порт]</span><span class="sxs-lookup"><span data-stu-id="102c4-121">LDAP://\<domain or server>:[port]</span></span><br /><br /> <span data-ttu-id="102c4-122">Номер порта является необязательным для ADAM и не требуется для Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-122">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="102c4-123">Поставщик выполняется для указанного домена или сервера.</span><span class="sxs-lookup"><span data-stu-id="102c4-123">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="102c4-124">При использовании AD создание и удаление пользователей выполняется в контейнере Пользователи по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="102c4-124">With AD, user creation and deletion is done in the default users container.</span></span> <span data-ttu-id="102c4-125">Все остальные операции, в том числе любые способы поиска, будут находиться в корне контекста именования по умолчанию для домена.</span><span class="sxs-lookup"><span data-stu-id="102c4-125">All other operations, including any search methods, will be rooted at the default naming context for the domain.</span></span><br /><br /> <span data-ttu-id="102c4-126">Если в строке подключения указан Active Directory домен, а не конкретный сервер, а <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> свойство имеет `true`, то экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет всегда подключаться к серверу с ролью PDC для домена, чтобы гарантировать, что изменения паролей вступят в силу. и доступны при вызове метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-126">If the connection string specifies an Active Directory domain rather than a specific server and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the server with the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span><br /><br /> <span data-ttu-id="102c4-127">Эта строка подключения не допускается при использовании ADAM и вызывает исключение <xref:System.NotSupportedException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-127">This connection string is not allowed when using ADAM, and will throw a <xref:System.NotSupportedException>.</span></span>|  
|<span data-ttu-id="102c4-128">LDAP://\<домена или сервера >: [порт]/\<DN контейнера ></span><span class="sxs-lookup"><span data-stu-id="102c4-128">LDAP://\<domain or server>:[port]/\<container dn></span></span><br /><br /> <span data-ttu-id="102c4-129">Номер порта является необязательным для ADAM и не требуется для Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-129">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="102c4-130">Поставщик выполняется для указанного домена или сервера.</span><span class="sxs-lookup"><span data-stu-id="102c4-130">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="102c4-131">Создание и удаление пользователей выполняется только в указанном контейнере.</span><span class="sxs-lookup"><span data-stu-id="102c4-131">User creation and deletion is only done in the specified container.</span></span> <span data-ttu-id="102c4-132">Все остальные операции, включая любые способы поиска, выполняют поиск в поддереве с корнем в контейнере.</span><span class="sxs-lookup"><span data-stu-id="102c4-132">All other operations, including any search methods, perform subtree searches rooted at the container.</span></span><br /><br /> <span data-ttu-id="102c4-133">Для серверов ADAM контейнер указывает корень раздела приложения или контейнер в разделе приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-133">For ADAM servers, the container specifies the root of an application partition, or a container within an application partition.</span></span><br /><br /> <span data-ttu-id="102c4-134">Рекомендуется, чтобы строка подключения определяла конкретный контейнер для повышения производительности.</span><span class="sxs-lookup"><span data-stu-id="102c4-134">We recommend that the connection string define a specific container to improve performance.</span></span>|  
  
 <span data-ttu-id="102c4-135"><xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр сопоставляет атрибуты каталога с <xref:System.Web.Security.ActiveDirectoryMembershipUser> свойствами.</span><span class="sxs-lookup"><span data-stu-id="102c4-135">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance maps directory attributes to <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties.</span></span> <span data-ttu-id="102c4-136">Атрибуты по умолчанию используются, если в файле Web. config не выполняется сопоставление атрибутов.</span><span class="sxs-lookup"><span data-stu-id="102c4-136">Default attributes are used if no attribute mapping is done in the Web.config file.</span></span> <span data-ttu-id="102c4-137">Дополнительные сведения о сопоставлении атрибутов см. в отдельных свойствах документации по классу <xref:System.Web.Security.ActiveDirectoryMembershipUser>.</span><span class="sxs-lookup"><span data-stu-id="102c4-137">For more information on attribute mappings, see the individual properties in the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class documentation.</span></span>  
  
 <span data-ttu-id="102c4-138">В следующей таблице перечислены свойства <xref:System.Web.Security.ActiveDirectoryMembershipUser> и их сопоставления атрибутов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="102c4-138">The following table lists the <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties and their default attribute mappings.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-139">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> явно не проверяет, что атрибуты поставщика не сопоставлены с основными атрибутами объекта пользователя в каталоге.</span><span class="sxs-lookup"><span data-stu-id="102c4-139">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not explicitly check that provider attributes are not mapped to core attributes of the user object in the directory.</span></span> <span data-ttu-id="102c4-140">Необходимо убедиться, что конфиденциальная информация из каталога не доступна через сопоставленные атрибуты.</span><span class="sxs-lookup"><span data-stu-id="102c4-140">You must ensure that sensitive information from the directory is not exposed through mapped attributes.</span></span>  
  
|<span data-ttu-id="102c4-141">Свойство.</span><span class="sxs-lookup"><span data-stu-id="102c4-141">Property</span></span>|<span data-ttu-id="102c4-142">Атрибут каталога по умолчанию</span><span class="sxs-lookup"><span data-stu-id="102c4-142">Default directory attribute</span></span>|<span data-ttu-id="102c4-143">Можно сопоставить?</span><span class="sxs-lookup"><span data-stu-id="102c4-143">Can be mapped?</span></span>|  
|--------------|---------------------------------|--------------------|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.ProviderUserKey%2A>|<span data-ttu-id="102c4-144">securityIdentifier</span><span class="sxs-lookup"><span data-stu-id="102c4-144">securityIdentifier</span></span>|<span data-ttu-id="102c4-145">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-145">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.UserName%2A>|<span data-ttu-id="102c4-146">userPrincipalName</span><span class="sxs-lookup"><span data-stu-id="102c4-146">userPrincipalName</span></span>|<span data-ttu-id="102c4-147">Да, но должно быть userPrincipalName или sAMAccountName</span><span class="sxs-lookup"><span data-stu-id="102c4-147">Yes, but must be either userPrincipalName or sAMAccountName</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>|<span data-ttu-id="102c4-148">комментарий</span><span class="sxs-lookup"><span data-stu-id="102c4-148">comment</span></span>|<span data-ttu-id="102c4-149">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-149">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.CreationDate%2A>|<span data-ttu-id="102c4-150">вхенкреатед</span><span class="sxs-lookup"><span data-stu-id="102c4-150">whenCreated</span></span>|<span data-ttu-id="102c4-151">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-151">No</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Email%2A>|<span data-ttu-id="102c4-152">почта</span><span class="sxs-lookup"><span data-stu-id="102c4-152">mail</span></span>|<span data-ttu-id="102c4-153">Да, но должен быть однозначным атрибутом типа String в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="102c4-153">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastActivityDate%2A>|<span data-ttu-id="102c4-154">Н/Д</span><span class="sxs-lookup"><span data-stu-id="102c4-154">n/a</span></span>|<span data-ttu-id="102c4-155">Не поддерживается <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-155">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>|<span data-ttu-id="102c4-156">Н/Д</span><span class="sxs-lookup"><span data-stu-id="102c4-156">n/a</span></span>|<span data-ttu-id="102c4-157">Не поддерживается <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-157">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastPasswordChangedDate%2A>|<span data-ttu-id="102c4-158">pwdLastSet</span><span class="sxs-lookup"><span data-stu-id="102c4-158">pwdLastSet</span></span>|<span data-ttu-id="102c4-159">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-159">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.PasswordQuestion%2A>|<span data-ttu-id="102c4-160">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-160">none</span></span>|<span data-ttu-id="102c4-161">Да, но должен быть однозначным атрибутом типа String в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="102c4-161">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.IsApproved%2A>|<span data-ttu-id="102c4-162">Управление учетными записями пользователей (AD)</span><span class="sxs-lookup"><span data-stu-id="102c4-162">User-Account-Control (AD)</span></span><br /><br /> <span data-ttu-id="102c4-163">mDS-Усераккаунтдисаблед (Адам)</span><span class="sxs-lookup"><span data-stu-id="102c4-163">mDS-UserAccountDisabled (ADAM)</span></span>|<span data-ttu-id="102c4-164">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-164">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.IsLockedOut%2A>|<span data-ttu-id="102c4-165">вычислено из lockoutTime и длительности блокировки AD (AD в Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="102c4-165">computed from lockoutTime and the AD lockout duration (AD on Windows 2000)</span></span><br /><br /> <span data-ttu-id="102c4-166">msDS-User-Account-Control — вычисление (AD на Windows Server 2003)</span><span class="sxs-lookup"><span data-stu-id="102c4-166">msDS-User-Account-Control-Computed (AD on Windows Server 2003)</span></span><br /><br /> <span data-ttu-id="102c4-167">msDS-User-Account-Control — вычисленный (Адам)</span><span class="sxs-lookup"><span data-stu-id="102c4-167">msDS-User-Account-Control-Computed (ADAM)</span></span>|<span data-ttu-id="102c4-168">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-168">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastLockoutDate%2A>|<span data-ttu-id="102c4-169">Если пользователь заблокирован из-за слишком большого числа неудачных попыток ввода пароля, возвращается атрибут времени блокировки.</span><span class="sxs-lookup"><span data-stu-id="102c4-169">If user is locked out due to too many bad password attempts, the lockout time attribute is returned.</span></span><br /><br /> <span data-ttu-id="102c4-170">Если пользователь заблокирован из-за слишком большого числа неудачных попыток ответа на пароль, возвращается значение, хранящееся в атрибуте, определенном `attributeMapFailedPasswordAnswerLockoutTime`.</span><span class="sxs-lookup"><span data-stu-id="102c4-170">If user is locked out due to too many bad password answer attempts, the value stored in the attribute defined by `attributeMapFailedPasswordAnswerLockoutTime` is returned.</span></span><br /><br /> <span data-ttu-id="102c4-171">Если пользователь заблокирован из-за неправильного пароля и слишком большого числа неудачных попыток ввода пароля, возвращается последнее значение даты и времени.</span><span class="sxs-lookup"><span data-stu-id="102c4-171">If user is locked out due to both a bad password and too many bad password attempts, the most recent date/time value is returned.</span></span><br /><br /> <span data-ttu-id="102c4-172">Если учетная запись не заблокирована, возвращается 1/1/1754 для совместимости с SQL.</span><span class="sxs-lookup"><span data-stu-id="102c4-172">If the account is not locked out, return 1/1/1754 for SQL compatibility.</span></span>|<span data-ttu-id="102c4-173">Нет</span><span class="sxs-lookup"><span data-stu-id="102c4-173">No</span></span>|  
  
 <span data-ttu-id="102c4-174">Если `true`свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> и <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>, то класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> поддерживает безопасность сброса пароля, запрашивая у пользователя ответ на заранее определенный вопрос.</span><span class="sxs-lookup"><span data-stu-id="102c4-174">When both the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> properties are `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class supports password-reset security by requiring the user to answer a predetermined question.</span></span> <span data-ttu-id="102c4-175">Чтобы обеспечить поддержку вопроса и ответа, необходимо задать следующие атрибуты конфигурации с помощью [элемента добавить для поставщиков (схема параметров ASP.NET)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-175">To support the question and answer, you must set the following configuration attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file.</span></span>  
  
|<span data-ttu-id="102c4-176">Атрибут конфигурации</span><span class="sxs-lookup"><span data-stu-id="102c4-176">Configuration attribute</span></span>|<span data-ttu-id="102c4-177">Тип атрибута</span><span class="sxs-lookup"><span data-stu-id="102c4-177">Attribute type</span></span>|  
|-----------------------------|--------------------|  
|`attributeMapPasswordQuestion`|<span data-ttu-id="102c4-178">Должен быть однозначным атрибутом типа String в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="102c4-178">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapPasswordAnswer`|<span data-ttu-id="102c4-179">Должен быть однозначным атрибутом типа String в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="102c4-179">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapFailedPasswordAnswerCount`|<span data-ttu-id="102c4-180">Должен быть атрибутом с одним значением типа Integer.</span><span class="sxs-lookup"><span data-stu-id="102c4-180">Must be a single-valued attribute of type Integer.</span></span>|  
|`attributeMapFailedPasswordAnswerTime`|<span data-ttu-id="102c4-181">Должен быть однозначным атрибутом типа "большое целое число" или "интервал".</span><span class="sxs-lookup"><span data-stu-id="102c4-181">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
|`attributeMapFailedPasswordAnswerLockoutTime`|<span data-ttu-id="102c4-182">Должен быть однозначным атрибутом типа "большое целое число" или "интервал".</span><span class="sxs-lookup"><span data-stu-id="102c4-182">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
  
 <span data-ttu-id="102c4-183">Дополнительные сведения об использовании безопасности сброса пароля см. в описании свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-183">For more information on using password-reset security, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property.</span></span>  
  
## <a name="active-directory-connections"></a><span data-ttu-id="102c4-184">Подключения Active Directory</span><span class="sxs-lookup"><span data-stu-id="102c4-184">Active Directory connections</span></span>  
 <span data-ttu-id="102c4-185">Если класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> используется для подключения к Active Directory или серверу режима приложения Active Directory (ADAM), то атрибут `connectionProtection`, заданный с помощью [элемента Add (схема параметров ASP.NET)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) в приложении. файл конфигурации может ограничивать типы операций, которые класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> может выполнять через соединение.</span><span class="sxs-lookup"><span data-stu-id="102c4-185">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is used to connect to an Active Directory or an Active Directory Application Mode (ADAM) server, the `connectionProtection` attribute that is set using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file may restrict the types of operations the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class can perform over the connection.</span></span> <span data-ttu-id="102c4-186">Атрибут `connectionProtection` также определяет методы, которые экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет использовать для создания подключения к серверу Active Directory или ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-186">The `connectionProtection` attribute also determines the methods the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use to create the connection to the Active Directory or ADAM server.</span></span>  
  
 <span data-ttu-id="102c4-187">В следующей таблице показано воздействие атрибута `connectionProtection` при соединении с Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-187">The following table shows the effect of the `connectionProtection` attribute when connecting to an Active Directory.</span></span>  
  
|<span data-ttu-id="102c4-188">Значение `connectionProtection`</span><span class="sxs-lookup"><span data-stu-id="102c4-188">`connectionProtection` setting</span></span>|<span data-ttu-id="102c4-189">Действие</span><span class="sxs-lookup"><span data-stu-id="102c4-189">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="102c4-190">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет подключаться к Active Directory с этими ограничениями.</span><span class="sxs-lookup"><span data-stu-id="102c4-190">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an Active Directory, with these restrictions.</span></span><br /><br /> <span data-ttu-id="102c4-191">— Любой метод, который задает пароль, завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="102c4-191">-   Any method that sets a password will fail.</span></span> <span data-ttu-id="102c4-192">Active Directory требует безопасного подключения при смене паролей.</span><span class="sxs-lookup"><span data-stu-id="102c4-192">Active Directory requires a secure connection when changing passwords.</span></span><br /><span data-ttu-id="102c4-193">— Необходимо явным образом задать атрибуты `connectionUsername` и `connectionPassword` с помощью [элемента добавить в качестве поставщика для членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) в файле конфигурации приложения; в противном случае экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выдаст исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-193">-   You must explicitly set the `connectionUsername` and `connectionPassword` attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file; otherwise, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span>|  
|`Secure`|<span data-ttu-id="102c4-194">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> пытается подключиться к Active Directory с помощью SSL.</span><span class="sxs-lookup"><span data-stu-id="102c4-194">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to Active Directory using SSL.</span></span> <span data-ttu-id="102c4-195">Если SSL не удается, будет выполнена вторая попытка подключения к Active Directory с помощью команды Sign-and-Seal.</span><span class="sxs-lookup"><span data-stu-id="102c4-195">If SSL fails, a second attempt to connect to Active Directory using sign-and-seal will be made.</span></span> <span data-ttu-id="102c4-196">В случае сбоя обеих попыток экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выдаст исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-196">If both attempts fail, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="102c4-197">Поддерживаются учетные данные процесса и явные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-197">Both process credentials and explicit credentials are supported.</span></span>|  
  
 <span data-ttu-id="102c4-198">В следующей таблице показан результат использования атрибута `connectionProtection` при подключении к серверу ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-198">The following table shows the effect of the `connectionProtection` attribute when connecting to an ADAM server.</span></span>  
  
|<span data-ttu-id="102c4-199">Значение `connectionProtection`</span><span class="sxs-lookup"><span data-stu-id="102c4-199">`connectionProtection` setting</span></span>|<span data-ttu-id="102c4-200">Действие</span><span class="sxs-lookup"><span data-stu-id="102c4-200">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="102c4-201">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет подключаться к серверу ADAM с этим ограничением.</span><span class="sxs-lookup"><span data-stu-id="102c4-201">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an ADAM server, with this restriction.</span></span><br /><br /> <span data-ttu-id="102c4-202">— Любой метод, устанавливающий пароли, завершится ошибкой, если только вы не настроите сервер ADAM явным образом, чтобы разрешить отправку и изменение паролей через небезопасное подключение.</span><span class="sxs-lookup"><span data-stu-id="102c4-202">-   Any method that sets passwords will fail unless you explicitly configure the ADAM server to allow passwords to be sent and changed over an insecure connection.</span></span><br /><br /> <span data-ttu-id="102c4-203">Поддерживаются учетные данные процесса и явные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-203">Both process credentials and explicit credentials are supported.</span></span>|  
|`Secure`|<span data-ttu-id="102c4-204">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет пытаться подключиться к серверу ADAM по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="102c4-204">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to the ADAM server using SSL.</span></span> <span data-ttu-id="102c4-205">Если соединение не может быть установлено, экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выдаст исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-205">If a connection cannot be made, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="102c4-206">Поддерживаются учетные данные процесса и явные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-206">Both process credentials and explicit credentials are supported.</span></span>|  
  
## <a name="adam-configuration"></a><span data-ttu-id="102c4-207">Конфигурация ADAM</span><span class="sxs-lookup"><span data-stu-id="102c4-207">ADAM Configuration</span></span>  
 <span data-ttu-id="102c4-208">При использовании сервера ADAM экземпляр ADAM должен содержать схему, определяющую класс `User`.</span><span class="sxs-lookup"><span data-stu-id="102c4-208">When using an ADAM server, the ADAM instance must contain a schema that defines the `User` class.</span></span> <span data-ttu-id="102c4-209">Вы можете импортировать `User` класс с импортом LDIF-файла `MS-User.ldf`, доступного в каталоге установки ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-209">You can import the `User` class with an LDIF import of the `MS-User.ldf` file available in the ADAM install directory.</span></span>  
  
 <span data-ttu-id="102c4-210">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет работать с сервером ADAM, настроенным для использования сетевых портов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="102c4-210">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will work with an ADAM server configured to use the default network ports.</span></span> <span data-ttu-id="102c4-211">В следующей таблице показаны значения по умолчанию, ожидаемые для сервера ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-211">The following table shows the defaults expected for the ADAM server.</span></span>  
  
|<span data-ttu-id="102c4-212">параметр Коннектионпротектион</span><span class="sxs-lookup"><span data-stu-id="102c4-212">connectionProtection setting</span></span>|<span data-ttu-id="102c4-213">Ожидаемый Порт ADAM</span><span class="sxs-lookup"><span data-stu-id="102c4-213">Expected ADAM port</span></span>|  
|----------------------------------|------------------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="102c4-214">389</span><span class="sxs-lookup"><span data-stu-id="102c4-214">389</span></span>|  
|`Secure`|<span data-ttu-id="102c4-215">636</span><span class="sxs-lookup"><span data-stu-id="102c4-215">636</span></span>|  
  
 <span data-ttu-id="102c4-216">Если сервер ADAM не использует порты по умолчанию, см. статью Q817583 "Active Directory Services не запрашивают безопасную авторизацию через SSL-соединение" в базе [знаний Майкрософт](https://go.microsoft.com/fwlink/?linkid=37115).</span><span class="sxs-lookup"><span data-stu-id="102c4-216">If your ADAM server is not using the default ports, see article Q817583, "Active Directory Services does not request secure authorization over an SSL connection," in the [Microsoft Knowledge Base](https://go.microsoft.com/fwlink/?linkid=37115).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-217">В следующем примере кода показан файл Web. config для приложения ASP.NET, настроенного для использования экземпляра <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-217">The following code examples show the Web.config file for an ASP.NET application configured to use an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span> <span data-ttu-id="102c4-218">В первом примере используются сопоставления по умолчанию для атрибутов Active Directory и не поддерживается безопасность сброса пароля с вопросом и ответом, а также возможность вызова методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-218">The first example uses the default mappings for Active Directory attributes, and does not support password-reset security with question-and-answer nor the ability to call search methods.</span></span> <span data-ttu-id="102c4-219">Во втором примере показаны все параметры атрибутов, разрешенные для экземпляра <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-219">The second example shows all the attribute settings allowed for an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span>  
  
 <span data-ttu-id="102c4-220">Первый пример — это простой файл конфигурации, в котором используются сопоставления по умолчанию для Active Directory атрибутов.</span><span class="sxs-lookup"><span data-stu-id="102c4-220">The first example is a simple configuration file using default mappings for Active Directory attributes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="102c4-221">В этом примере показаны все параметры атрибутов, доступные для экземпляра <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-221">This example shows all of the attribute settings that are available for an instance of <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership  
      defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"  
          type="System.Web.Security.ActiveDirectoryMembershipProvider,  
          System.Web, Version=1.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionStringName="ADService"  
          connectionUsername="UserWithAppropriateRights"  
          connectionPassword="PasswordForUser"  
          connectionProtection="Secure"  
          enablePasswordReset="true"  
          enableSearchMethods="true"  
          requiresQuestionAndAnswer="true"  
          applicationName="/"  
          description="Default AD connection"  
          requiresUniqueEmail="false"  
          clientSearchTimeout="30"  
          serverSearchTimeout="30"  
          timeoutUnit="Minutes"  
          attributeMapPasswordQuestion="department"  
          attributeMapPasswordAnswer="division"  
          attributeMapFailedPasswordAnswerCount="singleIntAttribute"  
         attributeMapFailedPasswordAnswerTime="singleLargeIntAttribute"  
         attributeMapFailedPasswordAnswerLockoutTime="singleLargeIntAttribute"  
          attributeMapEmail = "mail"  
          attributeMapUsername = "userPrincipalName"  
          maxInvalidPasswordAttempts = "5"  
          passwordAttemptWindow = "10"  
          passwordAnswerAttemptLockoutDuration = "30"  
          minRequiredPasswordLength="7"  
          minRequiredNonalphanumericCharacters="1"  
          passwordStrengthRegularExpression="  
          @\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
        />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="102c4-222">`clientSearchTimeout` и `serverSearchTimeout` по умолчанию — минуты.</span><span class="sxs-lookup"><span data-stu-id="102c4-222">`clientSearchTimeout` and `serverSearchTimeout` default to minutes.</span></span> <span data-ttu-id="102c4-223">Чтобы изменить единицы измерения, задайте для атрибута `timeoutUnit` значение один из значений: «Days», «hours», «minutes», «Seconds» или «миллисекунды».</span><span class="sxs-lookup"><span data-stu-id="102c4-223">To change the units, set the `timeoutUnit` attribute value to one of "Days", "Hours", "Minutes", "Seconds", or "Milliseconds".</span></span> <span data-ttu-id="102c4-224">Если атрибут не указан, значение по умолчанию — «minutes».</span><span class="sxs-lookup"><span data-stu-id="102c4-224">If the attribute is not specified, the default is "Minutes".</span></span>  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-225">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-225">Introduction to ASP.NET Membership</span></span></related>
    <related type="ExternalDocumentation" href="https://go.microsoft.com/fwlink/?linkid=149233"><span data-ttu-id="102c4-226">Как использовать членство в ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="102c4-226">How to: Use Membership in ASP.NET 2.0</span></span></related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ActiveDirectoryMembershipProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ActiveDirectoryMembershipProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="102c4-227">Создает новый экземпляр класса <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-227">Creates a new instance of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-228">Конструктор <xref:System.Web.Security.ActiveDirectoryMembershipProvider> вызывается ASP.NET для создания экземпляра класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, как указано в конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-228">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> constructor is called by ASP.NET to create an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class as specified in the configuration for the application.</span></span> <span data-ttu-id="102c4-229">Этот конструктор не предназначен для использования из кода.</span><span class="sxs-lookup"><span data-stu-id="102c4-229">This constructor is not intended to be used from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-230">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-230">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-231">Имя приложения, использующего пользовательского поставщика членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-231">The name of the application using the custom membership provider.</span></span></summary>
        <value><span data-ttu-id="102c4-232">Имя приложения, использующего пользовательского поставщика членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-232">The name of the application using the custom membership provider.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-233">Свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A> может быть присвоено имя приложения ASP.NET; Однако имя приложения не используется классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-233">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A> property can be set to the name of the ASP.NET application; however, the application name is not used by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
 <span data-ttu-id="102c4-234">Таким образом, в отличие от других реализаций <xref:System.Web.Security.MembershipProvider>, все приложения ASP.NET, которые обращаются к одному и тому же Active Directory хранилищу данных, всегда будут использовать одни и те же данные пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-234">Therefore, unlike other <xref:System.Web.Security.MembershipProvider> implementations, all ASP.NET applications that access the same Active Directory data store will always share the same user data.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-235">Была предпринята попытка установить свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-235">An attempt was made to set the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-236">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-236">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="ChangePassword">
      <MemberSignature Language="C#" Value="public override bool ChangePassword (string username, string oldPassword, string newPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePassword(string username, string oldPassword, string newPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePassword (username As String, oldPassword As String, newPassword As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePassword(System::String ^ username, System::String ^ oldPassword, System::String ^ newPassword);" />
      <MemberSignature Language="F#" Value="override this.ChangePassword : string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePassword (username, oldPassword, newPassword)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="oldPassword" Type="System.String" />
        <Parameter Name="newPassword" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-237">Имя пользователя, для которого нужно изменить пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-237">The name of the user to update the password for.</span></span></param>
        <param name="oldPassword"><span data-ttu-id="102c4-238">Текущий пароль заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-238">The current password for the specified user.</span></span></param>
        <param name="newPassword"><span data-ttu-id="102c4-239">Новый пароль для указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-239">The new password for the specified user.</span></span></param>
        <summary><span data-ttu-id="102c4-240">Изменяет пароль заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-240">Changes the password for the specified user.</span></span></summary>
        <returns><span data-ttu-id="102c4-241">Значение <see langword="true" />, если пароль был успешно обновлен; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-241"><see langword="true" /> if the password was updated successfully; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-242">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> используется для обновления пароля пользователя в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-242">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method is used to update the user's password in the Active Directory data store.</span></span> <span data-ttu-id="102c4-243">Независимо от учетных данных, для использования которых настроен экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, поставщик подключается к серверу Active Directory, используя параметры `username` и `oldPassword` в качестве учетных данных подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-243">Regardless of the credentials that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use, the provider connects to the Active Directory server using the `username` and `oldPassword` parameters as the connection credentials.</span></span>  
  
 <span data-ttu-id="102c4-244">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, пользователь не может изменить свой пароль, если учетная запись была ранее заблокирована, так как пользователь сделал слишком много попыток ответить на вопрос с паролем.</span><span class="sxs-lookup"><span data-stu-id="102c4-244">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user cannot change his or her password if the account was previously locked because the user made too many attempts to answer the password question.</span></span> <span data-ttu-id="102c4-245">Перед изменением пароля пользователь должен будет подождать количество минут, указанное в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-245">The user will need to wait the number of minutes specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property before changing the password.</span></span>  
  
 <span data-ttu-id="102c4-246">Если изменение пароля прошло удачно и свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, счетчики отслеживания ответов пользователя с неверным паролем сбрасываются.</span><span class="sxs-lookup"><span data-stu-id="102c4-246">If the password change succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, then the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="102c4-247">Поставщик находит пользовательский экземпляр для обновления, выполняя поиск по поддереву для имени пользователя, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-247">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-248">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-248">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-249">Чтобы изменить пароли на сервере Active Directory, атрибуту `connectionProtection` должно быть присвоено значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span><span class="sxs-lookup"><span data-stu-id="102c4-249">To change passwords on an Active Directory server the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="102c4-250">При использовании сервера ADAM атрибуту `connectionProtection` можно присвоить значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, но только в том случае, если вы явно настроили сервер ADAM для разрешения смены пароля через незащищенные соединения.</span><span class="sxs-lookup"><span data-stu-id="102c4-250">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password change over unsecured connections.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-251">Параметр <paramref name="username" /> пустой, или превышает максимальную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-251"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-252">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-252">-or-</span></span> 
 <span data-ttu-id="102c4-253"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-253"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-254">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-254">-or-</span></span> 
<span data-ttu-id="102c4-255">Имя пользователя отображается на атрибут <see langword="userPrincipalName" /> и параметр <paramref name="username" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-255">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="102c4-256">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-256">-or-</span></span> 
 <span data-ttu-id="102c4-257">Параметр <paramref name="oldPassword" /> или параметр <paramref name="newPassword" /> является строкой нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="102c4-257"><paramref name="oldPassword" /> or <paramref name="newPassword" /> is a zero-length string.</span></span>  
  
<span data-ttu-id="102c4-258">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-258">-or-</span></span> 
 <span data-ttu-id="102c4-259">Параметр <paramref name="oldPassword" /> или <paramref name="newPassword" /> превышает максимальную длину пароля (обычно 128 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-259"><paramref name="oldPassword" /> or <paramref name="newPassword" /> exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="102c4-260">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-260">-or-</span></span> 
 <span data-ttu-id="102c4-261">Длина параметра <paramref name="newPassword" /> меньше минимальной длины пароля, указанной в свойстве <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-261"><paramref name="newPassword" /> is less than the minimum password size specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property</span></span> 
<span data-ttu-id="102c4-262">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-262">-or-</span></span> 
 <span data-ttu-id="102c4-263">Параметр <paramref name="newPassword" /> содержит меньше нетекстовых символов, чем определено в свойстве <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-263"><paramref name="newPassword" /> contains fewer than the number of non-alphabetic characters specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property.</span></span>  
  
<span data-ttu-id="102c4-264">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-264">-or-</span></span> 
 <span data-ttu-id="102c4-265">Параметру <paramref name="newPassword" /> не удается пройти проверку регулярным выражением, определенным в свойстве <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-265"><paramref name="newPassword" /> fails validation by the regular expression defined in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-266">Свойство <paramref name="username" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-266"><paramref name="username" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-267">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-267">-or-</span></span> 
 <span data-ttu-id="102c4-268">Свойство <paramref name="oldPassword" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-268"><paramref name="oldPassword" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-269">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-269">-or-</span></span> 
 <span data-ttu-id="102c4-270">Свойство <paramref name="newPassword" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-270"><paramref name="newPassword" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><span data-ttu-id="102c4-271">Параметр <paramref name="newPassword" /> не удовлетворяет требованиям сложности, определенным сервером Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-271"><paramref name="newPassword" /> does not meet the complexity requirements defined by the Active Directory server.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-272">Нельзя создать безопасное подключение к серверу Active Directory Application Mode.</span><span class="sxs-lookup"><span data-stu-id="102c4-272">A secure connection could not be made to an Active Directory Application Mode server.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-273">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-273">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="102c4-274">Произошло необработанное исключение.</span><span class="sxs-lookup"><span data-stu-id="102c4-274">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-275">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-275">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ChangePasswordQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool ChangePasswordQuestionAndAnswer (string username, string password, string newPasswordQuestion, string newPasswordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePasswordQuestionAndAnswer(string username, string password, string newPasswordQuestion, string newPasswordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePasswordQuestionAndAnswer (username As String, password As String, newPasswordQuestion As String, newPasswordAnswer As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePasswordQuestionAndAnswer(System::String ^ username, System::String ^ password, System::String ^ newPasswordQuestion, System::String ^ newPasswordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ChangePasswordQuestionAndAnswer : string * string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer (username, password, newPasswordQuestion, newPasswordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="newPasswordQuestion" Type="System.String" />
        <Parameter Name="newPasswordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-276">Пользователь, для которого изменяется проверочный вопрос и ответ.</span><span class="sxs-lookup"><span data-stu-id="102c4-276">The user to change the password question and answer for.</span></span></param>
        <param name="password"><span data-ttu-id="102c4-277">Пароль заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-277">The password for the specified user.</span></span></param>
        <param name="newPasswordQuestion"><span data-ttu-id="102c4-278">Новый контрольный вопрос заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-278">The new password question for the specified user.</span></span></param>
        <param name="newPasswordAnswer"><span data-ttu-id="102c4-279">Новый контрольный ответ заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-279">The new password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="102c4-280">Обновляет запрос и ответ пароля пользователя членства в хранилище Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-280">Updates the password question and answer for a user in the Active Directory store.</span></span></summary>
        <returns><span data-ttu-id="102c4-281">Значение <see langword="true" />, если обновление выполнено успешно; в противном случае значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-281"><see langword="true" /> if the update was successful; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-282">Значение <see langword="false" /> также возвращается, если пароль неверен, пользователь заблокирован или пользователь отсутствует в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-282">A value of <see langword="false" /> is also returned if the password is incorrect, the user is locked out, or the user does not exist in the Active Directory data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-283">Метод вызывается классом <xref:System.Web.Security.ActiveDirectoryMembershipUser> для обновления вопроса и ответа пароля пользователя в хранилище членства Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-283">The method is called by the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class to update the password question and answer for a user in the Active Directory membership store.</span></span>  
  
 <span data-ttu-id="102c4-284">Запрос пароля и ответ на него обеспечивают дополнительный уровень безопасности при сбросе пароля пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-284">Requiring a password question and answer provides an additional layer of security when resetting a user's password.</span></span> <span data-ttu-id="102c4-285">При создании имени пользователя пользователь может указать вопрос и ответ, которые впоследствии можно будет использовать для сброса забытого пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-285">When creating a user name, a user can supply a question and answer that can later be used to reset a forgotten password.</span></span> <span data-ttu-id="102c4-286">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> обновляет вопрос и ответ пароля для пользователя членства в новых значениях.</span><span class="sxs-lookup"><span data-stu-id="102c4-286">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method updates the password question and answer for a membership user to new values.</span></span>  
  
 <span data-ttu-id="102c4-287">Чтобы использовать метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>, необходимо задать следующие дополнительные атрибуты в файле конфигурации приложения:</span><span class="sxs-lookup"><span data-stu-id="102c4-287">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, you must set these additional attributes in your application's configuration file:</span></span>  
  
-   <span data-ttu-id="102c4-288">необходимо `true.` `requiresQuestionAndAnswer`</span><span class="sxs-lookup"><span data-stu-id="102c4-288">`requiresQuestionAndAnswer` must be `true.`</span></span>  
  
-   <span data-ttu-id="102c4-289">`attributeMapPasswordQuestion` и `attributeMapPasswordAnswer` должны быть сопоставлены с атрибутами в схеме Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-289">`attributeMapPasswordQuestion` and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="102c4-290">Если указанные выше условия не выполняются, при инициализации возникает исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-290">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="102c4-291"><xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр подключается к хранилищу данных Active Directory с учетными данными, указанными в параметрах `username` и `password`, для проверки комбинации имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-291">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance connects to the Active Directory data store with the credentials provided in the `username` and `password` parameters to validate the user name/password combination.</span></span> <span data-ttu-id="102c4-292">Фактическое обновление вопроса и ответа выполняется с помощью настроенных учетных данных соединения поставщика.</span><span class="sxs-lookup"><span data-stu-id="102c4-292">The actual update of the question and answer is performed with the configured connection credentials of the provider.</span></span>  
  
 <span data-ttu-id="102c4-293">Если методу <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> передается неверный пароль, сервер каталогов увеличивает счетчики, которые отписывают недопустимые попытки ввода пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-293">If an incorrect password is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, the directory server will increment the counters that track invalid password attempts.</span></span> <span data-ttu-id="102c4-294">Это может привести к блокировке пользователя и невозможности входа в систему до тех пор, пока состояние блокировки не будет снято вызовом метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> или заблокированной длительностью, указанной в ходе передачи каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-294">This can result in the user being locked and unable to log on until either the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method or the locked duration specified in the directory passes.</span></span>  
  
 <span data-ttu-id="102c4-295">Если обновление для вопроса и ответа прошло удачно и свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, счетчики отслеживания ответов пользователя с неверным паролем сбрасываются.</span><span class="sxs-lookup"><span data-stu-id="102c4-295">If the update to the question and answer succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="102c4-296">Ответ на пароль шифруется с помощью метода <xref:System.Web.Security.MembershipProvider.EncryptPassword%2A>, прежде чем он будет сохранен в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-296">The password answer is encrypted using the <xref:System.Web.Security.MembershipProvider.EncryptPassword%2A> method before it is stored in the Active Directory data store.</span></span> <span data-ttu-id="102c4-297">Ключ шифрования и алгоритм задаются элементом конфигурации [элемента machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) .</span><span class="sxs-lookup"><span data-stu-id="102c4-297">The encryption key and algorithm are specified by the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element.</span></span> <span data-ttu-id="102c4-298">Необходимо указать атрибут расшифровки элемента [machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) , <xref:System.Web.Security.ActiveDirectoryMembershipProvider> класс не поддерживает автоматически созданные ключи шифрования.</span><span class="sxs-lookup"><span data-stu-id="102c4-298">The decryption attribute on the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element must be specified, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support auto-generated encryption keys.</span></span>  
  
 <span data-ttu-id="102c4-299">Максимальная длина контрольного вопроса — 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-299">The maximum length for the password question is 256 characters.</span></span> <span data-ttu-id="102c4-300">Максимальная длина ответа на пароль — 128 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-300">The maximum length for the password answer is 128 characters.</span></span>  
  
 <span data-ttu-id="102c4-301">Начальные и конечные пробелы удаляются из всех значений параметров, за исключением `password`.</span><span class="sxs-lookup"><span data-stu-id="102c4-301">Leading and trailing spaces are trimmed from all parameter values except for `password`.</span></span>  
  
 <span data-ttu-id="102c4-302">Поставщик находит пользовательский экземпляр для обновления, выполняя поиск по поддереву для имени пользователя, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-302">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-303">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-303">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-304">Администратор не отобразил поля запроса-ответа пароля на атрибуты схемы Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-304">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-305">Параметр <paramref name="username" /> пустой, или превышает максимальную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-305"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-306">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-306">-or-</span></span> 
 <span data-ttu-id="102c4-307"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-307"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-308">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-308">-or-</span></span> 
<span data-ttu-id="102c4-309">Имя пользователя отображается на атрибут <see langword="userPrincipalName" /> и параметр <paramref name="username" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-309">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="102c4-310">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-310">-or-</span></span> 
 <span data-ttu-id="102c4-311"><paramref name="password" /> представляет собой строку нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="102c4-311"><paramref name="password" /> is a zero-length string.</span></span>  
  
<span data-ttu-id="102c4-312">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-312">-or-</span></span> 
 <span data-ttu-id="102c4-313">Параметр <paramref name="password" /> превышает максимальную длину пароля (обычно 128 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-313"><paramref name="password" /> exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="102c4-314">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-314">-or-</span></span> 
 <span data-ttu-id="102c4-315">Параметр <paramref name="newPasswordQuestion" /> пустой и значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> равно <see langword="true" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-315"><paramref name="newPasswordQuestion" /> is empty and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property value is <see langword="true" />.</span></span>  
  
<span data-ttu-id="102c4-316">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-316">-or-</span></span> 
 <span data-ttu-id="102c4-317">Длина параметра <paramref name="newPasswordQuestion" /> превышает 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-317"><paramref name="newPasswordQuestion" /> exceeds 256 characters.</span></span>  
  
<span data-ttu-id="102c4-318">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-318">-or-</span></span> 
 <span data-ttu-id="102c4-319">Длина параметра <paramref name="newPasswordAnswer" /> после шифрования ответа превышает 128 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-319"><paramref name="newPasswordAnswer" /> exceeds 128 characters after the answer is encrypted.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-320"><paramref name="username" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-320"><paramref name="username" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-321">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-321">-or-</span></span> 
 <span data-ttu-id="102c4-322">Свойство <paramref name="password" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-322"><paramref name="password" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-323">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-323">-or-</span></span> 
 <span data-ttu-id="102c4-324">Параметр <paramref name="newPasswordQuestion" /> равен <see langword="null" /> и свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> равно <see langword="true" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-324"><paramref name="newPasswordQuestion" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span>  
  
<span data-ttu-id="102c4-325">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-325">-or-</span></span> 
 <span data-ttu-id="102c4-326">Параметр <paramref name="newPasswordAnswer" /> равен <see langword="null" /> и свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> равно <see langword="true" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-326"><paramref name="newPasswordAnswer" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-327">Элемент конфигурации [machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) указывает автоматически созданный ключ шифрования компьютера.</span><span class="sxs-lookup"><span data-stu-id="102c4-327">The [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="102c4-328">Необходимо явно установить атрибут <see langword="decryptionKey" /> элемента [machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) для хранения ответов пароля с поставщиком <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-328">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-329">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-329">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-330">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-330">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CreateUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser CreateUser (string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out System.Web.Security.MembershipCreateStatus status);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, [out] valuetype System.Web.Security.MembershipCreateStatus&amp; status) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function CreateUser (username As String, password As String, email As String, passwordQuestion As String, passwordAnswer As String, isApproved As Boolean, providerUserKey As Object, ByRef status As MembershipCreateStatus) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ CreateUser(System::String ^ username, System::String ^ password, System::String ^ email, System::String ^ passwordQuestion, System::String ^ passwordAnswer, bool isApproved, System::Object ^ providerUserKey, [Runtime::InteropServices::Out] System::Web::Security::MembershipCreateStatus % status);" />
      <MemberSignature Language="F#" Value="override this.CreateUser : string * string * string * string * string * bool * obj * MembershipCreateStatus -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.CreateUser (username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, status)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="email" Type="System.String" />
        <Parameter Name="passwordQuestion" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
        <Parameter Name="isApproved" Type="System.Boolean" />
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="status" Type="System.Web.Security.MembershipCreateStatus" RefType="out" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-331">Имя пользователя для нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-331">The user name for the new user.</span></span></param>
        <param name="password"><span data-ttu-id="102c4-332">Пароль для нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-332">The password for the new user.</span></span></param>
        <param name="email"><span data-ttu-id="102c4-333">Адрес электронной почты нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-333">The email address of the new user.</span></span></param>
        <param name="passwordQuestion"><span data-ttu-id="102c4-334">Вопрос пароля для нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-334">The password question for the new user.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="102c4-335">Контрольный ответ для пароля нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-335">The password answer for the new user.</span></span></param>
        <param name="isApproved"><span data-ttu-id="102c4-336">Утвержден ли новый пользователь для проверки.</span><span class="sxs-lookup"><span data-stu-id="102c4-336">Whether or not the new user is approved to be validated.</span></span></param>
        <param name="providerUserKey"><span data-ttu-id="102c4-337">Уникальный идентификатор из источника данных членства для пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-337">The unique identifier from the membership data source for the user.</span></span> <span data-ttu-id="102c4-338">Этот параметр должен равняться <see langword="null" /> при использовании класса <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-338">This parameter must be <see langword="null" /> when using the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></param>
        <param name="status"><span data-ttu-id="102c4-339">Результатом выполнения этого метода является одно из значений перечисления <see cref="T:System.Web.Security.MembershipCreateStatus" />, указывающее, был ли успешно создан пользователь.</span><span class="sxs-lookup"><span data-stu-id="102c4-339">When this method returns, contains one of the <see cref="T:System.Web.Security.MembershipCreateStatus" /> enumeration values indicating whether the user was created successfully.</span></span></param>
        <summary><span data-ttu-id="102c4-340">Добавляет нового пользователя к хранилищу данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-340">Adds a new user to the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="102c4-341">Экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" />, содержащий информацию о вновь созданном пользователе или значение <see langword="null" />, если пользователь не был успешно создан.</span><span class="sxs-lookup"><span data-stu-id="102c4-341">An <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> instance containing the information for the newly created user, or <see langword="null" /> if the user was not successfully created.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-342">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> вызывается классом <xref:System.Web.Security.Membership> для создания нового пользователя в Active Directory хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-342">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> method is called by the <xref:System.Web.Security.Membership> class to create a new user in the Active Directory data store.</span></span>  
  
 <span data-ttu-id="102c4-343">Для Active Directory и серверов Active Directory режима приложений (ADAM) класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> требует, чтобы класс экземпляра в каталоге `user`.</span><span class="sxs-lookup"><span data-stu-id="102c4-343">For both Active Directory and Active Directory Application Mode (ADAM) servers, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires that the instance class in the directory be `user`.</span></span> <span data-ttu-id="102c4-344">Альтернативные классы пользователей, такие как `inetOrgPerson`, не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="102c4-344">Alternative user classes such as `inetOrgPerson` are not supported.</span></span>  
  
 <span data-ttu-id="102c4-345">При использовании Active Directory сервера и имени пользователя, сопоставленного с атрибутом `userPrincipalName`, класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> автоматически создаст случайное 20-значное имя пользователя для параметра `sAMAccountName` от вашего имени.</span><span class="sxs-lookup"><span data-stu-id="102c4-345">When using an Active Directory server and the user name is mapped to the `userPrincipalName` attribute, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will automatically generate a random 20-character user name for the `sAMAccountName` parameter on your behalf.</span></span>  
  
 <span data-ttu-id="102c4-346">По умолчанию для параметров используется следующая максимальная длина.</span><span class="sxs-lookup"><span data-stu-id="102c4-346">Parameters default to the following maximum lengths.</span></span>  
  
|<span data-ttu-id="102c4-347">Параметр</span><span class="sxs-lookup"><span data-stu-id="102c4-347">Parameter</span></span>|<span data-ttu-id="102c4-348">Максимальная длина</span><span class="sxs-lookup"><span data-stu-id="102c4-348">Maximum length</span></span>|  
|---------------|--------------------|  
|`username`|<span data-ttu-id="102c4-349">64 символов при использовании атрибута `userPrincipalName`.</span><span class="sxs-lookup"><span data-stu-id="102c4-349">64 characters if using the `userPrincipalName` attribute.</span></span> <span data-ttu-id="102c4-350">При использовании атрибута `sAMAccountName` общее ограничение составляет не более 20 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-350">If using the `sAMAccountName` attribute, the common restriction is 20 characters or less.</span></span>|  
|`password`|<span data-ttu-id="102c4-351">128 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-351">128 characters.</span></span>|  
|`email`|<span data-ttu-id="102c4-352">256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-352">256 characters.</span></span>|  
|`passwordQuestion`|<span data-ttu-id="102c4-353">256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-353">256 characters.</span></span>|  
|`passwordAnswer`|<span data-ttu-id="102c4-354">128 символов до и после шифрования.</span><span class="sxs-lookup"><span data-stu-id="102c4-354">128 characters before and after encrypting.</span></span>|  
  
 <span data-ttu-id="102c4-355">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A> в возвращаемом <xref:System.Web.Security.ActiveDirectoryMembershipUser>ном экземпляре имеет ограничение в 1024 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-355">The <xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A> property on the returned <xref:System.Web.Security.ActiveDirectoryMembershipUser> instance is limited to 1024 characters.</span></span>  
  
 <span data-ttu-id="102c4-356">Если схема каталога была изменена путем уменьшения максимально допустимой длины для этих атрибутов, эти значения будут иметь приоритет.</span><span class="sxs-lookup"><span data-stu-id="102c4-356">If the directory schema has been modified by reducing the maximum allowable lengths for these attributes, these lengths will take precedence.</span></span>  
  
 <span data-ttu-id="102c4-357">Перед созданием пользователя класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> гарантирует, что имя пользователя является уникальным.</span><span class="sxs-lookup"><span data-stu-id="102c4-357">Before creating the user, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will make sure the user name is unique.</span></span> <span data-ttu-id="102c4-358">Если для экземпляра <xref:System.Web.Security.ActiveDirectoryMembershipProvider> настроено требование наличия уникальных адресов электронной почты, это также обеспечит уникальность адреса электронной почты.</span><span class="sxs-lookup"><span data-stu-id="102c4-358">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to require unique email addresses, it will also make sure the email address is unique.</span></span>  
  
 <span data-ttu-id="102c4-359">В Active Directory уникальность имени пользователя обеспечивается путем поиска GC, когда имя пользователя сопоставляется с `userPrincipalName`.</span><span class="sxs-lookup"><span data-stu-id="102c4-359">In an Active Directory user-name uniqueness is enforced by performing a GC search when the user name is mapped to `userPrincipalName`.</span></span> <span data-ttu-id="102c4-360">Если используется `sAMAccountName`, то каталог будет автоматически обеспечивать уникальность `sAMAccountName` в домене Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-360">If `sAMAccountName` is used, then the directory will automatically enforce uniqueness of the `sAMAccountName` across the Active Directory domain.</span></span>  
  
 <span data-ttu-id="102c4-361">Сервер ADAM автоматически применяет уникальность имени пользователя `userPrincipalName` во всех разделах приложений.</span><span class="sxs-lookup"><span data-stu-id="102c4-361">An ADAM server will automatically enforce user name uniqueness of the `userPrincipalName` across all application partitions.</span></span>  
  
 <span data-ttu-id="102c4-362">Уникальность адреса электронной почты обеспечивается путем выполнения поиска по поддереву для повторяющегося адреса электронной почты, начиная с корня контейнера, в котором создаются пользователи.</span><span class="sxs-lookup"><span data-stu-id="102c4-362">Uniqueness of the email address is enforced by performing a subtree search for a duplicate email address starting at the root of the container in which users are created.</span></span> <span data-ttu-id="102c4-363">Это контейнер пользователя по умолчанию (если он подключен к Active Directory и в строке подключения не указан контейнер) или контейнер, указанный в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-363">This is either the default user container (if connected to an Active Directory and no container was specified in the connection string) or the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="102c4-364">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> создает пользователя непосредственно в контейнере пользователя, указанном в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-364">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class creates the user directly in the user container specified in the connection string.</span></span> <span data-ttu-id="102c4-365">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-365">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-366">Для установки паролей на Active Directory сервере атрибут `connectionProtection` должен иметь значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span><span class="sxs-lookup"><span data-stu-id="102c4-366">For passwords to be set on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="102c4-367">При использовании сервера ADAM для атрибута `connectionProtection` можно задать значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, но только при явной настройке сервера ADAM для разрешения смены пароля через незащищенные соединения.</span><span class="sxs-lookup"><span data-stu-id="102c4-367">When an ADAM server is being used, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
 <span data-ttu-id="102c4-368">Начальные и конечные пробелы удаляются из всех значений строковых параметров, за исключением `password`.</span><span class="sxs-lookup"><span data-stu-id="102c4-368">Leading and trailing spaces are trimmed from all string parameter values except `password`.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-369">Вы не можете создавать новых пользователей, если учетные данные, используемые для подключения к серверу Active Directory, не имеют прав администратора домена (не рекомендуется) или "создать дочерний экземпляр", "удалить дочерний экземпляр" и "задать пароль".</span><span class="sxs-lookup"><span data-stu-id="102c4-369">You cannot create new users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "create child instance," "delete child instance," and "set password" access rights.</span></span> <span data-ttu-id="102c4-370">Право доступа "удалить дочерний экземпляр" требуется, так как создание пользователя является многоэтапным процессом, и если какой-либо шаг создания пользователя завершается неудачей, <xref:System.Web.Security.ActiveDirectoryMembershipProvider> класс удаляет пользовательский экземпляр, а не оставляет частично сконструированный пользовательский экземпляр в каталоге.</span><span class="sxs-lookup"><span data-stu-id="102c4-370">The "delete child instance" access right is required because creating a user is a multi-step process, and if any step of user creation fails, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will delete the user instance rather than leave a partially constructed user instance in the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-371">Параметр <paramref name="providerUserKey" /> не является <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-371">The <paramref name="providerUserKey" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-372">Администратор не отобразил поля запроса-ответа пароля на атрибуты схемы Active Directory, и один из параметров <paramref name="passwordQuestion" /> или <paramref name="passwordAnswer" /> не равен <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-372">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema, and either the <paramref name="passwordQuestion" /> or <paramref name="passwordAnswer" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-373">Элемент конфигурации [machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) указывает автоматически созданный ключ шифрования компьютера.</span><span class="sxs-lookup"><span data-stu-id="102c4-373">The [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="102c4-374">Необходимо явно установить атрибут <see langword="decryptionKey" /> элемента [machineKey (схема параметров ASP.NET)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) для хранения ответов пароля с поставщиком <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-374">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span>  
  
<span data-ttu-id="102c4-375">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-375">-or-</span></span> 
<span data-ttu-id="102c4-376">Поставщик <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не смог установить безопасное подключение к каталогу, при попытке установить пароль для нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-376">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> was unable to establish a secure connection to the directory when attempting to set the password for the new user.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="102c4-377">Произошла ошибка при попытке создания пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-377">An error occurred while attempting to create the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-378">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-378">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-379">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-379">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentConnectionProtection">
      <MemberSignature Language="C#" Value="public System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentConnectionProtection As ActiveDirectoryConnectionProtection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::Security::ActiveDirectoryConnectionProtection CurrentConnectionProtection { System::Web::Security::ActiveDirectoryConnectionProtection get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentConnectionProtection : System.Web.Security.ActiveDirectoryConnectionProtection" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.ActiveDirectoryConnectionProtection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-380">Возвращает текущий уровень безопасности, используемый для защиты связи с сервером.</span><span class="sxs-lookup"><span data-stu-id="102c4-380">Gets the current level of security being used to protect communications with the server.</span></span></summary>
        <value><span data-ttu-id="102c4-381">Одно из значений перечисления <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-381">One of the <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-382">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> указывает текущий уровень безопасности, используемый экземпляром <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-382">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property indicates the current level of security that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use.</span></span> <span data-ttu-id="102c4-383">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> основано на атрибуте `connnectionProtection`, заданном с помощью [элемента Add для providers для членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-383">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is based on the `connnectionProtection` attribute set with the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file.</span></span>  
  
 <span data-ttu-id="102c4-384">Для атрибута `connectionProtection` можно задать только <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> или <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> в файле конфигурации.</span><span class="sxs-lookup"><span data-stu-id="102c4-384">The `connectionProtection` attribute can only be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> or <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> in the configuration file.</span></span>  
  
 <span data-ttu-id="102c4-385">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-385">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-386">В следующем примере кода показана запись Web. config, которая настраивает <xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр для использования протокола безопасности SSL для подключения к серверу Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-386">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to use the SSL security protocol to connect to an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionProtection="SignAndSeal" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-387">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-387">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-388">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-388">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteUser">
      <MemberSignature Language="C#" Value="public override bool DeleteUser (string username, bool deleteAllRelatedData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteUser(string username, bool deleteAllRelatedData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteUser (username As String, deleteAllRelatedData As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteUser(System::String ^ username, bool deleteAllRelatedData);" />
      <MemberSignature Language="F#" Value="override this.DeleteUser : string * bool -&gt; bool" Usage="activeDirectoryMembershipProvider.DeleteUser (username, deleteAllRelatedData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="deleteAllRelatedData" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-389">Имя удаляемого пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-389">The name of the user to delete.</span></span></param>
        <param name="deleteAllRelatedData"><span data-ttu-id="102c4-390">Этот параметр игнорируется методом <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-390">This parameter is ignored by the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method.</span></span></param>
        <summary><span data-ttu-id="102c4-391">Удаляет сведения о членстве пользователя из хранилища данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-391">Removes a user's membership information from the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="102c4-392"><see langword="true" />, если пользователь был удален; в противном случае — <see langword="false" />, если пользователь не был найден в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-392"><see langword="true" /> if the user was deleted; otherwise, <see langword="false" /> if the user was not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-393">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> немедленно удаляет пользователя, определяемого параметром `username`.</span><span class="sxs-lookup"><span data-stu-id="102c4-393">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method immediately removes the user identified by the `username` parameter.</span></span> <span data-ttu-id="102c4-394">Поскольку Active Directory хранилище данных не сохраняет сведения о пользователях в отдельных областях каталога, параметр `deleteAllRelatedData` игнорируется, хотя при вызове метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> его необходимо задать как `true`, так и `false`.</span><span class="sxs-lookup"><span data-stu-id="102c4-394">Since the Active Directory data store does not store user information in separate areas of the directory, the `deleteAllRelatedData` parameter is ignored, although it must be set to either `true` or `false` when calling the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method.</span></span>  
  
 <span data-ttu-id="102c4-395">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> находит удаляемый пользовательский экземпляр, выполняя одноуровневое Поиск имени пользователя в контейнере Users, определяемого строкой подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-395">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class finds the user instance to delete by performing a single-level search for the user name in the users container determined by the connection string.</span></span> <span data-ttu-id="102c4-396">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-396">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-397">Длина `username` не должна превышать 64 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-397">`username` must be 64 characters or less.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-398">Нельзя удалить пользователей, если только учетные данные, используемые для подключения к серверу Active Directory, не имеют прав администратора домена (не рекомендуется) или права доступа "удалить дочерние экземпляры".</span><span class="sxs-lookup"><span data-stu-id="102c4-398">You cannot delete users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "delete child instances" access right.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-399">Параметр <paramref name="username" /> пустой, или превышает максимальную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-399"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-400">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-400">-or-</span></span> 
 <span data-ttu-id="102c4-401"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-401"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-402">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-402">-or-</span></span> 
<span data-ttu-id="102c4-403">Имя пользователя отображается на атрибут <see langword="userPrincipalName" /> и параметр <paramref name="userName" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-403">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="userName" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-404"><paramref name="username" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-404"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="102c4-405">Произошла ошибка при попытке удаления пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-405">An error occurred while attempting to delete the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-406">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-406">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-407">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-407">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordReset">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordReset { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordReset" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordReset As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordReset { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordReset : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-408">Возвращает значение, показывающее, настроен ли экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> на разрешение пользователям восстанавливать их пароли.</span><span class="sxs-lookup"><span data-stu-id="102c4-408">Gets a value indicating whether the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is configured to allow users to reset their passwords.</span></span></summary>
        <value><span data-ttu-id="102c4-409"><see langword="true" />, если восстановление пароля разрешено; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-409"><see langword="true" /> if password reset is allowed; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-410">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-410">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-411">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> указывает, можно ли использовать метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> для сброса пароля пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-411">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property indicates whether you can use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to reset a user's password.</span></span> <span data-ttu-id="102c4-412">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> задается в файле конфигурации приложения с помощью атрибута `enablePasswordReset` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-412">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is set in your application's configuration file using the `enablePasswordReset` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span>  
  
 <span data-ttu-id="102c4-413">Можно задать только свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> `true` при выполнении следующих параметров элемента [членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-413">You can only set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property `true` when the following [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element settings have been made.</span></span>  
  
-   <span data-ttu-id="102c4-414">необходимо `true``requiresQuestionAndAnswer`.</span><span class="sxs-lookup"><span data-stu-id="102c4-414">`requiresQuestionAndAnswer` must be `true`.</span></span>  
  
-   <span data-ttu-id="102c4-415">Схему Active Directory необходимо изменить, чтобы она содержала атрибуты для хранения вопроса и ответа пароля, а также три поля отслеживания для попыток изменения пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-415">The Active Directory schema must be modified to contain attributes for storing the password question and answer, as well as the three tracking fields for password-answer change attempts.</span></span>  
  
-   <span data-ttu-id="102c4-416">`attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`и `attributeMapFailedPasswordAnswerLockoutTime` должны быть сопоставлены с атрибутами в схеме Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-416">`attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockoutTime` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="102c4-417">Если указанные выше условия не выполняются, при инициализации возникает исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-417">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="102c4-418">Если в строке подключения в файле конфигурации приложения указан Active Directory домен, а не конкретный сервер, то экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет всегда подключаться к контроллеру домена, имеющему роль PDC для домена, чтобы обеспечить этот пароль. изменения вступают в силу и становятся доступными при вызове метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-418">When the connection string in the application configuration file specifies an Active Directory domain rather than a specific server, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the domain controller that has the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-419">Даже если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, вы не можете сбрасывать пароли пользователей, если только учетные данные, используемые для подключения к серверу Active Directory, не имеют прав администратора домена (не рекомендуется) или права доступа "Сброс пароля".</span><span class="sxs-lookup"><span data-stu-id="102c4-419">Even if the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, you cannot reset user passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-420">В следующем примере кода показана запись Web. config, которая настраивает <xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр для включения сброса пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-420">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="102c4-421">Он использует явные учетные данные пользователя при наличии права доступа "Сброс пароля".</span><span class="sxs-lookup"><span data-stu-id="102c4-421">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-422">При помещении учетных данных пользователя в файл Web. config возникают потенциальные угрозы безопасности.</span><span class="sxs-lookup"><span data-stu-id="102c4-422">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="102c4-423">Пользователи с правами доступа к каталогу, содержащему файл Web. config, могут прочитать файл и, таким же, просмотреть учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-423">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="102c4-424">Дополнительные сведения о защите от этой угрозы см. в разделе [Шифрование сведений о конфигурации с помощью защищенной конфигурации](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span><span class="sxs-lookup"><span data-stu-id="102c4-424">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-425">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-425">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-426">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-426">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordRetrieval">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordRetrieval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordRetrieval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordRetrieval As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordRetrieval { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordRetrieval : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-427">Получает значение, указывающее, может ли пароль пользователя быть извлечен из хранилища данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-427">Gets a value indicating whether the user's password can be retrieved from the Active Directory data store.</span></span> <span data-ttu-id="102c4-428">Данное свойство всегда возвращает значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-428">This property always returns <see langword="false" />.</span></span></summary>
        <value><span data-ttu-id="102c4-429">Значение <see langword="false" />, чтобы показать, что возврат пароля не поддерживается классом <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-429"><see langword="false" /> to indicate that password retrieval is not supported by the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-430">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> не поддерживает извлечение пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-430">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support password retrieval.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-431">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-431">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="EnableSearchMethods">
      <MemberSignature Language="C#" Value="public bool EnableSearchMethods { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableSearchMethods" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EnableSearchMethods As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableSearchMethods { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnableSearchMethods : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-432">Возвращает значение, указывающее, доступны ли методы <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> ориентированные на поиск.</span><span class="sxs-lookup"><span data-stu-id="102c4-432">Gets a value indicating whether search-oriented <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> methods are available.</span></span></summary>
        <value><span data-ttu-id="102c4-433"><see langword="true" />, если методы поиска доступны; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-433"><see langword="true" /> if search methods are available; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-434">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-434">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-435">Поскольку поиск на сервере Active Directory потенциально ресурсоемких ресурсов, свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> позволяет отключить методы <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, ориентированные на поиск.</span><span class="sxs-lookup"><span data-stu-id="102c4-435">Because searching an Active Directory server is potentially resource intensive, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property enables you to turn off search-oriented <xref:System.Web.Security.ActiveDirectoryMembershipProvider> methods.</span></span> <span data-ttu-id="102c4-436">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> задается в файле конфигурации приложения с помощью атрибута `enableSearchMethods` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-436">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is set in your application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span>  
  
 <span data-ttu-id="102c4-437">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> `false`, следующие методы недоступны.</span><span class="sxs-lookup"><span data-stu-id="102c4-437">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`, the following methods are not available:</span></span>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>  
  
 <span data-ttu-id="102c4-438">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-438">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-439">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-439">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-440">Рекомендуется не включать Поиск в рабочих системах, пока не будет подтверждено, что запросы поиска, выданные классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, не негативно повлияют на производительность сервера каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-440">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="102c4-441">Поскольку класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> предназначен для веб-среды без отслеживания состояния, невозможно использовать оптимизацию разбиения по страницам, предоставляемую базовыми API <xref:System.DirectoryServices>.</span><span class="sxs-lookup"><span data-stu-id="102c4-441">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="102c4-442">Это означает, что операции подкачки во время поиска в больших каталогах очень ресурсоемки, и их следует избегать.</span><span class="sxs-lookup"><span data-stu-id="102c4-442">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="102c4-443">Операции поиска всегда выдаются для сервера каталогов, настроенного в строке подключения, или автоматически выбранного сервера в случае строки подключения, указывающей на домен.</span><span class="sxs-lookup"><span data-stu-id="102c4-443">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="102c4-444">Поставщик не использует глобальный каталог для своих методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-444">The provider does not use a global catalog for its search methods.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-445">В следующем примере кода показана запись Web. config, которая настраивает экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для включения поиска на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-445">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable searching an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          enableSearchMethods="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-446">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-446">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-447">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-447">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByEmail">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByEmail (string emailToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByEmail(string emailToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByEmail (emailToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByEmail(System::String ^ emailToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByEmail : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByEmail (emailToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="emailToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="emailToMatch"><span data-ttu-id="102c4-448">Адрес электронной почты (или его часть) для поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-448">Email address or portion of email address to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="102c4-449">Индекс страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-449">The index of the page of results to return.</span></span> <span data-ttu-id="102c4-450">Индекс <paramref name="pageIndex" /> отсчитывается от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-450"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="102c4-451">Размер страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-451">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="102c4-452">По окончании метод возвращает общее число пользователей, возвращенных в коллекции.</span><span class="sxs-lookup"><span data-stu-id="102c4-452">When this method returns, contains the total number of users returned in the collection.</span></span> <span data-ttu-id="102c4-453">Этот параметр передается неинициализированным.</span><span class="sxs-lookup"><span data-stu-id="102c4-453">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="102c4-454">Возвращает коллекцию пользователей членства из хранилища данных Active Directory, основанную на адресах электронной почты пользователей.</span><span class="sxs-lookup"><span data-stu-id="102c4-454">Returns a collection of membership users from the Active Directory data store based on the user's email address.</span></span></summary>
        <returns><span data-ttu-id="102c4-455">Объект <see cref="T:System.Web.Security.MembershipUserCollection" />, содержащий экземпляры <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" />, начиная со страницы, определенной параметром <paramref name="pageIndex" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-455">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-456">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> возвращает <xref:System.Web.Security.MembershipUserCollection>, содержащий записи пользователя из хранилища Active Directory, соответствующие параметрам `emailToMatch`.</span><span class="sxs-lookup"><span data-stu-id="102c4-456">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method gets a <xref:System.Web.Security.MembershipUserCollection> containing the user records from the Active Directory store that match the `emailToMatch` parameters.</span></span> <span data-ttu-id="102c4-457">Записи пользователей возвращаются в порядке возрастания по адресу электронной почты.</span><span class="sxs-lookup"><span data-stu-id="102c4-457">The user records are returned sorted in ascending order by email address.</span></span>  
  
 <span data-ttu-id="102c4-458">Длина параметра `emailToMatch` ограничена 256 символами.</span><span class="sxs-lookup"><span data-stu-id="102c4-458">The `emailToMatch` parameter is limited to 256 characters.</span></span>  
  
 <span data-ttu-id="102c4-459">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выполнит поиск, используя значения конфигурации `clientSearchTimeout` и `serverSearchTimeout`.</span><span class="sxs-lookup"><span data-stu-id="102c4-459">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will issue the search using both the `clientSearchTimeout` and `serverSearchTimeout` configuration values.</span></span> <span data-ttu-id="102c4-460">Так как класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выполняет поиск в сервере каталогов с помощью страниц с 512 строк на страницу, время ожидания применяется к каждой странице результатов, извлекаемых классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-460">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class performs searches against the directory server using pages with 512 rows per page, the time-outs apply to each page of results fetched by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="102c4-461">Например, если поисковый запрос выдает 1 000 строк данных, то класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> выберет эти сведения как две страницы данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-461">For example, if a search query results in 1,000 rows of data, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will fetch this information as two pages of data.</span></span> <span data-ttu-id="102c4-462">Это означает, что время ожидания клиента и поиска начнет отсчет с нуля, когда класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> запрашивает вторую страницу данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-462">This means that the client and search time-outs will start counting from zero when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requests the second page of data.</span></span>  
  
 <span data-ttu-id="102c4-463">Результаты, возвращаемые методом <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>, ограничиваются параметрами `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="102c4-463">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="102c4-464">Параметр `pageSize` указывает максимальное число экземпляров <xref:System.Web.Security.MembershipUser>, возвращаемых в <xref:System.Web.Security.MembershipUserCollection>.</span><span class="sxs-lookup"><span data-stu-id="102c4-464">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="102c4-465">Параметр `pageIndex` указывает возвращаемую страницу результатов, где 0 (ноль) указывает на первую страницу.</span><span class="sxs-lookup"><span data-stu-id="102c4-465">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="102c4-466">Параметр `totalRecords` — это `out` параметр, который задает общее число соответствующих пользователей членства, найденных в Active Directory хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-466">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="102c4-467">Например, если для настроенного хранилища данных установлено 13 пользователей, а `pageIndex` значение было равно 1 с `pageSize` 5, то возвращаемый <xref:System.Web.Security.MembershipUserCollection> будет содержать шестую часть по десятым пользователям.</span><span class="sxs-lookup"><span data-stu-id="102c4-467">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="102c4-468">Параметру `totalRecords` будет присвоено значение 13.</span><span class="sxs-lookup"><span data-stu-id="102c4-468">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="102c4-469">Можно указать, следует ли разрешить поиск пользователей, задав свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> в файле конфигурации приложения с помощью атрибута `enableSearchMethods` элемента [членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-469">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-470">Присвоение свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> значения `false` приводит к тому, что метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> вызывает исключение <xref:System.NotSupportedException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-470">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="102c4-471">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-471">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-472">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-472">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-473">Рекомендуется не включать Поиск в рабочих системах, пока не будет подтверждено, что запросы поиска, выданные классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, не негативно повлияют на производительность сервера каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-473">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="102c4-474">Поскольку класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> предназначен для веб-среды без отслеживания состояния, невозможно использовать оптимизацию разбиения по страницам, предоставляемую базовыми API <xref:System.DirectoryServices>.</span><span class="sxs-lookup"><span data-stu-id="102c4-474">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="102c4-475">Это означает, что операции подкачки во время поиска в больших каталогах очень ресурсоемки, и их следует избегать.</span><span class="sxs-lookup"><span data-stu-id="102c4-475">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="102c4-476">Операции поиска всегда выдаются для сервера каталогов, настроенного в строке подключения, или автоматически выбранного сервера в случае строки подключения, указывающей на домен.</span><span class="sxs-lookup"><span data-stu-id="102c4-476">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="102c4-477">Поставщик не использует глобальный каталог для своих методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-477">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-478">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-478">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-479">Параметр <paramref name="emailToMatch" /> пуст.</span><span class="sxs-lookup"><span data-stu-id="102c4-479"><paramref name="emailToMatch" /> is empty.</span></span>  
  
<span data-ttu-id="102c4-480">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-480">-or-</span></span> 
 <span data-ttu-id="102c4-481">Длина параметра <paramref name="emailToMatch" /> превышает 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-481"><paramref name="emailToMatch" /> exceeds 256 characters.</span></span>  
  
<span data-ttu-id="102c4-482">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-482">-or-</span></span> 
 <span data-ttu-id="102c4-483">Значение параметра <paramref name="pageIndex" /> меньше 0.</span><span class="sxs-lookup"><span data-stu-id="102c4-483"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="102c4-484">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-484">-or-</span></span> 
 <span data-ttu-id="102c4-485">Значение параметра<paramref name="pageSize" /> меньше 1.</span><span class="sxs-lookup"><span data-stu-id="102c4-485"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="102c4-486">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-486">-or-</span></span> 
 <span data-ttu-id="102c4-487">Значение <paramref name="pageSize" />, умноженное на <paramref name="pageIndex" />, плюс <paramref name="pageSize" /> минус 1 больше <see cref="F:System.Int32.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-487"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-488">Значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-488">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-489">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-489">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByName">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByName (string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByName(string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByName (usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByName(System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByName : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByName (usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch"><span data-ttu-id="102c4-490">Имя пользователя (или его часть) для поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-490">The user name or portion of a user name to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="102c4-491">Индекс страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-491">The index of the page of results to return.</span></span> <span data-ttu-id="102c4-492">Индекс <paramref name="pageIndex" /> отсчитывается от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-492"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="102c4-493">Размер страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-493">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="102c4-494">По окончании метод возвращает общее число записей, возвращенных в коллекции.</span><span class="sxs-lookup"><span data-stu-id="102c4-494">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="102c4-495">Этот параметр передается неинициализированным.</span><span class="sxs-lookup"><span data-stu-id="102c4-495">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="102c4-496">Возвращает коллекцию пользователей из хранилища данных Active Directory, основанную на именах пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-496">Returns a collection of users from the Active Directory data store based on the user name.</span></span></summary>
        <returns><span data-ttu-id="102c4-497">Объект <see cref="T:System.Web.Security.MembershipUserCollection" />, содержащий экземпляры <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" />, начиная со страницы, определенной параметром <paramref name="pageIndex" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-497">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-498">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> возвращает экземпляр <xref:System.Web.Security.MembershipUserCollection>, содержащий записи пользователя из Active Directory хранилища данных для всех имен пользователей, которые соответствуют параметрам `userNameToMatch`.</span><span class="sxs-lookup"><span data-stu-id="102c4-498">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method returns a <xref:System.Web.Security.MembershipUserCollection> instance containing the user records from the Active Directory data store for all user names that match the `userNameToMatch` parameters.</span></span> <span data-ttu-id="102c4-499">Записи возвращаются в алфавитном порядке по имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-499">The records are returned sorted alphabetically by user name.</span></span>  
  
 <span data-ttu-id="102c4-500">Результаты, возвращаемые методом <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>, ограничиваются параметрами `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="102c4-500">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="102c4-501">Параметр `pageSize` указывает максимальное число экземпляров <xref:System.Web.Security.MembershipUser>, возвращаемых в <xref:System.Web.Security.MembershipUserCollection>.</span><span class="sxs-lookup"><span data-stu-id="102c4-501">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="102c4-502">Параметр `pageIndex` указывает возвращаемую страницу результатов, где 0 (ноль) указывает на первую страницу.</span><span class="sxs-lookup"><span data-stu-id="102c4-502">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="102c4-503">Параметр `totalRecords` — это `out` параметр, который задает общее число соответствующих пользователей членства, найденных в Active Directory хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-503">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="102c4-504">Например, если для настроенного хранилища данных установлено 13 пользователей, а `pageIndex` значение было равно 1 с `pageSize` 5, то возвращаемый <xref:System.Web.Security.MembershipUserCollection> будет содержать шестую часть по десятым пользователям.</span><span class="sxs-lookup"><span data-stu-id="102c4-504">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="102c4-505">Параметру `totalRecords` будет присвоено значение 13.</span><span class="sxs-lookup"><span data-stu-id="102c4-505">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="102c4-506">Можно указать, следует ли разрешить поиск пользователей, задав свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> в файле конфигурации приложения с помощью атрибута `enableSearchMethods` элемента [членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-506">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-507">Присвоение свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> значения `false` приводит к тому, что метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> вызывает исключение <xref:System.NotSupportedException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-507">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property value to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="102c4-508">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-508">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-509">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-509">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-510">Рекомендуется не включать Поиск в рабочих системах, пока не будет подтверждено, что запросы поиска, выданные классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, не негативно повлияют на производительность сервера каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-510">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="102c4-511">Поскольку класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> предназначен для веб-среды без отслеживания состояния, невозможно использовать оптимизацию разбиения по страницам, предоставляемую базовыми API <xref:System.DirectoryServices>.</span><span class="sxs-lookup"><span data-stu-id="102c4-511">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="102c4-512">Это означает, что операции подкачки во время поиска в больших каталогах очень ресурсоемки, и их следует избегать.</span><span class="sxs-lookup"><span data-stu-id="102c4-512">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="102c4-513">Операции поиска всегда выдаются для сервера каталогов, настроенного в строке подключения, или автоматически выбранного сервера в случае строки подключения, указывающей на домен.</span><span class="sxs-lookup"><span data-stu-id="102c4-513">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="102c4-514">Поставщик не использует глобальный каталог для своих методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-514">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-515">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-515">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-516">Параметр <paramref name="usernameToMatch" /> пустой, или превышает максимальную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-516"><paramref name="usernameToMatch" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-517">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-517">-or-</span></span> 
 <span data-ttu-id="102c4-518"><paramref name="usernameToMatch" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-518"><paramref name="usernameToMatch" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-519">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-519">-or-</span></span> 
 <span data-ttu-id="102c4-520">Значение параметра <paramref name="pageIndex" /> меньше 0.</span><span class="sxs-lookup"><span data-stu-id="102c4-520"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="102c4-521">или</span><span class="sxs-lookup"><span data-stu-id="102c4-521">-or</span></span> 
 <span data-ttu-id="102c4-522">Значение параметра <paramref name="pageSize" /> меньше 1.</span><span class="sxs-lookup"><span data-stu-id="102c4-522"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="102c4-523">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-523">-or-</span></span> 
 <span data-ttu-id="102c4-524">Значение <paramref name="pageSize" />, умноженное на <paramref name="pageIndex" />, плюс <paramref name="pageSize" /> минус 1 больше <see cref="F:System.Int32.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-524"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-525"><paramref name="usernameToMatch" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-525"><paramref name="usernameToMatch" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-526">Значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-526">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-527">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-527">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GeneratePassword">
      <MemberSignature Language="C#" Value="public virtual string GeneratePassword ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GeneratePassword() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GeneratePassword () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GeneratePassword();" />
      <MemberSignature Language="F#" Value="abstract member GeneratePassword : unit -&gt; string&#xA;override this.GeneratePassword : unit -&gt; string" Usage="activeDirectoryMembershipProvider.GeneratePassword " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="102c4-528">Генерирует случайный пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-528">Generates a random password.</span></span></summary>
        <returns><span data-ttu-id="102c4-529">Случайный пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-529">A random password.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-530">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider> вызывает метод <xref:System.Web.Security.Membership.GeneratePassword%2A> класса <xref:System.Web.Security.Membership> для получения случайного пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-530">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class calls the <xref:System.Web.Security.Membership.GeneratePassword%2A> method of the <xref:System.Web.Security.Membership> class to retrieve a random password.</span></span> <span data-ttu-id="102c4-531">Длина пароля равна значению свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-531">The password length is set to the value of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property.</span></span> <span data-ttu-id="102c4-532">Длина пароля не может быть меньше 14.</span><span class="sxs-lookup"><span data-stu-id="102c4-532">The password length can never be less than 14.</span></span>  
  
 <span data-ttu-id="102c4-533">Можно специально вызвать метод <xref:System.Web.Security.Membership.GeneratePassword%2A>, ссылаясь на класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> непосредственно из свойства Provider класса <xref:System.Web.Security.Membership>.</span><span class="sxs-lookup"><span data-stu-id="102c4-533">You can specifically call the <xref:System.Web.Security.Membership.GeneratePassword%2A> method by referencing the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class directly from the Provider property of the <xref:System.Web.Security.Membership> class.</span></span>  
  
 <span data-ttu-id="102c4-534">Созданный пароль содержит только буквенно-цифровые символы и следующие знаки пунктуации:! @ # $% ^ & \* () _-+ = [{]};:&#124;< >./?.</span><span class="sxs-lookup"><span data-stu-id="102c4-534">The generated password only contains alphanumeric characters and the following punctuation marks: !@#$%^&\*()_-+=[{]};:<>&#124;./?.</span></span> <span data-ttu-id="102c4-535">В создаваемый пароль не включаются скрытые или непечатаемые управляющие символы.</span><span class="sxs-lookup"><span data-stu-id="102c4-535">No hidden or non-printable control characters are included in the generated password.</span></span>  
  
 <span data-ttu-id="102c4-536">Созданный пароль будет содержать по крайней мере число символов, отличных от буквенно-цифровых, указанных в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-536">The generated password will contain at least the number of non-alphanumeric characters specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property.</span></span> <span data-ttu-id="102c4-537">Созданный пароль не будет проверяться с помощью регулярного выражения в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-537">The generated password will not be tested with the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-538">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> не создает пароли, соответствующие требованиям сложности, заданным в каталоге.</span><span class="sxs-lookup"><span data-stu-id="102c4-538">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not generate passwords that match complexity requirements set in the directory.</span></span> <span data-ttu-id="102c4-539">Можно создать случайный пароль, который не проходит правила сложности пароля, заданные в каталоге.</span><span class="sxs-lookup"><span data-stu-id="102c4-539">It is possible to generate a random password that fails the password complexity rules set by the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-540">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-540">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetAllUsers">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection GetAllUsers (int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection GetAllUsers(int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllUsers (pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ GetAllUsers(int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllUsers : int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.GetAllUsers (pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pageIndex"><span data-ttu-id="102c4-541">Индекс страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-541">The index of the page of results to return.</span></span> <span data-ttu-id="102c4-542">Индекс <paramref name="pageIndex" /> отсчитывается от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-542"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="102c4-543">Размер страницы возвращаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="102c4-543">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="102c4-544">По окончании метод возвращает общее число записей, возвращенных в коллекции.</span><span class="sxs-lookup"><span data-stu-id="102c4-544">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="102c4-545">Этот параметр передается неинициализированным.</span><span class="sxs-lookup"><span data-stu-id="102c4-545">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="102c4-546">Возвращает коллекцию всех пользователей, хранимых в источнике данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-546">Gets a collection of all the users stored in an Active Directory data source.</span></span></summary>
        <returns><span data-ttu-id="102c4-547">Объект <see cref="T:System.Web.Security.MembershipUserCollection" />, содержащий экземпляры <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" />, начиная со страницы, определенной параметром <paramref name="pageIndex" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-547">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-548">Этот метод вызывается классом <xref:System.Web.Security.Membership> для получения сведений о пользователе из хранилища данных Active Directory, указанного в файле конфигурации приложения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="102c4-548">This method is called by the <xref:System.Web.Security.Membership> class to retrieve user information from the Active Directory data store specified in the ASP.NET application's configuration file.</span></span>  
  
 <span data-ttu-id="102c4-549">Результаты, возвращаемые методом <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>, ограничиваются параметрами `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="102c4-549">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="102c4-550">Параметр `pageSize` указывает максимальное число экземпляров <xref:System.Web.Security.MembershipUser>, возвращаемых в коллекцию <xref:System.Web.Security.MembershipUserCollection>.</span><span class="sxs-lookup"><span data-stu-id="102c4-550">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection> collection.</span></span> <span data-ttu-id="102c4-551">Параметр `pageIndex` указывает возвращаемую страницу результатов, где 0 (ноль) указывает на первую страницу.</span><span class="sxs-lookup"><span data-stu-id="102c4-551">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="102c4-552">Параметр `totalRecords` — это `out` параметр, который задает общее число соответствующих пользователей членства, найденных в Active Directory хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-552">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="102c4-553">Например, если для настроенного хранилища данных установлено 13 пользователей, а `pageIndex` значение было 1 с шестым `pageSize` 5, возвращаемый <xref:System.Web.Security.MembershipUserCollection> будет содержать от 6 до десятых пользователей.</span><span class="sxs-lookup"><span data-stu-id="102c4-553">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with la `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="102c4-554">Параметру `totalRecords` будет присвоено значение 13.</span><span class="sxs-lookup"><span data-stu-id="102c4-554">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="102c4-555">Можно указать, следует ли разрешить поиск пользователей, задав свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> в файле конфигурации приложения с помощью атрибута `enableSearchMethods` элемента [членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-555">You can control whether to allow searching for users by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-556">Присвоение свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> значения `false` приводит к тому, что метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> вызывает исключение <xref:System.NotSupportedException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-556">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="102c4-557">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-557">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-558">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-558">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-559">Рекомендуется не включать Поиск в рабочих системах, пока не будет подтверждено, что запросы поиска, выданные классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, не негативно повлияют на производительность сервера каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-559">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="102c4-560">Поскольку класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> предназначен для веб-среды без отслеживания состояния, невозможно использовать оптимизацию разбиения по страницам, предоставляемую базовыми API <xref:System.DirectoryServices>.</span><span class="sxs-lookup"><span data-stu-id="102c4-560">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="102c4-561">Это означает, что операции подкачки во время поиска в больших каталогах очень ресурсоемки, и их следует избегать.</span><span class="sxs-lookup"><span data-stu-id="102c4-561">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="102c4-562">Операции поиска всегда выдаются для сервера каталогов, настроенного в строке подключения, или автоматически выбранного сервера в случае строки подключения, указывающей на домен.</span><span class="sxs-lookup"><span data-stu-id="102c4-562">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="102c4-563">Поставщик не использует глобальный каталог для своих методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-563">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-564">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-564">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-565">Значение параметра <paramref name="pageIndex" /> меньше 0.</span><span class="sxs-lookup"><span data-stu-id="102c4-565"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="102c4-566">или</span><span class="sxs-lookup"><span data-stu-id="102c4-566">-or</span></span> 
 <span data-ttu-id="102c4-567">Значение параметра <paramref name="pageSize" /> меньше 1.</span><span class="sxs-lookup"><span data-stu-id="102c4-567"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="102c4-568">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-568">-or-</span></span> 
 <span data-ttu-id="102c4-569">Значение <paramref name="pageSize" />, умноженное на <paramref name="pageIndex" />, плюс <paramref name="pageSize" /> минус 1 больше <see cref="F:System.Int32.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-569"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-570">Значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-570">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-571">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-571">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfUsersOnline">
      <MemberSignature Language="C#" Value="public override int GetNumberOfUsersOnline ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfUsersOnline() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfUsersOnline () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfUsersOnline();" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfUsersOnline : unit -&gt; int" Usage="activeDirectoryMembershipProvider.GetNumberOfUsersOnline " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="102c4-572">Вызывает исключение <see cref="T:System.NotSupportedException" /> во всех случаях.</span><span class="sxs-lookup"><span data-stu-id="102c4-572">Throws a <see cref="T:System.NotSupportedException" /> exception in all cases.</span></span></summary>
        <returns><span data-ttu-id="102c4-573">Значение <see cref="T:System.NotSupportedException" /> во всех случаях.</span><span class="sxs-lookup"><span data-stu-id="102c4-573">A <see cref="T:System.NotSupportedException" /> in all cases.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-574">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> не поддерживает возврат числа пользователей в сети.</span><span class="sxs-lookup"><span data-stu-id="102c4-574">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the number of users online.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-575">Любой вызов метода <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-575">Any call to the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> method.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-576">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-576">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetPassword">
      <MemberSignature Language="C#" Value="public override string GetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.GetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.GetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-577">Пользователь, чей пароль требуется получить.</span><span class="sxs-lookup"><span data-stu-id="102c4-577">The user to retrieve the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="102c4-578">Ответ на проверочный вопрос для этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-578">The password answer for the user.</span></span></param>
        <summary><span data-ttu-id="102c4-579">Возвращает пароль указанного пользователя из базы данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-579">Returns the password of the specified user from the database.</span></span> <span data-ttu-id="102c4-580">Класс <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не поддерживает данный метод.</span><span class="sxs-lookup"><span data-stu-id="102c4-580">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class does not support this method.</span></span></summary>
        <returns><span data-ttu-id="102c4-581">Всегда выдает исключение <see cref="T:System.NotSupportedException" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-581">Always throws a <see cref="T:System.NotSupportedException" /> exception.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-582">Класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> не поддерживает возврат пароля пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-582">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the user's password.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-583">Класс <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не поддерживает возврат пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-583">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> does not support password retrieval.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-584">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-584">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="102c4-585">Возвращает сведения о членстве пользователя из хранилища данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-585">Gets the information from a membership user in the Active Directory data store.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (object providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(object providerUserKey, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (providerUserKey As Object, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::Object ^ providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : obj * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (providerUserKey, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="providerUserKey"><span data-ttu-id="102c4-586">Уникальный идентификатор для пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-586">The unique identifier for the user.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="102c4-587">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> игнорирует этот параметр.</span><span class="sxs-lookup"><span data-stu-id="102c4-587">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="102c4-588">Возвращает информацию пользователя членства, связанную с указанным ключом пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-588">Gets the membership user information associated with the specified user key.</span></span></summary>
        <returns><span data-ttu-id="102c4-589">Экземпляр <see cref="T:System.Web.Security.MembershipUser" />, представляющий указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-589">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="102c4-590">Если в хранилище данных Active Directory не найдено пользователей для заданного значения <paramref name="providerUserKey" />, то возвращается <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-590">If no user is found in the Active Directory data store for the specified <paramref name="providerUserKey" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-591">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> вызывается классом <xref:System.Web.Security.Membership> для получения сведений об указанном пользователе из Active Directory хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-591">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="102c4-592">Поиск будет искать пользовательский экземпляр, в котором атрибут `objectSID` соответствует параметру `providerUserKey`.</span><span class="sxs-lookup"><span data-stu-id="102c4-592">The search looks for a user instance where the `objectSID` attribute matches the `providerUserKey` parameter.</span></span>  
  
 <span data-ttu-id="102c4-593">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-593">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-594">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-594">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-595">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-595">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-596">Параметр <paramref name="providerUserKey" /> не является параметром типа <see cref="T:System.Security.Principal.SecurityIdentifier" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-596"><paramref name="providerUserKey" /> is not of type <see cref="T:System.Security.Principal.SecurityIdentifier" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-597"><paramref name="providerUserKey" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-597"><paramref name="providerUserKey" /> is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (string username, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(string username, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (username As String, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::String ^ username, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : string * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (username, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-598">Имя пользователя для получения данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-598">The name of the user to get information for.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="102c4-599">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> игнорирует этот параметр.</span><span class="sxs-lookup"><span data-stu-id="102c4-599">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="102c4-600">Возвращает информацию пользователя членства, связанную с указанным именем пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-600">Gets the membership user information associated with the specified user name.</span></span></summary>
        <returns><span data-ttu-id="102c4-601">Экземпляр <see cref="T:System.Web.Security.MembershipUser" />, представляющий указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-601">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="102c4-602">Если в хранилище данных Active Directory не найдено пользователей для заданного значения <paramref name="username" />, то возвращается <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-602">If no user is found in the Active Directory data store for the specified <paramref name="username" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-603">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> вызывается классом <xref:System.Web.Security.Membership> для получения сведений об указанном пользователе из Active Directory хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-603">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="102c4-604">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-604">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-605">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-605">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-606">Начальные и конечные пробелы удаляются из значения параметра `username`.</span><span class="sxs-lookup"><span data-stu-id="102c4-606">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-607">Параметр <paramref name="username" /> пустой, или превышает максимальную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-607"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-608">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-608">-or-</span></span> 
 <span data-ttu-id="102c4-609"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-609"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-610">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-610">-or-</span></span> 
<span data-ttu-id="102c4-611">Имя пользователя отображается на атрибут <see langword="userPrincipalName" /> и параметр <paramref name="username" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-611">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-612">Свойство <paramref name="username" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-612"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-613">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-613">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-614">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-614">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetUserNameByEmail">
      <MemberSignature Language="C#" Value="public override string GetUserNameByEmail (string email);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetUserNameByEmail(string email) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUserNameByEmail (email As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetUserNameByEmail(System::String ^ email);" />
      <MemberSignature Language="F#" Value="override this.GetUserNameByEmail : string -&gt; string" Usage="activeDirectoryMembershipProvider.GetUserNameByEmail email" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="email" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="email"><span data-ttu-id="102c4-615">Адрес электронной почты для поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-615">The email address to search for.</span></span></param>
        <summary><span data-ttu-id="102c4-616">Возвращает имя пользователя, связанное с указанным адресом электронной почты.</span><span class="sxs-lookup"><span data-stu-id="102c4-616">Gets the user name associated with the specified email address.</span></span></summary>
        <returns><span data-ttu-id="102c4-617">Имя пользователя, связанное с указанным адресом электронной почты.</span><span class="sxs-lookup"><span data-stu-id="102c4-617">The user name associated with the specified email address.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-618">Этот метод вызывается классом <xref:System.Web.Security.Membership> для получения имени пользователя из Active Directory хранилища данных на основе адреса электронной почты пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-618">This method is called by the <xref:System.Web.Security.Membership> class to retrieve a user name from the Active Directory data store based on the email address for the user.</span></span>  
  
 <span data-ttu-id="102c4-619">Если несколько пользователей в хранилище данных членства имеют одинаковый адрес электронной почты, возвращается первое обнаруженное имя пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-619">If more than one user in the membership data store has the same email address, the first user name encountered is returned.</span></span> <span data-ttu-id="102c4-620">Можно задать атрибут `requiresUniqueEmail` элемента [членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) , чтобы `true` в файле конфигурации приложения, чтобы гарантировать уникальность каждого адреса электронной почты в базе данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-620">You can set the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element to `true` in the application configuration file to ensure that each email address in the database is unique.</span></span>  
  
 <span data-ttu-id="102c4-621">Начальные и конечные пробелы удаляются из значения параметра `email`.</span><span class="sxs-lookup"><span data-stu-id="102c4-621">Leading and trailing spaces are trimmed from the `email` parameter value.</span></span> <span data-ttu-id="102c4-622">Если после усечения адрес электронной почты пуст, выдается <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-622">If the email address is empty after trimming, an <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="102c4-623">Если адрес электронной почты `null`, выполняется поиск всех имен пользователей в Active Directory хранилище данных и возвращается первое имя пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-623">If the email address is `null`, all user names in the Active Directory data store are searched, and the first user name is returned.</span></span>  
  
 <span data-ttu-id="102c4-624">Рекомендуется не включать Поиск в рабочих системах, пока не будет подтверждено, что запросы поиска, выданные классом <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, не негативно повлияют на производительность сервера каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-624">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-625">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A> будет выполняться, даже если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> имеет значение `false`.</span><span class="sxs-lookup"><span data-stu-id="102c4-625">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A> method will run even when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`.</span></span>  
  
 <span data-ttu-id="102c4-626">Поскольку класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider> предназначен для веб-среды без отслеживания состояния, невозможно использовать оптимизацию разбиения по страницам, предоставляемую базовыми API <xref:System.DirectoryServices>.</span><span class="sxs-lookup"><span data-stu-id="102c4-626">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="102c4-627">Это означает, что операции подкачки во время поиска в больших каталогах очень ресурсоемки, и их следует избегать.</span><span class="sxs-lookup"><span data-stu-id="102c4-627">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="102c4-628">Операции поиска всегда выдаются для сервера каталогов, настроенного в строке подключения, или автоматически выбранного сервера в случае строки подключения, указывающей на домен.</span><span class="sxs-lookup"><span data-stu-id="102c4-628">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="102c4-629">Поставщик не использует глобальный каталог для своих методов поиска.</span><span class="sxs-lookup"><span data-stu-id="102c4-629">The provider does not use a global catalog for its search methods.</span></span>  
  
 <span data-ttu-id="102c4-630">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-630">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-631">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-631">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-632">Длина параметра <paramref name="email" /> превышает 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-632"><paramref name="email" /> exceeds 256 characters</span></span> 
<span data-ttu-id="102c4-633">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-633">-or-</span></span> 
<span data-ttu-id="102c4-634">После удаления пробелов параметр <paramref name="email" /> пустой.</span><span class="sxs-lookup"><span data-stu-id="102c4-634">after trimming, <paramref name="email" /> is empty.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-635">В хранилище данных имеется более одного пользователя с одинаковым адресом электронной почты, и значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> равно <see langword="true" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-635">More than one user exists in the data store with the same email address and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property value is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-636">Поставщик не инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-636">The provider is not initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-637">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-637">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="activeDirectoryMembershipProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name"><span data-ttu-id="102c4-638">Имя экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> для инициализации.</span><span class="sxs-lookup"><span data-stu-id="102c4-638">The name of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance to initialize.</span></span></param>
        <param name="config"><span data-ttu-id="102c4-639">Коллекция <see cref="T:System.Collections.Specialized.NameValueCollection" />, которая содержит имена и значения параметров конфигурации для поставщика членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-639">A <see cref="T:System.Collections.Specialized.NameValueCollection" /> containing the names and values of the configuration options for the membership provider.</span></span></param>
        <summary><span data-ttu-id="102c4-640">Выполняет инициализацию экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> со значениями свойств из файла конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-640">Initializes the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance with the property values from the application's configuration files.</span></span> <span data-ttu-id="102c4-641">Этот метод не предназначен для непосредственного вызова из кода.</span><span class="sxs-lookup"><span data-stu-id="102c4-641">This method is not intended to be called from your code.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-642">Этот метод инициализирует объект <xref:System.Web.Security.ActiveDirectoryMembershipProvider> со значениями свойств, указанными в файле конфигурации приложения ASP.NET (Web. config), и не предназначен для непосредственного использования в коде.</span><span class="sxs-lookup"><span data-stu-id="102c4-642">This method initializes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object with the property values specified in the ASP.NET application configuration file (Web.config) and is not intended to be used directly from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-643"><paramref name="config" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-643"><paramref name="config" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-644">Атрибут <see langword="applicationName" />, указанный в конфигурации приложения превышает по длине 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-644">The <see langword="applicationName" /> attribute specified in the application configuration exceeds 256 characters.</span></span>  
  
<span data-ttu-id="102c4-645">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-645">-or-</span></span> 
<span data-ttu-id="102c4-646">Атрибут <see langword="connectionStringName" /> пуст или отсутствует в конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-646">The <see langword="connectionStringName" /> attribute is empty or does not exist in the application configuration.</span></span>  
  
<span data-ttu-id="102c4-647">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-647">-or-</span></span> 
<span data-ttu-id="102c4-648">Строка подключения, указанная в атрибуте <see langword="connectionStringName" /> файла конфигурации приложения пустая или не существует.</span><span class="sxs-lookup"><span data-stu-id="102c4-648">The connection string specified in the <see langword="connectionStringName" /> attribute in the application configuration file is empty or does not exist.</span></span>  
  
<span data-ttu-id="102c4-649">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-649">-or-</span></span> 
<span data-ttu-id="102c4-650">Атрибут <see langword="connectionProtection" /> установлен в значение, отличное от <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> или <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-650">The <see langword="connectionProtection" /> attribute is set to a value other than <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> or <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="102c4-651">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-651">-or-</span></span> 
<span data-ttu-id="102c4-652">Атрибут <see langword="connectionUsername" /> определен в файле конфигурации приложения, но его значение пустое.</span><span class="sxs-lookup"><span data-stu-id="102c4-652">The <see langword="connectionUsername" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="102c4-653">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-653">-or-</span></span> 
<span data-ttu-id="102c4-654">Атрибут <see langword="connectionPassword" /> определен в файле конфигурации приложения, но его значение пустое.</span><span class="sxs-lookup"><span data-stu-id="102c4-654">The <see langword="connectionPassword" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="102c4-655">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-655">-or-</span></span> 
<span data-ttu-id="102c4-656">Один из атрибутов <see langword="connectionUsername" /> и <see langword="connectionPassword" /> определен в файле конфигурации приложения, но не оба.</span><span class="sxs-lookup"><span data-stu-id="102c4-656">Either the <see langword="connectionUsername" /> attribute or the <see langword="connectionPassword" /> attribute is specified in the application configuration file, but not both.</span></span>  
  
<span data-ttu-id="102c4-657">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-657">-or-</span></span> 
<span data-ttu-id="102c4-658">Атрибут <see langword="clientSearchTimeout" /> определен, но не является целым положительным числом.</span><span class="sxs-lookup"><span data-stu-id="102c4-658">The <see langword="clientSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="102c4-659">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-659">-or-</span></span> 
<span data-ttu-id="102c4-660">Атрибут <see langword="serverSearchTimeout" /> определен, но не является целым положительным числом.</span><span class="sxs-lookup"><span data-stu-id="102c4-660">The <see langword="serverSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="102c4-661">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-661">-or-</span></span> 
<span data-ttu-id="102c4-662">Атрибут <see langword="enableSearchMethods" /> определен, но не является логическим значением.</span><span class="sxs-lookup"><span data-stu-id="102c4-662">The <see langword="enableSearchMethods" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="102c4-663">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-663">-or-</span></span> 
<span data-ttu-id="102c4-664">Атрибут <see langword="requiresUniqueEmail" /> определен, но не является логическим значением.</span><span class="sxs-lookup"><span data-stu-id="102c4-664">The <see langword="requiresUniqueEmail" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="102c4-665">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-665">-or-</span></span> 
<span data-ttu-id="102c4-666">Атрибут <see langword="enablePasswordReset" /> определен, но не является логическим значением.</span><span class="sxs-lookup"><span data-stu-id="102c4-666">The <see langword="enablePasswordReset" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="102c4-667">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-667">-or-</span></span> 
<span data-ttu-id="102c4-668">Атрибут <see langword="requiresQuestionAndAnswer" /> определен, но не является логическим значением.</span><span class="sxs-lookup"><span data-stu-id="102c4-668">The <see langword="requiresQuestionAndAnswer" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="102c4-669">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-669">-or-</span></span> 
<span data-ttu-id="102c4-670">Атрибут <see langword="minRequiredPasswordLength" /> определен, но либо отрицателен, либо больше 128.</span><span class="sxs-lookup"><span data-stu-id="102c4-670">The <see langword="minRequiredPasswordLength" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="102c4-671">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-671">-or-</span></span> 
<span data-ttu-id="102c4-672">Атрибут <see langword="minRequiredNonalphanumericCharacters" /> определен, но либо отрицателен, либо больше 128.</span><span class="sxs-lookup"><span data-stu-id="102c4-672">The <see langword="minRequiredNonalphanumericCharacters" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="102c4-673">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-673">-or-</span></span> 
<span data-ttu-id="102c4-674">Регулярное выражение, указанное в атрибуте <see langword="passwordStrengthRegularExpression" /> в файле конфигурации приложения, не является действительным регулярным выражением.</span><span class="sxs-lookup"><span data-stu-id="102c4-674">The regular expression specified in the <see langword="passwordStrengthRegularExpression" /> attribute in the application configuration file is not a valid regular expression</span></span> 
<span data-ttu-id="102c4-675">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-675">-or-</span></span> 
<span data-ttu-id="102c4-676">Атрибут <see langword="attributeMapUsername" /> определен, но является пустой строкой.</span><span class="sxs-lookup"><span data-stu-id="102c4-676">The <see langword="attributeMapUsername" /> attribute is specified, but it is an empty string.</span></span>  
  
<span data-ttu-id="102c4-677">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-677">-or-</span></span> 
<span data-ttu-id="102c4-678">Атрибут <see langword="connectionString" /> не начинается с "LDAP".</span><span class="sxs-lookup"><span data-stu-id="102c4-678">The <see langword="connectionString" /> attribute does not begin with "LDAP".</span></span>  
  
<span data-ttu-id="102c4-679">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-679">-or-</span></span> 
<span data-ttu-id="102c4-680">Строка подключения, указанная в атрибуте <see langword="connectionString" />, является недействительной.</span><span class="sxs-lookup"><span data-stu-id="102c4-680">The connection string specified in the <see langword="connectionString" /> attribute is invalid.</span></span>  
  
<span data-ttu-id="102c4-681">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-681">-or-</span></span> 
<span data-ttu-id="102c4-682">Строка подключения в атрибуте <see langword="connectionString" /> определяет привязку без сервера.</span><span class="sxs-lookup"><span data-stu-id="102c4-682">The connection string in the <see langword="connectionString" /> attribute specifies a server-less bind.</span></span>  
  
<span data-ttu-id="102c4-683">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-683">-or-</span></span> 
<span data-ttu-id="102c4-684">Поставщик <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не смог установить соединение с доменом или сервером каталогов.</span><span class="sxs-lookup"><span data-stu-id="102c4-684">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish a connection with the domain or directory server.</span></span>  
  
<span data-ttu-id="102c4-685">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-685">-or-</span></span> 
<span data-ttu-id="102c4-686">Атрибут <see langword="connectionProtection" /> установлен <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, но, ни SSL, ни подписанное и скрепленное печатью соединение с сервером не может быть установлено.</span><span class="sxs-lookup"><span data-stu-id="102c4-686">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, but neither an SSL nor a signed and sealed connection can be established with the server.</span></span>  
  
<span data-ttu-id="102c4-687">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-687">-or-</span></span> 
<span data-ttu-id="102c4-688">Атрибут <see langword="connectionProtection" /> установлен в <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" />, атрибуты <see langword="connectionUsername" /> и <see langword="connectionPassword" /> не установлены.</span><span class="sxs-lookup"><span data-stu-id="102c4-688">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> but the <see langword="connectionUsername" /> and <see langword="connectionPassword" /> attributes are not set.</span></span>  
  
<span data-ttu-id="102c4-689">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-689">-or-</span></span> 
<span data-ttu-id="102c4-690">Атрибут <see langword="connectionProtection" /> установлен в <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, но поставщик <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не смог установить SSL-соединение сервером ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-690">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish an SSL connection with an ADAM server.</span></span>  
  
<span data-ttu-id="102c4-691">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-691">-or-</span></span> 
<span data-ttu-id="102c4-692">Атрибут <see langword="connectionString" /> определяет либо глобальный каталог (GC) или порт глобального каталога SSL.</span><span class="sxs-lookup"><span data-stu-id="102c4-692">The <see langword="connectionString" /> attribute specifies either the global catalog (GC) or an SSL global catalog port.</span></span>  
  
<span data-ttu-id="102c4-693">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-693">-or-</span></span> 
<span data-ttu-id="102c4-694">Атрибут <see langword="connectionString" /> определяет сервер или домен Active Directory, но поставщик <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не может извлечь контекст именования по умолчанию для домена.</span><span class="sxs-lookup"><span data-stu-id="102c4-694">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default naming context for the domain.</span></span>  
  
<span data-ttu-id="102c4-695">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-695">-or-</span></span> 
<span data-ttu-id="102c4-696">Атрибут <see langword="connectionString" /> определяет сервер или домен Active Directory, но поставщик <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> не может извлечь контейнер пользователей по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="102c4-696">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default users container.</span></span>  
  
<span data-ttu-id="102c4-697">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-697">-or-</span></span> 
<span data-ttu-id="102c4-698">Атрибут <see langword="connectionString" /> определяет сервер ADAM, но не указывает раздел приложения или контейнер.</span><span class="sxs-lookup"><span data-stu-id="102c4-698">The <see langword="connectionString" /> attribute specifies an ADAM server, but it does not specify an application partition or container.</span></span>  
  
<span data-ttu-id="102c4-699">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-699">-or-</span></span> 
<span data-ttu-id="102c4-700">Атрибут <see langword="connectionString" /> определяет раздел приложения или контейнер, но указанный контейнер не существует.</span><span class="sxs-lookup"><span data-stu-id="102c4-700">The <see langword="connectionString" /> attribute specifies an application partition or container, but the specified container does not exist.</span></span>  
  
<span data-ttu-id="102c4-701">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-701">-or-</span></span> 
<span data-ttu-id="102c4-702">Атрибут <see langword="connectionString" /> определяет контейнер, которому не разрешено хранить экземпляры пользователей.</span><span class="sxs-lookup"><span data-stu-id="102c4-702">The <see langword="connectionString" /> attribute specifies a container that is not allowed to contain user instances.</span></span>  
  
<span data-ttu-id="102c4-703">Отображение атрибута определено, но его значение пустое.</span><span class="sxs-lookup"><span data-stu-id="102c4-703">An attribute mapping is specified but its value was empty.</span></span>  
  
<span data-ttu-id="102c4-704">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-704">-or-</span></span> 
<span data-ttu-id="102c4-705">Отображение атрибута определено дважды.</span><span class="sxs-lookup"><span data-stu-id="102c4-705">An attribute mapping is specified twice.</span></span>  
  
<span data-ttu-id="102c4-706">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-706">-or-</span></span> 
<span data-ttu-id="102c4-707">Отображение атрибута определено, но атрибут отсутствует в экземпляре пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-707">An attribute mapping is specified but the attribute does not exist on the user instance.</span></span>  
  
<span data-ttu-id="102c4-708">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-708">-or-</span></span> 
<span data-ttu-id="102c4-709">Отображение атрибута определено, атрибуты каталога имеют некорректный тип данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-709">An attribute mapping is specified but the directory attribute is not of the correct data type.</span></span>  
  
<span data-ttu-id="102c4-710">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-710">-or-</span></span> 
<span data-ttu-id="102c4-711">Отображение атрибута определено, но атрибут каталога многозначен.</span><span class="sxs-lookup"><span data-stu-id="102c4-711">An attribute mapping is specified but the directory attribute is multi-valued.</span></span>  
  
<span data-ttu-id="102c4-712">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-712">-or-</span></span> 
<span data-ttu-id="102c4-713">Атрибут <see langword="attributeMapUserName" /> определен, но не был сопоставлен ни с атрибутом каталога <c>sAMAccountName</c>, ни с атрибутом каталога <c>userPrincipalName</c> при подключении к Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-713">The <see langword="attributeMapUserName" /> attribute is specified but was mapped to neither the <c>sAMAccountName</c> nor the <c>userPrincipalName</c> directory attribute when connecting to an Active Directory.</span></span>  
  
<span data-ttu-id="102c4-714">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-714">-or-</span></span> 
<span data-ttu-id="102c4-715">Атрибут <see langword="attributeMapUserName" /> определен, но не был сопоставлен с атрибутом каталога <c>userPrincipalName</c> при подключении к серверу ADAM.</span><span class="sxs-lookup"><span data-stu-id="102c4-715">The <see langword="attributeMapUserName" /> attribute is specified but was not mapped to the <c>userPrincipalName</c> directory attribute when connecting to an ADAM server.</span></span>  
  
<span data-ttu-id="102c4-716">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-716">-or-</span></span> 
<span data-ttu-id="102c4-717">Атрибут <see langword="enablePasswordReset" /> равен <see langword="true" />, и атрибут <see langword="requiresQuestionAndAnswer" /> равен <see langword="false" /> в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-717">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and the <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="false" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="102c4-718">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-718">-or-</span></span> 
<span data-ttu-id="102c4-719">Атрибут <see langword="maxInvalidPasswordAttempts" /> определен, но не является положительным целым числом, отличным от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-719">The <see langword="maxInvalidPasswordAttempts" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="102c4-720">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-720">-or-</span></span> 
<span data-ttu-id="102c4-721">Атрибут <see langword="passwordAttemptWindow" /> определен, но не является положительным целым числом, отличным от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-721">The <see langword="passwordAttemptWindow" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="102c4-722">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-722">-or-</span></span> 
<span data-ttu-id="102c4-723">Атрибут <see langword="passwordAnswerAttemptLockoutDuration" /> определен, но не является положительным целым числом, отличным от нуля.</span><span class="sxs-lookup"><span data-stu-id="102c4-723">The <see langword="passwordAnswerAttemptLockoutDuration" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="102c4-724">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-724">-or-</span></span> 
<span data-ttu-id="102c4-725">Атрибут <see langword="enablePasswordReset" /> равен <see langword="true" />, и каждый из атрибутов <see langword="attributeMapFailedPasswordAnswerCount" />, <see langword="attributeMapFailedPasswordAnswerTime" /> и <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> пуст.</span><span class="sxs-lookup"><span data-stu-id="102c4-725">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and any of the <see langword="attributeMapFailedPasswordAnswerCount" />, <see langword="attributeMapFailedPasswordAnswerTime" />, and <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> attributes are empty.</span></span>  
  
<span data-ttu-id="102c4-726">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-726">-or-</span></span> 
<span data-ttu-id="102c4-727">Атрибут <see langword="requiresQuestionAndAnswer" /> равен <see langword="true" />, но один из атрибутов <see langword="attributeMapPasswordQuestion" /> или <see langword="attributeMapPasswordAnswer" /> пуст.</span><span class="sxs-lookup"><span data-stu-id="102c4-727">The <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="true" /> but either the <see langword="attributeMapPasswordQuestion" /> or the <see langword="attributeMapPasswordAnswer" /> attribute is empty.</span></span>  
  
<span data-ttu-id="102c4-728">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-728">-or-</span></span> 
<span data-ttu-id="102c4-729">Атрибут, указанный в файле конфигурации приложения, недействителен.</span><span class="sxs-lookup"><span data-stu-id="102c4-729">An attribute specified in the application configuration file is not valid.</span></span></exception>
        <exception cref="T:System.Web.HttpException"><span data-ttu-id="102c4-730">Приложение выполняется в среде узла и объект <see cref="T:System.Web.AspNetHostingPermissionLevel" /> установлен в <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-730">The application is running in a hosted environment and the <see cref="T:System.Web.AspNetHostingPermissionLevel" /> is set to <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="102c4-731">При запросе каталога произошла ошибка.</span><span class="sxs-lookup"><span data-stu-id="102c4-731">An error occurred while querying the directory.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-732">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-732">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MaxInvalidPasswordAttempts">
      <MemberSignature Language="C#" Value="public override int MaxInvalidPasswordAttempts { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MaxInvalidPasswordAttempts" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MaxInvalidPasswordAttempts As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MaxInvalidPasswordAttempts { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxInvalidPasswordAttempts : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-733">Возвращает число неудачных попыток ответ пользователя, разрешенное для запроса на восстановление пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-733">Gets the number of failed answer attempts a user is allowed for the password-reset question.</span></span></summary>
        <value><span data-ttu-id="102c4-734">Число неудачных попыток ответа пароля пользователя, разрешенное до блокировки учетной записи.</span><span class="sxs-lookup"><span data-stu-id="102c4-734">The number of failed password answer attempts a user is allowed before the account is locked.</span></span> <span data-ttu-id="102c4-735">Значение по умолчанию — <c>5</c>.</span><span class="sxs-lookup"><span data-stu-id="102c4-735">The default is <c>5</c>.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-736">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> `true`, пользователь должен ответить на вопрос с паролем, чтобы сбросить свой пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-736">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="102c4-737">Пользователю разрешено ограниченное количество попыток ответа в течение временного интервала, установленного свойством <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-737">The user is allowed a limited number of answer attempts within the time window established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property.</span></span> <span data-ttu-id="102c4-738">Если число попыток ответа на пароль больше или равно значению, хранящемуся в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>, пользователь блокирует дальнейшие попытки в течение числа минут, хранящихся в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-738">If the number of password answer attempts is greater than or equal to the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, the user is locked out of further attempts for the number of minutes stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-739">Это свойство не управляет числом неудачных попыток входа, которые пользователь может сделать до блокировки. Сервер Active Directory обрабатывает неудачные попытки входа в систему и не влияет на значение этого свойства.</span><span class="sxs-lookup"><span data-stu-id="102c4-739">This property does not control the number of failed logon attempts a user can make before being locked out. The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span>  
  
 <span data-ttu-id="102c4-740">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> задается в файле конфигурации приложения с помощью атрибута `maxInvalidPasswordAttempts` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-740">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set in your application's configuration file using the `maxInvalidPasswordAttempts` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-741">Если свойство не задано в файле конфигурации приложения, свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> присваивается значение по умолчанию `5`.</span><span class="sxs-lookup"><span data-stu-id="102c4-741">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set to the default value of `5`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-742">В следующем примере кода показана запись Web. config, которая настраивает экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для блокировки пользователей, которые делают три неудачные попытки ввода ответа на пароль в течение 10 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-742">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="102c4-743">Если пользователь заблокирован, дальнейшая попытка ответить на этот вопрос с паролем может быть выполнена в течение 15 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-743">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-744">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-744">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-745">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-745">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredNonAlphanumericCharacters">
      <MemberSignature Language="C#" Value="public override int MinRequiredNonAlphanumericCharacters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredNonAlphanumericCharacters As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredNonAlphanumericCharacters { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredNonAlphanumericCharacters : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-746">Получает минимальное количество специальных символов, которые должны присутствовать в допустимом пароле.</span><span class="sxs-lookup"><span data-stu-id="102c4-746">Gets the minimum number of special characters that must be present in a valid password.</span></span></summary>
        <value><span data-ttu-id="102c4-747">Минимальное количество специальных символов, которые должны присутствовать в допустимом пароле.</span><span class="sxs-lookup"><span data-stu-id="102c4-747">The minimum number of special characters that must be present in a valid password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-748">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> возвращает минимальное число специальных, не буквенно-цифровых символов, которые необходимо указать для создания допустимого пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-748">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property returns the minimum number of special, non-alphanumeric characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="102c4-749">Значение свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> задается в конфигурации приложения с помощью атрибута `minRequiredNonalphanumericCharacters` элемента конфигурации [элемента членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-749">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property value is set in the application configuration using the `minRequiredNonalphanumericCharacters` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
 <span data-ttu-id="102c4-750">Символ, не являющийся буквенно-цифровым, является символом, для которого метод <xref:System.Char.IsLetterOrDigit%2A> возвращает `false`.</span><span class="sxs-lookup"><span data-stu-id="102c4-750">A non-alphanumeric character is a character for which the <xref:System.Char.IsLetterOrDigit%2A> method returns `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-751">В следующем примере показан элемент конфигурации [элемента membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) в разделе `system.web` файла Web. config приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-751">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="102c4-752">Он указывает, что приложение использует экземпляр класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для предоставления служб членства и присваивает атрибуту `minRequiredNonalphanumericCharacters` один символ.</span><span class="sxs-lookup"><span data-stu-id="102c4-752">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredNonalphanumericCharacters` attribute to one character.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredNonalphanumericCharacters = "1" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-753">Доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> осуществляется до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-753">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-754">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-754">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredPasswordLength">
      <MemberSignature Language="C#" Value="public override int MinRequiredPasswordLength { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredPasswordLength" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredPasswordLength As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredPasswordLength { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredPasswordLength : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-755">Получает минимальную длину пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-755">Gets the minimum length required for a password.</span></span></summary>
        <value><span data-ttu-id="102c4-756">Минимальная длина пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-756">The minimum length required for a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-757">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> возвращает минимальное число символов, которые необходимо указать для создания допустимого пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-757">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property gets the minimum number of characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="102c4-758">Значение свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> задается в конфигурации приложения с помощью атрибута `minRequiredPasswordLength` элемента конфигурации [элемента членства (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-758">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property value is set in the application configuration using the `minRequiredPasswordLength` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-759">В следующем примере показан элемент конфигурации [элемента membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) в разделе `system.web` файла Web. config приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-759">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="102c4-760">Он указывает, что приложение использует экземпляр класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для предоставления служб членства и устанавливает атрибут `minRequiredPasswordLength` в семь символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-760">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredPasswordLength` attribute to seven characters.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredPasswordLength = "7" />  
  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-761">Доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> осуществляется до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-761">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-762">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-762">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAnswerAttemptLockoutDuration">
      <MemberSignature Language="C#" Value="public int PasswordAnswerAttemptLockoutDuration { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property PasswordAnswerAttemptLockoutDuration As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int PasswordAnswerAttemptLockoutDuration { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAnswerAttemptLockoutDuration : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-763">Возвращает интервал времени, на который блокируется учетная запись пользователя, из-за слишком большого числа попыток неправильного ввода пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-763">Get the length of time for which a user account is locked out after the user makes too many bad password-answer attempts.</span></span></summary>
        <value><span data-ttu-id="102c4-764">Время, в минутах, на которое пользователь заблокирован, после слишком большого числа неверных ответов пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-764">The time, in minutes, that a user is locked out after providing too many incorrect password answers.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-765">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> `true`, пользователь должен ответить на вопрос с паролем, чтобы сбросить свой пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-765">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="102c4-766">Если пользователю не удается предоставить правильный ответ в несколько раз подряд, равное значению свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> за период наблюдения, заданный свойством <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>, пользователь блокирует дальнейшие попытки в течение числа минут, содержащихся в Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-766">If the user fails to supply the correct answer a consecutive number of times equal to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property value within the observation time period specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, the user is locked out of further attempts for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-767">Это свойство не задает продолжительность блокировки пользователя после неудачного ввода допустимого пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-767">This property does not set the duration a user is locked out after failing to enter a valid password.</span></span> <span data-ttu-id="102c4-768">Сервер Active Directory обрабатывает неудачные попытки входа в систему и не влияет на значение этого свойства.</span><span class="sxs-lookup"><span data-stu-id="102c4-768">The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span> <span data-ttu-id="102c4-769">Рекомендуется, чтобы свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> было иметь то же значение, что и длительность блокировки учетной записи, заданная для слишком большого числа неудачных попыток входа в конфигурацию Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-769">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration specified for too many failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="102c4-770">Это обеспечит единообразное поведение автоматической блокировки для пользователей независимо от того, были ли они заблокированы из-за неудачных попыток входа или неправильного ответа на пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-770">This will present consistent auto-lockout behavior for users regardless of whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="102c4-771">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> задается в файле конфигурации приложения с помощью атрибута `passwordAnswerAttemptLockoutDuration` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-771">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAnswerAttemptLockoutDuration` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-772">Если свойство не задано в файле конфигурации приложения, для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> задается значение по умолчанию, равное 30 минутам.</span><span class="sxs-lookup"><span data-stu-id="102c4-772">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 30 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-773">В следующем примере кода показана запись Web. config, которая настраивает экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для блокировки пользователей, которые делают три неудачные попытки ввода ответа на пароль в течение 10 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-773">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="102c4-774">Если пользователь заблокирован, дальнейшая попытка ответить на этот вопрос с паролем может быть выполнена в течение 15 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-774">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-775">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-775">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-776">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-776">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAttemptWindow">
      <MemberSignature Language="C#" Value="public override int PasswordAttemptWindow { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAttemptWindow" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordAttemptWindow As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int PasswordAttemptWindow { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAttemptWindow : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-777">Возвращает интервал времени, в течении которого отслеживаются последовательные попытки ввода недействительного пароля или ответа пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-777">Gets the time window during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span></summary>
        <value><span data-ttu-id="102c4-778">Интервал времени, в минутах, в течении которого отслеживаются последовательные попытки ввода недействительного пароля или ответа пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-778">The time window, in minutes, during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span> <span data-ttu-id="102c4-779">Значение по умолчанию — 10 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-779">The default is 10 minutes.</span></span> <span data-ttu-id="102c4-780">Если интервал между неудачными попытками больше значения свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />, экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> рассматривает очередную неудачную попытку как первую неудачную попытку.</span><span class="sxs-lookup"><span data-stu-id="102c4-780">If the interval between each failed attempt is greater than the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property setting, the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance treats each failed attempt as if it were the first failed attempt.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-781">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> работает совместно со свойством <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>, чтобы помочь защититься от нежелательного источника, отвечающего за нежелательные попытки, с помощью повторяющихся попыток получить пароль или ответ на пароль пользователя членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-781">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property works in conjunction with the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property to help guard against an unwanted source guessing the password or password answer of a membership user through repeated attempts.</span></span> <span data-ttu-id="102c4-782">Когда пользователи пытаются войти в систему, изменить пароль или сбросить пароль, в течение заданного временного интервала может быть только определенное число последовательных попыток.</span><span class="sxs-lookup"><span data-stu-id="102c4-782">When users are attempting to log in, change their password, or reset their password, only a certain number of consecutive attempts are allowed within a specified time window.</span></span> <span data-ttu-id="102c4-783">Длина временного окна задается свойством <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>, которое определяет допустимое количество минут между недопустимыми попытками.</span><span class="sxs-lookup"><span data-stu-id="102c4-783">The length of the time window is specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, which identifies the number of minutes allowed between invalid attempts.</span></span> <span data-ttu-id="102c4-784">Если число последовательных неудачных попыток, которое пользователь выполняет для сброса пароля, равен значению, хранящемуся в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>, а время, прошедшее с момента последней недопустимой попытки, меньше, чем число минут, заданное для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> , учетная запись пользователя была заблокирована в течение числа минут, содержащихся в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-784">If the number of consecutive failed attempts a user makes to reset his or her password equals the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, and the time elapsed since the last invalid attempt is less than the number of minutes specified for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, then the user account s locked out for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span> <span data-ttu-id="102c4-785">Если интервал между текущей попыткой неудачной попытки и последней неудачной попыткой превышает значение свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>, текущая попытка считается недействительной.</span><span class="sxs-lookup"><span data-stu-id="102c4-785">If the interval between the current failed attempt and the last failed attempt is greater than the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property setting, the current invalid attempt is counted as the first attempt.</span></span> <span data-ttu-id="102c4-786">Если получен допустимый ответ на пароль до достижения максимального числа допустимых попыток, то число попыток ввода пароля будет равно нулю.</span><span class="sxs-lookup"><span data-stu-id="102c4-786">If a valid password answer is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password-answer attempts is set to zero.</span></span> <span data-ttu-id="102c4-787">Если допустимый пароль предоставляется до достижения максимального разрешенного количества недопустимых попыток, число недопустимых попыток ввода пароля и число недопустимых попыток ввода пароля задаются равными нулю.</span><span class="sxs-lookup"><span data-stu-id="102c4-787">If a valid password is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password attempts and the count of invalid password-answer attempts are set to zero.</span></span>  
  
 <span data-ttu-id="102c4-788">Рекомендуется, чтобы для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> было задано то же значение, что и для блокировки учетной записи, заданной для максимального числа неудачных попыток входа в конфигурацию Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-788">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration that is specified for the maximum number of failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="102c4-789">Это обеспечит единообразное поведение автоматической блокировки для пользователей независимо от того, были ли они заблокированы из-за неудачных попыток входа или неправильного ответа на пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-789">This will present consistent auto-lockout behavior for users whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="102c4-790">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> задается в файле конфигурации приложения с помощью атрибута `passwordAttemptWindow` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-790">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAttemptWindow` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-791">Если свойство не задано в файле конфигурации приложения, для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> задается значение по умолчанию 10 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-791">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 10 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-792">В следующем примере кода показана запись Web. config, которая настраивает экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для блокировки пользователей, которые делают три неудачные попытки ввода ответа на пароль в течение 10 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-792">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="102c4-793">Если пользователь заблокирован, дальнейшая попытка ответить на этот вопрос с паролем может быть выполнена в течение 15 минут.</span><span class="sxs-lookup"><span data-stu-id="102c4-793">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
        passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-794">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-794">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-795">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-795">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordFormat">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipPasswordFormat PasswordFormat { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.MembershipPasswordFormat PasswordFormat" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordFormat As MembershipPasswordFormat" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::Security::MembershipPasswordFormat PasswordFormat { System::Web::Security::MembershipPasswordFormat get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordFormat : System.Web.Security.MembershipPasswordFormat" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipPasswordFormat</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-796">Возвращает значение, показывающее формат паролей в хранилище данных членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-796">Gets a value indicating the format of passwords in the Active Directory data store.</span></span></summary>
        <value><span data-ttu-id="102c4-797">Одно из значений перечисления <see cref="T:System.Web.Security.MembershipPasswordFormat" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-797">One of the <see cref="T:System.Web.Security.MembershipPasswordFormat" /> values.</span></span> <span data-ttu-id="102c4-798">Свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> всегда возвращает значение <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-798">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> property always returns <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-799">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider> не поддерживает извлечение пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-799">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> property does not support password retrieval.</span></span> <span data-ttu-id="102c4-800">Поведение объекта <xref:System.Web.Security.ActiveDirectoryMembershipProvider> аналогично тому, как другие поставщики, работающие с `Hashed` паролями.</span><span class="sxs-lookup"><span data-stu-id="102c4-800">The behavior of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object is the same as other providers working with `Hashed` passwords.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-801">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-801">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordStrengthRegularExpression">
      <MemberSignature Language="C#" Value="public override string PasswordStrengthRegularExpression { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string PasswordStrengthRegularExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordStrengthRegularExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ PasswordStrengthRegularExpression { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordStrengthRegularExpression : string" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-802">Возвращает регулярное выражение, используемое для обработки пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-802">Gets the regular expression used to evaluate a password.</span></span></summary>
        <value><span data-ttu-id="102c4-803">Регулярное выражение, используемое для обработки пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-803">A regular expression used to evaluate a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-804">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> возвращает регулярное выражение, используемое для вычисления сложности пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-804">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property gets the regular expression used to evaluate password complexity.</span></span>  
  
 <span data-ttu-id="102c4-805">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> не используется для проверки автоматически создаваемых паролей в методе <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-805">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is not used to validate auto-generated passwords in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method.</span></span>  
  
 <span data-ttu-id="102c4-806">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> задается в конфигурации приложения с помощью атрибута `passwordStrengthRegularExpression` элемента конфигурации [элемента membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-806">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is set in the application configuration using the `passwordStrengthRegularExpression` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-807">В следующем примере показан элемент конфигурации [элемента membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) в разделе `system.web` файла Web. config приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-807">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="102c4-808">Он указывает, что приложение использует экземпляр класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для предоставления служб членства и задает для атрибута `passwordStrengthRegularExpression` регулярное выражение, которое проверяет, соответствует ли пароль следующим критериям:</span><span class="sxs-lookup"><span data-stu-id="102c4-808">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services and sets the `passwordStrengthRegularExpression` attribute to a regular expression that validates that the password meets the following criteria:</span></span>  
  
-   <span data-ttu-id="102c4-809">Больше семи символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-809">Is greater than seven characters.</span></span>  
  
-   <span data-ttu-id="102c4-810">Содержит по меньшей мере одну цифру.</span><span class="sxs-lookup"><span data-stu-id="102c4-810">Contains at least one digit.</span></span>  
  
-   <span data-ttu-id="102c4-811">Содержит по крайней мере один специальный (не буквенно-цифровой) символ.</span><span class="sxs-lookup"><span data-stu-id="102c4-811">Contains at least one special (non-alphanumeric) character.</span></span>  
  
 <span data-ttu-id="102c4-812">Если пароль не соответствует этим критериям, поставщик членства не принимает пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-812">If the password does not meet these criteria, the password is not accepted by the membership provider.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          passwordStrengthRegularExpression=  
            "@\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-813">Доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> осуществляется до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-813">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-814">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-814">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool RequiresQuestionAndAnswer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresQuestionAndAnswer" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresQuestionAndAnswer As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresQuestionAndAnswer { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresQuestionAndAnswer : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-815">Получает значение, показывающее, настроен ли поставщик участия, чтобы запрашивать пароль при создании пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-815">Gets a value indicating whether the membership provider is configured to require a password question and answer when creating a user.</span></span></summary>
        <value><span data-ttu-id="102c4-816"><see langword="true" />, если объект <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> сконфигурирован требовать запрос-ответ пароля; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-816"><see langword="true" /> if the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> object is configured to require a password question and answer for a user; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-817">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-817">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-818">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> задается в файле конфигурации приложения с помощью атрибута `requiresQuestionAndAnswer` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-818">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set in your application's configuration file using the `requiresQuestionAndAnswer` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-819">Если свойство не задано в файле конфигурации приложения, свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> присваивается значение по умолчанию `false`.</span><span class="sxs-lookup"><span data-stu-id="102c4-819">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set to the default value of `false`.</span></span>  
  
 <span data-ttu-id="102c4-820">Если для атрибута `requiresQuestionAndAnswer` задано значение `true`, необходимо также задать эти дополнительные атрибуты.</span><span class="sxs-lookup"><span data-stu-id="102c4-820">When the `requiresQuestionAndAnswer` attribute is set to `true`, you must also set these additional attributes.</span></span>  
  
-   <span data-ttu-id="102c4-821">`attributeMapPasswordQuestion` и `attributeMapPasswordAnswer` должны быть сопоставлены с атрибутами в схеме Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-821">`attributeMapPasswordQuestion` and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="102c4-822">Если указанные выше условия не выполняются, при инициализации возникает исключение <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-822">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-823">При создании пользователя можно запрашивать вопрос и ответ с паролем, но задать для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> значение `false`, чтобы запретить пользователям изменять пароли с помощью класса <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-823">You can require a password question and answer when creating a user, but set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property to `false` to prevent users from changing their passwords using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-824">В следующем примере кода показана запись Web. config, которая настраивает <xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр для включения сброса пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-824">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="102c4-825">Он использует явные учетные данные пользователя при наличии права доступа "Сброс пароля".</span><span class="sxs-lookup"><span data-stu-id="102c4-825">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-826">При помещении учетных данных пользователя в файл Web. config возникают потенциальные угрозы безопасности.</span><span class="sxs-lookup"><span data-stu-id="102c4-826">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="102c4-827">Пользователи с правами доступа к каталогу, содержащему файл Web. config, могут прочитать файл и, таким же, просмотреть учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-827">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="102c4-828">Дополнительные сведения о защите от этой угрозы см. в разделе [Шифрование сведений о конфигурации с помощью защищенной конфигурации](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span><span class="sxs-lookup"><span data-stu-id="102c4-828">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-829">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-829">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-830">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-830">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresUniqueEmail">
      <MemberSignature Language="C#" Value="public override bool RequiresUniqueEmail { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresUniqueEmail" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresUniqueEmail As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresUniqueEmail { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresUniqueEmail : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="102c4-831">Возвращает значение, указывающее, должен ли быть уникальным адрес электронной почты, который хранится на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-831">Gets a value indicating whether an email address stored on the Active Directory server must be unique.</span></span></summary>
        <value><span data-ttu-id="102c4-832"><see langword="true" />, если адреса электронной почты должны быть уникальными; в противном случае <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-832"><see langword="true" /> if email addresses must be unique; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-833">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-833">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-834">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> `true`, то экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> гарантирует, что адрес электронной почты не будет использоваться другими пользователями в текущей области при вызове метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> или <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-834">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance ensures that the email address is not used by any other user within the current scope when either the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> or <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method is called.</span></span>  
  
 <span data-ttu-id="102c4-835">Свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> задается в файле конфигурации приложения с помощью атрибута `requiresUniqueEmail` элемента [Membership (схема параметров ASP.NET)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) .</span><span class="sxs-lookup"><span data-stu-id="102c4-835">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set in your application's configuration file using the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="102c4-836">Если свойство не задано в файле конфигурации приложения, свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> присваивается значение по умолчанию `false`.</span><span class="sxs-lookup"><span data-stu-id="102c4-836">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set to the default value of `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="102c4-837">В следующем примере кода показана запись Web. config, которая настраивает <xref:System.Web.Security.ActiveDirectoryMembershipProvider> экземпляр, чтобы требовать уникальные адреса электронной почты для пользователей, хранящихся на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-837">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to require unique email addresses for users stored on the Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          requiresUniqueEmail="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-838">Была предпринята попытка получить доступ к свойству <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> до того, как экземпляр <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> был инициализирован.</span><span class="sxs-lookup"><span data-stu-id="102c4-838">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-839">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-839">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ResetPassword">
      <MemberSignature Language="C#" Value="public override string ResetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ResetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ResetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ResetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.ResetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-840">Пользователь, чей пароль требуется сбросить.</span><span class="sxs-lookup"><span data-stu-id="102c4-840">The user to reset the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="102c4-841">Контрольный ответ для пароля заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-841">The password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="102c4-842">Сбрасывает пароль пользователя и устанавливает новый, автоматически сгенерированный пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-842">Resets a user's password to a new, automatically generated password.</span></span></summary>
        <returns><span data-ttu-id="102c4-843">Новый пароль для указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-843">The new password for the specified user.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-844">Метод вызывается классом <xref:System.Web.Security.Membership> для сброса пароля пользователя в Active Directoryном хранилище данных до нового случайного значения.</span><span class="sxs-lookup"><span data-stu-id="102c4-844">The method is called by the <xref:System.Web.Security.Membership> class to reset the password for a user in the Active Directory data store to a new randomly generated value.</span></span> <span data-ttu-id="102c4-845">Будет возвращен новый пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-845">The new password is returned.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-846">Случайный пароль, созданный методом <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>, не гарантирует передачу регулярного выражения в свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-846">The random password created by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method is not guaranteed to pass the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span> <span data-ttu-id="102c4-847">Однако случайный пароль будет соответствовать критериям, установленным в свойствах <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> и <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-847">However, the random password will meet the criteria established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> properties.</span></span>  
  
 <span data-ttu-id="102c4-848">Если методу <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> предоставлен неверный ответ, внутренний счетчик, который отслеживает недопустимые попытки ввода пароля, увеличивается на единицу.</span><span class="sxs-lookup"><span data-stu-id="102c4-848">If an incorrect answer is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method, the internal counter that tracks invalid password-answer attempts is incremented by one.</span></span> <span data-ttu-id="102c4-849">Это может привести к тому, что пользователь не сможет войти в систему до тех пор, пока состояние блокировки не будет снято вызовом метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-849">This can result in the user being unable to log on until the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method.</span></span> <span data-ttu-id="102c4-850">Если указан правильный ответ на пароль и пользователь не заблокирован, внутренний счетчик, который отслеживает попытки ввода пароля, сбрасывается в ноль.</span><span class="sxs-lookup"><span data-stu-id="102c4-850">If the correct password answer is supplied and the user is not currently locked out, then the internal counter that tracks invalid password attempts is reset to zero.</span></span> <span data-ttu-id="102c4-851">Дополнительные сведения см. в разделе Свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> и <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-851">For more information, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> properties.</span></span>  
  
 <span data-ttu-id="102c4-852">Начальные и конечные пробелы удаляются из всех значений параметров.</span><span class="sxs-lookup"><span data-stu-id="102c4-852">Leading and trailing spaces are trimmed from all parameter values.</span></span>  
  
 <span data-ttu-id="102c4-853">Вы можете вызвать метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> напрямую, сначала получив ссылку на экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> из свойства <xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="102c4-853">You can call the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method directly by first obtaining a reference to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance from the <xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="102c4-854">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-854">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-855">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-855">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-856">Чтобы задать пароли на сервере Active Directory, атрибуту `connectionProtection` должно быть присвоено значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span><span class="sxs-lookup"><span data-stu-id="102c4-856">To set passwords on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="102c4-857">При использовании сервера ADAM атрибуту `connectionProtection` можно присвоить значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, но только в том случае, если вы явно настроили сервер ADAM для разрешения смены пароля по незащищенным соединениям.</span><span class="sxs-lookup"><span data-stu-id="102c4-857">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-858">Нельзя сбросить пароли, если только учетные данные, используемые для подключения к серверу Active Directory, не имеют прав администратора домена (не рекомендуется) или права доступа "Сброс пароля".</span><span class="sxs-lookup"><span data-stu-id="102c4-858">You cannot reset passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
 <span data-ttu-id="102c4-859">Чтобы сбросить пароль, должны быть выполнены все следующие условия.</span><span class="sxs-lookup"><span data-stu-id="102c4-859">To reset a password, all of the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="102c4-860">Для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> необходимо задать значение `true`.</span><span class="sxs-lookup"><span data-stu-id="102c4-860">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="102c4-861">Схема Active Directory должна быть изменена, чтобы содержать атрибуты для хранения вопроса и ответа пароля, а также три поля отслеживания для изменения ответов на пароли.</span><span class="sxs-lookup"><span data-stu-id="102c4-861">The Active Directory schema must be modified to contain attributes for storing the password question and answer, and the three tracking fields for password answer changes.</span></span>  
  
-   <span data-ttu-id="102c4-862">В файле конфигурации приложения должны быть заданы атрибуты `attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`и `attributeMapFailedPasswordAnswerLockedTime`.</span><span class="sxs-lookup"><span data-stu-id="102c4-862">The `attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockedTime` attributes must be set in the application configuration file.</span></span>  
  
-   <span data-ttu-id="102c4-863">Для свойства <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> необходимо задать значение `true`.</span><span class="sxs-lookup"><span data-stu-id="102c4-863">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="102c4-864">Контекст безопасности для подключения к Active Directory хранилищу данных (учетная запись процесса или явные учетные данные) должен иметь достаточные привилегии для изменения паролей.</span><span class="sxs-lookup"><span data-stu-id="102c4-864">The security context for connecting to the Active Directory data store (either the process account or the explicit credentials) must have sufficient privileges to change passwords.</span></span> <span data-ttu-id="102c4-865">Учетные данные, используемые для подключения к серверу Active Directory, имеют либо права администратора домена (не рекомендуется), либо право доступа "Сброс пароля".</span><span class="sxs-lookup"><span data-stu-id="102c4-865">The credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="102c4-866">Политики безопасности, установленные на Active Directory сервере, могут сделать так, чтобы метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> не мог создать пароль, соответствующий политикам.</span><span class="sxs-lookup"><span data-stu-id="102c4-866">Security policies set on the Active Directory server may make it impossible for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to generate a password that satisfies the policies.</span></span> <span data-ttu-id="102c4-867">Реализация метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> по умолчанию создает пароли, которые соответствуют политикам паролей по умолчанию на контроллерах домена под Windows Server 2003 с пакетом обновления 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="102c4-867">The default implementation of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method will generate passwords that satisfy the default password policies on domain controllers running Windows Server 2003 SP1.</span></span> <span data-ttu-id="102c4-868">Если не удается сбросить пароль из-за политик безопасности на Active Directory сервере, создается <xref:System.Configuration.Provider.ProviderException>.</span><span class="sxs-lookup"><span data-stu-id="102c4-868">If the password cannot be reset due to security policies on the Active Directory server, a <xref:System.Configuration.Provider.ProviderException> is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-869">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-869">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="102c4-870">Значение свойства <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> равно <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-870">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property value is <see langword="false" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-871">Свойство <paramref name="passwordAnswer" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-871"><paramref name="passwordAnswer" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-872">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-872">-or-</span></span> 
 <span data-ttu-id="102c4-873"><paramref name="username" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-873"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-874">После удаления пробелов параметр <paramref name="passwordAnswer" /> пустой.</span><span class="sxs-lookup"><span data-stu-id="102c4-874"><paramref name="passwordAnswer" /> is empty after trimming</span></span> 
<span data-ttu-id="102c4-875">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-875">-or-</span></span> 
 <span data-ttu-id="102c4-876">Длина параметра <paramref name="passwordAnswer" /> превышает 128 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-876"><paramref name="passwordAnswer" /> exceeds 128 characters.</span></span>  
  
<span data-ttu-id="102c4-877">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-877">-or-</span></span> 
 <span data-ttu-id="102c4-878">Параметр <paramref name="username" /> пустой, или превышает максимальную разрешенную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-878"><paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-879">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-879">-or-</span></span> 
 <span data-ttu-id="102c4-880"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-880"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-881">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-881">-or-</span></span> 
<span data-ttu-id="102c4-882">Имя пользователя отображается на атрибут <see langword="userPrincipalName" />, но параметр <paramref name="username" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-882">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><span data-ttu-id="102c4-883">Пользователь заблокирован из-за слишком большого числа ошибок при подключении или восстановлении запроса-ответа пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-883">The user is locked out because of too many bad logon attempts or too many attempted password-answer reset attempts.</span></span>  
  
<span data-ttu-id="102c4-884">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-884">-or-</span></span> 
 <span data-ttu-id="102c4-885">Параметр <paramref name="passwordAnswer" /> не соответствует хранимому ответу пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-885"><paramref name="passwordAnswer" /> does not match the stored password answer.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-886">Пользователь, указанный в параметре <paramref name="username" />, отсутствует в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-886">The user specified in <paramref name="username" /> does not exist in the Active Directory data store.</span></span>  
  
<span data-ttu-id="102c4-887">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-887">-or-</span></span> 
<span data-ttu-id="102c4-888">Сгенерированный пароль не проходит пользователь обработчик проверки.</span><span class="sxs-lookup"><span data-stu-id="102c4-888">A generated password does not pass a custom validation handler.</span></span>  
  
<span data-ttu-id="102c4-889">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-889">-or-</span></span> 
<span data-ttu-id="102c4-890">Сгенерированный пароль не достаточно сложен для удовлетворения пользовательской политики паролей, установленной на сервере Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-890">The generated password is not complex enough to satisfy custom password policies set on the Active Directory server.</span></span>  
  
<span data-ttu-id="102c4-891">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-891">-or-</span></span> 
<span data-ttu-id="102c4-892">Нельзя создать безопасное подключение к серверу Active Directory Application Mode для установки нового пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-892">A secure connection cannot be made to an Active Directory Application Mode server to set the new password.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="102c4-893">Произошло необработанное исключение.</span><span class="sxs-lookup"><span data-stu-id="102c4-893">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-894">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-894">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UnlockUser">
      <MemberSignature Language="C#" Value="public override bool UnlockUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool UnlockUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function UnlockUser (username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool UnlockUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="override this.UnlockUser : string -&gt; bool" Usage="activeDirectoryMembershipProvider.UnlockUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-895">Имя пользователя членства, для которого снимается блокировка.</span><span class="sxs-lookup"><span data-stu-id="102c4-895">The name of the membership user to clear the lock status for.</span></span></param>
        <summary><span data-ttu-id="102c4-896">Снимает блокировку так, что пользователь членства может быть проверен.</span><span class="sxs-lookup"><span data-stu-id="102c4-896">Clears a lock so that a membership user can be validated.</span></span></summary>
        <returns><span data-ttu-id="102c4-897">Значение <see langword="true" />, если авторизованный пользователь успешно разблокирован; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-897"><see langword="true" /> if the membership user was successfully unlocked; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-898">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> также возвращает <see langword="false" />, когда пользователь членства не найден в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="102c4-898">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method also returns <see langword="false" /> when the membership user is not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-899">Чаще всего пользователи блокируются и не могут быть проверены методом <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>, если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> превышено в течение времени, указанного в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>, или когда было выполнено слишком много попыток входа с использованием неправильного пароля.</span><span class="sxs-lookup"><span data-stu-id="102c4-899">Users are most commonly locked out and cannot be validated by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is exceeded within the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property or when too many attempts have been made to log on using the wrong password.</span></span>  
  
 <span data-ttu-id="102c4-900">Если <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> свойство имеет значение `true`, то при снятии блокировки счетчиков для неверных паролей сбрасываются.</span><span class="sxs-lookup"><span data-stu-id="102c4-900">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, when a user is unlocked the counters for bad passwords are reset.</span></span>  
  
 <span data-ttu-id="102c4-901">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-901">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-902">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-902">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="102c4-903">Начальные и конечные пробелы удаляются из значения параметра `username`.</span><span class="sxs-lookup"><span data-stu-id="102c4-903">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-904">Параметр <paramref name="username" /> пустой, или превышает максимальную разрешенную длину имени пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-904"><paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-905">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-905">-or-</span></span> 
 <span data-ttu-id="102c4-906"><paramref name="username" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-906"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="102c4-907">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-907">-or-</span></span> 
<span data-ttu-id="102c4-908">Имя пользователя отображается на атрибут <see langword="userPrincipalName" />, но параметр <paramref name="username" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-908">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-909"><paramref name="username" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-909"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-910">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-910">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-911">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-911">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateUser">
      <MemberSignature Language="C#" Value="public override void UpdateUser (System.Web.Security.MembershipUser user);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void UpdateUser(class System.Web.Security.MembershipUser user) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub UpdateUser (user As MembershipUser)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void UpdateUser(System::Web::Security::MembershipUser ^ user);" />
      <MemberSignature Language="F#" Value="override this.UpdateUser : System.Web.Security.MembershipUser -&gt; unit" Usage="activeDirectoryMembershipProvider.UpdateUser user" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.Web.Security.MembershipUser" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="102c4-912">Экземпляр <see cref="T:System.Web.Security.MembershipUser" />, представляющий пользователя для обновления и обновленную информацию для пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-912">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user to update and the updated information for the user.</span></span></param>
        <summary><span data-ttu-id="102c4-913">Обновляет информацию о пользователе в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-913">Updates information about a user in the Active Directory data store.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-914">Этот метод вызывается классом <xref:System.Web.Security.Membership> для обновления сведений о пользователях в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-914">This method is called by the <xref:System.Web.Security.Membership> class to update user information in the Active Directory data store.</span></span> <span data-ttu-id="102c4-915">Значения свойств <xref:System.Web.Security.MembershipUser.Email%2A>, <xref:System.Web.Security.MembershipUser.Comment%2A>и <xref:System.Web.Security.MembershipUser.IsApproved%2A> обновляются для указанного пользователя членства.</span><span class="sxs-lookup"><span data-stu-id="102c4-915">The <xref:System.Web.Security.MembershipUser.Email%2A>, <xref:System.Web.Security.MembershipUser.Comment%2A>, and <xref:System.Web.Security.MembershipUser.IsApproved%2A> property values are updated for the specified membership user.</span></span> <span data-ttu-id="102c4-916">Все остальные свойства игнорируются.</span><span class="sxs-lookup"><span data-stu-id="102c4-916">All other properties are ignored.</span></span>  
  
 <span data-ttu-id="102c4-917">Максимальная длина параметра `username` составляет 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-917">The maximum length for the `username` parameter is 256 characters.</span></span> <span data-ttu-id="102c4-918">Максимальная длина свойства <xref:System.Web.Security.MembershipUser.Email%2A> — 256 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-918">The maximum length for the <xref:System.Web.Security.MembershipUser.Email%2A> property is 256 characters.</span></span>  
  
 <span data-ttu-id="102c4-919">Невозможно обновить пароль для пользователя членства с помощью метода <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-919">The password for a membership user cannot be updated using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method.</span></span> <span data-ttu-id="102c4-920">Чтобы обновить пароль для пользователя членства, используйте метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-920">To update the password for a membership user, use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method.</span></span>  
  
 <span data-ttu-id="102c4-921">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-921">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="102c4-922">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-922">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-923">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-923">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="102c4-924"><paramref name="user" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-924"><paramref name="user" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="102c4-925">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-925">-or-</span></span> 
<span data-ttu-id="102c4-926">Свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> равно <see langword="true" />, но адрес электронной почты из указанного образца <see cref="T:System.Web.Security.MembershipUser" /> равен <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-926">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" /> but the email address from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="102c4-927">Свойство <see cref="P:System.Web.Security.MembershipUser.Email" /> пустое после удаления пробелов.</span><span class="sxs-lookup"><span data-stu-id="102c4-927">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property is empty after trimming.</span></span>  
  
<span data-ttu-id="102c4-928">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-928">-or-</span></span> 
<span data-ttu-id="102c4-929">Длина свойства <see cref="P:System.Web.Security.MembershipUser.Email" /> превышает 256 знаков.</span><span class="sxs-lookup"><span data-stu-id="102c4-929">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property exceeds 256 characters.</span></span>  
  
<span data-ttu-id="102c4-930">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-930">-or-</span></span> 
<span data-ttu-id="102c4-931">Длина свойства <see cref="P:System.Web.Security.MembershipUser.Comment" /> превышает 1024 символов.</span><span class="sxs-lookup"><span data-stu-id="102c4-931">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property exceeds 1024 characters.</span></span>  
  
<span data-ttu-id="102c4-932">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-932">-or-</span></span> 
<span data-ttu-id="102c4-933">свойство <see cref="P:System.Web.Security.MembershipUser.Comment" /> является пустым;</span><span class="sxs-lookup"><span data-stu-id="102c4-933">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property is empty.</span></span>  
  
<span data-ttu-id="102c4-934">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-934">-or-</span></span> 
<span data-ttu-id="102c4-935">Имя пользователя из указанного экземпляра <see cref="T:System.Web.Security.MembershipUser" /> пустое или превышает максимальную длину, разрешенную для имен пользователя (обычно 256 символов).</span><span class="sxs-lookup"><span data-stu-id="102c4-935">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="102c4-936">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-936">-or-</span></span> 
<span data-ttu-id="102c4-937">Имя пользователя из указанного экземпляра <see cref="T:System.Web.Security.MembershipUser" /> содержит запятые.</span><span class="sxs-lookup"><span data-stu-id="102c4-937">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains commas.</span></span>  
  
<span data-ttu-id="102c4-938">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-938">-or-</span></span> 
<span data-ttu-id="102c4-939">Имя пользователя отображается на атрибут <see langword="userPrincipalName" />, но имя пользователь из указанного экземпляра <see cref="T:System.Web.Security.MembershipUser" /> содержит обратные косые черты.</span><span class="sxs-lookup"><span data-stu-id="102c4-939">The user name is mapped to <see langword="userPrincipalName" /> but the user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains backslashes.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="102c4-940">Указанный пользователь не найден в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-940">The specified user is not found in the Active Directory data store.</span></span>  
  
<span data-ttu-id="102c4-941">- или -</span><span class="sxs-lookup"><span data-stu-id="102c4-941">-or-</span></span> 
<span data-ttu-id="102c4-942">Свойство <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> равно <see langword="true" />, и новое значение свойства <see cref="P:System.Web.Security.MembershipUser.Email" /> дублирует существующий адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="102c4-942">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" />, and the new value of the <see cref="P:System.Web.Security.MembershipUser.Email" /> property duplicates an existing email address.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-943">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-943">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ValidateUser">
      <MemberSignature Language="C#" Value="public override bool ValidateUser (string username, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ValidateUser(string username, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ValidateUser (username As String, password As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ValidateUser(System::String ^ username, System::String ^ password);" />
      <MemberSignature Language="F#" Value="override this.ValidateUser : string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ValidateUser (username, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="102c4-944">Имя пользователя для проверки.</span><span class="sxs-lookup"><span data-stu-id="102c4-944">The name of the user to validate.</span></span></param>
        <param name="password"><span data-ttu-id="102c4-945">Пароль заданного пользователя.</span><span class="sxs-lookup"><span data-stu-id="102c4-945">The password for the specified user.</span></span></param>
        <summary><span data-ttu-id="102c4-946">Проверяет существование указанного имени пользователя и пароля в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-946">Verifies that the specified user name and password exist in the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="102c4-947">Значение <see langword="true" />, если указанные <paramref name="username" /> и <paramref name="password" /> действительны; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-947"><see langword="true" /> if the specified <paramref name="username" /> and <paramref name="password" /> are valid; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="102c4-948">Если указанный пользователь не существует в хранилище данных Active Directory, метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> возвращает <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-948">If the user specified does not exist in the Active Directory data store, the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method returns <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="102c4-949">Этот метод вызывается классом <xref:System.Web.Security.Membership> для проверки учетных данных пользователя в хранилище данных Active Directory.</span><span class="sxs-lookup"><span data-stu-id="102c4-949">This method is called by the <xref:System.Web.Security.Membership> class to validate user credentials against the Active Directory data store.</span></span>  
  
 <span data-ttu-id="102c4-950">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true` и предоставлены допустимые учетные данные, то счетчики отслеживания неудачных ответов пользователя сбрасываются.</span><span class="sxs-lookup"><span data-stu-id="102c4-950">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true` and the supplied credentials are valid, the user's tracking counters for bad password answers are reset.</span></span>  
  
 <span data-ttu-id="102c4-951">Метод <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> может возвращать `false` при предоставлении правильных учетных данных в следующих случаях.</span><span class="sxs-lookup"><span data-stu-id="102c4-951">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method may return `false` when the correct credentials are supplied, under the following circumstances:</span></span>  
  
1.  <span data-ttu-id="102c4-952">Учетная запись пользователя была заблокирована сервером каталогов из-за слишком большого числа неудачных попыток входа.</span><span class="sxs-lookup"><span data-stu-id="102c4-952">The user account was locked out by the directory server because of too many failed logon attempts.</span></span> <span data-ttu-id="102c4-953">Пользователь не сможет войти в систему, пока не будет пройдена длительность блокировки каталога.</span><span class="sxs-lookup"><span data-stu-id="102c4-953">The user will not be able to log on until the directory's lockout duration passes.</span></span>  
  
2.  <span data-ttu-id="102c4-954">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, учетная запись пользователя будет заблокирована, если пользователь слишком много раз указал недопустимый ответ на пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-954">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user account will be locked if the user supplied a bad password answer too many times.</span></span> <span data-ttu-id="102c4-955">Учетная запись пользователя будет разблокирована после передачи времени, указанного в свойстве <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>.</span><span class="sxs-lookup"><span data-stu-id="102c4-955">The user's account will unlock after the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property has passed.</span></span>  
  
3.  <span data-ttu-id="102c4-956">Пользователь должен существовать в контейнере, указанном в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-956">The user must exist in the container specified in the connection string.</span></span> <span data-ttu-id="102c4-957">Для учетной записи пользователя, расположенной в другом контейнере или в другом домене, предоставляются действительные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="102c4-957">Valid credentials are supplied for a user account located in a different container or in a different domain.</span></span> <span data-ttu-id="102c4-958">Пользователь должен существовать в контейнере, указанном в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="102c4-958">The user must exist in the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="102c4-959">При проверке пользователя поставщик проверяет учетные данные, подключаясь к Active Directory хранилищу данных, используя указанные имя пользователя и пароль, а не учетные данные, настроенные в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="102c4-959">When validating a user, the provider validates the credentials by connecting to the Active Directory data store using the specified user name and password, not the credentials configured in the application configuration file.</span></span>  
  
 <span data-ttu-id="102c4-960">Однако экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет подключаться к каталогу, используя настроенные учетные данные по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="102c4-960">However, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will connect to the directory using the configured credentials for the following reasons.</span></span>  
  
-   <span data-ttu-id="102c4-961">Чтобы убедиться, что пользователь существует в области поиска, определяется строкой подключения экземпляра <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-961">To confirm that a user exists within the search scope as determined by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance's connection string.</span></span> <span data-ttu-id="102c4-962">Поставщик использует поиск по поддереву, начиная с точки поиска, указанной в строке подключения, чтобы определить, существует ли пользователь.</span><span class="sxs-lookup"><span data-stu-id="102c4-962">The provider uses a subtree search starting at the search point specified in the connection string to determine whether a user exists.</span></span> <span data-ttu-id="102c4-963">Пользователь должен существовать в указанном контейнере.</span><span class="sxs-lookup"><span data-stu-id="102c4-963">The user must exist in the specified container.</span></span> <span data-ttu-id="102c4-964">Учетные данные, допустимые вне указанного контейнера строки подключения, не будут проверены.</span><span class="sxs-lookup"><span data-stu-id="102c4-964">Credentials that are valid outside the connection string's specified container will not be validated.</span></span> <span data-ttu-id="102c4-965">Дополнительные сведения о строках подключения см. в разделе класс <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span><span class="sxs-lookup"><span data-stu-id="102c4-965">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
-   <span data-ttu-id="102c4-966">Если свойство <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> имеет значение `true`, то экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет использовать настроенные учетные данные для загрузки пользовательского экземпляра, чтобы проверить, заблокирован ли пользователь, так как он сделал слишком много неудачных попыток изменить ответ на пароль.</span><span class="sxs-lookup"><span data-stu-id="102c4-966">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use the configured credentials to load the user instance to check whether the user has been locked out because he or she has made too many failed attempts to change the password answer.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="102c4-967">Подключение к контроллеру домена Active Directory с включенной учетной записью "гость" является потенциальной угрозой безопасности.</span><span class="sxs-lookup"><span data-stu-id="102c4-967">Connecting to an Active Directory domain controller with the "Guest" account enabled is a potential security threat.</span></span> <span data-ttu-id="102c4-968">Все попытки проверки, выполненные на контроллере домена Active Directory с включенной учетной записью гостя, будут выполнены.</span><span class="sxs-lookup"><span data-stu-id="102c4-968">All validation attempts made on an Active Directory domain controller with the "Guest" account enabled will succeed.</span></span> <span data-ttu-id="102c4-969">Чтобы повысить безопасность при использовании Active Directory контроллера домена, необходимо отключить гостевую учетную запись на контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="102c4-969">To improve security when using an Active Directory domain controller, you should disable the "Guest" account on the domain controller.</span></span>  
  
 <span data-ttu-id="102c4-970">Экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider> будет пытаться выполнить одновременную привязку к Active Directory при выполнении одного из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="102c4-970">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will attempt a concurrent bind against Active Directory when one of the following conditions is met:</span></span>  
  
-   <span data-ttu-id="102c4-971">Свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> задано значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>.</span><span class="sxs-lookup"><span data-stu-id="102c4-971">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>.</span></span>  
  
-   <span data-ttu-id="102c4-972">Свойству <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> присвоено значение <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> и SSL выбирается экземпляром <xref:System.Web.Security.ActiveDirectoryMembershipProvider> для защиты соединения.</span><span class="sxs-lookup"><span data-stu-id="102c4-972">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> and SSL is chosen by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to secure the connection.</span></span>  
  
 <span data-ttu-id="102c4-973">Кроме того, для параллельной привязки необходимо выполнить следующие условия.</span><span class="sxs-lookup"><span data-stu-id="102c4-973">In addition, for a concurrent bind to be made, the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="102c4-974">Сервер каталогов должен работать под Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="102c4-974">The directory server must be running on Windows Server 2003.</span></span>  
  
-   <span data-ttu-id="102c4-975">Операционная система веб-сервера, на котором работает экземпляр <xref:System.Web.Security.ActiveDirectoryMembershipProvider>, должна поддерживать параллельные привязки (например, Windows Server 2003).</span><span class="sxs-lookup"><span data-stu-id="102c4-975">The operating system of the Web server running the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance must support concurrent binds (for example, Windows Server 2003).</span></span>  
  
 <span data-ttu-id="102c4-976">При использовании параллельной привязки Дата последнего входа пользователя в систему в каталоге не обновляется; Поэтому свойство <xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A> не может быть полагаться на.</span><span class="sxs-lookup"><span data-stu-id="102c4-976">When a concurrent bind is used, the last logon date for the user is not updated in the directory; therefore, the <xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A> property cannot be relied on.</span></span>  
  
 <span data-ttu-id="102c4-977">Начальные и конечные пробелы удаляются из параметра `username`.</span><span class="sxs-lookup"><span data-stu-id="102c4-977">Leading and trailing spaces are trimmed from the `username` parameter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="102c4-978">Метод <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> вызывается до инициализации экземпляра <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span><span class="sxs-lookup"><span data-stu-id="102c4-978">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="102c4-979">Введение в членство в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="102c4-979">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>
