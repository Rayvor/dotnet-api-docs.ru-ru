<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <Metadata><Meta Name="ms.openlocfilehash" Value="04a4e68caa27f29b0802e4a5a228d4e5a4f49b56" /><Meta Name="ms.sourcegitcommit" Value="a6c4dae9c1ba2cfbc4452907ef5697ad1f870c0d" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="10/30/2019" /><Meta Name="ms.locfileid" Value="73080243" /></Metadata><TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <TypeSignature Language="F#" Value="type EventLog = class&#xA;    inherit Component&#xA;    interface ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.1.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.EventLogInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Diagnostics.MonitoringDescription("EventLogDesc")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="92a74-101">Обеспечивает взаимодействие с журналами событий Windows.</span><span class="sxs-lookup"><span data-stu-id="92a74-101">Provides interaction with Windows event logs.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-102"><xref:System.Diagnostics.EventLog> позволяет получать доступ к журналам событий Windows и настраивать их, а также записывать сведения о важных событиях программного обеспечения или оборудования.</span><span class="sxs-lookup"><span data-stu-id="92a74-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="92a74-103">С помощью <xref:System.Diagnostics.EventLog>можно выполнять чтение из существующих журналов, записывать записи в журналы, создавать или удалять источники событий, удалять журналы и отвечать на записи журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="92a74-104">При создании источника событий можно также создать новые журналы.</span><span class="sxs-lookup"><span data-stu-id="92a74-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="92a74-105">Этот тип реализует интерфейс <xref:System.IDisposable>.</span><span class="sxs-lookup"><span data-stu-id="92a74-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="92a74-106">По окончании использования выдаленную ему память следует прямо или косвенно освободить.</span><span class="sxs-lookup"><span data-stu-id="92a74-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="92a74-107">Чтобы сделать это прямо, вызовите его метод <xref:System.IDisposable.Dispose%2A> в блоке `try`/`catch`.</span><span class="sxs-lookup"><span data-stu-id="92a74-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="92a74-108">Чтобы сделать это косвенно, используйте языковые конструкции, такие как `using` (в C#) или `Using` (в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="92a74-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="92a74-109">Дополнительные сведения см. в разделе "Использование объекта, реализующего IDisposable" в статье об интерфейсе <xref:System.IDisposable>.</span><span class="sxs-lookup"><span data-stu-id="92a74-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="92a74-110">Кроме предоставления доступа к отдельным журналам событий и их записям, класс <xref:System.Diagnostics.EventLog> позволяет получить доступ к коллекции всех журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="92a74-111">`static` члены <xref:System.Diagnostics.EventLog> можно использовать для удаления журналов, получения списков журналов, создания или удаления источника или определения того, содержит ли компьютер определенный источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="92a74-112">Существует три журнала событий по умолчанию: Приложение, система и безопасность.</span><span class="sxs-lookup"><span data-stu-id="92a74-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="92a74-113">Журнал безопасности доступен только для чтения.</span><span class="sxs-lookup"><span data-stu-id="92a74-113">A Security log is read-only.</span></span> <span data-ttu-id="92a74-114">Другие приложения и службы, которые вы устанавливаете, например Active Directory, могут иметь дополнительные журналы событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="92a74-115">При использовании класса <xref:System.Diagnostics.EventLog> необходимо учитывать вопросы безопасности.</span><span class="sxs-lookup"><span data-stu-id="92a74-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="92a74-116">для <xref:System.Diagnostics.EventLog> требуются разрешения <xref:System.Diagnostics.EventLogPermission> для определенных действий в .NET Framework 2,0 и более поздних версий или полное доверие в .NET Framework 1,0 и 1,1.</span><span class="sxs-lookup"><span data-stu-id="92a74-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="92a74-117">Рекомендуется <xref:System.Diagnostics.EventLogPermission> не предоставляться частично доверенному коду.</span><span class="sxs-lookup"><span data-stu-id="92a74-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="92a74-118">Никогда не следует передавать объекты журнала событий, в том числе <xref:System.Diagnostics.EventLogEntryCollection> и <xref:System.Diagnostics.EventLogEntry>, в менее надежный код.</span><span class="sxs-lookup"><span data-stu-id="92a74-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="92a74-119">Например, создание объекта <xref:System.Diagnostics.EventLog>, запись, а затем передача объекта <xref:System.Diagnostics.EventLog> в частично доверенный код может создать ошибку безопасности, так как возможность чтения и записи в журнал событий позволяет коду выполнять такие действия, как выдача журнала событий. сообщения в имени другого приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="92a74-120">Начиная с Windows Vista, Управление учетными записями пользователей (UAC) определяет учетные данные пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="92a74-121">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-122">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-123">Чтобы выполнить код, обращающийся к журналу безопасности, необходимо сначала повысить свои учетные данные от обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="92a74-124">Это можно сделать при запуске приложения, открыв контекстное меню для приложения (если вы используете мышь, щелкните правой кнопкой мыши значок приложения) и укажите, что требуется запустить от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="92a74-125"><xref:System.Diagnostics.EventLog> можно использовать для создания пользовательских журналов событий, которые можно просмотреть с помощью Просмотр событий сервера.</span><span class="sxs-lookup"><span data-stu-id="92a74-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="92a74-126">Используйте метод <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>, чтобы отобразить локализованное имя для журнала событий в Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="92a74-127">Используйте метод <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>, чтобы настроить поведение журнала событий при достижении максимального размера журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="92a74-128">Для чтения из журнала событий укажите имя журнала (<xref:System.Diagnostics.EventLog.Log%2A> свойство) и имя компьютера сервера (<xref:System.Diagnostics.EventLog.MachineName%2A> свойство для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="92a74-129">Если не указать имя компьютера сервера, предполагается, что используется локальный компьютер ".".</span><span class="sxs-lookup"><span data-stu-id="92a74-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="92a74-130">Нет необходимости указывать источник события (свойство<xref:System.Diagnostics.EventLog.Source%2A>), поскольку источник необходим только для записи в журналы.</span><span class="sxs-lookup"><span data-stu-id="92a74-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="92a74-131">Свойство <xref:System.Diagnostics.EventLog.Entries%2A> автоматически заполняется списком записей журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="92a74-132">Для записи в журнал событий укажите или создайте источник события (<xref:System.Diagnostics.EventLog.Source%2A> свойство).</span><span class="sxs-lookup"><span data-stu-id="92a74-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="92a74-133">Для создания нового источника событий необходимо иметь учетные данные администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="92a74-134">Источник событий регистрирует приложение в журнале событий в качестве допустимого источника записей.</span><span class="sxs-lookup"><span data-stu-id="92a74-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="92a74-135">Можно использовать источник событий для записи только в один журнал за раз.</span><span class="sxs-lookup"><span data-stu-id="92a74-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="92a74-136">Свойство <xref:System.Diagnostics.EventLog.Source%2A> может быть любой случайной строкой, но имя должно отличаться от других источников на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="92a74-137">Источником события обычно является имя приложения или другая идентифицирующая строка.</span><span class="sxs-lookup"><span data-stu-id="92a74-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="92a74-138">При попытке создать повторяющееся <xref:System.Diagnostics.EventLog.Source%2A> значение возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="92a74-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="92a74-139">Однако один журнал событий может быть связан с несколькими источниками.</span><span class="sxs-lookup"><span data-stu-id="92a74-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="92a74-140">Если источник событий для журнала событий, связанного с экземпляром <xref:System.Diagnostics.EventLog>, не существует, создается новый источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="92a74-141">Чтобы создать источник событий в Windows Vista и более поздних версиях или Windows Server 2003, необходимо иметь учетные данные администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="92a74-142">Это требование связано с тем, что необходимо выполнить поиск всех журналов событий, включая журналы безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-143">Начиная с Windows Vista, пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="92a74-144">Для создания или удаления источника события требуется синхронизация базового кода с помощью именованного мьютекса.</span><span class="sxs-lookup"><span data-stu-id="92a74-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="92a74-145">Если приложение с высоким уровнем привилегий блокирует именованный мьютекс, попытка создать или удалить источник события приведет к тому, что приложение перестанет отвечать, пока блокировка не будет снята.</span><span class="sxs-lookup"><span data-stu-id="92a74-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="92a74-146">Чтобы предотвратить возникновение этой проблемы, никогда не предоставляйте <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> разрешение на ненадежный код.</span><span class="sxs-lookup"><span data-stu-id="92a74-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="92a74-147">Кроме того, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> разрешение потенциально позволяет обходить другие разрешения и предоставлять только строго доверенному коду.</span><span class="sxs-lookup"><span data-stu-id="92a74-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="92a74-148">Приложения и службы должны выполнять запись в журнал приложений или в пользовательский журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="92a74-149">Драйверы устройств должны записывать в системный журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="92a74-150">Если не задать явно свойство <xref:System.Diagnostics.EventLog.Log%2A>, по умолчанию в журнале событий будет указан журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-151">Нет ничего защищать приложение от записи в качестве зарегистрированного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="92a74-152">Если приложению предоставлено разрешение <xref:System.Diagnostics.EventLogPermissionAccess.Write>, оно может записывать события для любого допустимого источника, зарегистрированного на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="92a74-153">Используйте методы <xref:System.Diagnostics.EventLog.WriteEvent%2A> и <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="92a74-154">Для записи событий необходимо указать источник события. перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-155">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-156">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-157">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-158">Новый источник можно настроить с помощью объекта <xref:System.Diagnostics.EventLogInstaller> или метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-159">Для создания нового источника событий необходимо иметь учетные данные администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-160">Каждый источник может записывать только один журнал событий; Однако приложение может использовать несколько источников для записи в несколько журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="92a74-161">Например, приложению может потребоваться несколько источников, настроенных для различных журналов событий или разных файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="92a74-162">Чтобы изменить сведения о конфигурации существующего источника, необходимо удалить источник, а затем создать его с новой конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="92a74-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="92a74-163">Если другие приложения или компоненты используют существующий источник, создайте новый источник с обновленной конфигурацией вместо удаления существующего источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="92a74-164">Вы можете зарегистрировать источник событий в локализованных ресурсах для категории событий и строк сообщений.</span><span class="sxs-lookup"><span data-stu-id="92a74-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="92a74-165">Приложение может записывать записи журнала событий с помощью идентификаторов ресурсов вместо указания фактических строковых значений.</span><span class="sxs-lookup"><span data-stu-id="92a74-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="92a74-166">Дополнительные сведения о настройке источника с помощью файлов ресурсов см. в разделе классы <xref:System.Diagnostics.EventLogInstaller> и <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="92a74-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="92a74-167">Если приложение записывает строковые значения непосредственно в журнал событий, не нужно задавать свойства файла ресурсов для источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="92a74-168">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-169">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-170">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-171">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="92a74-172">При записи событий необходимо по крайней мере указать либо строку сообщения, либо идентификатор ресурса для строки сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="92a74-173">Другие свойства событий являются необязательными.</span><span class="sxs-lookup"><span data-stu-id="92a74-173">Other event properties are optional.</span></span> <span data-ttu-id="92a74-174">Примеры необязательных параметров событий включают следующее.</span><span class="sxs-lookup"><span data-stu-id="92a74-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="92a74-175">Можно задать <xref:System.Diagnostics.EventLogEntryType>, чтобы указать значок, отображаемый для записи в Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="92a74-176">Можно указать идентификатор категории для события, если приложение использует категории для фильтрации событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="92a74-177">Если требуется связать дополнительные сведения с заданным событием, можно присоединить двоичные данные к записи события.</span><span class="sxs-lookup"><span data-stu-id="92a74-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="92a74-178">Ведение журнала событий потребляет место на диске, процессорное время и другие системные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="92a74-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="92a74-179">Важно регистрировать только важную информацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-179">It is important to log only essential information.</span></span> <span data-ttu-id="92a74-180">Рекомендуется размещать вызовы журнала событий в пути ошибки, а не в основном коде кода, чтобы они не влияли на производительность.</span><span class="sxs-lookup"><span data-stu-id="92a74-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="92a74-181">Список начальных значений свойств для экземпляра <xref:System.Diagnostics.EventLog> см. в разделе Конструктор <xref:System.Diagnostics.EventLog.%23ctor%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-182">В следующем примере создается источник события `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-183">Начиная с Windows Vista, это приложение необходимо запускать от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-184">Инициализирует новый экземпляр класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-185">Инициализирует новый экземпляр класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="92a74-186">Не связывает экземпляр с каким-либо журналом.</span><span class="sxs-lookup"><span data-stu-id="92a74-186">Does not associate the instance with any log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-187">Перед вызовом <xref:System.Diagnostics.EventLog.WriteEntry%2A>укажите свойство <xref:System.Diagnostics.EventLog.Source%2A> экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="92a74-188">При чтении <xref:System.Diagnostics.EventLog.Entries%2A> из журнала можно также указать только свойства <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-189">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-190">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="92a74-191">Свойство.</span><span class="sxs-lookup"><span data-stu-id="92a74-191">Property</span></span>|<span data-ttu-id="92a74-192">Начальное значение</span><span class="sxs-lookup"><span data-stu-id="92a74-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="92a74-193">Пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="92a74-194">Пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="92a74-195">Локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="92a74-196">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-197">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-197">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-198">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog logName" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-199">Имя журнала на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-199">The name of the log on the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-200">Инициализирует новый экземпляр класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="92a74-201">Связывает экземпляр с журналом на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-201">Associates the instance with a log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-202">Эта перегрузка задает для свойства <xref:System.Diagnostics.EventLog.Log%2A> значение параметра `logName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="92a74-203">Перед вызовом <xref:System.Diagnostics.EventLog.WriteEntry%2A>укажите свойство <xref:System.Diagnostics.EventLog.Source%2A> экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="92a74-204">При чтении <xref:System.Diagnostics.EventLog.Entries%2A> из журнала можно также указать только свойства <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-205">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="92a74-206">Эта перегрузка конструктора задает свойство <xref:System.Diagnostics.EventLog.Log%2A>, но его можно изменить перед чтением свойства <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="92a74-207">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A>, уникален из других источников на компьютере, последующий вызов <xref:System.Diagnostics.EventLog.WriteEntry%2A> создает журнал с указанным именем, если он еще не существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="92a74-208">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="92a74-209">Свойство.</span><span class="sxs-lookup"><span data-stu-id="92a74-209">Property</span></span>|<span data-ttu-id="92a74-210">Начальное значение</span><span class="sxs-lookup"><span data-stu-id="92a74-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="92a74-211">Пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="92a74-212">Параметр `logName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="92a74-213">Локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="92a74-214">Следующий пример считывает записи в журнале событий myNewLog на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-215">Имя журнала <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-215">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-216">Недопустимое имя журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-216">The log name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-217">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-217">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-218">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-219">Имя журнала на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-219">The name of the log on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-220">Компьютер, на котором существует журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-220">The computer on which the log exists.</span></span></param>
        <summary><span data-ttu-id="92a74-221">Инициализирует новый экземпляр класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="92a74-222">Связывает экземпляр с журналом на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-222">Associates the instance with a log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-223">Эта перегрузка устанавливает свойство <xref:System.Diagnostics.EventLog.Log%2A> в параметр `logName`, а свойство <xref:System.Diagnostics.EventLog.MachineName%2A> — в параметр `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="92a74-224">Перед вызовом <xref:System.Diagnostics.EventLog.WriteEntry%2A>укажите свойство <xref:System.Diagnostics.EventLog.Source%2A> <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="92a74-225">При чтении <xref:System.Diagnostics.EventLog.Entries%2A> из журнала можно также указать только свойства <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-226">Эта перегрузка конструктора задает свойства <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>, но вы можете изменить их перед чтением свойства <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="92a74-227">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="92a74-228">Свойство.</span><span class="sxs-lookup"><span data-stu-id="92a74-228">Property</span></span>|<span data-ttu-id="92a74-229">Начальное значение</span><span class="sxs-lookup"><span data-stu-id="92a74-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="92a74-230">Пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="92a74-231">Параметр `logName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="92a74-232">Параметр `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="92a74-233">Следующий пример считывает записи в журнале событий myNewLog на компьютере myServer.</span><span class="sxs-lookup"><span data-stu-id="92a74-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-234">Имя журнала <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-234">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-235">Недопустимое имя журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-235">The log name is invalid.</span></span>  
  
 <span data-ttu-id="92a74-236">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-236">-or-</span></span>  
  
 <span data-ttu-id="92a74-237">Недопустимое имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-237">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-238">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-238">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-239">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-239">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName, source)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-240">Имя журнала на указанном компьютере</span><span class="sxs-lookup"><span data-stu-id="92a74-240">The name of the log on the specified computer</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-241">Компьютер, на котором существует журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-241">The computer on which the log exists.</span></span></param>
        <param name="source"><span data-ttu-id="92a74-242">Источник записей журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-242">The source of event log entries.</span></span></param>
        <summary><span data-ttu-id="92a74-243">Инициализирует новый экземпляр класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-243">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="92a74-244">Связывает экземпляр с журналом на указанном компьютере и создает или присваивает заданный источник классу <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-244">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-245">Этот конструктор задает для свойства <xref:System.Diagnostics.EventLog.Log%2A> параметр `logName`, свойство <xref:System.Diagnostics.EventLog.MachineName%2A> к параметру `machineName`, а свойство <xref:System.Diagnostics.EventLog.Source%2A> — параметру `source`.</span><span class="sxs-lookup"><span data-stu-id="92a74-245">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="92a74-246">Свойство <xref:System.Diagnostics.EventLog.Source%2A> является обязательным при записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-246">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="92a74-247">Однако при чтении только из журнала событий требуются только свойства <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A> (при условии, что журнал событий на сервере уже связан с источником).</span><span class="sxs-lookup"><span data-stu-id="92a74-247">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="92a74-248">Если выполняется только чтение из журнала событий, может быть достаточно другой перегрузки конструктора.</span><span class="sxs-lookup"><span data-stu-id="92a74-248">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="92a74-249">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-249">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="92a74-250">Свойство.</span><span class="sxs-lookup"><span data-stu-id="92a74-250">Property</span></span>|<span data-ttu-id="92a74-251">Начальное значение</span><span class="sxs-lookup"><span data-stu-id="92a74-251">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="92a74-252">Параметр `source`.</span><span class="sxs-lookup"><span data-stu-id="92a74-252">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="92a74-253">Параметр `logName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-253">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="92a74-254">Параметр `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-254">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="92a74-255">В следующем примере запись в журнал событий MyNewLog на локальном компьютере записывается с использованием источника MySource.</span><span class="sxs-lookup"><span data-stu-id="92a74-255">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-256">Имя журнала <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-256">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-257">Недопустимое имя журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-257">The log name is invalid.</span></span>  
  
 <span data-ttu-id="92a74-258">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-258">-or-</span></span>  
  
 <span data-ttu-id="92a74-259">Недопустимое имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-259">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-260">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-260">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-261">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-261">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberSignature Language="F#" Value="abstract member BeginInit : unit -&gt; unit&#xA;override this.BeginInit : unit -&gt; unit" Usage="eventLog.BeginInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-262">Начинает инициализацию класса <see cref="T:System.Diagnostics.EventLog" />, используемого в форме или используемого другим компонентом.</span><span class="sxs-lookup"><span data-stu-id="92a74-262">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span></span> <span data-ttu-id="92a74-263">Инициализация происходит во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="92a74-263">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-264">Среда разработки [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] использует этот метод для запуска инициализации компонента, используемого в форме или другим компонентом.</span><span class="sxs-lookup"><span data-stu-id="92a74-264">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="92a74-265">Метод <xref:System.Diagnostics.EventLog.EndInit%2A> завершает инициализацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-265">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="92a74-266">Использование методов <xref:System.Diagnostics.EventLog.BeginInit%2A> и <xref:System.Diagnostics.EventLog.EndInit%2A> предотвращает использование элемента управления до полной инициализации.</span><span class="sxs-lookup"><span data-stu-id="92a74-266">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-267"><see cref="T:System.Diagnostics.EventLog" /> уже инициализирован.</span><span class="sxs-lookup"><span data-stu-id="92a74-267"><see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-268">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-268">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-269">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-269">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberSignature Language="F#" Value="member this.Clear : unit -&gt; unit" Usage="eventLog.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-270">Удаляет все записи из журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-270">Removes all entries from the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-271">Для журналов событий задаются максимальные размеры, определяющие количество записей, которые могут содержаться в них.</span><span class="sxs-lookup"><span data-stu-id="92a74-271">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="92a74-272">Когда журнал событий заполнен, он прекращает запись новых сведений о событиях или начинает перезаписывать предыдущие записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-272">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="92a74-273">Если запись событий прекращается, можно использовать этот метод, чтобы очистить журнал существующих записей и разрешить ему снова начать запись событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-273">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="92a74-274">Для очистки записей журнала событий необходимо иметь разрешения администратора на компьютере, на котором находится журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-274">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="92a74-275"><xref:System.Diagnostics.EventLog.Clear%2A> закрывает журнал событий, освобождает обработчики событий, получает новые дескрипторы чтения и записи и повторно открывает журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-275"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="92a74-276">События, полученные после вызова метода, не удаляются вместе с существующими событиями.</span><span class="sxs-lookup"><span data-stu-id="92a74-276">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-277">В следующем примере очищается журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-277">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="92a74-278">Так как приложение, система, безопасность и другие ненастраиваемые журналы могут содержать важную информацию; перед выполнением этого примера кода обязательно укажите пользовательский журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-278">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="92a74-279">В этом примере удаляется настраиваемый `myNewLog`журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-279">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-280">Создание журнала событий не было завершено успешно.</span><span class="sxs-lookup"><span data-stu-id="92a74-280">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="92a74-281">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-281">-or-</span></span>  
  
 <span data-ttu-id="92a74-282">Невозможно открыть журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-282">The log cannot be opened.</span></span> <span data-ttu-id="92a74-283">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-283">A Windows error code is not available.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-284">Для свойства <see cref="P:System.Diagnostics.EventLog.Log" /> не указано значение.</span><span class="sxs-lookup"><span data-stu-id="92a74-284">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span></span> <span data-ttu-id="92a74-285">Убедитесь, что имя журнала — не пустая строка.</span><span class="sxs-lookup"><span data-stu-id="92a74-285">Make sure the log name is not an empty string.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-286">Журнал не существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-286">The log does not exist.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-287">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-287">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-288">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-288">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="eventLog.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-289">Закрывает журнал событий и удаляет дескрипторы чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-289">Closes the event log and releases read and write handles.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-290">Метод <xref:System.Diagnostics.EventLog.Close%2A> вызывается методом защищенного <xref:System.ComponentModel.Component.Dispose%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-290">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="92a74-291">Не нужно вызывать <xref:System.Diagnostics.EventLog.Close%2A> перед вызовом <xref:System.ComponentModel.Component.Dispose%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-291">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-292">Дескриптор чтения или записи события не был успешно удален.</span><span class="sxs-lookup"><span data-stu-id="92a74-292">The event log's read handle or write handle was not released successfully.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-293">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-293">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-294">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-294">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-295">Задает приложение как источник записей для определенного журнала событий в системе.</span><span class="sxs-lookup"><span data-stu-id="92a74-295">Establishes an application as able to write event information to a particular log on the system.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : System.Diagnostics.EventSourceCreationData -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource sourceData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="sourceData"><span data-ttu-id="92a74-296">Свойства конфигурации для источника событий и его целевого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-296">The configuration properties for the event source and its target event log.</span></span></param>
        <summary><span data-ttu-id="92a74-297">Задает допустимый источник событий для записи локализованных сообщений о событиях, используя указанные свойства конфигурации источника событий и соответствующий журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-297">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-298">Используйте эту перегрузку для настройки нового источника для записи записей в журнал событий на локальном или удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-298">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="92a74-299">Нет необходимости использовать этот метод для чтения из журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-299">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="92a74-300">Метод <xref:System.Diagnostics.EventLog.CreateEventSource%2A> использует свойства input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> и <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> для создания значений реестра на целевом компьютере для нового источника и связанного с ним журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-300">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="92a74-301">Новое имя источника не может совпадать с именем существующего источника или существующим именем журнала событий на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-301">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="92a74-302">Если свойство <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> не задано, источник регистрируется для журнала событий приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-302">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="92a74-303">Если <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> не задан, источник регистрируется на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-303">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-304">Чтобы создать источник событий в Windows Vista и более поздних версиях или Windows Server 2003, необходимо иметь права администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-304">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="92a74-305">Причина этого требования заключается в том, что необходимо выполнить поиск всех журналов событий, включая систему безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-305">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-306">Начиная с Windows Vista, пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-306">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="92a74-307">Начиная с Windows Vista, привилегии пользователя определяются контролем учетных записей (UAC).</span><span class="sxs-lookup"><span data-stu-id="92a74-307">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-308">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-308">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-309">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-309">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-310">Чтобы выполнить код, обращающийся к журналу безопасности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-310">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-311">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-311">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="92a74-312">Используйте <xref:System.Diagnostics.EventLog.WriteEvent%2A> и <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="92a74-313">Для записи событий необходимо указать источник события. перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-313">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-314">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-314">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-315">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-315">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-316">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-316">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-317">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-317">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-318">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-318">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-319">Можно создать источник событий для существующего журнала событий или нового журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-319">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="92a74-320">При создании нового источника для нового журнала событий система регистрирует источник для этого журнала, но журнал не создается, пока в него не будет записана первая запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-320">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="92a74-321">Журналы событий сохраняются операционной системой как файлы.</span><span class="sxs-lookup"><span data-stu-id="92a74-321">The operating system stores event logs as files.</span></span> <span data-ttu-id="92a74-322">При использовании <xref:System.Diagnostics.EventLogInstaller> или <xref:System.Diagnostics.EventLog.CreateEventSource%2A> для создания нового журнала событий связанный файл сохраняется в каталоге%SystemRoot%\System32\Config на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-322">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="92a74-323">Имя файла задается путем добавления первых 8 символов свойства <xref:System.Diagnostics.EventLog.Log%2A> к расширению имени файла ". evt".</span><span class="sxs-lookup"><span data-stu-id="92a74-323">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="92a74-324">Каждый источник может одновременно записывать только в один журнал событий. Однако приложение может использовать несколько источников для записи в несколько журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-324">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="92a74-325">Например, приложению может потребоваться несколько источников, настроенных для различных журналов событий или разных файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-325">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="92a74-326">Вы можете зарегистрировать источник событий с локализованными файлами ресурсов для категорий событий и строк сообщений.</span><span class="sxs-lookup"><span data-stu-id="92a74-326">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="92a74-327">Приложение может записывать записи журнала событий с помощью идентификаторов ресурсов вместо того, чтобы указывать фактическую строку.</span><span class="sxs-lookup"><span data-stu-id="92a74-327">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="92a74-328">Просмотр событий использует идентификатор ресурса для поиска и вывода соответствующей строки из локализованного файла ресурсов на основе текущих языковых параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-328">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="92a74-329">Можно зарегистрировать отдельный файл для категорий событий, сообщений и строк вставки параметров, либо зарегистрировать один и тот же файл ресурсов для всех трех типов строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-329">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="92a74-330">Используйте свойства <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>и <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>, чтобы настроить источник для записи локализованных записей в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-330">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="92a74-331">Если приложение записывает значения строк непосредственно в журнал событий, задавать эти свойства не нужно.</span><span class="sxs-lookup"><span data-stu-id="92a74-331">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="92a74-332">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-332">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-333">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-333">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-334">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-334">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-335">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-335">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="92a74-336">Чтобы изменить сведения о конфигурации существующего источника, необходимо удалить источник, а затем создать его с новой конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="92a74-336">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="92a74-337">Если другие приложения или компоненты используют существующий источник, создайте новый источник с обновленной конфигурацией, а не удалите существующий источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-337">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-338">Если источник настроен для журнала событий и вы переконфигурируете его для другого журнала событий, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-338">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-339">В следующем примере определяется, зарегистрирован ли источник событий с именем `SampleApplicationSource` на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-339">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="92a74-340">Если источник событий не существует, в примере задается файл ресурса сообщения для источника и создается новый источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-340">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="92a74-341">Наконец, в примере задается локализованное отображаемое имя для журнала событий с использованием значения идентификатора ресурса в `DisplayNameMsgId` и пути к файлу ресурса в `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="92a74-341">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="92a74-342">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-342">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-343">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-343">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-344">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-344">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="92a74-345">В частности, идентификатор ресурса 5001 определен для локализованного имени журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-345">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-346">Имя компьютера, заданное в <paramref name="sourceData" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="92a74-346">The computer name specified in <paramref name="sourceData" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-347">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-347">-or-</span></span> 
<span data-ttu-id="92a74-348">Имя источника, указанное в параметре <paramref name="sourceData" />, равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-348">The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-349">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-349">-or-</span></span> 
<span data-ttu-id="92a74-350">Имя журнала, заданное в <paramref name="sourceData" /> недопустимо.</span><span class="sxs-lookup"><span data-stu-id="92a74-350">The log name specified in <paramref name="sourceData" /> is not valid.</span></span> <span data-ttu-id="92a74-351">Имена журналов событий должны содержать печатные символы и не должны содержать символы "\*", "?" или "\\".</span><span class="sxs-lookup"><span data-stu-id="92a74-351">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="92a74-352">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-352">-or-</span></span> 
<span data-ttu-id="92a74-353">Имя журнала, заданное в <paramref name="sourceData" />, недопустимо для создания пользовательского журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-353">The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span></span> <span data-ttu-id="92a74-354">Имена AppEvent, SysEvent и SecEvent зарезервированы для системного использования.</span><span class="sxs-lookup"><span data-stu-id="92a74-354">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="92a74-355">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-355">-or-</span></span> 
<span data-ttu-id="92a74-356">Имя журнала совпадает с существующим именем источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-356">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="92a74-357">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-357">-or-</span></span> 
<span data-ttu-id="92a74-358">При таком имени источника, заданном в <paramref name="sourceData" />, длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-358">The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="92a74-359">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-359">-or-</span></span> 
<span data-ttu-id="92a74-360">Первые 8 символов имени журнала, заданные в <paramref name="sourceData" />, не уникальны.</span><span class="sxs-lookup"><span data-stu-id="92a74-360">The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span></span>  
  
<span data-ttu-id="92a74-361">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-361">-or-</span></span> 
<span data-ttu-id="92a74-362">Имя источника, заданное в <paramref name="sourceData" />, уже зарегистрировано.</span><span class="sxs-lookup"><span data-stu-id="92a74-362">The source name specified in <paramref name="sourceData" /> is already registered.</span></span>  
  
<span data-ttu-id="92a74-363">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-363">-or-</span></span> 
<span data-ttu-id="92a74-364">Имя источника, заданное в <paramref name="sourceData" />, совпадает с существующим именем журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-364">The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-365">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-365">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-366"><paramref name="sourceData" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-366"><paramref name="sourceData" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-367">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-367">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-368">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-368">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-369">Имя источника, по которому приложение регистрируется на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-369">The source name by which the application is registered on the local computer.</span></span></param>
        <param name="logName"><span data-ttu-id="92a74-370">Имя журнала, в который вносятся записи о событиях источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-370">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="92a74-371">Допустимые значения: Application, System или имя пользовательского журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-371">Possible values include Application, System, or a custom event log.</span></span></param>
        <summary><span data-ttu-id="92a74-372">Задает указанное имя источника в качестве допустимого источника событий для внесения записей в журнал на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-372">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span></span> <span data-ttu-id="92a74-373">Используя этот метод, можно также создать новый пользовательский журнал на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-373">This method can also create a new custom log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-374">Используйте эту перегрузку для создания пользовательского журнала или для создания и регистрации <xref:System.Diagnostics.EventLog.Source%2A> существующего журнала на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-374">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="92a74-375">Если `logName` является `null` или пустой строкой ("") при вызове <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, по умолчанию используется журнал приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-375">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="92a74-376">Если журнал не существует на локальном компьютере, система создает пользовательский журнал и регистрирует приложение в качестве <xref:System.Diagnostics.EventLog.Source%2A> для этого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-376">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-377">Чтобы создать источник событий в Windows Vista и более поздних версиях или Windows Server 2003, необходимо иметь права администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-377">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="92a74-378">Причина этого требования заключается в том, что необходимо выполнить поиск всех журналов событий, включая систему безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-378">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-379">Начиная с Windows Vista, пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-379">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="92a74-380">В Windows Vista и более поздних версиях права доступа пользователя определяются контролем учетных записей.</span><span class="sxs-lookup"><span data-stu-id="92a74-380">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-381">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-381">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-382">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-382">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-383">Чтобы выполнить код, обращающийся к журналу безопасности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-383">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-384">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-384">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="92a74-385">При записи в журнал событий необходимо создать только источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-385">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="92a74-386">Перед записью записи в журнал событий необходимо зарегистрировать источник событий в журнале событий в качестве допустимого источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-386">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="92a74-387">При написании записи журнала система использует <xref:System.Diagnostics.EventLog.Source%2A> для поиска соответствующего журнала, в котором будет размещена запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-387">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="92a74-388">При чтении журнала событий можно указать либо <xref:System.Diagnostics.EventLog.Source%2A>, либо <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-388">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-389">Не требуется указывать <xref:System.Diagnostics.EventLog.MachineName%2A> при подключении к журналу на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-389">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="92a74-390">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> при чтении из журнала, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-390">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-391">Используйте <xref:System.Diagnostics.EventLog.WriteEvent%2A> и <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="92a74-392">Для записи событий необходимо указать источник события. перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-392">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-393">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-393">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-394">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-394">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-395">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-395">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-396">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-396">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-397">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-397">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-398">Можно создать источник событий для существующего журнала событий или нового журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-398">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="92a74-399">При создании нового источника для нового журнала событий система регистрирует источник для этого журнала, но журнал не создается, пока в него не будет записана первая запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-399">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="92a74-400">Журналы событий сохраняются операционной системой как файлы.</span><span class="sxs-lookup"><span data-stu-id="92a74-400">The operating system stores event logs as files.</span></span> <span data-ttu-id="92a74-401">При использовании <xref:System.Diagnostics.EventLogInstaller> или <xref:System.Diagnostics.EventLog.CreateEventSource%2A> для создания нового журнала событий связанный файл сохраняется в каталоге%SystemRoot%\System32\Config на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-401">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="92a74-402">Имя файла задается путем добавления первых 8 символов свойства <xref:System.Diagnostics.EventLog.Log%2A> к расширению имени файла ". evt".</span><span class="sxs-lookup"><span data-stu-id="92a74-402">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="92a74-403">Источник должен быть уникальным на локальном компьютере; новое имя источника не может совпадать с существующим именем источника или именем существующего журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-403">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="92a74-404">Каждый источник может записывать только один журнал событий; Однако приложение может использовать несколько источников для записи в несколько журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-404">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="92a74-405">Например, приложению может потребоваться несколько источников, настроенных для различных журналов событий или разных файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-405">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="92a74-406">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-406">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-407">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-407">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-408">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-408">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-409">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-409">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="92a74-410">Чтобы изменить сведения о конфигурации существующего источника, необходимо удалить источник, а затем создать его с новой конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="92a74-410">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="92a74-411">Если другие приложения или компоненты используют существующий источник, создайте новый источник с обновленной конфигурацией, а не удалите существующий источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-411">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-412">Если источник уже сопоставлен с журналом и вы переменяете его в новый журнал, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-412">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-413">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-413">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-414"><paramref name="source" /> является пустой строкой ("") или <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-414"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-415">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-415">-or-</span></span> 
 <span data-ttu-id="92a74-416"><paramref name="logName" /> не является допустимым именем журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-416"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="92a74-417">Имена журналов событий должны содержать печатные символы и не должны содержать символы "\*", "?" или "\\".</span><span class="sxs-lookup"><span data-stu-id="92a74-417">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="92a74-418">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-418">-or-</span></span> 
 <span data-ttu-id="92a74-419">Значение <paramref name="logName" /> недопустимо для создания журнала пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-419"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="92a74-420">Имена AppEvent, SysEvent и SecEvent зарезервированы для системного использования.</span><span class="sxs-lookup"><span data-stu-id="92a74-420">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="92a74-421">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-421">-or-</span></span> 
<span data-ttu-id="92a74-422">Имя журнала совпадает с существующим именем источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-422">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="92a74-423">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-423">-or-</span></span> 
<span data-ttu-id="92a74-424">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-424">The source name results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="92a74-425">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-425">-or-</span></span> 
<span data-ttu-id="92a74-426">Первые 8 символов <paramref name="logName" /> совпадают с первыми 8 символами имени существующего журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-426">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span></span>  
  
<span data-ttu-id="92a74-427">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-427">-or-</span></span> 
<span data-ttu-id="92a74-428">Невозможно зарегистрировать источник, поскольку он уже существует на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-428">The source cannot be registered because it already exists on the local computer.</span></span>  
  
<span data-ttu-id="92a74-429">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-429">-or-</span></span> 
<span data-ttu-id="92a74-430">Имя источника совпадает с существующим именем журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-430">The source name matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-431">Раздел реестра для журнала событий не может быть открыт на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-431">The registry key for the event log could not be opened on the local computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-432">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-432">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-433">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-433">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.Obsolete("This method has been deprecated.  Please use System.Diagnostics.EventLog.CreateEventSource(EventSourceCreationData sourceData) instead.  https://go.microsoft.com/fwlink/?linkid=14202")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="dotnet-plat-ext-3.0;netcore-3.0">
          <AttributeName>System.Obsolete("This method has been deprecated.  Please use System.Diagnostics.EventLog.CreateEventSource(EventSourceCreationData sourceData) instead.  https://go.microsoft.com/fwlink/?linkid=14202")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-434">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-434">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="logName"><span data-ttu-id="92a74-435">Имя журнала, в который вносятся записи о событиях источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-435">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="92a74-436">Допустимые значения: Application, System или имя пользовательского журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-436">Possible values include Application, System, or a custom event log.</span></span> <span data-ttu-id="92a74-437">Если значение не указано, то параметр <paramref name="logName" /> по умолчанию имеет значение Application.</span><span class="sxs-lookup"><span data-stu-id="92a74-437">If you do not specify a value, <paramref name="logName" /> defaults to Application.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-438">Имя компьютера, на котором регистрируется источник событий, или значение ".", если используется локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-438">The name of the computer to register this event source with, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-439">Устанавливает заданное имяисточника в качестве допустимого источника событий для внесения записей в журнал на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-439">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span></span> <span data-ttu-id="92a74-440">Этот метод можно также использовать для создания нового пользовательского журнала на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-440">This method can also be used to create a new custom log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-441">Используйте эту перегрузку для создания пользовательского журнала или для создания и регистрации <xref:System.Diagnostics.EventLog.Source%2A> существующего журнала на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-441">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="92a74-442">Если `logName` является `null` или пустой строкой ("") при вызове <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, по умолчанию используется журнал приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-442">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="92a74-443">Если журнал не существует на указанном компьютере, система создает пользовательский журнал и регистрирует приложение в качестве <xref:System.Diagnostics.EventLog.Source%2A> для этого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-443">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="92a74-444">При записи в журнал событий необходимо создать только источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-444">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="92a74-445">Перед записью записи в журнал событий необходимо зарегистрировать источник событий в журнале событий в качестве допустимого источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-445">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="92a74-446">При написании записи журнала система использует <xref:System.Diagnostics.EventLog.Source%2A> для поиска соответствующего журнала, в котором будет размещена запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-446">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="92a74-447">При чтении журнала событий можно указать либо <xref:System.Diagnostics.EventLog.Source%2A>, либо <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-447">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-448">Чтобы создать источник событий в Windows Vista и более поздних версиях или Windows Server 2003, необходимо иметь права администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-448">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="92a74-449">Причина этого требования заключается в том, что необходимо выполнить поиск всех журналов событий, включая систему безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-449">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-450">В Windows Vista и более поздних версиях пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-450">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="92a74-451">В Windows Vista и более поздних версиях права доступа пользователя определяются контролем учетных записей.</span><span class="sxs-lookup"><span data-stu-id="92a74-451">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-452">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-452">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-453">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-453">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-454">Чтобы выполнить код, обращающийся к журналу безопасности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-454">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-455">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-455">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="92a74-456">Используйте <xref:System.Diagnostics.EventLog.WriteEvent%2A> и <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="92a74-457">Для записи событий необходимо указать источник события. перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-457">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-458">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-458">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-459">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-459">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-460">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-460">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-461">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-461">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-462">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-462">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-463">Можно создать источник событий для существующего журнала событий или нового журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-463">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="92a74-464">При создании нового источника для нового журнала событий система регистрирует источник для этого журнала, но журнал не создается, пока в него не будет записана первая запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-464">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="92a74-465">Журналы событий сохраняются операционной системой как файлы.</span><span class="sxs-lookup"><span data-stu-id="92a74-465">The operating system stores event logs as files.</span></span> <span data-ttu-id="92a74-466">При использовании <xref:System.Diagnostics.EventLogInstaller> или <xref:System.Diagnostics.EventLog.CreateEventSource%2A> для создания нового журнала событий связанный файл сохраняется в каталоге%SystemRoot%\System32\Config на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-466">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="92a74-467">Имя файла задается путем добавления первых 8 символов свойства <xref:System.Diagnostics.EventLog.Log%2A> к расширению имени файла ". evt".</span><span class="sxs-lookup"><span data-stu-id="92a74-467">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="92a74-468">Источник должен быть уникальным на локальном компьютере; новое имя источника не может совпадать с существующим именем источника или именем существующего журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-468">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="92a74-469">Каждый источник может записывать только один журнал событий; Однако приложение может использовать несколько источников для записи в несколько журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-469">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="92a74-470">Например, приложению может потребоваться несколько источников, настроенных для различных журналов событий или разных файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-470">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="92a74-471">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-471">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-472">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-472">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-473">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-473">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-474">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-474">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="92a74-475">Чтобы изменить сведения о конфигурации существующего источника, необходимо удалить источник, а затем создать его с новой конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="92a74-475">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="92a74-476">Если другие приложения или компоненты используют существующий источник, создайте новый источник с обновленной конфигурацией, а не удалите существующий источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-476">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-477">Если источник уже сопоставлен с журналом и вы переменяете его в новый журнал, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-477">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-478">В следующем примере создается исходный `MySource` на компьютере `MyServer`и записывается запись в `MyNewLog`журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-478">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-479"><paramref name="machineName" /> не является допустимым именем компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-479">The <paramref name="machineName" /> is not a valid computer name.</span></span>  
  
<span data-ttu-id="92a74-480">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-480">-or-</span></span> 
 <span data-ttu-id="92a74-481"><paramref name="source" /> является пустой строкой ("") или <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-481"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-482">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-482">-or-</span></span> 
 <span data-ttu-id="92a74-483"><paramref name="logName" /> не является допустимым именем журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-483"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="92a74-484">Имена журналов событий должны содержать печатные символы и не должны содержать символы "\*", "?" или "\\".</span><span class="sxs-lookup"><span data-stu-id="92a74-484">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="92a74-485">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-485">-or-</span></span> 
 <span data-ttu-id="92a74-486">Значение <paramref name="logName" /> недопустимо для создания журнала пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-486"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="92a74-487">Имена AppEvent, SysEvent и SecEvent зарезервированы для системного использования.</span><span class="sxs-lookup"><span data-stu-id="92a74-487">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="92a74-488">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-488">-or-</span></span> 
<span data-ttu-id="92a74-489">Имя журнала совпадает с существующим именем источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-489">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="92a74-490">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-490">-or-</span></span> 
<span data-ttu-id="92a74-491">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-491">The source name results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="92a74-492">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-492">-or-</span></span> 
<span data-ttu-id="92a74-493">Первые 8 символов <paramref name="logName" /> совпадают с первыми 8 символами имени существующего журнала событий на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-493">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span></span>  
  
<span data-ttu-id="92a74-494">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-494">-or-</span></span> 
<span data-ttu-id="92a74-495">Невозможно зарегистрировать источник, так как он уже существует на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-495">The source cannot be registered because it already exists on the specified computer.</span></span>  
  
<span data-ttu-id="92a74-496">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-496">-or-</span></span> 
<span data-ttu-id="92a74-497">Имя источника совпадает с существующим именем источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-497">The source name matches an existing event source name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-498">Раздел реестра для журнала событий не может быть открыт на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-498">The registry key for the event log could not be opened on the specified computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-499">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-499">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-500">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-500">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-501">Удаляет ресурс журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-501">Removes a log resource.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-502">Имя удаляемого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-502">The name of the log to delete.</span></span> <span data-ttu-id="92a74-503">Возможные значения: Application, Security, System или имя пользовательского журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-503">Possible values include: Application, Security, System, and any custom event logs on the computer.</span></span></param>
        <summary><span data-ttu-id="92a74-504">Удаляет журнал событий с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-504">Removes an event log from the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-505">Используйте этот метод, если журнал, который вы хотите удалить, находится на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-505">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="92a74-506">Вы можете удалить любой журнал на компьютере, если у вас есть соответствующие разрешения в реестре.</span><span class="sxs-lookup"><span data-stu-id="92a74-506">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="92a74-507"><xref:System.Diagnostics.EventLog.Delete%2A> удаляет журнал, указанный `logName`, с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-507"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="92a74-508">Если необходимо удалить только источник, зарегистрированный в журнале, вызовите <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-508">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="92a74-509">Если нужно только удалить записи журнала, вызовите <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-509">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="92a74-510"><xref:System.Diagnostics.EventLog.Delete%2A> и <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> являются методами `static`, поэтому их можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-510"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="92a74-511">Нет необходимости создавать новый экземпляр <xref:System.Diagnostics.EventLog> для вызова любого метода.</span><span class="sxs-lookup"><span data-stu-id="92a74-511">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="92a74-512">Метод <xref:System.Diagnostics.EventLog.Delete%2A> сначала удаляет файл, содержащий содержимое журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-512">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="92a74-513">Затем он обращается к реестру и удаляет все источники событий, зарегистрированные для этого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-513">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="92a74-514">Если вы повторно создаете журнал позже, необходимо снова зарегистрировать источники событий, если они будут повторно использоваться.</span><span class="sxs-lookup"><span data-stu-id="92a74-514">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="92a74-515">Если вы не регистрируете источники событий и другие пользователи выполняют запись в источник событий без указания имени журнала, источник события будет создан в журнале событий приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-515">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="92a74-516">Таким образом, приложения, которые ранее смогли записать записи в удаленный и воссозданный журнал, вместо этого будут записывать данные в журнал приложений, так как теперь он содержит источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-516">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-517">Повторное создание журнала событий может быть сложным процессом.</span><span class="sxs-lookup"><span data-stu-id="92a74-517">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="92a74-518">Не удаляйте созданные системой журналы событий, например журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-518">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="92a74-519">При удалении журнала с помощью вызова <xref:System.Diagnostics.EventLog.Delete%2A> автоматически удаляются источники, зарегистрированные в этом журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-519">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="92a74-520">Это может привести к неработоспособности других приложений, использующих этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-520">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-521">В следующем примере удаляется журнал с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-521">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="92a74-522">В примере определяется журнал из источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-522">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-523">В журнал событий может записываться более одного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-523">More than one source might write to an event log.</span></span> <span data-ttu-id="92a74-524">Перед удалением настраиваемого журнала убедитесь, что другие источники не выполняют запись в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-524">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-525"><paramref name="logName" /> является пустой строкой ("") или <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-525"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-526">Раздел реестра для журнала событий не может быть открыт на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-526">The registry key for the event log could not be opened on the local computer.</span></span>  
  
<span data-ttu-id="92a74-527">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-527">-or-</span></span>
  
 <span data-ttu-id="92a74-528">Журнала на локальном компьютере не существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-528">The log does not exist on the local computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-529">Создание журнала событий не было завершено успешно.</span><span class="sxs-lookup"><span data-stu-id="92a74-529">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="92a74-530">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-530">-or-</span></span>  
  
 <span data-ttu-id="92a74-531">Невозможно открыть журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-531">The log cannot be opened.</span></span> <span data-ttu-id="92a74-532">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-532">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-533">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-533">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-534">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-534">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Delete : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-535">Имя удаляемого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-535">The name of the log to delete.</span></span> <span data-ttu-id="92a74-536">Возможные значения: Application, Security, System или имя пользовательского журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-536">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-537">Имя компьютера, с которого удаляется журнал, или значение ".", если используется локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-537">The name of the computer to delete the log from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-538">Удаляет журнал событий с указанного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-538">Removes an event log from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-539">Используйте этот метод, если журнал, который вы хотите удалить, находится на удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-539">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="92a74-540">Вы можете удалить любой журнал на компьютере, если у вас есть соответствующие разрешения в реестре.</span><span class="sxs-lookup"><span data-stu-id="92a74-540">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="92a74-541"><xref:System.Diagnostics.EventLog.Delete%2A> удаляет журнал, указанный `logName`, с компьютера, указанного в `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-541"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="92a74-542">Если необходимо удалить только источник, зарегистрированный в журнале, вызовите <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-542">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="92a74-543">Если нужно только удалить записи журнала, вызовите <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-543">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="92a74-544"><xref:System.Diagnostics.EventLog.Delete%2A> и <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> являются методами `static`, поэтому их можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-544"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="92a74-545">Нет необходимости создавать экземпляр <xref:System.Diagnostics.EventLog> для вызова любого из методов.</span><span class="sxs-lookup"><span data-stu-id="92a74-545">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="92a74-546">Сначала этот метод удаляет файл, содержащий содержимое журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-546">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="92a74-547">Затем он обращается к реестру и удаляет все источники событий, зарегистрированные для этого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-547">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="92a74-548">Если вы повторно создаете журнал позже, необходимо снова зарегистрировать источники событий, если они будут повторно использоваться.</span><span class="sxs-lookup"><span data-stu-id="92a74-548">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="92a74-549">Если вы не регистрируете источники событий и другие пользователи выполняют запись в источник событий без указания имени журнала, источник события будет создан в журнале событий приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-549">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="92a74-550">Таким образом, приложения, которые ранее смогли записать записи в удаленный и воссозданный журнал, вместо этого будут записывать данные в журнал приложений, так как теперь он содержит источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-550">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-551">Повторное создание журнала событий может быть сложным процессом.</span><span class="sxs-lookup"><span data-stu-id="92a74-551">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="92a74-552">Не удаляйте созданные системой журналы событий, например журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-552">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="92a74-553">При удалении журнала с помощью вызова <xref:System.Diagnostics.EventLog.Delete%2A> автоматически удаляются источники, зарегистрированные в этом журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="92a74-554">Это может привести к неработоспособности других приложений, использующих этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-554">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-555">В следующем примере удаляется журнал с указанного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-555">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="92a74-556">В примере определяется журнал из источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-556">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-557">В журнал событий может записываться более одного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-557">More than one source might write to an event log.</span></span> <span data-ttu-id="92a74-558">Перед удалением настраиваемого журнала убедитесь, что другие источники не выполняют запись в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-558">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-559"><paramref name="logName" /> является пустой строкой ("") или <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-559"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-560">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-560">-or-</span></span> 
 <span data-ttu-id="92a74-561">Параметр <paramref name="machineName" /> не является допустимым именем компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-561"><paramref name="machineName" /> is not a valid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-562">Раздел реестра для журнала событий не может быть открыт на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-562">The registry key for the event log could not be opened on the specified computer.</span></span>  
  
<span data-ttu-id="92a74-563">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-563">-or-</span></span>
  
 <span data-ttu-id="92a74-564">Журнала на указанном компьютере не существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-564">The log does not exist on the specified computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-565">Создание журнала событий не было завершено успешно.</span><span class="sxs-lookup"><span data-stu-id="92a74-565">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="92a74-566">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-566">-or-</span></span>  
  
 <span data-ttu-id="92a74-567">Невозможно открыть журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-567">The log cannot be opened.</span></span> <span data-ttu-id="92a74-568">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-568">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-569">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-569">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-570">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-570">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-571">Удаляет из журнала событий регистрацию источника событий приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-571">Removes an application's event source registration from the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-572">Имя, с которым приложение регистрируется в журнале событий системы.</span><span class="sxs-lookup"><span data-stu-id="92a74-572">The name by which the application is registered in the event log system.</span></span></param>
        <summary><span data-ttu-id="92a74-573">Удаляет регистрацию источника событий из журнала событий на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-573">Removes the event source registration from the event log of the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-574">Используйте этот метод для удаления регистрации <xref:System.Diagnostics.EventLog.Source%2A> с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-574">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="92a74-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> обращается к реестру на локальном компьютере и удаляет регистрацию приложения в качестве допустимого источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="92a74-576">Можно удалить компонент в качестве допустимого источника событий, если он больше не нужен для записи в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-576">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="92a74-577">Например, это можно сделать, если необходимо изменить компонент с одного журнала на другой.</span><span class="sxs-lookup"><span data-stu-id="92a74-577">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="92a74-578">Поскольку источник может быть зарегистрирован только в одном журнале за раз, изменение журнала требует удаления текущей регистрации.</span><span class="sxs-lookup"><span data-stu-id="92a74-578">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="92a74-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> удаляет только источник, зарегистрированный в журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="92a74-580">Если вы хотите удалить сам журнал, вызовите <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-580">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="92a74-581">Если нужно только удалить записи журнала, вызовите <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-581">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="92a74-582"><xref:System.Diagnostics.EventLog.Delete%2A> и <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> являются методами `static`, поэтому их можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-582"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="92a74-583">Нет необходимости создавать экземпляр <xref:System.Diagnostics.EventLog> для вызова любого из методов.</span><span class="sxs-lookup"><span data-stu-id="92a74-583">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="92a74-584">При удалении журнала с помощью вызова <xref:System.Diagnostics.EventLog.Delete%2A> автоматически удаляются источники, зарегистрированные в этом журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-584">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="92a74-585">Это может привести к неработоспособности других приложений, использующих этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-585">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-586">Если источник уже сопоставлен с журналом и вы переменяете его в новый журнал, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-586">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-587">В следующем примере удаляется источник с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-587">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="92a74-588">В примере определяется журнал из источника, а затем удаляется журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-588">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-589">В журнал событий может записываться более одного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-589">More than one source might write to an event log.</span></span> <span data-ttu-id="92a74-590">Перед удалением настраиваемого журнала убедитесь, что другие источники не выполняют запись в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-590">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-591">Параметр <paramref name="source" /> отсутствует в реестре локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-591">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span></span>  
  
<span data-ttu-id="92a74-592">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-592">-or-</span></span> 
<span data-ttu-id="92a74-593">Отсутствуют права на запись в раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-593">You do not have write access on the registry key for the event log.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-594">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-594">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-595">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-595">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-596">Имя, с которым приложение регистрируется в журнале событий системы.</span><span class="sxs-lookup"><span data-stu-id="92a74-596">The name by which the application is registered in the event log system.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-597">Имя компьютера, с которого удаляется регистрация, или "." для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-597">The name of the computer to remove the registration from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-598">Удаляет регистрацию источника событий приложения с указанного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-598">Removes the application's event source registration from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-599">Используйте эту перегрузку для удаления регистрации <xref:System.Diagnostics.EventLog.Source%2A> с удаленного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-599">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="92a74-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> обращается к реестру на компьютере, указанном в `machineName`, и удаляет регистрацию приложения в качестве допустимого источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="92a74-601">Можно удалить компонент в качестве допустимого источника событий, если он больше не нужен для записи в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-601">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="92a74-602">Например, это можно сделать, если необходимо изменить компонент с одного журнала на другой.</span><span class="sxs-lookup"><span data-stu-id="92a74-602">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="92a74-603">Поскольку источник может быть зарегистрирован только в одном журнале за раз, изменение журнала требует удаления текущей регистрации.</span><span class="sxs-lookup"><span data-stu-id="92a74-603">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="92a74-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> удаляет только источник, зарегистрированный в журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="92a74-605">Если вы хотите удалить сам журнал, вызовите <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-605">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="92a74-606">Если нужно только удалить записи журнала, вызовите <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-606">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="92a74-607"><xref:System.Diagnostics.EventLog.Delete%2A> и <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> являются методами `static`, поэтому их можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-607"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="92a74-608">Нет необходимости создавать экземпляр <xref:System.Diagnostics.EventLog> для вызова любого из методов.</span><span class="sxs-lookup"><span data-stu-id="92a74-608">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="92a74-609">При удалении журнала с помощью вызова <xref:System.Diagnostics.EventLog.Delete%2A> автоматически удаляются источники, зарегистрированные в этом журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-609">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="92a74-610">Это может привести к неработоспособности других приложений, использующих этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-610">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-611">Если источник уже сопоставлен с журналом и вы переменяете его в новый журнал, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-611">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-612">В следующем примере удаляется источник с указанного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-612">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="92a74-613">В примере определяется журнал из источника, а затем удаляется журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-613">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-614">В журнал событий может записываться более одного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-614">More than one source might write to an event log.</span></span> <span data-ttu-id="92a74-615">Перед удалением настраиваемого журнала убедитесь, что другие источники не выполняют запись в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-615">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-616">Параметр <paramref name="machineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-616">The <paramref name="machineName" /> parameter is invalid.</span></span>  
  
<span data-ttu-id="92a74-617">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-617">-or-</span></span> 
<span data-ttu-id="92a74-618">Параметр <paramref name="source" /> отсутствует в реестре заданного компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-618">The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span></span>  
  
<span data-ttu-id="92a74-619">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-619">-or-</span></span> 
<span data-ttu-id="92a74-620">Отсутствуют права на запись в раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-620">You do not have write access on the registry key for the event log.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-621"><paramref name="source" /> не может быть удален, так как в реестре, родительский раздел реестра <paramref name="source" /> не содержит подразделы с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="92a74-621"><paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-622">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-622">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-623">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="abstract member Dispose : bool -&gt; unit&#xA;override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing"><span data-ttu-id="92a74-624">Значение <see langword="true" /> позволяет освободить управляемые и неуправляемые ресурсы; значение <see langword="false" /> позволяет освободить только неуправляемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="92a74-624"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="92a74-625">Освобождает неуправляемые ресурсы, используемые журналом <see cref="T:System.Diagnostics.EventLog" />, и при необходимости освобождает также управляемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="92a74-625">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-626">Этот метод вызывается с помощью открытого метода `Dispose()` и метода <xref:System.Object.Finalize%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-626">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="92a74-627">`Dispose()` вызывает защищенный метод `Dispose(Boolean)` с параметром `disposing`, для которого задано значение `true`.</span><span class="sxs-lookup"><span data-stu-id="92a74-627">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="92a74-628"><xref:System.Object.Finalize%2A> вызывает `Dispose` с `disposing`, установленным в `false`.</span><span class="sxs-lookup"><span data-stu-id="92a74-628"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="92a74-629">Если параметр `disposing` имеет значение true, этот метод освобождает все ресурсы, удерживаемые всеми управляемыми объектами, на которые ссылается этот <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-629">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="92a74-630">Этот метод вызывает метод `Dispose()` каждого объекта, на который есть ссылка.</span><span class="sxs-lookup"><span data-stu-id="92a74-630">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides"><para><span data-ttu-id="92a74-631">Метод 
            <see langword="Dispose" /> может вызываться несколько раз другими объектами.</span><span class="sxs-lookup"><span data-stu-id="92a74-631">
            <see langword="Dispose" /> can be called multiple times by other objects.</span></span> <span data-ttu-id="92a74-632">При переопределении <see langword="Dispose(Boolean)" /> следует избегать ссылок на объекты, которые ранее были удалены в предыдущем вызове <see langword="Dispose" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-632">When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />.</span></span> <span data-ttu-id="92a74-633">Дополнительные сведения о реализации <see langword="Dispose(Boolean)" /> см. в разделе [Реализация метода Dispose](~/docs/standard/garbage-collection/implementing-dispose.md).</span><span class="sxs-lookup"><span data-stu-id="92a74-633">For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
<span data-ttu-id="92a74-634">Дополнительные сведения о <see langword="Dispose" /> и <see cref="M:System.Object.Finalize" /> см. в разделе [Очистка неуправляемых ресурсов](~/docs/standard/garbage-collection/unmanaged.md).</span><span class="sxs-lookup"><span data-stu-id="92a74-634">For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</span></span></para></block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableRaisingEvents : bool with get, set" Usage="System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMonitoring")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-635">Возвращает или задает значение, определяющее, получает ли класс <see cref="T:System.Diagnostics.EventLog" /> уведомления о событии <see cref="E:System.Diagnostics.EventLog.EntryWritten" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-635">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span></span></summary>
        <value><span data-ttu-id="92a74-636">Значение <see langword="true" />, если класс <see cref="T:System.Diagnostics.EventLog" /> получает уведомления при внесении записи в журнал; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-636"><see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-637">Свойство <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> определяет, вызывает ли <xref:System.Diagnostics.EventLog> события при записи записей в журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-637">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="92a74-638">Если свойство имеет значение `true`, компоненты, получающие событие <xref:System.Diagnostics.EventLog.EntryWritten>, получают уведомление при каждом записи записи в журнал, указанный в свойстве <xref:System.Diagnostics.EventLog.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-638">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="92a74-639">Если <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> `false`, события не создаются.</span><span class="sxs-lookup"><span data-stu-id="92a74-639">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-640">Уведомления о событиях можно получать только в том случае, если записи записываются на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-640">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="92a74-641">Вы не можете получать уведомления для записей, записанных на удаленных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="92a74-641">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-642">В следующем примере обрабатывается событие <xref:System.Diagnostics.EventLog.EntryWritten>.</span><span class="sxs-lookup"><span data-stu-id="92a74-642">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-643">Журнал событий на удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-643">The event log is on a remote computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-644">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-644">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-645">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-645">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberSignature Language="F#" Value="abstract member EndInit : unit -&gt; unit&#xA;override this.EndInit : unit -&gt; unit" Usage="eventLog.EndInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-646">Завершает инициализацию класса <see cref="T:System.Diagnostics.EventLog" />, используемого в форме или другим компонентом.</span><span class="sxs-lookup"><span data-stu-id="92a74-646">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span></span> <span data-ttu-id="92a74-647">Инициализация происходит во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="92a74-647">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-648">Среда разработки [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] использует этот метод для завершения инициализации компонента, используемого в форме или другим компонентом.</span><span class="sxs-lookup"><span data-stu-id="92a74-648">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="92a74-649">Метод <xref:System.Diagnostics.EventLog.BeginInit%2A> запускает инициализацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-649">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="92a74-650">Использование методов <xref:System.Diagnostics.EventLog.BeginInit%2A> и <xref:System.Diagnostics.EventLog.EndInit%2A> предотвращает использование элемента управления до полной инициализации.</span><span class="sxs-lookup"><span data-stu-id="92a74-650">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-651">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-651">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-652">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-652">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Entries : System.Diagnostics.EventLogEntryCollection" Usage="System.Diagnostics.EventLog.Entries" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntries")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netcore-2.1;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-653">Возвращает содержимое журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-653">Gets the contents of the event log.</span></span></summary>
        <value><span data-ttu-id="92a74-654">Класс <see cref="T:System.Diagnostics.EventLogEntryCollection" />, в котором хранятся записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-654">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span></span> <span data-ttu-id="92a74-655">Каждая запись связана с экземпляром класса <see cref="T:System.Diagnostics.EventLogEntry" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-655">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-656">При чтении из журнала событий используйте элемент <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-656">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="92a74-657">Поскольку свойство доступно только для чтения, нельзя изменить запись или запись в журнал с помощью <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-657">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="92a74-658">Вместо этого укажите <xref:System.Diagnostics.EventLog.Source%2A> и вызовите <xref:System.Diagnostics.EventLog.WriteEntry%2A>, чтобы записать новую запись в журнале.</span><span class="sxs-lookup"><span data-stu-id="92a74-658">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="92a74-659"><xref:System.Diagnostics.EventLog.Entries%2A> можно использовать для подсчета количества записей в журнале событий и просмотра каждого <xref:System.Diagnostics.EventLogEntry> в коллекции.</span><span class="sxs-lookup"><span data-stu-id="92a74-659">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="92a74-660">Используйте индексированный элемент <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> для получения сведений о конкретной записи, например <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>или <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-660">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="92a74-661">Необязательно указывать <xref:System.Diagnostics.EventLog.Source%2A> при чтении из журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-661">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="92a74-662">Для экземпляра <xref:System.Diagnostics.EventLog> можно указать только имя <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A> (имя компьютера сервера).</span><span class="sxs-lookup"><span data-stu-id="92a74-662">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="92a74-663">В любом случае элемент <xref:System.Diagnostics.EventLog.Entries%2A> автоматически заполняется списком записей журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-663">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="92a74-664">Для чтения отдельных записей можно выбрать соответствующий индекс элемента в этом списке.</span><span class="sxs-lookup"><span data-stu-id="92a74-664">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="92a74-665">Важным различием между чтением и записью записей журнала является необязательное явное обращение к методу Read.</span><span class="sxs-lookup"><span data-stu-id="92a74-665">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="92a74-666">После указания <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A> свойство <xref:System.Diagnostics.EventLog.Entries%2A> заполняется автоматически.</span><span class="sxs-lookup"><span data-stu-id="92a74-666">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="92a74-667">Если изменить значение свойства <xref:System.Diagnostics.EventLog.Log%2A> или <xref:System.Diagnostics.EventLog.MachineName%2A>, то свойство <xref:System.Diagnostics.EventLog.Entries%2A> будет повторно заполнено при следующем чтении.</span><span class="sxs-lookup"><span data-stu-id="92a74-667">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-668">Не требуется указывать <xref:System.Diagnostics.EventLog.MachineName%2A> при подключении к журналу.</span><span class="sxs-lookup"><span data-stu-id="92a74-668">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="92a74-669">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается, что используется локальный компьютер ".".</span><span class="sxs-lookup"><span data-stu-id="92a74-669">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-670">Следующий пример считывает записи в журнале событий MyNewLog на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-670">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-671">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-671">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-672">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-672">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberSignature Language="F#" Value="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " Usage="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntryWritten")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-673">Происходит при внесении записи в журнал событий на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-673">Occurs when an entry is written to an event log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-674">Чтобы получать уведомления о событиях, необходимо задать для параметра <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="92a74-674">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="92a74-675">Уведомления о событиях можно получать только при записи записей на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-675">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="92a74-676">Вы не можете получать уведомления для записей, записанных на удаленных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="92a74-676">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="92a74-677">При создании делегата <xref:System.Diagnostics.EventLog.EntryWritten> определяется метод обработки события.</span><span class="sxs-lookup"><span data-stu-id="92a74-677">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="92a74-678">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="92a74-678">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="92a74-679">Обработчик событий вызывается при каждом возникновении события, пока не будет удален делегат.</span><span class="sxs-lookup"><span data-stu-id="92a74-679">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="92a74-680">Дополнительные сведения об обработке событий с помощью делегатов см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="92a74-680">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="92a74-681">Система реагирует на <xref:System.Diagnostics.EventLog.WriteEntry%2A> только в том случае, если Последнее событие записи произошло по крайней мере через шесть секунд ранее.</span><span class="sxs-lookup"><span data-stu-id="92a74-681">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="92a74-682">Это означает, что вы получите только одно <xref:System.Diagnostics.EventLog.EntryWritten> уведомление о событии в течение шести секунд, даже если происходит несколько изменений в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-682">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="92a74-683">Если вы вставили достаточно длительный интервал спящего режима (около 10 секунд) между вызовами <xref:System.Diagnostics.EventLog.WriteEntry%2A>, то вероятность пропуска события меньше.</span><span class="sxs-lookup"><span data-stu-id="92a74-683">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="92a74-684">Однако если события записи происходят чаще, вы можете не получить уведомление о событии до следующего интервала.</span><span class="sxs-lookup"><span data-stu-id="92a74-684">However, if write events occur more frequently, you might not receive the event notification until the next interval.</span></span> <span data-ttu-id="92a74-685">Как правило, уведомления о пропущенных событиях не теряются, но задерживаются.</span><span class="sxs-lookup"><span data-stu-id="92a74-685">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-686">В следующем примере обрабатывается записанное событие записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-686">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-687">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-687">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-688">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-688">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-689">Определяет существование указанного журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-689">Determines whether the specified log exists.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-690">Имя журнала, который нужно найти.</span><span class="sxs-lookup"><span data-stu-id="92a74-690">The name of the log to search for.</span></span> <span data-ttu-id="92a74-691">Возможные значения: Application, Security, System, имена журналов определенных приложений (например службы каталогов Active Directory) или имя любого пользовательского журнала на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-691">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <summary><span data-ttu-id="92a74-692">Определяет наличие журнала на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-692">Determines whether the log exists on the local computer.</span></span></summary>
        <returns><span data-ttu-id="92a74-693">Значение <see langword="true" />, если журнал существует на локальном компьютере; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-693"><see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-694">Используйте этот метод, чтобы определить, существует ли журнал на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-694">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="92a74-695">Если необходимо определить, существует ли источник на локальном компьютере, используйте <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-695">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="92a74-696">Поскольку этот метод обращается к реестру, необходимо иметь соответствующие разрешения на доступ к реестру на локальном компьютере. в противном случае запрос возвращает `false`.</span><span class="sxs-lookup"><span data-stu-id="92a74-696">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="92a74-697">Так как нельзя присвоить новому журналу имя существующего журнала на том же компьютере, используйте этот метод перед созданием нового журнала, чтобы определить, существует ли уже указанный `logName` на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-697">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="92a74-698">Параметр `logName` не учитывает регистр.</span><span class="sxs-lookup"><span data-stu-id="92a74-698">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="92a74-699"><xref:System.Diagnostics.EventLog.Exists%2A> является методом `static`, поэтому его можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-699"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="92a74-700">Нет необходимости создавать экземпляр <xref:System.Diagnostics.EventLog> для вызова <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-700">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-701">Параметр logName принимает значение <see langword="null" /> или пустое значение.</span><span class="sxs-lookup"><span data-stu-id="92a74-701">The logName is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-702">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-702">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-703">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-703">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Exists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="92a74-704">Журнал, который нужно найти.</span><span class="sxs-lookup"><span data-stu-id="92a74-704">The log for which to search.</span></span> <span data-ttu-id="92a74-705">Возможные значения: Application, Security, System, имена журналов определенных приложений (например службы каталогов Active Directory) или имя любого пользовательского журнала на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-705">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-706">Имя компьютера, на котором выполняется поиск журнала, или значение ".", если используется локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-706">The name of the computer on which to search for the log, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-707">Определяет наличие журнала на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-707">Determines whether the log exists on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="92a74-708">Значение <see langword="true" />, если журнал существует на заданном компьютере; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-708"><see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-709">Используйте этот метод, чтобы определить, существует ли журнал на удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-709">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="92a74-710">Если необходимо определить, существует ли источник на удаленном компьютере, используйте <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-710">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="92a74-711">Поскольку этот метод обращается к реестру, необходимо иметь соответствующие разрешения на доступ к реестру на указанном компьютере. в противном случае запрос возвращает `false`.</span><span class="sxs-lookup"><span data-stu-id="92a74-711">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="92a74-712">Так как нельзя присвоить новому журналу имя существующего журнала на том же компьютере, используйте этот метод перед созданием нового журнала, чтобы определить, существует ли он с указанным `logName` на сервере, указанном параметром `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-712">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="92a74-713">Параметры `logName` и `machineName` не учитывают регистр.</span><span class="sxs-lookup"><span data-stu-id="92a74-713">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="92a74-714"><xref:System.Diagnostics.EventLog.Exists%2A> является методом `static`, поэтому его можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-714"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="92a74-715">Нет необходимости создавать новый экземпляр <xref:System.Diagnostics.EventLog> для вызова <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-715">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-716">Недопустимый формат параметра <paramref name="machineName" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-716">The <paramref name="machineName" /> parameter is an invalid format.</span></span> <span data-ttu-id="92a74-717">Убедитесь, что при поиске на компьютере используется правильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="92a74-717">Make sure you have used proper syntax for the computer on which you are searching.</span></span>  
  
<span data-ttu-id="92a74-718">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-718">-or-</span></span> 
<span data-ttu-id="92a74-719">Параметр <paramref name="logName" /> принимает значение <see langword="null" /> или пустое значение.</span><span class="sxs-lookup"><span data-stu-id="92a74-719">The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-720">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-720">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-721">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-721">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-722">Создает массив журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-722">Creates an array of the event logs.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : unit -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="92a74-723">Выполняет поиск всех журналов событий на локальном компьютере и создает массив объектов <see cref="T:System.Diagnostics.EventLog" />, содержащих список.</span><span class="sxs-lookup"><span data-stu-id="92a74-723">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="92a74-724">Массив типа <see cref="T:System.Diagnostics.EventLog" />, представляющий журналы на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-724">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-725">Массив объектов <xref:System.Diagnostics.EventLog> является моментальным снимком всех журналов событий на локальном компьютере, когда выполняется вызов <xref:System.Diagnostics.EventLog.GetEventLogs%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-725">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="92a74-726">Это не динамическая коллекция, поэтому она не отражает удаление или создание журналов в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="92a74-726">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="92a74-727">Перед чтением или записью в массив необходимо убедиться, что журнал в нем существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-727">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="92a74-728">Массив обычно содержит по крайней мере три журнала: Приложение, система и безопасность.</span><span class="sxs-lookup"><span data-stu-id="92a74-728">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="92a74-729">Если вы создали пользовательские журналы на локальном компьютере, они также будут отображаться в массиве.</span><span class="sxs-lookup"><span data-stu-id="92a74-729">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="92a74-730">Чтобы получить список журналов событий, необходимо иметь соответствующие разрешения в реестре.</span><span class="sxs-lookup"><span data-stu-id="92a74-730">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="92a74-731">Эти разрешения идентичны тем, которые необходимы для вызова <xref:System.Diagnostics.EventLog.Exists%2A> и <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-731">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-732">В следующем примере перечисляются журналы событий, определенные на локальном компьютере, и отображаются сведения о конфигурации для каждого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-732">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException"><span data-ttu-id="92a74-733">Отсутствуют права на доступ к реестру.</span><span class="sxs-lookup"><span data-stu-id="92a74-733">You do not have read access to the registry.</span></span>  
  
 <span data-ttu-id="92a74-734">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-734">-or-</span></span>  
  
 <span data-ttu-id="92a74-735">На компьютере отсутствует служба журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-735">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-736">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-736">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-737">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-737">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : string -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="92a74-738">Компьютер, на котором выполняется поиск журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-738">The computer on which to search for event logs.</span></span></param>
        <summary><span data-ttu-id="92a74-739">Выполняет поиск всех журналов событий на заданном компьютере и создает массив объектов <see cref="T:System.Diagnostics.EventLog" />, содержащих список.</span><span class="sxs-lookup"><span data-stu-id="92a74-739">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="92a74-740">Массив типа <see cref="T:System.Diagnostics.EventLog" />, представляющий журналы на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-740">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-741">Массив объектов <xref:System.Diagnostics.EventLog> является моментальным снимком всех журналов событий на компьютере, указанном параметром `machineName`, когда выполняется вызов <xref:System.Diagnostics.EventLog.GetEventLogs%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-741">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="92a74-742">Это не динамическая коллекция, поэтому она не отражает удаление или создание журналов в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="92a74-742">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="92a74-743">Перед чтением или записью в массив необходимо убедиться, что журнал в нем существует.</span><span class="sxs-lookup"><span data-stu-id="92a74-743">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="92a74-744">Массив обычно содержит по крайней мере три журнала: Приложение, система и безопасность.</span><span class="sxs-lookup"><span data-stu-id="92a74-744">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="92a74-745">Если на указанном компьютере были созданы пользовательские журналы, они также будут отображаться в массиве.</span><span class="sxs-lookup"><span data-stu-id="92a74-745">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="92a74-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> является методом `static`, поэтому его можно вызывать в самом классе <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="92a74-747">Нет необходимости создавать экземпляр объекта <xref:System.Diagnostics.EventLog>, чтобы вызвать метод.</span><span class="sxs-lookup"><span data-stu-id="92a74-747">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="92a74-748">Чтобы получить список журналов событий, необходимо иметь соответствующие разрешения в реестре.</span><span class="sxs-lookup"><span data-stu-id="92a74-748">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="92a74-749">Эти разрешения идентичны тем, которые необходимы для вызова <xref:System.Diagnostics.EventLog.Exists%2A> и <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-749">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-750">В следующем примере возвращается список журналов на компьютере myServer.</span><span class="sxs-lookup"><span data-stu-id="92a74-750">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="92a74-751">Затем он выводит имя каждого журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-751">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-752">Параметр <paramref name="machineName" /> содержит недопустимое имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-752">The <paramref name="machineName" /> parameter is an invalid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-753">Отсутствуют права на доступ к реестру.</span><span class="sxs-lookup"><span data-stu-id="92a74-753">You do not have read access to the registry.</span></span>  
  
 <span data-ttu-id="92a74-754">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-754">-or-</span></span>  
  
 <span data-ttu-id="92a74-755">На компьютере отсутствует служба журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-755">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-756">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-756">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-757">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-757">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Log : string with get, set" Usage="System.Diagnostics.EventLog.Log" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogLog")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-758">Возвращает или задает имя журнала, из которого производится чтение или запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-758">Gets or sets the name of the log to read from or write to.</span></span></summary>
        <value><span data-ttu-id="92a74-759">Имя журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-759">The name of the log.</span></span> <span data-ttu-id="92a74-760">Существуют следующие имена: журнал приложения, журнал системы, журнал безопасности или имя, указанное пользователем.</span><span class="sxs-lookup"><span data-stu-id="92a74-760">This can be Application, System, Security, or a custom log name.</span></span> <span data-ttu-id="92a74-761">Значение по умолчанию — пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-761">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-762">На сервере по умолчанию существует три файла журнала: Приложение, система и безопасность.</span><span class="sxs-lookup"><span data-stu-id="92a74-762">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="92a74-763">Приложения и службы используют файл журнала приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-763">Applications and services use the Application log file.</span></span> <span data-ttu-id="92a74-764">Драйверы устройств используют файл журнала системы.</span><span class="sxs-lookup"><span data-stu-id="92a74-764">Device drivers use the System log file.</span></span> <span data-ttu-id="92a74-765">Система создает события успешного и неуспешного аудита в журнале безопасности при включенном аудите.</span><span class="sxs-lookup"><span data-stu-id="92a74-765">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="92a74-766">Если установлены другие приложения, например Active Directory на серверах Windows, могут существовать и другие файлы журнала по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="92a74-766">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="92a74-767">Кроме того, можно создавать пользовательские файлы журналов на локальном или удаленном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-767">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="92a74-768">Настраиваемые журналы помогают упорядочить записи более подробно, чем разрешено, когда компоненты записывают события в журнал приложений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="92a74-768">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-769">Длина имен журналов ограничена восемью символами.</span><span class="sxs-lookup"><span data-stu-id="92a74-769">Log names are limited to eight characters.</span></span> <span data-ttu-id="92a74-770">В соответствии с системой MyLogSample1 и MyLogSample2 являются одним и тем же журналом.</span><span class="sxs-lookup"><span data-stu-id="92a74-770">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="92a74-771">При записи в журнал событий недостаточно указать свойство <xref:System.Diagnostics.EventLog.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-771">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="92a74-772">Необходимо связать свойство <xref:System.Diagnostics.EventLog.Source%2A> с ресурсом журнала событий, чтобы подключить его к определенному журналу.</span><span class="sxs-lookup"><span data-stu-id="92a74-772">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="92a74-773">При чтении из журнала необязательно указывать <xref:System.Diagnostics.EventLog.Source%2A>, но источник событий должен быть связан с ресурсом журнала событий в реестре сервера.</span><span class="sxs-lookup"><span data-stu-id="92a74-773">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="92a74-774">Для чтения можно указать только имя <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A> (имя компьютера сервера).</span><span class="sxs-lookup"><span data-stu-id="92a74-774">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-775">Не требуется указывать <xref:System.Diagnostics.EventLog.MachineName%2A> при подключении к журналу.</span><span class="sxs-lookup"><span data-stu-id="92a74-775">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="92a74-776">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается, что используется локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-776">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-777">Если свойство <xref:System.Diagnostics.EventLog.Source%2A> не задано, вызов метода <xref:System.Diagnostics.EventLog.Log%2A> возвращает пустую строку, если <xref:System.Diagnostics.EventLog.Log%2A> не было явно задано (путем установки свойства <xref:System.Diagnostics.EventLog.Log%2A> или с помощью конструктора).</span><span class="sxs-lookup"><span data-stu-id="92a74-777">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="92a74-778">Если <xref:System.Diagnostics.EventLog.Source%2A> указан, <xref:System.Diagnostics.EventLog.Log%2A> возвращает имя журнала, в который был зарегистрирован этот источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-778">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="92a74-779">Источник может быть зарегистрирован только в одном журнале за раз.</span><span class="sxs-lookup"><span data-stu-id="92a74-779">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="92a74-780">Если свойство <xref:System.Diagnostics.EventLog.Source%2A> было задано для экземпляра <xref:System.Diagnostics.EventLog>, нельзя изменить свойство <xref:System.Diagnostics.EventLog.Log%2A> для этого <xref:System.Diagnostics.EventLog>, не изменяя значение <xref:System.Diagnostics.EventLog.Source%2A> или вызывая <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> First.</span><span class="sxs-lookup"><span data-stu-id="92a74-780">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="92a74-781">При изменении свойства <xref:System.Diagnostics.EventLog.Log%2A> после установки свойства <xref:System.Diagnostics.EventLog.Source%2A> запись журнала вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="92a74-781">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="92a74-782">Журналы событий сохраняются операционной системой как файлы.</span><span class="sxs-lookup"><span data-stu-id="92a74-782">The operating system stores event logs as files.</span></span> <span data-ttu-id="92a74-783">При использовании <xref:System.Diagnostics.EventLogInstaller> или <xref:System.Diagnostics.EventLog.CreateEventSource%2A> для создания нового журнала событий связанный файл сохраняется в каталоге%SystemRoot%\System32\Config на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-783">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="92a74-784">Имя файла задается путем добавления первых 8 символов свойства <xref:System.Diagnostics.EventLog.Log%2A> к расширению имени файла ". evt".</span><span class="sxs-lookup"><span data-stu-id="92a74-784">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="92a74-785">Нельзя создать новый журнал, используя только свойство <xref:System.Diagnostics.EventLog.Log%2A> (без указания источника для журнала).</span><span class="sxs-lookup"><span data-stu-id="92a74-785">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="92a74-786">Можно вызвать <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, передав новое имя журнала в качестве параметра, а затем вызвать <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-786">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="92a74-787">Тем не менее намерением обычно является создание (и запись записей) новых журналов для конкретного приложения или чтение из существующих журналов.</span><span class="sxs-lookup"><span data-stu-id="92a74-787">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="92a74-788">Если значение <xref:System.Diagnostics.EventLog.Log%2A> меняется, журнал событий закрывается и освобождаются все дескрипторы событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-788">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="92a74-789">Если для свойства <xref:System.Diagnostics.EventLog.Log%2A> задано имя несуществующего журнала, система прикрепляет <xref:System.Diagnostics.EventLog> в журнале приложений, но не предупреждает о том, что используется журнал, отличный от указанного вами.</span><span class="sxs-lookup"><span data-stu-id="92a74-789">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-790">Следующий пример считывает записи в журнале событий «Невевентлог» на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-790">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-791">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-791">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-792">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-792">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LogDisplayName : string" Usage="System.Diagnostics.EventLog.LogDisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-793">Возвращает понятное имя журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-793">Gets the event log's friendly name.</span></span></summary>
        <value><span data-ttu-id="92a74-794">Имя, представляющее журнал событий в "Просмотре событий".</span><span class="sxs-lookup"><span data-stu-id="92a74-794">A name that represents the event log in the system's event viewer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="92a74-795">В Windows Vista и более поздних версиях пользователи не имеют разрешения на доступ к журналу безопасности.</span><span class="sxs-lookup"><span data-stu-id="92a74-795">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="92a74-796">Если вы используете Windows Vista или более поздней версии в качестве пользователя, при попытке доступа к отображаемому имени события в журнале безопасности будет получен <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-796">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="92a74-797">В Windows Vista и более поздних версиях права доступа пользователя определяются контролем учетных записей.</span><span class="sxs-lookup"><span data-stu-id="92a74-797">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-798">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-798">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-799">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-799">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-800">Чтобы выполнить код, обращающийся к журналу безопасности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-800">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-801">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-801">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-802">В следующем примере перечисляются журналы событий, определенные на локальном компьютере, и выводится <xref:System.Diagnostics.EventLog.LogDisplayName%2A> для каждого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-802">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-803">Параметр <see cref="P:System.Diagnostics.EventLog.Log" /> отсутствует в реестре для этого компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-803">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-804">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-804">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-805">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-805">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="92a74-806">для возможности чтения указанного раздела реестра.</span><span class="sxs-lookup"><span data-stu-id="92a74-806">for the ability to read the specified registry key.</span></span> <span data-ttu-id="92a74-807">Связанное перечисление: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span><span class="sxs-lookup"><span data-stu-id="92a74-807">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="92a74-808">возможность доступа к указанному разделу реестра, если он является удаленным ключом.</span><span class="sxs-lookup"><span data-stu-id="92a74-808">for the ability to access the specified registry key if it is a remote key.</span></span> <span data-ttu-id="92a74-809">Связанное перечисление: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="92a74-809">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member LogNameFromSourceName : string * string -&gt; string" Usage="System.Diagnostics.EventLog.LogNameFromSourceName (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-810">Имя источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-810">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-811">Имя компьютера, на котором выполняется поиск, или значение ".", если используется локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-811">The name of the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-812">Возвращает имя журнала, в котором зарегистрирован указанный источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-812">Gets the name of the log to which the specified source is registered.</span></span></summary>
        <returns><span data-ttu-id="92a74-813">Имя журнала, связанное с указанным источником в реестре.</span><span class="sxs-lookup"><span data-stu-id="92a74-813">The name of the log associated with the specified source in the registry.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-814">Источник события указывает, в каком журнале регистрируется событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-814">The event source indicates what logs the event.</span></span> <span data-ttu-id="92a74-815">Часто это имя приложения или имя подкомпонента приложения, если приложение велико.</span><span class="sxs-lookup"><span data-stu-id="92a74-815">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="92a74-816">Приложения и службы должны записывать в журнал приложений или пользовательский журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-816">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="92a74-817">Драйверы устройств должны записывать в системный журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-817">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="92a74-818">При создании нового источника, который может записывать данные только в один журнал, система регистрирует приложение в качестве допустимого источника записей в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-818">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="92a74-819">Свойство <xref:System.Diagnostics.EventLog.Source%2A> может быть любой строкой, но оно не может использоваться другими источниками на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-819">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="92a74-820">Попытка создать повторяющееся <xref:System.Diagnostics.EventLog.Source%2A> значение вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="92a74-820">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="92a74-821">Однако один журнал событий может иметь множество различных источников, в которых осуществляется запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-821">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-822">В следующем примере удаляется источник с локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-822">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="92a74-823">В примере определяется журнал из источника, а затем удаляется журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-823">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-824">В журнал событий может записываться более одного источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-824">More than one source might write to an event log.</span></span> <span data-ttu-id="92a74-825">Перед удалением настраиваемого журнала убедитесь, что другие источники не выполняют запись в этот журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-825">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-826">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-826">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-827">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-827">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Diagnostics.EventLog.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMachineName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-828">Возвращает или задает имя компьютера, на котором производится чтение или запись событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-828">Gets or sets the name of the computer on which to read or write events.</span></span></summary>
        <value><span data-ttu-id="92a74-829">Имя сервера, на котором находится журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-829">The name of the server on which the event log resides.</span></span> <span data-ttu-id="92a74-830">Значение по умолчанию — локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-830">The default is the local computer (".").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-831">При записи в журнал событий необходимо связать <xref:System.Diagnostics.EventLog.Source%2A> с объектом журнала событий, чтобы подключить его к определенному журналу.</span><span class="sxs-lookup"><span data-stu-id="92a74-831">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="92a74-832">При чтении из журнала необязательно указывать свойство <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-832">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="92a74-833">Можно указать только имя <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A> (имя компьютера сервера).</span><span class="sxs-lookup"><span data-stu-id="92a74-833">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-834">Не нужно указывать <xref:System.Diagnostics.EventLog.MachineName%2A> при подключении к журналу.</span><span class="sxs-lookup"><span data-stu-id="92a74-834">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="92a74-835">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается, что используется локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-835">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-836">Источник может быть зарегистрирован только в одном журнале за раз.</span><span class="sxs-lookup"><span data-stu-id="92a74-836">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="92a74-837">Если свойство <xref:System.Diagnostics.EventLog.Source%2A> было задано для экземпляра <xref:System.Diagnostics.EventLog>, нельзя изменить свойство <xref:System.Diagnostics.EventLog.MachineName%2A> для этого <xref:System.Diagnostics.EventLog>, не изменяя значение <xref:System.Diagnostics.EventLog.Source%2A> или вызывая <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> First.</span><span class="sxs-lookup"><span data-stu-id="92a74-837">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="92a74-838">При изменении свойства <xref:System.Diagnostics.EventLog.MachineName%2A> <xref:System.Diagnostics.EventLog> закрывает все дескрипторы и повторно подключается к журналу и источнику на новом компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-838">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="92a74-839">Значение <xref:System.Diagnostics.EventLog.MachineName%2A> не может быть пустой строкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-839">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="92a74-840">Если он не задан явно, по умолчанию используется локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-840">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-841">Следующий пример считывает записи в журнале событий «Невевентлог» на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-841">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-842">Недопустимое имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-842">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-843">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-843">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-844">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-844">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumKilobytes : int64 with get, set" Usage="System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netcore-2.1;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-845">Возвращает или устанавливает максимальный размер журнала событий в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="92a74-845">Gets or sets the maximum event log size in kilobytes.</span></span></summary>
        <value><span data-ttu-id="92a74-846">Максимальный размер журнала событий в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="92a74-846">The maximum event log size in kilobytes.</span></span> <span data-ttu-id="92a74-847">Значение по умолчанию — 512, что означает максимальный размер файла 512 килобайт.</span><span class="sxs-lookup"><span data-stu-id="92a74-847">The default is 512, indicating a maximum file size of 512 kilobytes.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-848">Свойство <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> представляет предельный размер файла журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-848">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="92a74-849">Когда журнал событий достигает предельного размера, настроенное <xref:System.Diagnostics.EventLog.OverflowAction%2A> значение определяет, отбрасываются ли новые записи, или перезапись старых записей новыми записями.</span><span class="sxs-lookup"><span data-stu-id="92a74-849">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-850">Это свойство представляет параметр конфигурации для журнала событий, представленного этим экземпляром.</span><span class="sxs-lookup"><span data-stu-id="92a74-850">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="92a74-851">Когда журнал событий достигает максимального размера, это свойство указывает, как операционная система обрабатывает новые записи, записанные всеми источниками событий, зарегистрированными для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-851">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-852">В следующем примере перечисляются журналы событий, определенные на локальном компьютере, и отображаются сведения о конфигурации для каждого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-852">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="92a74-853">Указанное значение меньше 64 или больше 4194240 или не кратно 64.</span><span class="sxs-lookup"><span data-stu-id="92a74-853">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-854">Значение параметра <see cref="P:System.Diagnostics.EventLog.Log" /> является недопустимым именем журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-854">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="92a74-855">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-855">-or-</span></span> 
<span data-ttu-id="92a74-856">Раздел реестра для журнала событий не может быть открыт на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-856">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-857">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-857">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-858">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-858">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinimumRetentionDays : int" Usage="System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-859">Возвращает количество дней, которое записи хранятся в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-859">Gets the number of days to retain entries in the event log.</span></span></summary>
        <value><span data-ttu-id="92a74-860">Количество дней, которое записи хранятся в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-860">The number of days that entries in the event log are retained.</span></span> <span data-ttu-id="92a74-861">Значение по умолчанию — 7.</span><span class="sxs-lookup"><span data-stu-id="92a74-861">The default value is 7.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-862">Используйте свойство <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> для проверки текущего значения для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-862">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="92a74-863">Используйте <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>, чтобы изменить минимальное число дней, в течение которых должна храниться каждая запись в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-863">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="92a74-864">Значение <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> зависит от настроенного поведения переполнения журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-864">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="92a74-865">Если свойство <xref:System.Diagnostics.OverflowAction> для журнала событий имеет значение <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, то <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> значение равно 0.</span><span class="sxs-lookup"><span data-stu-id="92a74-865">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="92a74-866">Если свойство <xref:System.Diagnostics.OverflowAction> для журнала событий имеет значение <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, то <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> значение равно-1.</span><span class="sxs-lookup"><span data-stu-id="92a74-866">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="92a74-867">Если свойство <xref:System.Diagnostics.OverflowAction> для журнала событий имеет значение <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, то <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> значение больше нуля и представляет число дней для удержания записей журнала событий при заполнении журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-867">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="92a74-868">Поведение переполнения происходит только при достижении предельного размера журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-868">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="92a74-869">Если для <xref:System.Diagnostics.EventLog> <xref:System.Diagnostics.EventLog.OverflowAction%2A> задано значение <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, а журнал событий достигает максимального размера, новые записи записываются только в том случае, если они могут заменить записи, возраст которых превышает период <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-869">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="92a74-870">Сохранение записей событий в течение минимального периода допустимо, если журнал событий архивируется регулярно.</span><span class="sxs-lookup"><span data-stu-id="92a74-870">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="92a74-871">В противном случае вы рискуете потерять новые записи при достижении предельного размера журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-871">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="92a74-872">Чтобы избежать потери новых сведений о событиях, установите минимальные дни хранения для событий в зависимости от расписания архивации для определенного журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-872">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-873">В следующем примере перечисляются журналы событий, определенные на локальном компьютере, и отображаются сведения о конфигурации для каждого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-873">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-874">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-874">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-875">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-875">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberSignature Language="F#" Value="member this.ModifyOverflowPolicy : System.Diagnostics.OverflowAction * int -&gt; unit" Usage="eventLog.ModifyOverflowPolicy (action, retentionDays)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="retentionDays" Type="System.Int32" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="92a74-876">Поведение при внесении новых записей в журнал событий в случае переполнения.</span><span class="sxs-lookup"><span data-stu-id="92a74-876">The overflow behavior for writing new entries to the event log.</span></span></param>
        <param name="retentionDays"><span data-ttu-id="92a74-877">Минимальное количество дней, которое будет храниться каждая запись журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-877">The minimum number of days each event log entry is retained.</span></span> <span data-ttu-id="92a74-878">Этот параметр используется только в том случае, если значение <paramref name="action" /> равно <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-878">This parameter is used only if <paramref name="action" /> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></param>
        <summary><span data-ttu-id="92a74-879">Изменяет поведение при внесении новых записей, когда файл журнала событий достигает максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-879">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-880">Поведение переполнения для журнала событий указывает, что происходит при записи новых записей в журнал, достиг максимального размера файла.</span><span class="sxs-lookup"><span data-stu-id="92a74-880">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-881">Поведение переполнения вступает в силу только в том случае, если размер файла журнала событий достигнет максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-881">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="92a74-882">Поведение переполнения не влияет на запись новой записи в журнал, который может разместить дополнительные записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-882">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="92a74-883">Метод <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> настраивает поведение переполнения журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-883">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="92a74-884"><xref:System.Diagnostics.EventLog> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="92a74-884"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="92a74-885">После вызова этого метода для журнала событий, указанного свойством <xref:System.Diagnostics.EventLog.Log%2A>, значения свойств <xref:System.Diagnostics.EventLog.OverflowAction%2A> и <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> отражали только что настроенное поведение переполнения.</span><span class="sxs-lookup"><span data-stu-id="92a74-885">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-886">Это свойство представляет параметр конфигурации для журнала событий, представленного этим экземпляром.</span><span class="sxs-lookup"><span data-stu-id="92a74-886">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="92a74-887">Когда журнал событий достигает максимального размера, это свойство указывает, как операционная система обрабатывает новые записи, записанные всеми источниками событий, зарегистрированными для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-887">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="92a74-888">Задайте для параметра `action` значение <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, чтобы указать, что новая запись перезаписывает самую старую запись, когда <xref:System.Diagnostics.EventLog> достигает максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-888">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="92a74-889">Если параметр `action` имеет значение <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, значение параметра `retentionDays` игнорируется.</span><span class="sxs-lookup"><span data-stu-id="92a74-889">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="92a74-890">Задайте для параметра `action` значение <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, чтобы указать, что каждая новая запись перезаписывает старые записи, когда <xref:System.Diagnostics.EventLog> достигает максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-890">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="92a74-891">Укажите число дней, в течение которых события должны храниться в журнале с помощью параметра `retentionDays`.</span><span class="sxs-lookup"><span data-stu-id="92a74-891">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="92a74-892">События, записанные в пределах диапазона хранения, не перезаписываются новыми записями.</span><span class="sxs-lookup"><span data-stu-id="92a74-892">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="92a74-893">Задайте для параметра `action` значение <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, чтобы отменить новые события по достижении максимального размера журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-893">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="92a74-894">Если параметр `action` имеет значение <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, значение параметра `retentionDays` игнорируется.</span><span class="sxs-lookup"><span data-stu-id="92a74-894">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="92a74-895">Установка для политики переполнения значения <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> указывает, что при заполнении журнала событий новые записи будут удалены.</span><span class="sxs-lookup"><span data-stu-id="92a74-895">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="92a74-896">При использовании этого параметра необходимо, чтобы журнал событий был регулярно архивирован и сброшен, чтобы не допустить достижения максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-896">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-897">В следующем примере выводится настроенная политика переполнения для указанного журнала событий, которая позволяет пользователю выбрать новый параметр политики переполнения для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-897">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-898"><paramref name="action" /> не является допустимым значением <see cref="P:System.Diagnostics.EventLog.OverflowAction" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-898"><paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="92a74-899">Параметр <paramref name="retentionDays" /> меньше 1 или больше 365.</span><span class="sxs-lookup"><span data-stu-id="92a74-899"><paramref name="retentionDays" /> is less than one, or larger than 365.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-900">Значение параметра <see cref="P:System.Diagnostics.EventLog.Log" /> является недопустимым именем журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-900">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="92a74-901">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-901">-or-</span></span> 
<span data-ttu-id="92a74-902">Раздел реестра для журнала событий не может быть открыт на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-902">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-903">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-903">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-904">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-904">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberSignature Language="F#" Value="member this.OverflowAction : System.Diagnostics.OverflowAction" Usage="System.Diagnostics.EventLog.OverflowAction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-905">Возвращает поведение при переполнении для хранения новых записей, когда файл журнала событий достигает максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-905">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span></span></summary>
        <value><span data-ttu-id="92a74-906">Значение <see cref="T:System.Diagnostics.OverflowAction" />, которое определяет поведение при переполнении для хранения новых записей, когда файл журнала событий достигает максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-906">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span></span> <span data-ttu-id="92a74-907">Значение по умолчанию — <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-907">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-908">Размер журналов событий увеличивается по мере записи новых событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-908">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="92a74-909">Каждый журнал событий имеет настроенный максимальный размер. Свойство <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> определяет максимальное количество килобайтов, допустимое для размера файла журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-909">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="92a74-910">Используйте значение свойства <xref:System.Diagnostics.EventLog.OverflowAction%2A>, чтобы проверить настроенное поведение переполнения для журнала событий с максимальным размером.</span><span class="sxs-lookup"><span data-stu-id="92a74-910">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="92a74-911">Используйте метод <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>, чтобы изменить поведение переполнения для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-911">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-912">Поведение переполнения вступает в силу только в том случае, если размер файла журнала событий достигнет максимального размера.</span><span class="sxs-lookup"><span data-stu-id="92a74-912">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="92a74-913">Поведение переполнения не влияет на запись новой записи в журнал, который может разместить дополнительные записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-913">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-914">В следующем примере перечисляются журналы событий, определенные на локальном компьютере, и отображаются сведения о конфигурации для каждого журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-914">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-915">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-915">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-916">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-916">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberSignature Language="F#" Value="member this.RegisterDisplayName : string * int64 -&gt; unit" Usage="eventLog.RegisterDisplayName (resourceFile, resourceId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="resourceId" Type="System.Int64" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="resourceFile"><span data-ttu-id="92a74-917">Полный путь к локализованному файлу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-917">The fully specified path to a localized resource file.</span></span></param>
        <param name="resourceId"><span data-ttu-id="92a74-918">Идентификатор ресурса, который индексирует локализованную строку в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-918">The resource identifier that indexes a localized string within the resource file.</span></span></param>
        <summary><span data-ttu-id="92a74-919">Определяет локализованное имя для журнала событий, которое отображается в "Просмотре событий" сервера.</span><span class="sxs-lookup"><span data-stu-id="92a74-919">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-920">Используйте <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> для регистрации и вывода локализованного имени в Просмотр событий для пользовательских журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-920">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="92a74-921">Указанный идентификатор ресурса должен соответствовать локализованной строке, определенной в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-921">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="92a74-922">Просмотр событий отображает имя пользовательского журнала событий, используя локализованную строку и текущие параметры языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-922">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="92a74-923">Например, можно определить несколько имен журналов событий, локализованных для различных языков и региональных параметров в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-923">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="92a74-924">Просмотр событий отображает локализованную строку, соответствующую параметрам языка и региональных параметров текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-924">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="92a74-925">Если Просмотр событий не может загрузить локализованную строку из файла ресурсов или если отображаемое имя не зарегистрировано для журнала событий, Просмотр событий отображает имя журнала событий, определенное в <xref:System.Diagnostics.EventLog.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-925">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-926">Для предварительно определенных журналов событий не нужно регистрировать отображаемое имя.</span><span class="sxs-lookup"><span data-stu-id="92a74-926">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="92a74-927">Операционная система регистрирует локализованные отображаемые имена для журналов событий приложений, систем и безопасности.</span><span class="sxs-lookup"><span data-stu-id="92a74-927">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-928">В следующем примере определяется, зарегистрирован ли источник событий с именем `SampleApplicationSource` на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-928">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="92a74-929">Если источник событий не существует, в примере задается файл ресурса сообщения для источника и создается новый источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-929">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="92a74-930">Наконец, в примере задается локализованное отображаемое имя для журнала событий с использованием значения идентификатора ресурса в `DisplayNameMsgId` и пути к файлу ресурса в `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="92a74-930">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="92a74-931">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-931">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-932">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-932">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-933">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-933">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="92a74-934">В частности, идентификатор ресурса 5001 определен для локализованного имени журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-934">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-935">Значение параметра <see cref="P:System.Diagnostics.EventLog.Log" /> является недопустимым именем журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-935">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="92a74-936">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-936">-or-</span></span> 
<span data-ttu-id="92a74-937">Раздел реестра для журнала событий не может быть открыт на конечном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-937">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-938">Свойство <paramref name="resourceFile" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-938"><paramref name="resourceFile" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-939">для администрирования сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-939">for administering event log information on the computer.</span></span> <span data-ttu-id="92a74-940">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="92a74-940">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Source : string with get, set" Usage="System.Diagnostics.EventLog.Source" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSource")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-941">Возвращает или задает имя источника, регистрируемого в журнале и используемого при записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-941">Gets or sets the source name to register and use when writing to the event log.</span></span></summary>
        <value><span data-ttu-id="92a74-942">Имя, регистрируемое в журнале событий как имя источника записей.</span><span class="sxs-lookup"><span data-stu-id="92a74-942">The name registered with the event log as a source of entries.</span></span> <span data-ttu-id="92a74-943">Значение по умолчанию — пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-943">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-944">Источник события указывает, в каком журнале регистрируется событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-944">The event source indicates what logs the event.</span></span> <span data-ttu-id="92a74-945">Часто это имя приложения или имя подкомпонента приложения, если приложение велико.</span><span class="sxs-lookup"><span data-stu-id="92a74-945">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="92a74-946">Приложения и службы должны записывать в журнал приложений или пользовательский журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-946">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="92a74-947">Драйверы устройств должны записывать в системный журнал.</span><span class="sxs-lookup"><span data-stu-id="92a74-947">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="92a74-948">При записи в журнал событий необходимо указывать только источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-948">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="92a74-949">Перед записью записи в журнал событий необходимо зарегистрировать источник событий в журнале событий в качестве допустимого источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-949">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="92a74-950">При написании записи журнала система использует свойство <xref:System.Diagnostics.EventLog.Source%2A> для поиска соответствующего журнала, в котором будет размещена запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-950">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="92a74-951">При чтении журнала событий можно указать либо <xref:System.Diagnostics.EventLog.Source%2A>, либо <xref:System.Diagnostics.EventLog.Log%2A> и <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-951">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-952">Не требуется указывать <xref:System.Diagnostics.EventLog.MachineName%2A> при подключении к журналу на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-952">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="92a74-953">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A>, предполагается, что используется локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-953">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-954">Используйте <xref:System.Diagnostics.EventLog.WriteEvent%2A> и <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-954">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="92a74-955">Для записи событий необходимо указать источник события. перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-955">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-956">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-956">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-957">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-957">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-958">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-958">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-959">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-959">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-960">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-960">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-961">Можно создать источник событий для существующего журнала событий или нового журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-961">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="92a74-962">При создании нового источника для нового журнала событий система регистрирует источник для этого журнала, но журнал не создается, пока в него не будет записана первая запись.</span><span class="sxs-lookup"><span data-stu-id="92a74-962">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="92a74-963">Источник должен быть уникальным на локальном компьютере; новое имя источника не может совпадать с существующим именем источника или именем существующего журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-963">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="92a74-964">Каждый источник может записывать только один журнал событий; Однако приложение может использовать несколько источников для записи в несколько журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-964">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="92a74-965">Например, приложению может потребоваться несколько источников, настроенных для различных журналов событий или разных файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-965">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="92a74-966">Если изменить значение <xref:System.Diagnostics.EventLog.Source%2A>, <xref:System.Diagnostics.EventLog>, с которым он зарегистрирован, будет закрыт и освобождаются все дескрипторы событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-966">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="92a74-967">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-967">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-968">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-968">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-969">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-969">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-970">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-970">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="92a74-971">Чтобы изменить сведения о конфигурации существующего источника, необходимо удалить источник, а затем создать его с новой конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="92a74-971">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="92a74-972">Если другие приложения или компоненты используют существующий источник, создайте новый источник с обновленной конфигурацией, а не удалите существующий источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-972">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-973">Если источник уже сопоставлен с журналом и вы переменяете его в новый журнал, необходимо перезагрузить компьютер, чтобы изменения вступили в силу.</span><span class="sxs-lookup"><span data-stu-id="92a74-973">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-974">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-974">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-975">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-975">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-976">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-976">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-977">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-977">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-978">Выполняет поиск заданного источника событий в реестре компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-978">Searches a computer's registry for a given event source.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-979">Имя источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-979">The name of the event source.</span></span></param>
        <summary><span data-ttu-id="92a74-980">Определяет, зарегистрирован ли источник событий на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-980">Determines whether an event source is registered on the local computer.</span></span></summary>
        <returns><span data-ttu-id="92a74-981">Значение <see langword="true" />, если источник событий зарегистрирован на локальном компьютере; в противном случае — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-981"><see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-982">Используйте этот метод, чтобы определить, существует ли источник событий на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-982">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="92a74-983">Если необходимо определить, существует ли журнал на локальном компьютере, используйте <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-983">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="92a74-984">Поскольку этот метод обращается к реестру, необходимо иметь соответствующие разрешения на доступ к реестру на локальном компьютере. в противном случае будет выдано исключение <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-984">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-985">Для поиска источника событий в Windows Vista и более поздних версиях или Windows Server 2003 необходимо иметь права администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-985">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="92a74-986">Причина этого требования заключается в том, что необходимо выполнить поиск всех журналов событий, включая систему безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-986">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-987">Начиная с Windows Vista, пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-987">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="92a74-988">Начиная с Windows Vista, привилегии пользователя определяются контролем учетных записей (UAC).</span><span class="sxs-lookup"><span data-stu-id="92a74-988">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-989">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-989">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-990">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-990">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-991">Чтобы выполнить код, обращающийся к счетчикам производительности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-991">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-992">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-992">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-993">У службы, выполняющейся в учетной записи <xref:System.ServiceProcess.ServiceAccount.LocalSystem>, нет прав, необходимых для выполнения этого метода.</span><span class="sxs-lookup"><span data-stu-id="92a74-993">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="92a74-994">Решение состоит в том, чтобы проверить, существует ли источник событий в <xref:System.ServiceProcess.ServiceInstaller>, и если он не существует, для создания источника в установщике.</span><span class="sxs-lookup"><span data-stu-id="92a74-994">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="92a74-995">Так как нельзя присвоить новому источнику имя существующего источника на том же компьютере, используйте этот метод перед попыткой вызова <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, чтобы убедиться, что источник с именем, указанным в `source`, еще не существует на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-995">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="92a74-996">Параметр `source` не учитывает регистр.</span><span class="sxs-lookup"><span data-stu-id="92a74-996">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-997">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-997">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="92a74-998"><paramref name="source" /> не найден, но поиск некоторых или всех журналов событий не был произведен.</span><span class="sxs-lookup"><span data-stu-id="92a74-998"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-999">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-999">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1000">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1000">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1001">Имя источника событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1001">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="92a74-1002">Имя компьютера, на котором выполняется поиск, или значение ".", если используется локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="92a74-1002">The name the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="92a74-1003">Определяет, зарегистрирован ли источник событий на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1003">Determines whether an event source is registered on a specified computer.</span></span></summary>
        <returns><span data-ttu-id="92a74-1004">Значение <see langword="true" />, если источник событий зарегистрирован на заданном компьютере; в противном случае — значение <see langword="false" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1004"><see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1005">Используйте этот метод, чтобы определить, существует ли источник событий на компьютере, указанном параметром `machineName`.</span><span class="sxs-lookup"><span data-stu-id="92a74-1005">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="92a74-1006">Если необходимо определить, существует ли журнал на указанном компьютере, используйте <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1006">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1007">Поскольку этот метод обращается к реестру, необходимо иметь соответствующие разрешения на доступ к реестру на данном сервере. в противном случае будет выдано исключение <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1007">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1008">Для поиска источника событий в Windows Vista и более поздних версиях или Windows Server 2003 необходимо иметь права администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-1008">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="92a74-1009">Причина этого требования заключается в том, что необходимо выполнить поиск всех журналов событий, включая систему безопасности, чтобы определить, является ли источник события уникальным.</span><span class="sxs-lookup"><span data-stu-id="92a74-1009">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="92a74-1010">Начиная с Windows Vista, пользователи не имеют разрешения на доступ к журналу безопасности; Поэтому создается <xref:System.Security.SecurityException>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1010">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="92a74-1011">Начиная с Windows Vista, привилегии пользователя определяются контролем учетных записей (UAC).</span><span class="sxs-lookup"><span data-stu-id="92a74-1011">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="92a74-1012">Члену встроенной группы "Администраторы" присваивается два маркера доступа на время выполнения: маркер доступа обычного пользователя и маркер доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-1012">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="92a74-1013">По умолчанию назначена роль обычного пользователя.</span><span class="sxs-lookup"><span data-stu-id="92a74-1013">By default, you are in the standard user role.</span></span> <span data-ttu-id="92a74-1014">Чтобы выполнить код, обращающийся к счетчикам производительности, необходимо сначала повысить привилегии обычного пользователя до администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-1014">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="92a74-1015">Это можно сделать при запуске приложения, , щелкнув значок приложения правой кнопкой мыши и указав, что приложение должно запускаться от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="92a74-1015">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1016">У службы, выполняющейся в учетной записи <xref:System.ServiceProcess.ServiceAccount.LocalSystem>, нет прав, необходимых для выполнения этого метода.</span><span class="sxs-lookup"><span data-stu-id="92a74-1016">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="92a74-1017">Решение состоит в том, чтобы проверить, существует ли источник событий в <xref:System.ServiceProcess.ServiceInstaller>, и если он не существует, для создания источника в установщике.</span><span class="sxs-lookup"><span data-stu-id="92a74-1017">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="92a74-1018">Так как нельзя присвоить новому источнику имя существующего источника на том же компьютере, используйте этот метод перед попыткой вызова <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, чтобы убедиться, что источник с именем, указанным в `source`, еще не существует на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1018">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="92a74-1019">Параметры `source` и `machineName` не учитывают регистр.</span><span class="sxs-lookup"><span data-stu-id="92a74-1019">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="92a74-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> является методом `static`, поэтому его можно вызывать в самом классе.</span><span class="sxs-lookup"><span data-stu-id="92a74-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="92a74-1021">Нет необходимости создавать экземпляр <xref:System.Diagnostics.EventLog> для вызова <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1021">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1022">В следующем примере создается исходный `MySource` на компьютере `MyServer`и записывается запись в `MyNewLog`журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1022">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1023">Значение параметра <paramref name="machineName" /> не является допустимым именем компьютера.</span><span class="sxs-lookup"><span data-stu-id="92a74-1023"><paramref name="machineName" /> is an invalid computer name.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="92a74-1024"><paramref name="source" /> не найден, но поиск некоторых или всех журналов событий не был произведен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1024"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1025">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1025">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1026">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1026">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;netcore-3.0;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92a74-1027">Возвращает или задает объект, используемый для маршалинга вызовов обработчика событий, возникающих в результате события записи в <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1027">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span></span></summary>
        <value><span data-ttu-id="92a74-1028">Объект <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, используемый для маршалинга вызовов обработчика событий, возникающих в результате события записи <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1028">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1029">Если <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> `null`, методы, обрабатывающие событие <xref:System.Diagnostics.EventLog.EntryWritten>, вызываются в потоке из пула системных потоков.</span><span class="sxs-lookup"><span data-stu-id="92a74-1029">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="92a74-1030">Дополнительные сведения о пулах системных потоков см. в разделе <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1030">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="92a74-1031">Если событие <xref:System.Diagnostics.EventLog.EntryWritten> обрабатывается компонентом Visual Windows Forms, например кнопкой, доступ к компоненту через пул системных потоков может не работать или может привести к исключению.</span><span class="sxs-lookup"><span data-stu-id="92a74-1031">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="92a74-1032">Это следует избегать, если присвоить <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> компоненту Windows Forms, в результате чего методы, обрабатывающие событие <xref:System.Diagnostics.EventLog.EntryWritten>, вызываются в том же потоке, в котором был создан компонент.</span><span class="sxs-lookup"><span data-stu-id="92a74-1032">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="92a74-1033">Если <xref:System.Diagnostics.EventLog> используется в [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] в конструкторе Windows Forms, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> автоматически устанавливается в элемент управления, содержащий <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1033">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="92a74-1034">Например, при помещении <xref:System.Diagnostics.EventLog> в конструктор для Form1 (который наследуется от <xref:System.Windows.Forms.Form>) свойству <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> <xref:System.Diagnostics.EventLog> присваивается экземпляр Form1.</span><span class="sxs-lookup"><span data-stu-id="92a74-1034">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1035">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1035">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1036">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1036">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-1037">Вносит запись в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1037">Writes an entry in the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string -&gt; unit" Usage="eventLog.WriteEntry message" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="92a74-1038">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1038">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="92a74-1039">Вносит в журнал событий запись сведений с заданным текстом сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1039">Writes an information type entry, with the given message text, to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1040">Используйте этот метод для записи информации в журнал событий, связанный с данным экземпляром <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1040">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="92a74-1041">Если необходимо указать другие <xref:System.Diagnostics.EventLogEntryType>, используйте другую перегрузку <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1041">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1042">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1042">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1043">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1043">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1044">Прежде чем можно будет записывать записи в журнал, необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1044">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="92a74-1045">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1045">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-1046">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1046">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1047">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1047">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1048">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1048">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1049">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1049">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1050">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1050">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1051">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A> данного экземпляра <xref:System.Diagnostics.EventLog>, не зарегистрирован на компьютере, куда записывается компонент, <xref:System.Diagnostics.EventLog.WriteEntry%2A> вызывает <xref:System.Diagnostics.EventLog.CreateEventSource%2A> и регистрирует источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1051">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1052">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.CreateEventSource%2A> или <xref:System.Diagnostics.EventLog.WriteEntry%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1052">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1053">Если системе необходимо зарегистрировать <xref:System.Diagnostics.EventLog.Source%2A> с помощью вызова метода <xref:System.Diagnostics.EventLog.WriteEntry%2A> и свойства <xref:System.Diagnostics.EventLog.Log%2A> не заданы в экземпляре <xref:System.Diagnostics.EventLog>, по умолчанию используется журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1053">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1054">Многие из перечисленных выше исключений генерируются ошибками, возникающими в процессе регистрации <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1054">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1055">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1055">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1056">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1056">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1057">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1057">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1058">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1058">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1059">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1059">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1060">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1060">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1061">При записи записи на удаленный компьютер значение сообщения (текстовая строка) может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1061">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1062">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1062">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1063">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-1063">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1064">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1064">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1065">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1065">-or-</span></span> 
<span data-ttu-id="92a74-1066">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1066">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1067">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1067">-or-</span></span> 
<span data-ttu-id="92a74-1068">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1068">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1069">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1069">-or-</span></span> 
<span data-ttu-id="92a74-1070">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1070">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1071">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1071">-or-</span></span> 
<span data-ttu-id="92a74-1072">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1072">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1073">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1073">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1074">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1074">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1075">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1075">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1076">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1076">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1077">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1077">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="eventLog.WriteEntry (message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="92a74-1078">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1078">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1079">Одно из значений перечисления <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1079">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="92a74-1080">Вносит в журнал событий следующие записи с заданным текстом сообщения: ошибка, предупреждение, сведения, аудит отказов или аудит успехов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1080">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1081">Используйте этот метод, чтобы записать запись указанного <xref:System.Diagnostics.EventLogEntryType> в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1081">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="92a74-1082">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1082">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1083">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1083">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1084">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1084">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1085">Прежде чем можно будет записывать записи в журнал, необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1085">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="92a74-1086">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1086">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-1087">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1087">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1088">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1088">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1089">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1089">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1090">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1090">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1091">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1091">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1092">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A> данного экземпляра <xref:System.Diagnostics.EventLog>, не зарегистрирован на компьютере, куда записывается компонент, <xref:System.Diagnostics.EventLog.WriteEntry%2A> вызывает <xref:System.Diagnostics.EventLog.CreateEventSource%2A> и регистрирует источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1092">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1093">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.CreateEventSource%2A> или <xref:System.Diagnostics.EventLog.WriteEntry%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1093">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1094">Если системе необходимо зарегистрировать <xref:System.Diagnostics.EventLog.Source%2A> с помощью вызова метода <xref:System.Diagnostics.EventLog.WriteEntry%2A> и свойства <xref:System.Diagnostics.EventLog.Log%2A> не заданы в экземпляре <xref:System.Diagnostics.EventLog>, по умолчанию используется журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1094">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1095">Многие исключения, перечисленные выше, генерируются ошибками, возникающими в процессе регистрации <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1095">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1096">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1096">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1097">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1097">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1098">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1098">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1099">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1099">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1100">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1100">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1101">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1101">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1102">При записи записи на удаленный компьютер значение сообщения (текстовая строка) может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1102">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1103">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1103">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1104">В следующем примере запись предупреждения записывается в журнал событий MyNewLog на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1104">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1105">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1105">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1106">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1106">-or-</span></span> 
<span data-ttu-id="92a74-1107">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1107">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1108">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1108">-or-</span></span> 
<span data-ttu-id="92a74-1109">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1109">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1110">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1110">-or-</span></span> 
<span data-ttu-id="92a74-1111">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1111">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1112">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1112">-or-</span></span> 
<span data-ttu-id="92a74-1113">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1113">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1114"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1114"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1115">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1115">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1116">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1116">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1117">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1117">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1118">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1118">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1119">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1119">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1120">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1120">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="92a74-1121">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1121">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="92a74-1122">Вносит в журнал событий запись сведений с заданным текстом сообщения, используя указанный зарегистрированный источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1122">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1123">Используйте этот метод для записи информации в журнал событий с помощью источника, который уже зарегистрирован в качестве источника события для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1123">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1124">Если необходимо указать другие <xref:System.Diagnostics.EventLogEntryType>, используйте другую перегрузку <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1124">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1125">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1125">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1126">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1126">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1127">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1127">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1128">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1128">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1129">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1129">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1130">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1130">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1131">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1131">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1132">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1132">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1133">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1133">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1134">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1134">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1135">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1135">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1136">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1136">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1137">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1137">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="92a74-1138">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1138">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1139">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1139">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1140">В следующем примере создается исходный `MySource`, если он еще не существует, и запись в журнал событий `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-1140">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1141">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1141">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1142">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1142">-or-</span></span> 
<span data-ttu-id="92a74-1143">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1143">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1144">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1144">-or-</span></span> 
<span data-ttu-id="92a74-1145">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1145">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1146">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1146">-or-</span></span> 
<span data-ttu-id="92a74-1147">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1147">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1148">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1148">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1149">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1149">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1150">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1150">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1151">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1151">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1152">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1152">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="92a74-1153">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1153">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1154">Одно из значений <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1154">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1155">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1155">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="92a74-1156">Вносит в журнал событий запись с заданным текстом сообщения и идентификатором события, который определяется приложением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1156">Writes an entry with the given message text and application-defined event identifier to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1157">Используйте этот метод для записи записи с определяемым приложением `eventID` в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1157">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="92a74-1158">`eventID` вместе с источником уникально идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1158">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="92a74-1159">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1159">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1160">Средства просмотра событий отображают эти строковые значения, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1160">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1161">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1161">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1162">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1162">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1163">В дополнение к идентификатору события можно указать <xref:System.Diagnostics.EventLogEntryType> события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1163">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1164">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1164">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1165">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1165">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1166">Прежде чем можно будет записывать записи в журнал, необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1166">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="92a74-1167">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1167">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-1168">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1168">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1169">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1169">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1170">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1170">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1171">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1171">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1172">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1172">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1173">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A> данного экземпляра <xref:System.Diagnostics.EventLog>, не зарегистрирован на компьютере, куда записывается компонент, <xref:System.Diagnostics.EventLog.WriteEntry%2A> вызывает <xref:System.Diagnostics.EventLog.CreateEventSource%2A> и регистрирует источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1173">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1174">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.CreateEventSource%2A> или <xref:System.Diagnostics.EventLog.WriteEntry%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1174">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1175">Если системе необходимо зарегистрировать <xref:System.Diagnostics.EventLog.Source%2A> с помощью вызова метода <xref:System.Diagnostics.EventLog.WriteEntry%2A> и свойства <xref:System.Diagnostics.EventLog.Log%2A> не заданы в экземпляре <xref:System.Diagnostics.EventLog>, по умолчанию используется журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1175">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1176">Многие исключения, перечисленные выше, генерируются ошибками, возникающими в процессе регистрации <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1176">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1177">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1177">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1178">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1178">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1179">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1179">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1180">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1180">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1181">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1181">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1182">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1182">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1183">При записи записи на удаленный компьютер значение сообщения (текстовая строка) может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1183">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1184">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1184">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1185">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1185">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1186">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1186">-or-</span></span> 
<span data-ttu-id="92a74-1187">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1187">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1188">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1188">-or-</span></span> 
<span data-ttu-id="92a74-1189">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1189">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1190">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1190">-or-</span></span> 
 <span data-ttu-id="92a74-1191"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1191"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1192">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1192">-or-</span></span> 
<span data-ttu-id="92a74-1193">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1193">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1194">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1194">-or-</span></span> 
<span data-ttu-id="92a74-1195">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1195">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1196">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1196">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1197"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1197"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1198">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1198">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1199">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1199">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1200">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1200">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1201">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1201">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1202">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1202">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="92a74-1203">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1203">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1204">Одно из значений <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1204">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="92a74-1205">Вносит в журнал событий, используя указанный зарегистрированный источник, следующие записи с заданным текстом сообщения: ошибка, предупреждение, сведения, аудит отказов или аудит успехов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1205">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1206">Этот метод используется для записи указанного <xref:System.Diagnostics.EventLogEntryType> в журнал событий с использованием источника, уже зарегистрированного в качестве источника событий для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1206">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1207">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1207">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1208">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1208">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1209">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1209">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1210">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1210">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1211">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1211">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1212">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1212">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1213">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1213">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1214">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1214">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1215">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1215">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1216">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1216">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1217">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1217">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1218">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1218">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1219">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1219">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1220">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1220">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1221">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1221">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1222">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1222">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1223">В следующем примере запись предупреждения записывается в журнал событий MyNewLog на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1223">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1224">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1224">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1225">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1225">-or-</span></span> 
<span data-ttu-id="92a74-1226">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1226">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1227">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1227">-or-</span></span> 
<span data-ttu-id="92a74-1228">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1228">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1229">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1229">-or-</span></span> 
<span data-ttu-id="92a74-1230">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1230">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1231">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1231">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1232"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1232"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1233">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1233">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1234">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1234">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1235">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1235">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1236">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1236">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="92a74-1237">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1237">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1238">Одно из значений <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1238">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1239">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1239">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="92a74-1240">Подкатегория конкретного приложения, связанная с сообщением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1240">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="92a74-1241">Вносит в журнал событий запись с заданным текстом сообщения, идентификатором события и категорией, которая определяется приложением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1241">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1242">Используйте этот метод для записи записи с определяемым приложением `category` в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1242">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="92a74-1243">Просмотр событий использует категорию для фильтрации событий, записанных источником событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1243">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="92a74-1244">Просмотр событий может отображать категорию в виде числового значения или использовать категорию в качестве идентификатора ресурса для вывода локализованной строки категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1244">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1245">Параметр `category` должен быть положительным значением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1245">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="92a74-1246">Отрицательные значения категории отображаются в Просмотр событий с дополнительным положительным числом.</span><span class="sxs-lookup"><span data-stu-id="92a74-1246">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="92a74-1247">Например,-10 отображается как 65 526, a – 1 как 65 535.</span><span class="sxs-lookup"><span data-stu-id="92a74-1247">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1248">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1248">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1249">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1249">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1250">Чтобы отобразить локализованные строки категории в Просмотр событий, необходимо использовать источник событий, настроенный с файлом ресурсов категории, и присвоить `category` идентификатору ресурса в файле ресурсов категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1250">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="92a74-1251">Если источник событий не имеет настроенного файла ресурсов категории или указанный `category` не индексирует строку в файле ресурсов категории, то Просмотр событий отображает числовое значение категории для этой записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-1251">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="92a74-1252">Настройте файл ресурсов категории, а также число строк категории в файле ресурсов с помощью <xref:System.Diagnostics.EventLogInstaller> или класса <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1252">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="92a74-1253">В дополнение к категории можно указать идентификатор события для события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1253">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1254">Идентификаторы событий, а также источник событий однозначно идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1254">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="92a74-1255">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1255">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1256">Средства просмотра событий отображают эти строковые значения, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1256">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="92a74-1257">Наконец, можно указать <xref:System.Diagnostics.EventLogEntryType> события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1257">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1258">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1258">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1259">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1259">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1260">Прежде чем можно будет записывать записи в журнал, необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1260">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="92a74-1261">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1261">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-1262">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1262">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1263">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1263">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1264">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1264">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1265">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1265">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1266">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1266">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1267">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A> данного экземпляра <xref:System.Diagnostics.EventLog>, не зарегистрирован на компьютере, куда записывается компонент, <xref:System.Diagnostics.EventLog.WriteEntry%2A> вызывает <xref:System.Diagnostics.EventLog.CreateEventSource%2A> и регистрирует источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1267">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1268">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.CreateEventSource%2A> или <xref:System.Diagnostics.EventLog.WriteEntry%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1268">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1269">Если системе необходимо зарегистрировать <xref:System.Diagnostics.EventLog.Source%2A> с помощью вызова метода <xref:System.Diagnostics.EventLog.WriteEntry%2A> и свойства <xref:System.Diagnostics.EventLog.Log%2A> не заданы в экземпляре <xref:System.Diagnostics.EventLog>, по умолчанию используется журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1269">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1270">Многие исключения, перечисленные выше, генерируются ошибками, возникающими в процессе регистрации <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1270">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1271">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1271">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1272">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1272">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1273">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1273">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1274">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1274">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1275">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1275">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1276">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1276">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1277">При записи записи на удаленный компьютер значение сообщения (текстовая строка) может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1277">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1278">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1278">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1279">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1279">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1280">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1280">-or-</span></span> 
<span data-ttu-id="92a74-1281">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1281">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1282">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1282">-or-</span></span> 
<span data-ttu-id="92a74-1283">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1283">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1284">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1284">-or-</span></span> 
 <span data-ttu-id="92a74-1285"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1285"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1286">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1286">-or-</span></span> 
<span data-ttu-id="92a74-1287">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1287">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1288">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1288">-or-</span></span> 
<span data-ttu-id="92a74-1289">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1289">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1290">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1290">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1291"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1291"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1292">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1292">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1293">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1293">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1294">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1294">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1295">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1295">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1296">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1296">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="92a74-1297">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1297">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1298">Одно из значений перечисления <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1298">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1299">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1299">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="92a74-1300">Вносит в журнал событий запись с заданным текстом сообщения и идентификатором события (который определяется приложением), используя указанный зарегистрированный источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1300">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1301">Используйте этот метод для записи записи с определяемым приложением `eventID` в журнал событий, используя источник, уже зарегистрированный в качестве источника событий для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1301">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1302">`eventID`, а также источник, однозначно идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1302">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="92a74-1303">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1303">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1304">Средства просмотра событий предоставляют пользователю эти строки, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1304">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1305">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1305">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1306">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1306">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="92a74-1307">В дополнение к идентификатору события, эта перегрузка <xref:System.Diagnostics.EventLog.WriteEntry%2A> позволяет указать <xref:System.Diagnostics.EventLogEntryType> для события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1307">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1308">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1308">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1309">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1309">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1310">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1310">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1311">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1311">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1312">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1312">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1313">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1313">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1314">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1314">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1315">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1315">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1316">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1316">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1317">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1317">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1318">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1318">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1319">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1319">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1320">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1320">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1321">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1321">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1322">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1322">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1323">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1323">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1324">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1324">-or-</span></span> 
<span data-ttu-id="92a74-1325">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1325">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1326">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1326">-or-</span></span> 
 <span data-ttu-id="92a74-1327"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1327"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1328">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1328">-or-</span></span> 
<span data-ttu-id="92a74-1329">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1329">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1330">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1330">-or-</span></span> 
<span data-ttu-id="92a74-1331">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1331">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1332">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1332">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1333"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1333"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1334">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1334">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1335">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1335">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1336">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1336">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1337">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1337">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="92a74-1338">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1338">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1339">Одно из значений перечисления <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1339">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1340">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1340">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="92a74-1341">Подкатегория конкретного приложения, связанная с сообщением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1341">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="92a74-1342">Массив байтов, в котором хранятся двоичные данные, связанные с записью.</span><span class="sxs-lookup"><span data-stu-id="92a74-1342">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1343">Вносит в журнал событий запись с заданным текстом сообщения, идентификатором события и категорией (которые определяются приложением), а затем добавляет в сообщение двоичные данные.</span><span class="sxs-lookup"><span data-stu-id="92a74-1343">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1344">Используйте эту перегрузку для записи определенных приложением данных о событиях в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1344">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="92a74-1345">Просмотр событий не интерпретирует эти данные; Он отображает необработанные данные только в комбинированном шестнадцатеричном и текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="92a74-1345">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="92a74-1346">Данные, относящиеся к событиям, следует использовать экономно, в том числе только в том случае, если вы уверены, что он будет полезен для отладки проблемы.</span><span class="sxs-lookup"><span data-stu-id="92a74-1346">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="92a74-1347">Можно также использовать данные событий для хранения информации, которую приложение может обрабатывать независимо от Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1347">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="92a74-1348">Например, можно написать средство просмотра, предназначенное для событий, или написать программу, которая сканирует файл журнала и создает отчеты, содержащие сведения из данных, относящихся к конкретному событию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1348">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="92a74-1349">Помимо двоичных данных, можно указать определяемую приложением категорию и идентификатор события, определяемый приложением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1349">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="92a74-1350">Просмотр событий использует категорию для фильтрации событий, записанных источником событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1350">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="92a74-1351">Просмотр событий может отображать категорию в виде числового значения или использовать категорию в качестве идентификатора ресурса для вывода локализованной строки категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1351">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1352">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1352">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1353">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1353">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1354">Параметр `category` должен быть положительным значением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1354">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="92a74-1355">Отрицательные значения категории отображаются в Просмотр событий с дополнительным положительным числом.</span><span class="sxs-lookup"><span data-stu-id="92a74-1355">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="92a74-1356">Например,-10 отображается как 65 526, a – 1 как 65 535.</span><span class="sxs-lookup"><span data-stu-id="92a74-1356">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="92a74-1357">Чтобы отобразить локализованные строки категории в Просмотр событий, необходимо использовать источник событий, настроенный с файлом ресурсов категории, и присвоить `category` идентификатору ресурса в файле ресурсов категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1357">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="92a74-1358">Если источник событий не имеет настроенного файла ресурсов категории или указанный `category` не индексирует строку в файле ресурсов категории, то Просмотр событий отображает числовое значение категории для этой записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-1358">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="92a74-1359">Настройте файл ресурсов категории, а также число строк категории в файле ресурсов с помощью <xref:System.Diagnostics.EventLogInstaller> или класса <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1359">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="92a74-1360">Идентификаторы событий, а также источник событий однозначно идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1360">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="92a74-1361">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1361">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1362">Средства просмотра событий отображают эти строковые значения, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1362">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="92a74-1363">Наконец, можно указать <xref:System.Diagnostics.EventLogEntryType> события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1363">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1364">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1364">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1365">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1365">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1366">Прежде чем можно будет записывать записи в журнал, необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1366">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="92a74-1367">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1367">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="92a74-1368">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1368">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1369">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1369">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1370">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1370">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1371">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1371">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1372">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1372">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1373">Если источник, указанный в свойстве <xref:System.Diagnostics.EventLog.Source%2A> данного экземпляра <xref:System.Diagnostics.EventLog>, не зарегистрирован на компьютере, куда записывается компонент, <xref:System.Diagnostics.EventLog.WriteEntry%2A> вызывает <xref:System.Diagnostics.EventLog.CreateEventSource%2A> и регистрирует источник.</span><span class="sxs-lookup"><span data-stu-id="92a74-1373">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1374">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.CreateEventSource%2A> или <xref:System.Diagnostics.EventLog.WriteEntry%2A>, предполагается локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1374">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1375">Если системе необходимо зарегистрировать <xref:System.Diagnostics.EventLog.Source%2A> с помощью вызова метода <xref:System.Diagnostics.EventLog.WriteEntry%2A> и свойства <xref:System.Diagnostics.EventLog.Log%2A> не заданы в экземпляре <xref:System.Diagnostics.EventLog>, по умолчанию используется журнал приложений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1375">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1376">Многие исключения, перечисленные выше, генерируются ошибками, возникающими в процессе регистрации <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1376">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="92a74-1377">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1377">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1378">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1378">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1379">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1379">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1380">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1380">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1381">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1381">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1382">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1382">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1383">При записи записи на удаленный компьютер значение сообщения (текстовая строка) может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1383">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1384">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1384">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1385">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1385">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1386">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1386">-or-</span></span> 
<span data-ttu-id="92a74-1387">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1387">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1388">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1388">-or-</span></span> 
<span data-ttu-id="92a74-1389">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1389">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1390">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1390">-or-</span></span> 
 <span data-ttu-id="92a74-1391"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1391"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1392">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1392">-or-</span></span> 
<span data-ttu-id="92a74-1393">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1393">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1394">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1394">-or-</span></span> 
<span data-ttu-id="92a74-1395">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1395">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1396">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1396">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1397"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1397"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1398">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1398">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1399">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1399">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1400">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1400">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1401">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1401">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1402">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1402">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="92a74-1403">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1403">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1404">Одно из значений перечисления <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1404">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1405">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1405">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="92a74-1406">Подкатегория конкретного приложения, связанная с сообщением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1406">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="92a74-1407">Вносит в журнал событий запись с заданным текстом сообщения и идентификатором события и категорией (которые определяется приложением), используя указанный зарегистрированный источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1407">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span></span> <span data-ttu-id="92a74-1408">С помощью <paramref name="category" /> осуществляется фильтрация событий журнала в компоненте "Просмотр событий".</span><span class="sxs-lookup"><span data-stu-id="92a74-1408">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1409">Используйте этот метод для записи записи с определяемым приложением `category` в журнал событий с помощью источника, который уже зарегистрирован в качестве источника события для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1409">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1410">Просмотр событий использует категорию для фильтрации событий, записанных источником событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1410">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="92a74-1411">Просмотр событий может отображать категорию в виде числового значения или использовать категорию в качестве идентификатора ресурса для вывода локализованной строки категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1411">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1412">Параметр `category` должен быть положительным значением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1412">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="92a74-1413">Отрицательные значения категории отображаются в Просмотр событий с дополнительным положительным числом.</span><span class="sxs-lookup"><span data-stu-id="92a74-1413">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="92a74-1414">Например,-10 отображается как 65 526, a – 1 как 65 535.</span><span class="sxs-lookup"><span data-stu-id="92a74-1414">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="92a74-1415">Чтобы отобразить локализованные строки категории в Просмотр событий, необходимо использовать источник событий, настроенный с файлом ресурсов категории, и присвоить `category` идентификатору ресурса в файле ресурсов категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1415">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="92a74-1416">Если источник событий не имеет настроенного файла ресурсов категории или указанный `category` не индексирует строку в файле ресурсов категории, то Просмотр событий отображает числовое значение категории для этой записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-1416">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="92a74-1417">Настройте файл ресурсов категории, а также число строк категории в файле ресурсов с помощью <xref:System.Diagnostics.EventLogInstaller> или класса <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1417">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="92a74-1418">В дополнение к категории можно указать идентификатор события для события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1418">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1419">Идентификаторы событий, а также источник событий однозначно идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1419">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="92a74-1420">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1420">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1421">Средства просмотра событий отображают эти строковые значения, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1421">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="92a74-1422">Наконец, можно указать <xref:System.Diagnostics.EventLogEntryType> события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1422">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1423">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1423">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1424">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1424">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1425">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1425">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1426">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1426">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1427">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1427">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1428">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1428">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1429">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1429">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1430">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1430">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1431">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1431">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1432">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1432">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1433">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1433">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1434">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1434">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1435">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1435">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1436">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1436">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1437">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1437">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="92a74-1438">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1438">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1439">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1439">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1440">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1440">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1441">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1441">-or-</span></span> 
<span data-ttu-id="92a74-1442">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1442">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1443">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1443">-or-</span></span> 
 <span data-ttu-id="92a74-1444"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1444"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1445">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1445">-or-</span></span> 
<span data-ttu-id="92a74-1446">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1446">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1447">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1447">-or-</span></span> 
<span data-ttu-id="92a74-1448">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1448">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1449">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1449">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1450"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1450"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1451">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1451">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1452">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1452">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1453">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1453">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1454">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1454">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1455">Источник, по которому приложение регистрируется на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1455">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="92a74-1456">Строка для записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1456">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="92a74-1457">Одно из значений перечисления <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1457">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="92a74-1458">Идентификатор для события, зависящий от приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1458">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="92a74-1459">Подкатегория конкретного приложения, связанная с сообщением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1459">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="92a74-1460">Массив байтов, в котором хранятся двоичные данные, связанные с записью.</span><span class="sxs-lookup"><span data-stu-id="92a74-1460">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1461">Вносит в журнал событий запись с заданным текстом сообщения, идентификатором события и категорией (которые определяются приложением), используя указанный зарегистрированный источник событий, а затем добавляет в сообщение двоичные данные.</span><span class="sxs-lookup"><span data-stu-id="92a74-1461">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1462">Этот метод используется для записи определяемых приложением данных событий в журнал событий с использованием источника, уже зарегистрированного в качестве источника событий для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1462">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1463">Просмотр событий не интерпретирует эти данные; Он отображает необработанные данные только в комбинированном шестнадцатеричном и текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="92a74-1463">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="92a74-1464">Используйте данные событий экономно. включайте его только в том случае, если вы уверены, что он будет полезен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1464">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="92a74-1465">Можно также использовать данные событий для хранения информации, которую приложение может обрабатывать независимо от Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1465">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="92a74-1466">Например, можно написать средство просмотра, предназначенное для событий, или написать программу, которая сканирует файл журнала и создает отчеты, содержащие сведения из данных, относящихся к конкретному событию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1466">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="92a74-1467">Помимо двоичных данных, можно указать определяемую приложением категорию и идентификатор события, определяемый приложением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1467">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="92a74-1468">Просмотр событий использует категорию для фильтрации событий, записанных источником событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1468">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="92a74-1469">Просмотр событий может отображать категорию в виде числового значения или использовать категорию в качестве идентификатора ресурса для вывода локализованной строки категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1469">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1470">Параметр `category` должен быть положительным значением.</span><span class="sxs-lookup"><span data-stu-id="92a74-1470">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="92a74-1471">Отрицательные значения категории отображаются в Просмотр событий с дополнительным положительным числом.</span><span class="sxs-lookup"><span data-stu-id="92a74-1471">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="92a74-1472">Например, значение-10 будет отображаться как 65 526, a – 1 как 65 535.</span><span class="sxs-lookup"><span data-stu-id="92a74-1472">For example, a -10 will appear as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="92a74-1473">Чтобы отобразить локализованные строки категории в Просмотр событий, необходимо использовать источник событий, настроенный с файлом ресурсов категории, и присвоить `category` идентификатору ресурса в файле ресурсов категории.</span><span class="sxs-lookup"><span data-stu-id="92a74-1473">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="92a74-1474">Если источник событий не имеет настроенного файла ресурсов категории или указанный `category` не индексирует строку в файле ресурсов категории, то Просмотр событий отображает числовое значение категории для этой записи.</span><span class="sxs-lookup"><span data-stu-id="92a74-1474">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="92a74-1475">Настройте файл ресурсов категории, а также число строк категории в файле ресурсов с помощью <xref:System.Diagnostics.EventLogInstaller> или класса <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1475">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="92a74-1476">Идентификаторы событий вместе с источником событий однозначно идентифицируют событие.</span><span class="sxs-lookup"><span data-stu-id="92a74-1476">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="92a74-1477">Каждое приложение может определять собственные нумерованные события и строки описания, с которыми они сопоставляются.</span><span class="sxs-lookup"><span data-stu-id="92a74-1477">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="92a74-1478">Средства просмотра событий отображают эти строковые значения, чтобы помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="92a74-1478">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="92a74-1479">Наконец, можно указать <xref:System.Diagnostics.EventLogEntryType> события, записываемого в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1479">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="92a74-1480">`type` обозначается значком и текстом в столбце Тип в Просмотр событий для журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1480">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="92a74-1481">Этот параметр указывает, является ли тип события "ошибка", "предупреждение", "информация", "успех аудита" или "сбой аудита".</span><span class="sxs-lookup"><span data-stu-id="92a74-1481">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="92a74-1482">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1482">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1483">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1483">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1484">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1484">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1485">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1485">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1486">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1486">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1487">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1487">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1488">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1488">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1489">Метод <xref:System.Diagnostics.EventLog.WriteEntry%2A> записывает заданную строку непосредственно в журнал событий; Он не использует файл ресурсов локализуемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1489">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="92a74-1490">Используйте метод <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи событий с помощью файла ресурсов локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1490">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="92a74-1491">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1491">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1492">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1492">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1493">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1493">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1494">Если параметр `message` содержит символ NUL, сообщение в журнале событий заканчивается символом NUL.</span><span class="sxs-lookup"><span data-stu-id="92a74-1494">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="92a74-1495">Строка `message` не может содержать%*n*, где *n* является целочисленным значением (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1495">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1496">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1496">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1497">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1497">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1498">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1498">-or-</span></span> 
<span data-ttu-id="92a74-1499">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1499">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1500">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1500">-or-</span></span> 
 <span data-ttu-id="92a74-1501"><paramref name="eventID" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1501"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1502">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1502">-or-</span></span> 
<span data-ttu-id="92a74-1503">Строка сообщения превышает 31,839 байт (32,766 байт в операционных системах Windows до Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="92a74-1503">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="92a74-1504">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1504">-or-</span></span> 
<span data-ttu-id="92a74-1505">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1505">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="92a74-1506"><paramref name="type" /> не является допустимым <see cref="T:System.Diagnostics.EventLogEntryType" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1506"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1507">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1507">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1508">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1508">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1509">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1509">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1510">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1510">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1511">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1511">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92a74-1512">Вносит записи локализованных событий в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1512">Writes a localized event entry to the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="values" Type="System.Object[]" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0">
          <Attributes>
            <Attribute FrameworkAlternate="dotnet-plat-ext-2.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="92a74-1513">Экземпляр <see cref="T:System.Diagnostics.EventInstance" />, который представляет локализованную запись журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1513">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="92a74-1514">Массив строк для слияния в текстовое сообщение записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1514">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1515">Вносит локализованные записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1515">Writes a localized entry to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1516">Этот метод используется для записи локализованной записи в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1516">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="92a74-1517">Свойства событий задаются с помощью идентификаторов ресурсов, а не строковых значений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1517">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="92a74-1518">Просмотр событий использует идентификаторы ресурсов для вывода соответствующих строк из локализованного файла ресурсов для <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1518">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="92a74-1519">Прежде чем записывать события с помощью идентификаторов ресурсов, необходимо зарегистрировать источник в соответствующем файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1519">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="92a74-1520">Входной `instance` экземпляр указывает сообщение и свойства события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1520">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="92a74-1521">Задайте <xref:System.Diagnostics.EventInstance.InstanceId%2A> `instance` входных данных для определенного сообщения в файле ресурсов исходного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1521">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="92a74-1522">При необходимости можно задать <xref:System.Diagnostics.EventInstance.CategoryId%2A> и <xref:System.Diagnostics.EventInstance.EntryType%2A> `instance` входные данные, чтобы определить категорию и тип события для записи события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1522">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="92a74-1523">Можно также указать массив строк, не зависящих от языка, для вставки в текст локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1523">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="92a74-1524">Установите `values` в значение `null`, если сообщение о событии не содержит заполнителей форматирования для строк замены.</span><span class="sxs-lookup"><span data-stu-id="92a74-1524">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="92a74-1525">Перед использованием <xref:System.Diagnostics.EventLog.WriteEvent%2A>необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> в компоненте <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1525">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="92a74-1526">Указанный источник должен быть настроен для записи локализованных записей в журнал; для источника должно быть задано по меньшей мере файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1526">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="92a74-1527">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1527">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1528">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1528">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1529">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1529">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1530">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1530">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1531">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1531">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1532">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1532">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1533">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1533">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1534">Используйте метод <xref:System.Diagnostics.EventLog.WriteEntry%2A>, если приложение записывает строковые значения непосредственно в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1534">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="92a74-1535">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1535">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1536">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1536">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1537">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1537">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1538">При записи записи на удаленный компьютер значение строки `message` может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1538">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="92a74-1539">Кроме того, строка `message` не может содержать%*n*, где *n* — целочисленное значение (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1539">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1540">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1540">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1541">В следующем примере две записи аудита записываются в журнал событий `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-1541">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="92a74-1542">В примере создается новый источник событий и новый журнал событий, если они не существуют на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1542">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="92a74-1543">Текст сообщения о событии указывается с помощью идентификатора ресурса в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1543">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="92a74-1544">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-1544">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-1545">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1545">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-1546">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-1546">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1547">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1547">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1548">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1548">-or-</span></span> 
<span data-ttu-id="92a74-1549">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1549">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1550">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1550">-or-</span></span> 
<span data-ttu-id="92a74-1551">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1551">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1552">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1552">-or-</span></span> 
 <span data-ttu-id="92a74-1553"><paramref name="instance.InstanceId" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1553"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1554">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1554">-or-</span></span> 
 <span data-ttu-id="92a74-1555"><paramref name="values" /> содержит более 256 элементов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1555"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="92a74-1556">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1556">-or-</span></span> 
<span data-ttu-id="92a74-1557">Один из элементов <paramref name="values" /> длиннее 32766 байт.</span><span class="sxs-lookup"><span data-stu-id="92a74-1557">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="92a74-1558">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1558">-or-</span></span> 
<span data-ttu-id="92a74-1559">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1559">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-1560">Свойство <paramref name="instance" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1560"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1561">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1561">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1562">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1562">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1563">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1563">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1564">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1564">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1565">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1565">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="data" Type="System.Byte[]" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="values" Type="System.Object[]" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0">
          <Attributes>
            <Attribute FrameworkAlternate="dotnet-plat-ext-2.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="92a74-1566">Экземпляр <see cref="T:System.Diagnostics.EventInstance" />, который представляет локализованную запись журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1566">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="92a74-1567">Массив байтов, в котором хранятся двоичные данные, связанные с записью.</span><span class="sxs-lookup"><span data-stu-id="92a74-1567">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="92a74-1568">Массив строк для слияния в текстовое сообщение записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1568">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1569">Заносит записи журнала событий с данными события, строками замещения сообщения и связанными двоичными данными.</span><span class="sxs-lookup"><span data-stu-id="92a74-1569">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1570">Используйте этот метод для записи локализованной записи с дополнительными данными о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1570">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="92a74-1571">Свойства событий задаются с помощью идентификаторов ресурсов, а не строковых значений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1571">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="92a74-1572">Просмотр событий использует идентификаторы ресурсов для вывода соответствующих строк из локализованного файла ресурсов для <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1572">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="92a74-1573">Прежде чем записывать события с помощью идентификаторов ресурсов, необходимо зарегистрировать источник в соответствующем файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1573">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="92a74-1574">Входной `instance` экземпляр указывает сообщение и свойства события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1574">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="92a74-1575">Задайте <xref:System.Diagnostics.EventInstance.InstanceId%2A> `instance` входных данных для определенного сообщения в файле ресурсов исходного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1575">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="92a74-1576">При необходимости можно задать <xref:System.Diagnostics.EventInstance.CategoryId%2A> и <xref:System.Diagnostics.EventInstance.EntryType%2A> `instance` входные данные, чтобы определить категорию и тип события для записи события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1576">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="92a74-1577">Можно также указать массив строк, не зависящих от языка, для вставки в текст локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1577">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="92a74-1578">Установите `values` в значение `null`, если сообщение о событии не содержит заполнителей форматирования для строк замены.</span><span class="sxs-lookup"><span data-stu-id="92a74-1578">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="92a74-1579">Укажите двоичные данные с событием, когда необходимо предоставить дополнительные сведения о событии.</span><span class="sxs-lookup"><span data-stu-id="92a74-1579">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="92a74-1580">Например, используйте параметр `data`, чтобы включить сведения об определенной ошибке.</span><span class="sxs-lookup"><span data-stu-id="92a74-1580">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="92a74-1581">Просмотр событий не интерпретирует связанные данные события; Он отображает данные в комбинированном шестнадцатеричном и текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="92a74-1581">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="92a74-1582">Используйте данные событий экономно. включайте его только в том случае, если вы уверены, что он будет полезен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1582">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="92a74-1583">Можно также использовать данные событий для хранения информации, которую приложение может обрабатывать независимо от Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1583">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="92a74-1584">Например, можно написать средство просмотра, предназначенное для событий, или написать программу, которая просматривает журнал событий и создает отчеты, содержащие сведения из данных, относящихся к конкретному событию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1584">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="92a74-1585">Перед использованием <xref:System.Diagnostics.EventLog.WriteEvent%2A>необходимо задать свойство <xref:System.Diagnostics.EventLog.Source%2A> для компонента <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1585">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="92a74-1586">Указанный источник должен быть настроен для записи локализованных записей в журнал; для источника должно быть задано по меньшей мере файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1586">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="92a74-1587">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1587">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1588">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1588">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1589">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1589">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1590">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1590">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1591">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1591">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1592">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1592">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1593">Если не указать <xref:System.Diagnostics.EventLog.MachineName%2A> для экземпляра <xref:System.Diagnostics.EventLog> перед вызовом <xref:System.Diagnostics.EventLog.WriteEvent%2A>, предполагается, что используется локальный компьютер (".").</span><span class="sxs-lookup"><span data-stu-id="92a74-1593">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="92a74-1594">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1594">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1595">Используйте метод <xref:System.Diagnostics.EventLog.WriteEntry%2A>, если приложение записывает строковые значения непосредственно в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1595">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="92a74-1596">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1596">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1597">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1597">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1598">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1598">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92a74-1599">При записи записи на удаленный компьютер значение строки `message` может отличаться от предполагаемого, если на удаленном компьютере не выполняется .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="92a74-1599">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="92a74-1600">Кроме того, строка `message` не может содержать%*n*, где *n* — целочисленное значение (например, %1), так как средство просмотра событий обрабатывает его как строку вставки.</span><span class="sxs-lookup"><span data-stu-id="92a74-1600">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="92a74-1601">Так как адрес протокола IP версии 6 (IPv6) может содержать эту последовательность символов, нельзя заносить в журнал сообщение о событии, содержащее IPv6-адрес.</span><span class="sxs-lookup"><span data-stu-id="92a74-1601">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1602">В следующем примере две записи аудита записываются в журнал событий `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="92a74-1602">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="92a74-1603">В примере создается новый источник событий и новый журнал событий, если они не существуют на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1603">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="92a74-1604">Текст сообщения о событии указывается с помощью идентификатора ресурса в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1604">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="92a74-1605">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-1605">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-1606">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1606">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-1607">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-1607">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1608">Не задано свойство <see cref="P:System.Diagnostics.EventLog.Source" /> класса <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1608">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="92a74-1609">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1609">-or-</span></span> 
<span data-ttu-id="92a74-1610">Метод пытается зарегистрировать новый источник событий, но имя компьютера в <see cref="P:System.Diagnostics.EventLog.MachineName" /> является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="92a74-1610">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="92a74-1611">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1611">-or-</span></span> 
<span data-ttu-id="92a74-1612">Источник уже зарегистрирован для различных журналов событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1612">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="92a74-1613">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1613">-or-</span></span> 
 <span data-ttu-id="92a74-1614"><paramref name="instance.InstanceId" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1614"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1615">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1615">-or-</span></span> 
 <span data-ttu-id="92a74-1616"><paramref name="values" /> содержит более 256 элементов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1616"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="92a74-1617">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1617">-or-</span></span> 
<span data-ttu-id="92a74-1618">Один из элементов <paramref name="values" /> длиннее 32766 байт.</span><span class="sxs-lookup"><span data-stu-id="92a74-1618">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="92a74-1619">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1619">-or-</span></span> 
<span data-ttu-id="92a74-1620">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1620">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-1621"><paramref name="instance" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1621"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1622">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1622">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1623">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1623">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1624">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1624">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1625">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1625">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1626">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1626">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="values" Type="System.Object[]" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0">
          <Attributes>
            <Attribute FrameworkAlternate="dotnet-plat-ext-2.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1627">Имя источника событий, зарегистрированного для приложения на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1627">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="92a74-1628">Экземпляр <see cref="T:System.Diagnostics.EventInstance" />, который представляет локализованную запись журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1628">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="92a74-1629">Массив строк для слияния в текстовое сообщение записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1629">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1630">Вносит в журнал событий запись с заданными данными сообщения и строками замещения сообщения, используя указанный зарегистрированный источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1630">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1631">Этот метод используется для записи локализованной записи в журнал событий с использованием источника, уже зарегистрированного в качестве источника событий для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1631">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1632">Свойства событий задаются с помощью идентификаторов ресурсов, а не строковых значений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1632">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="92a74-1633">Просмотр событий использует идентификаторы ресурсов для вывода соответствующих строк из локализованного файла ресурсов для источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1633">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="92a74-1634">Прежде чем записывать события с помощью идентификаторов ресурсов, необходимо зарегистрировать источник в соответствующем файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1634">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="92a74-1635">Входной `instance` экземпляр указывает сообщение и свойства события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1635">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="92a74-1636">Задайте <xref:System.Diagnostics.EventInstance.InstanceId%2A> `instance` входных данных для определенного сообщения в файле ресурсов исходного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1636">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="92a74-1637">При необходимости можно задать <xref:System.Diagnostics.EventInstance.CategoryId%2A> и <xref:System.Diagnostics.EventInstance.EntryType%2A> `instance` входные данные, чтобы определить категорию и тип события для записи события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1637">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="92a74-1638">Можно также указать массив строк, не зависящих от языка, для вставки в текст локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1638">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="92a74-1639">Установите `values` в значение `null`, если сообщение о событии не содержит заполнителей форматирования для строк замены.</span><span class="sxs-lookup"><span data-stu-id="92a74-1639">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="92a74-1640">Указанный источник должен быть зарегистрирован для журнала событий перед использованием <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1640">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="92a74-1641">Указанный источник должен быть настроен для записи локализованных записей в журнал; для источника должно быть задано по меньшей мере файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1641">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="92a74-1642">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1642">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1643">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1643">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1644">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1644">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1645">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1645">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1646">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1646">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1647">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1647">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1648">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1648">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1649">Используйте метод <xref:System.Diagnostics.EventLog.WriteEntry%2A>, если приложение записывает строковые значения непосредственно в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1649">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="92a74-1650">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1650">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1651">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1651">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1652">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1652">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1653">В следующем примере запись информационного события и запись события предупреждения записываются в существующий журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1653">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="92a74-1654">Текст сообщения о событии указывается с помощью идентификатора ресурса в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1654">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="92a74-1655">В этом примере предполагается, что соответствующий файл ресурсов был зарегистрирован для источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1655">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="92a74-1656">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-1656">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-1657">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1657">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-1658">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-1658">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1659">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1659">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1660">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1660">-or-</span></span> 
<span data-ttu-id="92a74-1661">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1661">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1662">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1662">-or-</span></span> 
 <span data-ttu-id="92a74-1663"><paramref name="instance.InstanceId" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1663"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1664">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1664">-or-</span></span> 
 <span data-ttu-id="92a74-1665"><paramref name="values" /> содержит более 256 элементов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1665"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="92a74-1666">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1666">-or-</span></span> 
<span data-ttu-id="92a74-1667">Один из элементов <paramref name="values" /> длиннее 32766 байт.</span><span class="sxs-lookup"><span data-stu-id="92a74-1667">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="92a74-1668">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1668">-or-</span></span> 
<span data-ttu-id="92a74-1669">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1669">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-1670">Свойство <paramref name="instance" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1670"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1671">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1671">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1672">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1672">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1673">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1673">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1674">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1674">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1675">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1675">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="data" Type="System.Byte[]" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="values" Type="System.Object[]" Index="3" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0">
          <Attributes>
            <Attribute FrameworkAlternate="dotnet-plat-ext-2.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="92a74-1676">Имя источника событий, зарегистрированного для приложения на заданном компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1676">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="92a74-1677">Экземпляр <see cref="T:System.Diagnostics.EventInstance" />, который представляет локализованную запись журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1677">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="92a74-1678">Массив байтов, в котором хранятся двоичные данные, связанные с записью.</span><span class="sxs-lookup"><span data-stu-id="92a74-1678">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="92a74-1679">Массив строк для слияния в текстовое сообщение записи журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1679">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="92a74-1680">Вносит в журнал событий запись с заданными данными сообщения, строками замещения сообщения и связанными двоичными данными, используя указанный зарегистрированный источник событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1680">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92a74-1681">Используйте этот метод для записи локализованной записи с дополнительными данными о событиях в журнал событий, используя источник, уже зарегистрированный в качестве источника событий для соответствующего журнала.</span><span class="sxs-lookup"><span data-stu-id="92a74-1681">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="92a74-1682">Свойства событий задаются с помощью идентификаторов ресурсов, а не строковых значений.</span><span class="sxs-lookup"><span data-stu-id="92a74-1682">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="92a74-1683">Просмотр событий использует идентификаторы ресурсов для вывода соответствующих строк из локализованного файла ресурсов для источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1683">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="92a74-1684">Прежде чем записывать события с помощью идентификаторов ресурсов, необходимо зарегистрировать источник в соответствующем файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1684">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="92a74-1685">Входной `instance` экземпляр указывает сообщение и свойства события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1685">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="92a74-1686">Задайте <xref:System.Diagnostics.EventInstance.InstanceId%2A> `instance` входных данных для определенного сообщения в файле ресурсов исходного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1686">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="92a74-1687">При необходимости можно задать <xref:System.Diagnostics.EventInstance.CategoryId%2A> и <xref:System.Diagnostics.EventInstance.EntryType%2A> `instance` входные данные, чтобы определить категорию и тип события для записи события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1687">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="92a74-1688">Можно также указать массив строк, не зависящих от языка, для вставки в текст локализованного сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1688">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="92a74-1689">Установите `values` в значение `null`, если сообщение о событии не содержит заполнителей форматирования для строк замены.</span><span class="sxs-lookup"><span data-stu-id="92a74-1689">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="92a74-1690">Укажите двоичные данные с событием, когда необходимо предоставить дополнительные сведения о событии.</span><span class="sxs-lookup"><span data-stu-id="92a74-1690">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="92a74-1691">Например, используйте параметр `data`, чтобы включить сведения об определенной ошибке.</span><span class="sxs-lookup"><span data-stu-id="92a74-1691">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="92a74-1692">Просмотр событий не интерпретирует связанные данные события; Он отображает данные в комбинированном шестнадцатеричном и текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="92a74-1692">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="92a74-1693">Используйте данные событий экономно. включайте его только в том случае, если вы уверены, что он будет полезен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1693">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="92a74-1694">Можно также использовать данные событий для хранения информации, которую приложение может обрабатывать независимо от Просмотр событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1694">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="92a74-1695">Например, можно написать средство просмотра, предназначенное для событий, или написать программу, которая просматривает журнал событий и создает отчеты, содержащие сведения из данных, относящихся к конкретному событию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1695">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="92a74-1696">Указанный источник должен быть зарегистрирован для журнала событий перед использованием <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1696">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="92a74-1697">Указанный источник должен быть настроен для записи локализованных записей в журнал; для источника должно быть задано по меньшей мере файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1697">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="92a74-1698">Перед записью первой записи с источником необходимо создать и настроить источник события.</span><span class="sxs-lookup"><span data-stu-id="92a74-1698">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="92a74-1699">Создайте новый источник событий во время установки приложения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1699">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="92a74-1700">Это позволяет операционной системе обновлять свой список зарегистрированных источников событий и их конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="92a74-1700">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="92a74-1701">Если операционная система не обновила список источников событий и вы пытаетесь написать событие с новым источником, операция записи завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="92a74-1701">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="92a74-1702">Новый источник можно настроить с помощью <xref:System.Diagnostics.EventLogInstaller>или с помощью метода <xref:System.Diagnostics.EventLog.CreateEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="92a74-1702">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="92a74-1703">Для создания нового источника событий необходимо иметь права администратора на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1703">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="92a74-1704">Источник должен быть настроен либо для записи локализованных записей, либо для записи прямых строк.</span><span class="sxs-lookup"><span data-stu-id="92a74-1704">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="92a74-1705">Используйте метод <xref:System.Diagnostics.EventLog.WriteEntry%2A>, если приложение записывает строковые значения непосредственно в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1705">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="92a74-1706">Если приложение записывает записи, используя как идентификаторы ресурсов, так и строковые значения, необходимо зарегистрировать два отдельных источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1706">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="92a74-1707">Например, можно настроить один источник с файлами ресурсов, а затем использовать этот источник в методе <xref:System.Diagnostics.EventLog.WriteEvent%2A> для записи записей с использованием идентификаторов ресурсов в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1707">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="92a74-1708">Затем создайте другой источник без файлов ресурсов и используйте этот источник в методе <xref:System.Diagnostics.EventLog.WriteEntry%2A> для записи строк непосредственно в журнал событий с помощью этого источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1708">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92a74-1709">В следующем примере запись информационного события и запись события предупреждения записываются в существующий журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1709">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="92a74-1710">Текст сообщения о событии указывается с помощью идентификатора ресурса в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1710">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="92a74-1711">В этом примере предполагается, что соответствующий файл ресурсов был зарегистрирован для источника.</span><span class="sxs-lookup"><span data-stu-id="92a74-1711">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="92a74-1712">В примере используется следующий текстовый файл сообщения, встроенный в библиотеку ресурсов Евентлогмсгс. dll.</span><span class="sxs-lookup"><span data-stu-id="92a74-1712">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="92a74-1713">Текстовый файл сообщения — это источник, из которого создается файл ресурсов сообщения.</span><span class="sxs-lookup"><span data-stu-id="92a74-1713">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="92a74-1714">В текстовом файле сообщения определяются идентификаторы ресурсов и текст для категории, сообщения о событии и строки вставки параметров.</span><span class="sxs-lookup"><span data-stu-id="92a74-1714">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92a74-1715">Значением <paramref name="source" /> является пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="92a74-1715">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="92a74-1716">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1716">-or-</span></span> 
<span data-ttu-id="92a74-1717">Значение <paramref name="source" /> равно <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1717">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="92a74-1718">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1718">-or-</span></span> 
 <span data-ttu-id="92a74-1719"><paramref name="instance.InstanceId" /> меньше нуля или больше <see cref="F:System.UInt16.MaxValue" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1719"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="92a74-1720">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1720">-or-</span></span> 
 <span data-ttu-id="92a74-1721"><paramref name="values" /> содержит более 256 элементов.</span><span class="sxs-lookup"><span data-stu-id="92a74-1721"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="92a74-1722">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1722">-or-</span></span> 
<span data-ttu-id="92a74-1723">Один из элементов <paramref name="values" /> длиннее 32766 байт.</span><span class="sxs-lookup"><span data-stu-id="92a74-1723">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="92a74-1724">- или -</span><span class="sxs-lookup"><span data-stu-id="92a74-1724">-or-</span></span> 
<span data-ttu-id="92a74-1725">При таком имени источника длина пути к разделу реестра превышает 254 символа.</span><span class="sxs-lookup"><span data-stu-id="92a74-1725">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92a74-1726">Свойство <paramref name="instance" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="92a74-1726"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="92a74-1727">Не удается открыть раздел реестра для журнала событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1727">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="92a74-1728">Операционная система сообщила об ошибке при записи сведений о событии в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="92a74-1728">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="92a74-1729">Код ошибки Windows недоступен.</span><span class="sxs-lookup"><span data-stu-id="92a74-1729">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="92a74-1730">для записи сведений журнала событий на компьютере.</span><span class="sxs-lookup"><span data-stu-id="92a74-1730">for writing the event log information on the computer.</span></span> <span data-ttu-id="92a74-1731">Связанное перечисление: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="92a74-1731">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>
