<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <Metadata><Meta Name="ms.openlocfilehash" Value="811421d63f59291395e6acc542f3d1bf00d3e3ed" /><Meta Name="ms.sourcegitcommit" Value="055a4a82a0b08bfbdc21bd1347fb71f7fe2c099e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="08/15/2019" /><Meta Name="ms.locfileid" Value="69382627" /></Metadata><TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <TypeSignature Language="F#" Value="type MessageQueue = class&#xA;    inherit Component&#xA;    interface IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.MessageQueueInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Messaging.MessagingDescription("MessageQueueDesc")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="25e03-101">Предоставляет доступ к очереди на сервере MSMQ.</span><span class="sxs-lookup"><span data-stu-id="25e03-101">Provides access to a queue on a Message Queuing server.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-102">Технология очередей сообщений позволяет приложениям, работающим в разное время, взаимодействовать через разнородные сети и системы, которые могут быть временно автономными.</span><span class="sxs-lookup"><span data-stu-id="25e03-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="25e03-103">Приложения отправляют, получают или считывают (чтение без удаления) сообщения из очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="25e03-104">Служба очереди сообщений является необязательным компонентом [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] и Windows NT и должна устанавливаться отдельно.</span><span class="sxs-lookup"><span data-stu-id="25e03-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="25e03-105"><xref:System.Messaging.MessageQueue> Класс является оболочкой для очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="25e03-106">Существует несколько версий очереди сообщений, и использование <xref:System.Messaging.MessageQueue> класса может немного различно повлиять на поведение в зависимости от используемой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="25e03-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="25e03-107">Сведения о конкретных функциях каждой версии очереди сообщений см. в разделе «новые возможности очереди сообщений» пакета Platform SDK на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="25e03-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="25e03-108"><xref:System.Messaging.MessageQueue> Класс предоставляет ссылку на очередь очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="25e03-109">Можно указать путь в <xref:System.Messaging.MessageQueue.%23ctor%2A> конструкторе для подключения к существующему ресурсу или создать новую очередь на сервере.</span><span class="sxs-lookup"><span data-stu-id="25e03-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="25e03-110">Прежде чем можно будет <xref:System.Messaging.MessageQueue.Send%28System.Object%29>вызвать <xref:System.Messaging.MessageQueue.Peek%2A>метод, <xref:System.Messaging.MessageQueue.Receive%2A>или, необходимо связать новый экземпляр <xref:System.Messaging.MessageQueue> класса с существующей очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="25e03-111">На этом этапе можно манипулировать свойствами очереди, такими как <xref:System.Messaging.MessageQueue.Category%2A> и. <xref:System.Messaging.MessageQueue.Label%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="25e03-112"><xref:System.Messaging.MessageQueue>поддерживает два типа извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="25e03-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="25e03-113">Синхронные методы, <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, вызывают поток процесса для ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-114">Асинхронные методы и <xref:System.Messaging.MessageQueue.BeginPeek%2A> <xref:System.Messaging.MessageQueue.BeginReceive%2A>позволяют основным задачам приложения продолжать работу в отдельном потоке, пока в очередь не поступит сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="25e03-115">Эти методы работают, используя объекты обратного вызова и объекты состояния для обмена данными между потоками.</span><span class="sxs-lookup"><span data-stu-id="25e03-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="25e03-116">При создании нового экземпляра <xref:System.Messaging.MessageQueue> класса новая очередь очередей сообщений не создается.</span><span class="sxs-lookup"><span data-stu-id="25e03-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="25e03-117">Вместо этого можно использовать <xref:System.Messaging.MessageQueue.Create%28System.String%29>методы, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>и <xref:System.Messaging.MessageQueue.Purge%2A> для управления очередями на сервере.</span><span class="sxs-lookup"><span data-stu-id="25e03-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="25e03-118">В отличие <xref:System.Messaging.MessageQueue.Purge%2A>от <xref:System.Messaging.MessageQueue.Create%28System.String%29> , <xref:System.Messaging.MessageQueue.Delete%28System.String%29> и являются`static` членами, поэтому их можно вызывать без создания нового экземпляра <xref:System.Messaging.MessageQueue> класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="25e03-119"><xref:System.Messaging.MessageQueue> <xref:System.Messaging.MessageQueue.Label%2A>Свойство объекта можно задать с помощью одного из трех имен: понятное имя, <xref:System.Messaging.MessageQueue.FormatName%2A>или. <xref:System.Messaging.MessageQueue.Path%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="25e03-120">Понятное имя <xref:System.Messaging.MessageQueue.MachineName%2A> , определяемое свойствами очереди и <xref:System.Messaging.MessageQueue.MachineName%2A> \\ <xref:System.Messaging.MessageQueue.QueueName%2A> , предназначено <xref:System.Messaging.MessageQueue.MachineName%2A> <xref:System.Messaging.MessageQueue.QueueName%2A> для общей очереди и \\ `Private$` \\ <xref:System.Messaging.MessageQueue.QueueName%2A> для частной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="25e03-121"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство разрешает автономный доступ к очередям сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="25e03-122">Наконец, можно использовать <xref:System.Messaging.MessageQueue.Label%2A> свойство очереди, чтобы задать значение <xref:System.Messaging.MessageQueue.Path%2A>очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="25e03-123">Список начальных значений свойств для экземпляра <xref:System.Messaging.MessageQueue>см. в <xref:System.Messaging.MessageQueue.%23ctor%2A> разделе Конструктор.</span><span class="sxs-lookup"><span data-stu-id="25e03-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-124">В следующем примере кода создаются новые <xref:System.Messaging.MessageQueue> объекты с использованием различных типов синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="25e03-125">В каждом случае он отправляет сообщение в очередь, путь которой определен в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="25e03-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="25e03-126">Следующий пример кода отправляет сообщение в очередь и получает сообщение из очереди, используя класс, зависящий от приложения, с именем `Order`.</span><span class="sxs-lookup"><span data-stu-id="25e03-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe><span data-ttu-id="25e03-127"><see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> Только метод является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span></span></threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-128">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-129">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span> <span data-ttu-id="25e03-130">После того как конструктор без параметров инициализирует новый экземпляр, необходимо задать свойство <see cref="P:System.Messaging.MessageQueue.Path" /> экземпляра, прежде чем можно будет использовать этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="25e03-130">After the parameterless constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-131">Используйте эту перегрузку для создания нового экземпляра <xref:System.Messaging.MessageQueue> класса, который не привязывается сразу к очереди на сервере очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="25e03-132">Перед использованием этого экземпляра необходимо подключить его к существующей очереди очереди сообщений, задав <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="25e03-133">Кроме того, можно задать <xref:System.Messaging.MessageQueue> ссылку <xref:System.Messaging.MessageQueue.Create%28System.String%29> на возвращаемое значение метода, тем самым создавая новую очередь очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="25e03-134">Конструктор создает экземпляр <xref:System.Messaging.MessageQueue> нового класса; он не создает новую очередь очереди сообщений. <xref:System.Messaging.MessageQueue.%23ctor%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="25e03-135">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="25e03-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="25e03-136">Свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-136">Property</span></span>|<span data-ttu-id="25e03-137">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="25e03-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="25e03-138">Значения, заданные конструктором <xref:System.Messaging.DefaultPropertiesToSend> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-138">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="25e03-139">Значения, заданные конструктором <xref:System.Messaging.MessagePropertyFilter> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-139">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="25e03-140">Все значения фильтра имеют значение `true`.</span><span class="sxs-lookup"><span data-stu-id="25e03-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-141">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue>объект.</span><span class="sxs-lookup"><span data-stu-id="25e03-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue path" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-142">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></param>
        <summary><span data-ttu-id="25e03-143">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-144">Используйте эту перегрузку, если требуется связать новый <xref:System.Messaging.MessageQueue> экземпляр с определенной очередью очереди сообщений, для которой известно имя формата или метка.</span><span class="sxs-lookup"><span data-stu-id="25e03-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="25e03-145">Если вы хотите предоставить эксклюзивный доступ к первому приложению, которое ссылается на очередь, необходимо задать <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> для `true` свойства значение или использовать конструктор, передающий параметр ограничения доступа для чтения.</span><span class="sxs-lookup"><span data-stu-id="25e03-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="25e03-146">Конструктор создает экземпляр <xref:System.Messaging.MessageQueue> нового класса; он не создает новую очередь очереди сообщений. <xref:System.Messaging.MessageQueue.%23ctor%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="25e03-147">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="25e03-148">Синтаксис `path` параметра зависит от типа очереди, на которую он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-149">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-149">Queue type</span></span>|<span data-ttu-id="25e03-150">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-151">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-152">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="25e03-153">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="25e03-154">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="25e03-155">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="25e03-156">Очередь недоставленных транзактных сообщений на компьютере</span><span class="sxs-lookup"><span data-stu-id="25e03-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="25e03-157">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-158">Справочники</span><span class="sxs-lookup"><span data-stu-id="25e03-158">Reference</span></span>|<span data-ttu-id="25e03-159">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-159">Syntax</span></span>|<span data-ttu-id="25e03-160">Пример</span><span class="sxs-lookup"><span data-stu-id="25e03-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="25e03-161">Название формата</span><span class="sxs-lookup"><span data-stu-id="25e03-161">Format name</span></span>|<span data-ttu-id="25e03-162">`FormatName:`[ *Формат имя* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="25e03-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="25e03-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="25e03-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="25e03-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="25e03-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="25e03-167">Метка</span><span class="sxs-lookup"><span data-stu-id="25e03-167">Label</span></span>|<span data-ttu-id="25e03-168">`Label:`[ *Метка* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="25e03-169">`Label:`селабел</span><span class="sxs-lookup"><span data-stu-id="25e03-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="25e03-170">Для работы в автономном режиме необходимо использовать синтаксис имени формата, а не синтаксис имени пути для конструктора.</span><span class="sxs-lookup"><span data-stu-id="25e03-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="25e03-171">В противном случае создается исключение, так как основной контроллер домена недоступен для разрешения пути к имени формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="25e03-172">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="25e03-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-173">Эти значения основываются на свойствах очереди сообщений и пути, заданном `path` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="25e03-174">Свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-174">Property</span></span>|<span data-ttu-id="25e03-175">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="25e03-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="25e03-176">0</span><span class="sxs-lookup"><span data-stu-id="25e03-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="25e03-177">Значения, заданные конструктором <xref:System.Messaging.DefaultPropertiesToSend> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-177">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="25e03-178">`true`значение, если уровень конфиденциальности очереди сообщений — "Body"; в противном случае —. `false`</span><span class="sxs-lookup"><span data-stu-id="25e03-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="25e03-179">Значение свойства "имя компьютера очереди сообщений".</span><span class="sxs-lookup"><span data-stu-id="25e03-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="25e03-180">Значения, заданные конструктором <xref:System.Messaging.MessagePropertyFilter> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-180">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="25e03-181"><xref:System.String.Empty>значение, если не задано конструктором.</span><span class="sxs-lookup"><span data-stu-id="25e03-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="25e03-182"><xref:System.String.Empty>значение, если не задано конструктором.</span><span class="sxs-lookup"><span data-stu-id="25e03-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="25e03-183">`true`значение, если включен параметр журнала объекта очереди сообщений. в противном случае —. `false`</span><span class="sxs-lookup"><span data-stu-id="25e03-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-184">В следующем примере кода создаются новые <xref:System.Messaging.MessageQueue> объекты с использованием различных типов синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="25e03-185">В каждом случае он отправляет сообщение в очередь, путь которой определен в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="25e03-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-186">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="25e03-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-187">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="25e03-188">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-188"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="25e03-189">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути и с указанным ограничением доступа на чтение.</span><span class="sxs-lookup"><span data-stu-id="25e03-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-190">Используйте эту перегрузку, если требуется связать новую <xref:System.Messaging.MessageQueue> с определенной очередью очереди сообщений, для которой известно расположение, имя формата или метку.</span><span class="sxs-lookup"><span data-stu-id="25e03-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="25e03-191">Если вы хотите предоставить эксклюзивный доступ к первому приложению, которое ссылается на очередь, задайте `sharedModeDenyReceive` для `true`параметра значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="25e03-192">В противном `sharedModeDenyReceive` случае `false` задайте для значение или используйте `path` конструктор, который содержит только параметр.</span><span class="sxs-lookup"><span data-stu-id="25e03-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="25e03-193">Параметр `sharedModeDenyReceive` влияет `true` на все объекты, обращающиеся к очереди очереди сообщений, включая другие приложения.</span><span class="sxs-lookup"><span data-stu-id="25e03-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="25e03-194">Эффекты параметра не ограничиваются этим приложением.</span><span class="sxs-lookup"><span data-stu-id="25e03-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="25e03-195">Конструктор создает новый экземпляр <xref:System.Messaging.MessageQueue> класса; он не создает новую очередь очереди сообщений. <xref:System.Messaging.MessageQueue.%23ctor%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="25e03-196">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="25e03-197">Синтаксис `path` параметра зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="25e03-198">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-198">Queue type</span></span>|<span data-ttu-id="25e03-199">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-200">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-201">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="25e03-202">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="25e03-203">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="25e03-204">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="25e03-205">Очередь недоставленных транзактных сообщений на компьютере</span><span class="sxs-lookup"><span data-stu-id="25e03-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="25e03-206">Кроме того, для описания пути очереди можно использовать имя формата или метку очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="25e03-207">Справочник</span><span class="sxs-lookup"><span data-stu-id="25e03-207">Reference</span></span>|<span data-ttu-id="25e03-208">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-208">Syntax</span></span>|<span data-ttu-id="25e03-209">Пример</span><span class="sxs-lookup"><span data-stu-id="25e03-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="25e03-210">Название формата</span><span class="sxs-lookup"><span data-stu-id="25e03-210">Format name</span></span>|<span data-ttu-id="25e03-211">`FormatName:`[ *Формат имя* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="25e03-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="25e03-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="25e03-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="25e03-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="25e03-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="25e03-216">Метка</span><span class="sxs-lookup"><span data-stu-id="25e03-216">Label</span></span>|<span data-ttu-id="25e03-217">`Label:`[ *Метка* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="25e03-218">`Label:`селабел</span><span class="sxs-lookup"><span data-stu-id="25e03-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="25e03-219">Для работы в автономном режиме необходимо использовать синтаксис имени формата, а не синтаксис понятного имени.</span><span class="sxs-lookup"><span data-stu-id="25e03-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="25e03-220">В противном случае создается исключение, так как основной контроллер домена (на котором размещается Active Directory) недоступен для разрешения пути к имени формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="25e03-221">`true` <xref:System.Messaging.MessageQueueException> <xref:System.Messaging.MessageQueue> Если при `sharedModeDenyReceive` открытии очереди с параметром задано значение, то все, что попытается выполнить чтение из очереди, порождает ошибку из-за нарушения общего доступа. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="25e03-222">Кроме того, исключение возникает, <xref:System.Messaging.MessageQueue> если объект пытается получить доступ к очереди в монопольном <xref:System.Messaging.MessageQueue> режиме, в то время как другой уже имеет немонопольный доступ к очереди. <xref:System.Messaging.MessageQueueException></span><span class="sxs-lookup"><span data-stu-id="25e03-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="25e03-223">В следующей таблице показаны начальные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="25e03-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-224">Эти значения основываются на свойствах очереди очереди сообщений с указанием пути, указанного `path` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="25e03-225">Свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-225">Property</span></span>|<span data-ttu-id="25e03-226">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="25e03-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="25e03-227">`false`.</span><span class="sxs-lookup"><span data-stu-id="25e03-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="25e03-228">0.</span><span class="sxs-lookup"><span data-stu-id="25e03-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="25e03-229"><xref:System.Guid.Empty>.</span><span class="sxs-lookup"><span data-stu-id="25e03-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="25e03-230">Значения, заданные конструктором <xref:System.Messaging.DefaultPropertiesToSend> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-230">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="25e03-231">`true`значение, если уровень конфиденциальности очереди сообщений — "Body"; в противном случае —. `false`</span><span class="sxs-lookup"><span data-stu-id="25e03-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="25e03-232"><xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="25e03-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="25e03-233"><xref:System.String.Empty>.</span><span class="sxs-lookup"><span data-stu-id="25e03-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="25e03-234">Значение свойства "имя компьютера очереди сообщений".</span><span class="sxs-lookup"><span data-stu-id="25e03-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="25e03-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="25e03-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="25e03-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="25e03-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="25e03-237">Значения, заданные конструктором <xref:System.Messaging.MessagePropertyFilter> без параметров класса.</span><span class="sxs-lookup"><span data-stu-id="25e03-237">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="25e03-238"><xref:System.String.Empty>значение, если не задано конструктором.</span><span class="sxs-lookup"><span data-stu-id="25e03-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="25e03-239"><xref:System.String.Empty>значение, если не задано конструктором.</span><span class="sxs-lookup"><span data-stu-id="25e03-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="25e03-240">Значение параметра `sharedModeDenyReceive`.</span><span class="sxs-lookup"><span data-stu-id="25e03-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="25e03-241">`true`значение, если включен параметр журнала объекта очереди сообщений. в противном случае —. `false`</span><span class="sxs-lookup"><span data-stu-id="25e03-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-242">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом, устанавливается его путь и отправляется сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-243">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="25e03-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-244">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="accessMode"><span data-ttu-id="25e03-245">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="25e03-246">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-247">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="25e03-248">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-248"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="25e03-249">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-249"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="25e03-250">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="25e03-251">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом на чтение и включенным кэшированием подключений.</span><span class="sxs-lookup"><span data-stu-id="25e03-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-252">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="25e03-253">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-253"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="25e03-254">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-254"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <param name="accessMode"><span data-ttu-id="25e03-255">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="25e03-256">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberSignature Language="F#" Value="member this.AccessMode : System.Messaging.QueueAccessMode" Usage="System.Messaging.MessageQueue.AccessMode" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-257">Получает значение, указывающее режим доступа для очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-257">Gets a value that indicates the access mode for the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-258">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-259">Режим доступа по умолчанию для очереди — `QueueAccessMode.SendAndReceive`, если не указано иное при вызове конструктора.</span><span class="sxs-lookup"><span data-stu-id="25e03-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.Authenticate : bool with get, set" Usage="System.Messaging.MessageQueue.Authenticate" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-260">Получает или задает значение, показывающее, принимает ли очередь только сообщения, прошедшие проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="25e03-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span></span></summary>
        <value><span data-ttu-id="25e03-261">Значение <see langword="true" />, если очередь принимает только сообщения, прошедшие проверку подлинности; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-261"><see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="25e03-262">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-262">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-263">Проверка подлинности сообщений позволяет обеспечить целостность сообщений и проверить, кто отправил сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="25e03-264">Чтобы запросить проверку подлинности, отправляющее приложение устанавливает уровень проверки подлинности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="25e03-265">Если задано <xref:System.Messaging.MessageQueue.Authenticate%2A> значение `true`, доступ к очереди на сервере ограничен, а не только с этим <xref:System.Messaging.MessageQueue> экземпляром.</span><span class="sxs-lookup"><span data-stu-id="25e03-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="25e03-266">Все клиенты, работающие с одной и той же очередью очереди сообщений, будут затронуты.</span><span class="sxs-lookup"><span data-stu-id="25e03-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="25e03-267">Очередь, принимающая только сообщения, прошедшие проверку подлинности, отклоняет сообщение без проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="25e03-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="25e03-268">Чтобы запросить уведомление о отклонении сообщений, в отправляющем приложении может быть <xref:System.Messaging.Message.AcknowledgeType%2A> задано свойство сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="25e03-269">Поскольку никакое другое указание о отклонении сообщений не существует, отправляющее приложение может потерять сообщение, если только не запрашивается его отправка в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="25e03-270">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-271">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-271">Workgroup mode</span></span>|<span data-ttu-id="25e03-272">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-273">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-273">Local computer</span></span>|<span data-ttu-id="25e03-274">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-274">Yes</span></span>|  
|<span data-ttu-id="25e03-275">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-275">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-276">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-276">Yes</span></span>|  
|<span data-ttu-id="25e03-277">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-277">Remote computer</span></span>|<span data-ttu-id="25e03-278">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-278">No</span></span>|  
|<span data-ttu-id="25e03-279">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-279">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-280">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-281">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.Authenticate%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-282">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-282">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberSignature Language="F#" Value="member this.BasePriority : int16 with get, set" Usage="System.Messaging.MessageQueue.BasePriority" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-283">Получает или задает базовый приоритет, используемый службой очереди сообщений для маршрутизации сообщений общей очереди по сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span></span></summary>
        <value><span data-ttu-id="25e03-284">Элементарный базовый приоритет для всех сообщений, переданных в общую очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-284">The single base priority for all messages sent to the (public) queue.</span></span> <span data-ttu-id="25e03-285">Значение по умолчанию равно нулю (0).</span><span class="sxs-lookup"><span data-stu-id="25e03-285">The default is zero (0).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-286">Базовый приоритет очереди сообщений определяет способ обработки маршрута сообщения к этой очереди по мере передачи по сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="25e03-287">Можно задать <xref:System.Messaging.MessageQueue.BasePriority%2A> для свойства значение более высокий или низкий приоритет для всех сообщений, отправляемых в указанную очередь, чем отправленные в другие очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="25e03-288">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-289">В связи с этим <xref:System.Messaging.MessageQueue> изменение затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="25e03-290">Очередь <xref:System.Messaging.MessageQueue.BasePriority%2A> сообщений не связана <xref:System.Messaging.Message.Priority%2A> со свойством сообщения, которое указывает порядок, в котором входящее сообщение помещается в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="25e03-291"><xref:System.Messaging.MessageQueue.BasePriority%2A>применяется только к общим очередям, пути которых указаны с использованием имени формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="25e03-292">Базовый приоритет частной очереди всегда равен нулю (0).</span><span class="sxs-lookup"><span data-stu-id="25e03-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="25e03-293">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-294">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-294">Workgroup mode</span></span>|<span data-ttu-id="25e03-295">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-296">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-296">Local computer</span></span>|<span data-ttu-id="25e03-297">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-297">Yes</span></span>|  
|<span data-ttu-id="25e03-298">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-298">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-299">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-299">Yes</span></span>|  
|<span data-ttu-id="25e03-300">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-300">Remote computer</span></span>|<span data-ttu-id="25e03-301">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-301">No</span></span>|  
|<span data-ttu-id="25e03-302">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-302">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-303">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-304">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.BasePriority%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-305">Для базового приоритета задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-305">The base priority was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-306">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-306">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="25e03-307">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-307">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="25e03-308">Инициирует асинхронную операцию считывания, указывая службе MSMQ на необходимость запуска операции считывания сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : unit -&gt; IAsyncResult" Usage="messageQueue.BeginPeek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-309">Инициирует асинхронную операцию считывания, не имеющую тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-310">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-311">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события при появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="25e03-312"><xref:System.Messaging.MessageQueue.PeekCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-313">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, обрабатывающий результаты асинхронной операции, и свяжите его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A>инициирует асинхронную операцию просмотра. уведомляется, вызывая <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-315">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызвав или извлекая результат с помощью <xref:System.Messaging.PeekCompletedEventArgs>. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-316"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-317">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-318">Для синхронного просмотра очереди используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-319">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-320">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-321">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-322">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-323">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-324">Если <xref:System.Messaging.MessageQueue.CanRead%2A> параметр `false`имеет значение, вызывается событие завершения, но при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-325">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-326">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-326">Workgroup mode</span></span>|<span data-ttu-id="25e03-327">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-328">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-328">Local computer</span></span>|<span data-ttu-id="25e03-329">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-329">Yes</span></span>|  
|<span data-ttu-id="25e03-330">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-330">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-331">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-331">Yes</span></span>|  
|<span data-ttu-id="25e03-332">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-332">Remote computer</span></span>|<span data-ttu-id="25e03-333">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-333">No</span></span>|  
|<span data-ttu-id="25e03-334">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-334">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-335">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-336">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, который прикрепляет его <xref:System.Messaging.MessageQueue.PeekCompleted> к делегату обработчика событий и <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается для инициации асинхронной операции просмотра в очереди, расположенной по пути ".\микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="25e03-337">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события пример считывает сообщение и записывает его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="25e03-338">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-339">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-340">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginPeek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-341">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="25e03-342">Инициирует асинхронную операцию считывания с заданным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-343">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-344">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события, когда сообщение появляется в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="25e03-345"><xref:System.Messaging.MessageQueue.PeekCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-346">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, обрабатывающий результаты асинхронной операции, и свяжите его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A>инициирует асинхронную операцию просмотра. уведомляется, вызывая <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-348">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызвав или извлекая результат с помощью <xref:System.Messaging.PeekCompletedEventArgs>. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-349"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-350">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-351">Для синхронного просмотра очереди используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-352">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-353">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-354">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-355">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-356">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-357">Эта перегрузка задает время ожидания. Если интервал, заданный `timeout` параметром, истечет, этот компонент <xref:System.Messaging.MessageQueue.PeekCompleted> вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="25e03-358">Поскольку сообщение не существует, последующий вызов метода <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="25e03-359">Если <xref:System.Messaging.MessageQueue.CanRead%2A> параметр `false`имеет значение, вызывается событие завершения, но при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-360">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-361">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-361">Workgroup mode</span></span>|<span data-ttu-id="25e03-362">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-363">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-363">Local computer</span></span>|<span data-ttu-id="25e03-364">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-364">Yes</span></span>|  
|<span data-ttu-id="25e03-365">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-365">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-366">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-366">Yes</span></span>|  
|<span data-ttu-id="25e03-367">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-367">Remote computer</span></span>|<span data-ttu-id="25e03-368">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-368">No</span></span>|  
|<span data-ttu-id="25e03-369">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-369">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-370">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-371">В следующем примере кода создается асинхронная операция просмотра с использованием пути очереди ".\Микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="25e03-372">Он создает обработчик `MyPeekCompleted`событий и присоединяет его <xref:System.Messaging.MessageQueue.PeekCompleted> к делегату обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="25e03-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A>вызывается с интервалом в одну минуту для инициации асинхронной операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="25e03-374">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события или истечении времени ожидания сообщение извлекается, если оно существует, а его текст записывается на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="25e03-375">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается повторно, чтобы инициировать новую асинхронную операцию считывания с тем же временем ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-376">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-377">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-377">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-378">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-378">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-379">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="25e03-380">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="25e03-381">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-382">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-383">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-384">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события, когда сообщение появляется в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="25e03-385"><xref:System.Messaging.MessageQueue.PeekCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-386">Используйте эту перегрузку, чтобы связать сведения с операцией, которая будет сохранена в течение всего времени существования операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-387">Обработчик событий может получить доступ к этим сведениям, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> объекта, связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="25e03-388">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, обрабатывающий результаты асинхронной операции, и свяжите его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A>инициирует асинхронную операцию просмотра. уведомляется, вызывая <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-390">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызвав или извлекая результат с помощью <xref:System.Messaging.PeekCompletedEventArgs>. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-391"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-392">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-393">Для синхронного просмотра очереди используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-394">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A>Возвращает значение <xref:System.IAsyncResult> типа, идентифицирующее асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-396">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-397">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-398">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-399">Эта перегрузка задает время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="25e03-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="25e03-400">Если интервал, заданный `timeout` параметром, истечет, этот компонент <xref:System.Messaging.MessageQueue.PeekCompleted> вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="25e03-401">Поскольку сообщение не существует, последующий вызов метода <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="25e03-402">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-403">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="25e03-404">Иллюстрация этого сценария приведена в разделе "пример".</span><span class="sxs-lookup"><span data-stu-id="25e03-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="25e03-405">Объект состояния также можно использовать для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="25e03-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="25e03-406">Если поток запущен, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалируется и передается обратно вместе со сведениями из события.</span><span class="sxs-lookup"><span data-stu-id="25e03-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="25e03-407">Если <xref:System.Messaging.MessageQueue.CanRead%2A> параметр `false`имеет значение, вызывается событие завершения, но при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-408">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-409">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-409">Workgroup mode</span></span>|<span data-ttu-id="25e03-410">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-411">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-411">Local computer</span></span>|<span data-ttu-id="25e03-412">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-412">Yes</span></span>|  
|<span data-ttu-id="25e03-413">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-413">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-414">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-414">Yes</span></span>|  
|<span data-ttu-id="25e03-415">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-415">Remote computer</span></span>|<span data-ttu-id="25e03-416">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-416">No</span></span>|  
|<span data-ttu-id="25e03-417">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-417">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-418">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-419">В следующем примере кода создается асинхронная операция просмотра с использованием пути очереди ".\Микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="25e03-420">Он создает обработчик `MyPeekCompleted`событий и присоединяет его <xref:System.Messaging.MessageQueue.PeekCompleted> к делегату обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="25e03-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A>вызывается со временем ожидания в одну минуту.</span><span class="sxs-lookup"><span data-stu-id="25e03-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="25e03-422">Каждый вызов <xref:System.Messaging.MessageQueue.BeginPeek%2A> имеет уникальное целое число, определяющее конкретную операцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="25e03-423">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события или истечения времени ожидания сообщение, если оно существует, извлекается, а его текст и целочисленный идентификатор операции записываются на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="25e03-424">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается повторно, чтобы инициировать новую асинхронную операцию считывания с тем же временем ожидания и связанным целым числом только что завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-425">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-427">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-427">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-428">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="25e03-429">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="25e03-430">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="25e03-431">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-432">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="25e03-433">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-434">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-435">При использовании этой перегрузки функция обратного вызова, указанная в параметре обратного вызова, вызывается непосредственно в том случае, когда сообщение становится доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.PeekCompleted> событие не возникает.</span><span class="sxs-lookup"><span data-stu-id="25e03-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="25e03-436">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="25e03-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="25e03-437"><xref:System.Messaging.MessageQueue.PeekCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-438"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-439">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-440">Для синхронного просмотра очереди используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-441">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A>Возвращает значение <xref:System.IAsyncResult> типа, идентифицирующее асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-443">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-444">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-445">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-446">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-447">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="25e03-448">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-449">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-449">Workgroup mode</span></span>|<span data-ttu-id="25e03-450">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-451">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-451">Local computer</span></span>|<span data-ttu-id="25e03-452">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-452">Yes</span></span>|  
|<span data-ttu-id="25e03-453">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-453">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-454">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-454">Yes</span></span>|  
|<span data-ttu-id="25e03-455">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-455">Remote computer</span></span>|<span data-ttu-id="25e03-456">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-456">No</span></span>|  
|<span data-ttu-id="25e03-457">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-457">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-458">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-459">В следующем примере кода создается асинхронная операция просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="25e03-460">Пример кода отправляет сообщение в локальную очередь сообщений, затем вызывает <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передает: значение времени ожидания, равное 10 секундам; уникальное целое число, идентифицирующее это конкретное сообщение, и новый экземпляр класса <xref:System.AsyncCallback> , который идентифицирует обработчик событий `MyPeekCompleted`.</span><span class="sxs-lookup"><span data-stu-id="25e03-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="25e03-461">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события обработчик событий считывает сообщение и записывает на экран текст сообщения и идентификатор целочисленного сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-462">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-463">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-463">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-464">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-464">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, cursor, action, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="4" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-465">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-466">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="25e03-467">Одно из значений перечисления <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="25e03-468">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-468">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <param name="state"><span data-ttu-id="25e03-469">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="25e03-470">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="25e03-471">Инициирует асинхронную операцию считывания, которая имеет заданный тайм-аут и использует заданный курсор, заданную операцию считывания и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="25e03-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span></span> <span data-ttu-id="25e03-472">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-472">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="25e03-473">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="25e03-474">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-475">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-476">При использовании этой перегрузки функция обратного вызова, указанная в параметре обратного вызова, вызывается напрямую, когда сообщение становится доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="25e03-477"><xref:System.Messaging.MessageQueue.PeekCompleted> Событие не возникает.</span><span class="sxs-lookup"><span data-stu-id="25e03-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="25e03-478">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="25e03-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="25e03-479"><xref:System.Messaging.MessageQueue.PeekCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-480"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-481">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-482">Для синхронного просмотра очереди используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-483">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A>Возвращает значение <xref:System.IAsyncResult> типа, идентифицирующее асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="25e03-485">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-486">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-487">В этом случае используйте <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> объекта для задания завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-488">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-489">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="25e03-490">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-491">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-491">Workgroup mode</span></span>|<span data-ttu-id="25e03-492">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-493">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-493">Local computer</span></span>|<span data-ttu-id="25e03-494">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-494">Yes</span></span>|  
|<span data-ttu-id="25e03-495">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-495">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-496">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-496">Yes</span></span>|  
|<span data-ttu-id="25e03-497">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-497">Remote computer</span></span>|<span data-ttu-id="25e03-498">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-498">No</span></span>|  
|<span data-ttu-id="25e03-499">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-499">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-500">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="25e03-501">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-502">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-503">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-504">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-504">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-505">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-505">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="25e03-506">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-506">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="25e03-507">Инициирует асинхронную операцию получения, указывая службе MSMQ на необходимость запуска операции получения сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : unit -&gt; IAsyncResult" Usage="messageQueue.BeginReceive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-508">Инициирует асинхронную операцию получения без тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-509">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-510">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события, когда сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="25e03-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-512">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который обрабатывает результаты асинхронной операции и связывает его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A>инициирует асинхронную операцию получения; уведомляется, вызывая <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-514">Затем может получить доступ к сообщению, вызвав метод <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-515"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-516">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди, не блокируя текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-517">Чтобы синхронно получить сообщение, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-518">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-519">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-520">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-521">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-522">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-523">Если <xref:System.Messaging.MessageQueue.CanRead%2A> параметр `false`имеет значение, вызывается событие завершения, но при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-524">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="25e03-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="25e03-525">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и помещайте транзакцию и (синхронную) <xref:System.Messaging.MessageQueue.Receive%2A> метод в обработчике событий, созданном для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="25e03-526">Обработчик событий может содержать функциональные возможности, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="25e03-527">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-528">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-528">Workgroup mode</span></span>|<span data-ttu-id="25e03-529">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-530">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-530">Local computer</span></span>|<span data-ttu-id="25e03-531">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-531">Yes</span></span>|  
|<span data-ttu-id="25e03-532">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-532">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-533">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-533">Yes</span></span>|  
|<span data-ttu-id="25e03-534">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-534">Remote computer</span></span>|<span data-ttu-id="25e03-535">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-535">No</span></span>|  
|<span data-ttu-id="25e03-536">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-536">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-537">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-538">В следующем примере кода демонстрируется последовательное выполнение асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="25e03-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="25e03-539">Предполагается, что на локальном компьютере имеется очередь с именем «myQueue».</span><span class="sxs-lookup"><span data-stu-id="25e03-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="25e03-540">Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы. `Main`</span><span class="sxs-lookup"><span data-stu-id="25e03-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="25e03-541">`MyReceiveCompleted`обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="25e03-542">В следующем примере кода асинхронные запросы поступают в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="25e03-543">Вызов метода <xref:System.Messaging.MessageQueue.BeginReceive%2A> <xref:System.IAsyncResult.AsyncWaitHandle%2A> использует в возвращаемом значении.</span><span class="sxs-lookup"><span data-stu-id="25e03-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="25e03-544">Перед завершением работы программа ожидает завершения всех асинхронных операций. `Main`</span><span class="sxs-lookup"><span data-stu-id="25e03-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-545">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-545">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-546">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-546">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginReceive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-547">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="25e03-548">Инициирует асинхронную операцию получения с указанным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-549">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-550">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события, когда сообщение появляется в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="25e03-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-552">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который обрабатывает результаты асинхронной операции и связывает его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A>инициирует асинхронную операцию получения; уведомляется, вызывая <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-554">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызвав или извлекая результат с <xref:System.Messaging.ReceiveCompletedEventArgs>помощью. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-555"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-556">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди, не блокируя текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-557">Чтобы синхронно получить сообщение, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-558">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-559">Если <xref:System.Messaging.MessageQueue.CanRead%2A> параметр `false`имеет значение, вызывается событие завершения, но при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>возникнет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-560">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-561">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-562">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-563">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-564">Эта перегрузка задает время ожидания. Если интервал, заданный `timeout` параметром, истечет, этот компонент <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="25e03-565">Поскольку сообщение не существует, последующий вызов метода <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="25e03-566">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="25e03-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="25e03-567">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и помещайте транзакцию и (синхронную) <xref:System.Messaging.MessageQueue.Receive%2A> метод в обработчике событий, созданном для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="25e03-568">Обработчик событий может содержать функциональные возможности, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="25e03-569">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-570">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-570">Workgroup mode</span></span>|<span data-ttu-id="25e03-571">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-572">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-572">Local computer</span></span>|<span data-ttu-id="25e03-573">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-573">Yes</span></span>|  
|<span data-ttu-id="25e03-574">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-574">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-575">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-575">Yes</span></span>|  
|<span data-ttu-id="25e03-576">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-576">Remote computer</span></span>|<span data-ttu-id="25e03-577">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-577">No</span></span>|  
|<span data-ttu-id="25e03-578">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-578">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-579">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-580">В следующем примере кода создается асинхронная операция получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="25e03-581">В примере кода создается обработчик событий, `MyReceiveCompleted`и он присоединяется <xref:System.Messaging.MessageQueue.ReceiveCompleted> к делегату обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="25e03-582">В примере кода сообщение отправляется в локальную очередь сообщений, а затем <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>вызывается, передавая значение времени ожидания в десять секунд.</span><span class="sxs-lookup"><span data-stu-id="25e03-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="25e03-583">При возникновении <xref:System.Messaging.MessageQueue.ReceiveCompleted> события обработчик событий получает сообщение и записывает текст сообщения на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-584">Значение, заданное для параметра <paramref name="timeout" />, недопустимо. Возможно, было введено отрицательное число.</span><span class="sxs-lookup"><span data-stu-id="25e03-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-585">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-585">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-586">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-586">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-587">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="25e03-588">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="25e03-589">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-590">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-591">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-592">При асинхронной обработке используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события, когда сообщение появляется в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="25e03-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-594">Используйте эту перегрузку, чтобы связать сведения с операцией, которая будет сохранена в течение всего времени существования операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-595">Обработчик событий может обнаружить эти сведения, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> объекта, связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="25e03-596">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который обрабатывает результаты асинхронной операции и связывает его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A>инициирует асинхронную операцию получения; уведомляется, вызывая <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-598">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызвав или извлекая результат с <xref:System.Messaging.ReceiveCompletedEventArgs>помощью. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-599"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-600">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди, не блокируя текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-601">Чтобы синхронно получить сообщение, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-602">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-603">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-604">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-605">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-606">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-607">Эта перегрузка задает время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="25e03-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="25e03-608">Если интервал, заданный `timeout` параметром, истечет, этот компонент <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="25e03-609">Поскольку сообщение не существует, последующий вызов метода <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="25e03-610">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-611">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="25e03-612">Объект состояния также можно использовать для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="25e03-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="25e03-613">Если поток запущен, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалируется и передается обратно вместе со сведениями из события.</span><span class="sxs-lookup"><span data-stu-id="25e03-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="25e03-614">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="25e03-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="25e03-615">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и помещайте транзакцию и (синхронную) <xref:System.Messaging.MessageQueue.Receive%2A> метод в обработчике событий, созданном для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="25e03-616">Обработчик событий может содержать функциональные возможности, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="25e03-617">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-618">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-618">Workgroup mode</span></span>|<span data-ttu-id="25e03-619">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-620">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-620">Local computer</span></span>|<span data-ttu-id="25e03-621">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-621">Yes</span></span>|  
|<span data-ttu-id="25e03-622">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-622">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-623">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-623">Yes</span></span>|  
|<span data-ttu-id="25e03-624">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-624">Remote computer</span></span>|<span data-ttu-id="25e03-625">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-625">No</span></span>|  
|<span data-ttu-id="25e03-626">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-626">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-627">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-628">В следующем примере кода создается асинхронная операция получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="25e03-629">В примере кода создается обработчик событий, `MyReceiveCompleted`и он присоединяется <xref:System.Messaging.MessageQueue.ReceiveCompleted> к делегату обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="25e03-630">Пример кода отправляет сообщение в локальную очередь сообщений, затем вызывает <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, передает значение времени ожидания десять секунд и уникальное целое число, идентифицирующее конкретное сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="25e03-631">При возникновении <xref:System.Messaging.MessageQueue.ReceiveCompleted> события обработчик событий получает сообщение и записывает на экран текст сообщения и идентификатор целочисленного сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-632">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-633">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-633">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-634">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-634">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-635">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="25e03-636">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="25e03-637">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="25e03-638">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="25e03-639">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="25e03-640">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-641">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-642">При использовании этой перегрузки функция обратного вызова, указанная в параметре обратного вызова, вызывается непосредственно в том случае, когда сообщение становится доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не возникает.</span><span class="sxs-lookup"><span data-stu-id="25e03-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="25e03-643">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="25e03-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="25e03-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-645">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который обрабатывает результаты асинхронной операции и связывает его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A>инициирует асинхронную операцию получения; уведомляется, вызывая <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-647">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызвав или извлекая результат с <xref:System.Messaging.ReceiveCompletedEventArgs>помощью. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-648"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-649">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди, не блокируя текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-650">Чтобы синхронно получить сообщение, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-651">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-652">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-653">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-654">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-655">В этом случае <xref:System.IAsyncResult> для задания завершенной <xref:System.IAsyncResult.AsyncWaitHandle%2A> операции используется свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-656">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-657">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="25e03-658">Объект состояния также можно использовать для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="25e03-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="25e03-659">Если поток запущен, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалируется и передается обратно вместе со сведениями из события.</span><span class="sxs-lookup"><span data-stu-id="25e03-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="25e03-660">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="25e03-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="25e03-661">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и помещайте транзакцию и (синхронную) <xref:System.Messaging.MessageQueue.Receive%2A> метод в обработчике событий, созданном для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="25e03-662">Обработчик событий может содержать функциональные возможности, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="25e03-663">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-664">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-664">Workgroup mode</span></span>|<span data-ttu-id="25e03-665">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-666">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-666">Local computer</span></span>|<span data-ttu-id="25e03-667">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-667">Yes</span></span>|  
|<span data-ttu-id="25e03-668">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-668">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-669">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-669">Yes</span></span>|  
|<span data-ttu-id="25e03-670">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-670">Remote computer</span></span>|<span data-ttu-id="25e03-671">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-671">No</span></span>|  
|<span data-ttu-id="25e03-672">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-672">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-673">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-674">В следующем примере кода создается асинхронная операция получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="25e03-675">Пример кода отправляет сообщение в локальную очередь сообщений, затем вызывает <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передает: значение времени ожидания, равное 10 секундам; уникальное целое число, идентифицирующее это конкретное сообщение, и новый экземпляр класса <xref:System.AsyncCallback> , который идентифицирует обработчик событий `MyReceiveCompleted`.</span><span class="sxs-lookup"><span data-stu-id="25e03-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="25e03-676">При возникновении <xref:System.Messaging.MessageQueue.ReceiveCompleted> события обработчик событий получает сообщение и записывает на экран текст сообщения и идентификатор целочисленного сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-677">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-678">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-678">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-679">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-679">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * System.Messaging.Cursor * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, cursor, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-680">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-681">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="state"><span data-ttu-id="25e03-682">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="25e03-683">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="25e03-684">Инициирует асинхронную операцию получения, которая имеет заданный тайм-аут и использует заданный курсор и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="25e03-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span></span> <span data-ttu-id="25e03-685">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-685">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="25e03-686">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="25e03-687">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-688">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="25e03-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-689">При использовании этой перегрузки функция обратного вызова, указанная в параметре обратного вызова, вызывается непосредственно в том случае, когда сообщение становится доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не возникает.</span><span class="sxs-lookup"><span data-stu-id="25e03-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="25e03-690">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="25e03-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="25e03-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted>также вызывается, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-692">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который обрабатывает результаты асинхронной операции и связывает его с делегатом события.</span><span class="sxs-lookup"><span data-stu-id="25e03-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="25e03-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A>инициирует асинхронную операцию получения; уведомляется, вызывая <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение поступает в очередь. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="25e03-694">Затем может получить доступ к сообщению, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызвав или извлекая результат с <xref:System.Messaging.ReceiveCompletedEventArgs>помощью. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="25e03-695"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает значение, но асинхронная операция не завершается до вызова обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="25e03-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="25e03-696">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди, не блокируя текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="25e03-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="25e03-697">Чтобы синхронно получить сообщение, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-698">После завершения асинхронной операции можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="25e03-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="25e03-699">Объект <xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> который возвращает, идентифицирует асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="25e03-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="25e03-700">Его можно использовать <xref:System.IAsyncResult> в течение всего времени существования операции, хотя обычно он не используется, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="25e03-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="25e03-701">Однако при запуске нескольких асинхронных операций можно поместить их <xref:System.IAsyncResult> значения в массив и указать, следует ли дожидаться завершения всех операций или любой операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="25e03-702">В этом случае используйте <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> объекта для задания завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="25e03-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="25e03-703">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="25e03-704">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз для инициации нескольких операций, каждую операцию можно определить с помощью отдельного определяемого объекта State.</span><span class="sxs-lookup"><span data-stu-id="25e03-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="25e03-705">Объект состояния также можно использовать для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="25e03-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="25e03-706">Если поток запущен, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалируется и передается обратно вместе со сведениями из события.</span><span class="sxs-lookup"><span data-stu-id="25e03-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="25e03-707">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="25e03-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="25e03-708">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и помещайте транзакцию и (синхронную) <xref:System.Messaging.MessageQueue.Receive%2A> метод в обработчике событий, созданном для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="25e03-709">Обработчик событий может содержать функциональные возможности, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="25e03-710">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-711">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-711">Workgroup mode</span></span>|<span data-ttu-id="25e03-712">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-713">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-713">Local computer</span></span>|<span data-ttu-id="25e03-714">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-714">Yes</span></span>|  
|<span data-ttu-id="25e03-715">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-715">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-716">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-716">Yes</span></span>|  
|<span data-ttu-id="25e03-717">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-717">Remote computer</span></span>|<span data-ttu-id="25e03-718">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-718">No</span></span>|  
|<span data-ttu-id="25e03-719">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-719">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-720">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-721">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-722">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-723">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-723">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-724">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-724">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanRead : bool" Usage="System.Messaging.MessageQueue.CanRead" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-725">Получает значение, указывающее, может ли быть прочитан объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span></span></summary>
        <value><span data-ttu-id="25e03-726">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может прочитать данные из него; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-726"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-727"><xref:System.Messaging.MessageQueue.CanRead%2A>Указывает, может ли приложение просматривать или получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="25e03-728">Если <xref:System.Messaging.MessageQueue.CanRead%2A> имеет `true`значение, <xref:System.Messaging.MessageQueue> то может принимать или считывать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="25e03-729">В противном случае он не может.</span><span class="sxs-lookup"><span data-stu-id="25e03-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="25e03-730"><xref:System.Messaging.MessageQueue.CanRead%2A>имеет `false` значение, если очередь уже открыта с монопольным доступом на чтение (или если она открыта с неисключительным доступом, <xref:System.Messaging.MessageQueue> а это требует монопольного доступа) или если у приложения недостаточно прав для доступа к нему.</span><span class="sxs-lookup"><span data-stu-id="25e03-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="25e03-731">Если приложение пытается выполнить чтение из очереди, когда <xref:System.Messaging.MessageQueue.CanRead%2A> имеет значение `false`, доступ запрещается.</span><span class="sxs-lookup"><span data-stu-id="25e03-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="25e03-732">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-733">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-733">Workgroup mode</span></span>|<span data-ttu-id="25e03-734">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-735">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-735">Local computer</span></span>|<span data-ttu-id="25e03-736">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-736">Yes</span></span>|  
|<span data-ttu-id="25e03-737">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-737">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-738">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-738">Yes</span></span>|  
|<span data-ttu-id="25e03-739">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-739">Remote computer</span></span>|<span data-ttu-id="25e03-740">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-740">No</span></span>|  
|<span data-ttu-id="25e03-741">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-741">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-742">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-743">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.CanRead%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanWrite : bool" Usage="System.Messaging.MessageQueue.CanWrite" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-744">Получает значение, указывающее, может ли быть выполнена запись в <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span></span></summary>
        <value><span data-ttu-id="25e03-745">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может записать в него данные; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-745"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-746"><xref:System.Messaging.MessageQueue.CanWrite%2A>Указывает, может ли приложение отправить сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="25e03-747">Если <xref:System.Messaging.MessageQueue.CanWrite%2A> параметр `true`имеет значение <xref:System.Messaging.MessageQueue> , объект может передавать сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="25e03-748">В противном случае он не может.</span><span class="sxs-lookup"><span data-stu-id="25e03-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="25e03-749"><xref:System.Messaging.MessageQueue.CanWrite%2A>имеет `false` значение, если очередь уже открыта с монопольным доступом на запись (или если она открыта с неисключительным доступом, <xref:System.Messaging.MessageQueue> а это требует монопольного доступа) или если у приложения недостаточно прав для доступа к нему.</span><span class="sxs-lookup"><span data-stu-id="25e03-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="25e03-750">Если приложение пытается выполнить запись в очередь, когда <xref:System.Messaging.MessageQueue.CanWrite%2A> имеет значение `false`, доступ запрещается.</span><span class="sxs-lookup"><span data-stu-id="25e03-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="25e03-751">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-752">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-752">Workgroup mode</span></span>|<span data-ttu-id="25e03-753">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-754">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-754">Local computer</span></span>|<span data-ttu-id="25e03-755">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-755">Yes</span></span>|  
|<span data-ttu-id="25e03-756">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-756">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-757">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-757">Yes</span></span>|  
|<span data-ttu-id="25e03-758">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-758">Remote computer</span></span>|<span data-ttu-id="25e03-759">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-759">No</span></span>|  
|<span data-ttu-id="25e03-760">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-760">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-761">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-762">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.CanWrite%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberSignature Language="F#" Value="member this.Category : Guid with get, set" Usage="System.Messaging.MessageQueue.Category" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-763">Возвращает или задает категорию очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-763">Gets or sets the queue category.</span></span></summary>
        <value><span data-ttu-id="25e03-764">Объект <see cref="T:System.Guid" />, представляющий категорию очереди (идентификатор типа очереди сообщений), которая позволяет приложению классифицировать его очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span></span> <span data-ttu-id="25e03-765">Значение по умолчанию — <see langword="Guid.empty" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-765">The default is <see langword="Guid.empty" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-766">Категория очереди позволяет приложению классифицировать свои очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="25e03-767">Например, можно разместить все очереди выставления счетов в одной категории, а все очереди заказов — в другой.</span><span class="sxs-lookup"><span data-stu-id="25e03-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="25e03-768">Свойство предоставляет доступ к свойству идентификатора типа очереди сообщений (доступному для чтения и записи), доступному в диалоговом окне **Свойства очереди** консоли управления компьютером. <xref:System.Messaging.MessageQueue.Category%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="25e03-769">Можно определить новую категорию.</span><span class="sxs-lookup"><span data-stu-id="25e03-769">You can define a new category.</span></span> <span data-ttu-id="25e03-770">Несмотря на то, <xref:System.Guid.NewGuid%2A> что можно использовать для создания значения категории, уникального <xref:System.Guid> для всех значений, такое действие не требуется.</span><span class="sxs-lookup"><span data-stu-id="25e03-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="25e03-771">Значение категории должно отличаться только от других категорий, а не от всех других <xref:System.Guid> значений.</span><span class="sxs-lookup"><span data-stu-id="25e03-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="25e03-772">Например, можно {00000000-0000-0000-0000-000000000001} назначить в <xref:System.Messaging.MessageQueue.Category%2A> качестве для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="25e03-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="25e03-773">Нет необходимости задавать <xref:System.Messaging.MessageQueue.Category%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="25e03-774">Допускается значение `null`.</span><span class="sxs-lookup"><span data-stu-id="25e03-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="25e03-775">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-776">В связи с этим <xref:System.Messaging.MessageQueue> изменение затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="25e03-777">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-778">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-778">Workgroup mode</span></span>|<span data-ttu-id="25e03-779">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-780">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-780">Local computer</span></span>|<span data-ttu-id="25e03-781">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-781">Yes</span></span>|  
|<span data-ttu-id="25e03-782">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-782">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-783">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-783">Yes</span></span>|  
|<span data-ttu-id="25e03-784">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-784">Remote computer</span></span>|<span data-ttu-id="25e03-785">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-785">No</span></span>|  
|<span data-ttu-id="25e03-786">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-786">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-787">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-788">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.Category%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-789">Для категории очереди задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-789">The queue category was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-790">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-790">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberSignature Language="F#" Value="static member ClearConnectionCache : unit -&gt; unit" Usage="System.Messaging.MessageQueue.ClearConnectionCache " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-791">Очищает кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="25e03-791">Clears the connection cache.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-792">При вызове <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>имена форматов, хранящиеся в кэше, удаляются, а открытые и сохраненные в кэше дескрипторы закрываются.</span><span class="sxs-lookup"><span data-stu-id="25e03-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="25e03-793">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-794">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-794">Workgroup mode</span></span>|<span data-ttu-id="25e03-795">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-796">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-796">Local computer</span></span>|<span data-ttu-id="25e03-797">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-797">Yes</span></span>|  
|<span data-ttu-id="25e03-798">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-798">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-799">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-799">Yes</span></span>|  
|<span data-ttu-id="25e03-800">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-800">Remote computer</span></span>|<span data-ttu-id="25e03-801">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-801">Yes</span></span>|  
|<span data-ttu-id="25e03-802">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-802">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-803">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-804">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="messageQueue.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-805">Освобождает все ресурсы, выделенные классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-806"><xref:System.Messaging.MessageQueue.Close%2A>Освобождает все ресурсы, связанные с, <xref:System.Messaging.MessageQueue>включая общие ресурсы, если это уместно.</span><span class="sxs-lookup"><span data-stu-id="25e03-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="25e03-807">Система повторно запрашивает эти ресурсы, если они все еще доступны, например при вызове <xref:System.Messaging.MessageQueue.Send%28System.Object%29> метода, как показано в следующем C# коде.</span><span class="sxs-lookup"><span data-stu-id="25e03-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="25e03-808">При вызове <xref:System.Messaging.MessageQueue.Close%2A>все <xref:System.Messaging.MessageQueue> свойства, которые напрямую обращаются к очереди очереди сообщений, очищаются. Все <xref:System.Messaging.MessageQueue.Path%2A> <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> ,,<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> и остаются в том виде, вкоторомонибыли.<xref:System.Messaging.MessageQueue.Formatter%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="25e03-809"><xref:System.Messaging.MessageQueue.Close%2A>не всегда освобождает дескрипторы чтения и записи в очереди, так как они могут быть общими.</span><span class="sxs-lookup"><span data-stu-id="25e03-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="25e03-810">Чтобы обеспечить освобождение дескрипторов чтения и записи в очереди, <xref:System.Messaging.MessageQueue.Close%2A> можно выполнить любое из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="25e03-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="25e03-811"><xref:System.Messaging.MessageQueue> Создайте с помощью монопольного доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="25e03-812">Для <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> этого вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> `true`конструктор или и задайте для параметразначение.`sharedModeDenyReceive`</span><span class="sxs-lookup"><span data-stu-id="25e03-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="25e03-813"><xref:System.Messaging.MessageQueue> Создайте с отключенным кэшированием подключений.</span><span class="sxs-lookup"><span data-stu-id="25e03-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="25e03-814">Для этого вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> конструктор и `enableConnectionCache` задайте для `false`параметра значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="25e03-815">Отключите кэширование подключения.</span><span class="sxs-lookup"><span data-stu-id="25e03-815">Disable connection caching.</span></span> <span data-ttu-id="25e03-816">Для этого задайте <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> для `false`свойства значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="25e03-817">Необходимо вызвать <xref:System.Messaging.MessageQueue.Close%2A> очередь перед удалением очереди на сервере очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="25e03-818">В противном случае сообщения, отправленные в очередь, могут вызвать исключения или появиться в очереди недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="25e03-819">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-820">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-820">Workgroup mode</span></span>|<span data-ttu-id="25e03-821">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-822">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-822">Local computer</span></span>|<span data-ttu-id="25e03-823">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-823">Yes</span></span>|  
|<span data-ttu-id="25e03-824">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-824">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-825">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-825">Yes</span></span>|  
|<span data-ttu-id="25e03-826">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-826">Remote computer</span></span>|<span data-ttu-id="25e03-827">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-827">Yes</span></span>|  
|<span data-ttu-id="25e03-828">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-828">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-829">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-830">В следующем примере кода закрывается очередь очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-831">Создает новую очередь на сервере очереди сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-831">Creates a new queue at the specified path on a Message Queuing server.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Create : string -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-832">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-832">The path of the queue to create.</span></span></param>
        <summary><span data-ttu-id="25e03-833">Создает нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-833">Creates a non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="25e03-834">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-835">Используйте эту перегрузку, чтобы создать нетранзакционную очередь очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="25e03-836">Чтобы создать новый экземпляр <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, <xref:System.Messaging.MessageQueue.%23ctor%2A> используйте конструктор.</span><span class="sxs-lookup"><span data-stu-id="25e03-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="25e03-837">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="25e03-838">Синтаксис `path` параметра зависит от типа очереди, на которую он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-839">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-839">Queue type</span></span>|<span data-ttu-id="25e03-840">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-841">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-842">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="25e03-843">Используйте "." для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="25e03-843">Use "." for the local computer.</span></span> <span data-ttu-id="25e03-844">Дополнительные сведения о синтаксисе см <xref:System.Messaging.MessageQueue.Path%2A> . в описании свойства.</span><span class="sxs-lookup"><span data-stu-id="25e03-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="25e03-845">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-846">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-846">Workgroup mode</span></span>|<span data-ttu-id="25e03-847">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-848">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-848">Local computer</span></span>|<span data-ttu-id="25e03-849">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-849">Yes</span></span>|  
|<span data-ttu-id="25e03-850">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-850">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-851">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-851">Yes</span></span>|  
|<span data-ttu-id="25e03-852">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-852">Remote computer</span></span>|<span data-ttu-id="25e03-853">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-853">No</span></span>|  
|<span data-ttu-id="25e03-854">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-854">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-855">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-856">В следующем примере кода создаются общие и частные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="25e03-857">Он отправляет сообщение в выбранные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-858">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="25e03-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-859">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-859">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="25e03-860">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-860">-or-</span></span>  
  
 <span data-ttu-id="25e03-861">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-861">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberSignature Language="F#" Value="static member Create : string * bool -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create (path, transactional)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-862">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-862">The path of the queue to create.</span></span></param>
        <param name="transactional"><span data-ttu-id="25e03-863">Значение <see langword="true" />, если необходимо создать транзакционную очередь; значение <see langword="false" />, если необходимо создать нетранзакционную очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-863"><see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span></span></param>
        <summary><span data-ttu-id="25e03-864">Создает транзакционную или нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="25e03-865">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-866">Эту перегрузку можно использовать для создания транзакционной очереди в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="25e03-867">Можно создать нетранзакционную очередь, задав `transactional` для `false` параметра значение или, <xref:System.Messaging.MessageQueue.Create%28System.String%29>вызвав другую перегрузку.</span><span class="sxs-lookup"><span data-stu-id="25e03-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="25e03-868">Чтобы создать новый экземпляр <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, <xref:System.Messaging.MessageQueue.%23ctor%2A> используйте конструктор.</span><span class="sxs-lookup"><span data-stu-id="25e03-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="25e03-869">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="25e03-870">Синтаксис `path` параметра зависит от типа очереди, на которую он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-871">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-871">Queue type</span></span>|<span data-ttu-id="25e03-872">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-873">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-874">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="25e03-875">Используйте "." для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="25e03-875">Use "." for the local computer.</span></span> <span data-ttu-id="25e03-876">Дополнительные сведения о синтаксисе см <xref:System.Messaging.MessageQueue.Path%2A> . в описании свойства.</span><span class="sxs-lookup"><span data-stu-id="25e03-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="25e03-877">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-878">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-878">Workgroup mode</span></span>|<span data-ttu-id="25e03-879">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-880">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-880">Local computer</span></span>|<span data-ttu-id="25e03-881">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-881">Yes</span></span>|  
|<span data-ttu-id="25e03-882">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-882">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-883">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-883">Yes</span></span>|  
|<span data-ttu-id="25e03-884">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-884">Remote computer</span></span>|<span data-ttu-id="25e03-885">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-885">No</span></span>|  
|<span data-ttu-id="25e03-886">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-886">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-887">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-888">В следующем примере кода создаются открытые и частные транзакционные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="25e03-889">Он отправляет сообщение в выбранные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-890">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="25e03-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-891">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-891">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="25e03-892">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-892">-or-</span></span>  
  
 <span data-ttu-id="25e03-893">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberSignature Language="F#" Value="member this.CreateCursor : unit -&gt; System.Messaging.Cursor" Usage="messageQueue.CreateCursor " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-894">Создает новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-895">Новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span> <span data-ttu-id="25e03-896">Этот курсор используется для сохранения определенного положения в очереди при чтении сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.CreateTime : DateTime" Usage="System.Messaging.MessageQueue.CreateTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-897">Получает время и дату создания очереди в службе очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-897">Gets the time and date that the queue was created in Message Queuing.</span></span></summary>
        <value><span data-ttu-id="25e03-898">Объект <see cref="T:System.DateTime" /> представляющий дату и время создания очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-899"><xref:System.Messaging.MessageQueue.CreateTime%2A>относится к очереди на сервере очереди сообщений, а не к <xref:System.Messaging.MessageQueue> экземпляру.</span><span class="sxs-lookup"><span data-stu-id="25e03-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="25e03-900">Если очередь существует, это свойство представляет время создания очереди, корректируется на местное время сервера, на котором существует очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="25e03-901">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-902">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-902">Workgroup mode</span></span>|<span data-ttu-id="25e03-903">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-904">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-904">Local computer</span></span>|<span data-ttu-id="25e03-905">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-905">Yes</span></span>|  
|<span data-ttu-id="25e03-906">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-906">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-907">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-907">Yes</span></span>|  
|<span data-ttu-id="25e03-908">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-908">Remote computer</span></span>|<span data-ttu-id="25e03-909">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-909">No</span></span>|  
|<span data-ttu-id="25e03-910">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-910">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-911">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-912">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.CreateTime%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-913">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-913">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DefaultPropertiesToSend : System.Messaging.DefaultPropertiesToSend with get, set" Usage="System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-914">Получает или задает значения свойств сообщения, которые будут использоваться по умолчанию, когда приложение будет отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-915">Свойство <see cref="T:System.Messaging.DefaultPropertiesToSend" />, содержащее используемые по умолчанию значения свойств сообщений очереди сообщений, которые применяются, когда приложение отправляет в очередь объекты, отличные от экземпляров <see cref="T:System.Messaging.Message" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-916">При отправке в очередь любого объекта, который не <xref:System.Messaging.Message> относится к типу <xref:System.Messaging.MessageQueue> , компонент вставляет объект в сообщение очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="25e03-917">В это время <xref:System.Messaging.MessageQueue> к сообщению применяется значение свойства, указанное <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> в свойстве.</span><span class="sxs-lookup"><span data-stu-id="25e03-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="25e03-918">И наоборот, при отправке <xref:System.Messaging.Message> в очередь эти свойства уже заданы для самого экземпляра, поэтому <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> для <xref:System.Messaging.Message>не учитывается.</span><span class="sxs-lookup"><span data-stu-id="25e03-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="25e03-919">Хотя свойства задаются с помощью <xref:System.Messaging.MessageQueue> объекта <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> , объект ссылается на свойства сообщений, которые отправляются в очередь, а не в саму очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="25e03-920">Значения по умолчанию для свойств показаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-921">Свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-921">Property</span></span>|<span data-ttu-id="25e03-922">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="25e03-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="25e03-923">Ноль (0)</span><span class="sxs-lookup"><span data-stu-id="25e03-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="25e03-924">Массив байтов нулевой длины</span><span class="sxs-lookup"><span data-stu-id="25e03-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="25e03-925">Пустая строка ("")</span><span class="sxs-lookup"><span data-stu-id="25e03-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="25e03-926">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-927">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-927">Workgroup mode</span></span>|<span data-ttu-id="25e03-928">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-929">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-929">Local computer</span></span>|<span data-ttu-id="25e03-930">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-930">Yes</span></span>|  
|<span data-ttu-id="25e03-931">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-931">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-932">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-932">Yes</span></span>|  
|<span data-ttu-id="25e03-933">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-933">Remote computer</span></span>|<span data-ttu-id="25e03-934">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-934">Yes</span></span>|  
|<span data-ttu-id="25e03-935">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-935">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-936">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-937">В следующем примере кода используется приоритет сообщения для определения свойств по умолчанию для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-938">Для очереди нельзя задать использующиеся по умолчанию свойства. Возможно, потому что неправильно задано одно из свойств.</span><span class="sxs-lookup"><span data-stu-id="25e03-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Messaging.MessageQueue.Delete path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-939">Расположение удаляемой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-939">The location of the queue to be deleted.</span></span></param>
        <summary><span data-ttu-id="25e03-940">Удаляет очередь с сервера очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-940">Deletes a queue on a Message Queuing server.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-941">Синтаксис `path` параметра зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="25e03-942">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-942">Queue type</span></span>|<span data-ttu-id="25e03-943">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-944">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-945">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="25e03-946">Дополнительные сведения о синтаксисе см <xref:System.Messaging.MessageQueue.Path%2A> . в описании свойства.</span><span class="sxs-lookup"><span data-stu-id="25e03-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="25e03-947">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="25e03-948">Справочник</span><span class="sxs-lookup"><span data-stu-id="25e03-948">Reference</span></span>|<span data-ttu-id="25e03-949">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="25e03-950">Название формата</span><span class="sxs-lookup"><span data-stu-id="25e03-950">Format name</span></span>|<span data-ttu-id="25e03-951">FormatName: [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="25e03-952">Метка</span><span class="sxs-lookup"><span data-stu-id="25e03-952">Label</span></span>|<span data-ttu-id="25e03-953">Метка: [ *Метка* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="25e03-954">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-955">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-955">Workgroup mode</span></span>|<span data-ttu-id="25e03-956">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-957">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-957">Local computer</span></span>|<span data-ttu-id="25e03-958">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-958">Yes</span></span>|  
|<span data-ttu-id="25e03-959">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-959">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-960">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-960">Yes</span></span>|  
|<span data-ttu-id="25e03-961">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-961">Remote computer</span></span>|<span data-ttu-id="25e03-962">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-962">No</span></span>|  
|<span data-ttu-id="25e03-963">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-963">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-964">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-965">В следующем примере кода удаляется очередь очереди сообщений, если она существует.</span><span class="sxs-lookup"><span data-stu-id="25e03-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-966">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="25e03-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-967">Для параметра <paramref name="path" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="25e03-967">The syntax for the <paramref name="path" /> parameter is not valid.</span></span>  
  
<span data-ttu-id="25e03-968">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-968">-or-</span></span> 
<span data-ttu-id="25e03-969">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-969">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DenySharedReceive : bool with get, set" Usage="System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-970">Получает или задает значение, показывающее, имеет ли этот объект <see cref="T:System.Messaging.MessageQueue" /> монопольный доступ на получение сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span></span></summary>
        <value><span data-ttu-id="25e03-971">Значение <see langword="true" />, если этот класс <see cref="T:System.Messaging.MessageQueue" /> имеет права монопольного доступа для получения сообщений из очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-971"><see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="25e03-972">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-972">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A>Указывает общий режим очереди, на который ссылается этот <xref:System.Messaging.MessageQueue>объект.</span><span class="sxs-lookup"><span data-stu-id="25e03-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-974">Задайте значение <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> , <xref:System.Messaging.MessageQueue> <xref:System.Messaging.MessageQueue.Path%2A>чтобы указать, что только этот объект должен иметь доступ для считывания или получения сообщений из очереди с указанным. `true`</span><span class="sxs-lookup"><span data-stu-id="25e03-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="25e03-975">Если другое <xref:System.Messaging.MessageQueue> или другое приложение связано с одним и тем же ресурсом очереди, этот экземпляр или приложение не сможет просматривать или получать сообщения, но по-прежнему может отправлять их.</span><span class="sxs-lookup"><span data-stu-id="25e03-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="25e03-976">Если <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> имеет `false`значение, очередь доступна нескольким приложениям для отправки, просмотра или получения сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="25e03-977">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-978">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-978">Workgroup mode</span></span>|<span data-ttu-id="25e03-979">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-980">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-980">Local computer</span></span>|<span data-ttu-id="25e03-981">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-981">Yes</span></span>|  
|<span data-ttu-id="25e03-982">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-982">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-983">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-983">Yes</span></span>|  
|<span data-ttu-id="25e03-984">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-984">Remote computer</span></span>|<span data-ttu-id="25e03-985">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-985">Yes</span></span>|  
|<span data-ttu-id="25e03-986">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-986">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-987">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-988">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="messageQueue.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing"><span data-ttu-id="25e03-989">Значение <see langword="true" /> позволяет освободить управляемые и неуправляемые ресурсы; значение <see langword="false" /> позволяет освободить только неуправляемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="25e03-989"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="25e03-990">Уничтожает ресурсы (кроме памяти), используемые классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-991">Вызовите метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> по окончании использования класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="25e03-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-992">Метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> оставляет класс <xref:System.Messaging.MessageQueue> в непригодном для использования состоянии.</span><span class="sxs-lookup"><span data-stu-id="25e03-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="25e03-993">После вызова <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>необходимо освободить все ссылки на, <xref:System.Messaging.MessageQueue> чтобы память, которую он занимают, могла быть освобождена при сборке мусора.</span><span class="sxs-lookup"><span data-stu-id="25e03-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="25e03-994">Перед освобождением <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> последней ссылки <xref:System.Messaging.MessageQueue>на необходимо вызвать метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-995">В противном случае ресурсы <xref:System.Messaging.MessageQueue> , которые использует, не будут освобождены до тех пор <xref:System.Messaging.MessageQueue> , пока сборка мусора не вызовет деструктор объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableConnectionCache : bool with get, set" Usage="System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-996">Получает или задает значение, указывающее, будет ли приложение поддерживать кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="25e03-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span></span></summary>
        <value><span data-ttu-id="25e03-997">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-997"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-998">Кэш подключений — это список ссылок на структуры, которые содержат дескрипторы чтения или записи для очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="25e03-999">Если <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> имеет `true`значение, <xref:System.Messaging.MessageQueue> то при каждом вызове метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29> <xref:System.Messaging.MessageQueue.Peek%2A>, или <xref:System.Messaging.MessageQueue.Receive%2A>, вместо открытия новых дескрипторов они будут обрабатываться из кэша.</span><span class="sxs-lookup"><span data-stu-id="25e03-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="25e03-1000">Это может повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="25e03-1000">This can improve performance.</span></span> <span data-ttu-id="25e03-1001">Использование кэша подключений также изолирует <xref:System.Messaging.MessageQueue> изменения в топологии сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="25e03-1002">При создании нового соединения с очередью, когда кэш подключения полон, объект <xref:System.Messaging.MessageQueue> перезаписывает самый последний доступную структуру с новым соединением.</span><span class="sxs-lookup"><span data-stu-id="25e03-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="25e03-1003">Можно полностью очистить кэш, вызвав <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, например, если имена форматов очередей, с которыми вы работаете, изменились, чтобы предыдущие дескрипторы чтения и записи стали недействительными.</span><span class="sxs-lookup"><span data-stu-id="25e03-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="25e03-1004">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1005">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1005">Workgroup mode</span></span>|<span data-ttu-id="25e03-1006">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1007">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1007">Local computer</span></span>|<span data-ttu-id="25e03-1008">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1008">Yes</span></span>|  
|<span data-ttu-id="25e03-1009">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1009">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1010">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1010">Yes</span></span>|  
|<span data-ttu-id="25e03-1011">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1011">Remote computer</span></span>|<span data-ttu-id="25e03-1012">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1012">Yes</span></span>|  
|<span data-ttu-id="25e03-1013">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1014">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1015">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberSignature Language="F#" Value="member this.EncryptionRequired : System.Messaging.EncryptionRequired with get, set" Usage="System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1016">Получает или задает значение, указывающее, будет ли очередь принимать только неконфиденциальные (незашифрованные) сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span></span></summary>
        <value><span data-ttu-id="25e03-1017">Одно из значений перечисления <see cref="T:System.Messaging.EncryptionRequired" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span></span> <span data-ttu-id="25e03-1018">Значение по умолчанию — <see langword="None" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1018">The default is <see langword="None" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1019">Если указано, что шифрование требуется для сообщений, отправляемых в очередь, шифруются только тексты сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="25e03-1020">Другие члены (например, <xref:System.Messaging.Message.Label%2A> свойства и <xref:System.Messaging.Message.SenderId%2A> ) не могут быть зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="25e03-1021">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-1022">В связи с этим <xref:System.Messaging.MessageQueue> изменение затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="25e03-1023">При шифровании сообщения сообщение становится частным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="25e03-1024">Для `None`параметра требования к шифрованию очереди можно задать значение, `Body`или `Optional` , задав <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойство соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="25e03-1025"><xref:System.Messaging.Message.UseEncryption%2A> Параметр сообщения должен соответствовать требованиям к шифрованию очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="25e03-1026">Если сообщение не зашифровано, а очередь указывает `Body`, или если сообщение зашифровано, а очередь указывает `None`, сообщение отклоняется очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="25e03-1027">Если отправляющее приложение запрашивает в этом событии отрицательное сообщение подтверждения, очередь сообщений указывает на отклонение сообщения отправляющему приложению.</span><span class="sxs-lookup"><span data-stu-id="25e03-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="25e03-1028">Если свойство имеет `true`значение, сообщение, которое не удается выполнить шифрование, отправляется в очередь недоставленных сообщений. <xref:System.Messaging.Message.UseDeadLetterQueue%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="25e03-1029">В противном случае сообщение будет потеряно.</span><span class="sxs-lookup"><span data-stu-id="25e03-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="25e03-1030">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1031">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1031">Workgroup mode</span></span>|<span data-ttu-id="25e03-1032">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1033">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1033">Local computer</span></span>|<span data-ttu-id="25e03-1034">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1034">Yes</span></span>|  
|<span data-ttu-id="25e03-1035">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1035">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1036">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1036">Yes</span></span>|  
|<span data-ttu-id="25e03-1037">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1037">Remote computer</span></span>|<span data-ttu-id="25e03-1038">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1038">No</span></span>|  
|<span data-ttu-id="25e03-1039">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1040">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1041">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1042">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1042">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndPeek : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndPeek asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="25e03-1043">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию считывания, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="25e03-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="25e03-1044">Завершает указанную асинхронную операцию считывания.</span><span class="sxs-lookup"><span data-stu-id="25e03-1044">Completes the specified asynchronous peek operation.</span></span></summary>
        <returns><span data-ttu-id="25e03-1045">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1046">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события <xref:System.Messaging.MessageQueue.BeginPeek%2A> завершает операцию, инициированную <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызовом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="25e03-1047">Для этого <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> просматривает сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="25e03-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A>может указывать время ожидания, которое вызывает <xref:System.Messaging.MessageQueue.PeekCompleted> событие, если время ожидания возникает до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="25e03-1049">Если время ожидания происходит без сообщения, поступающего в очередь, последующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="25e03-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>используется для чтения сообщения, которое привело <xref:System.Messaging.MessageQueue.PeekCompleted> к возникновению события.</span><span class="sxs-lookup"><span data-stu-id="25e03-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="25e03-1051">Если вы хотите продолжить асинхронное считывание сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginPeek%2A> после вызова. <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29></span><span class="sxs-lookup"><span data-stu-id="25e03-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-1052">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1053">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1053">Workgroup mode</span></span>|<span data-ttu-id="25e03-1054">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1055">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1055">Local computer</span></span>|<span data-ttu-id="25e03-1056">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1056">Yes</span></span>|  
|<span data-ttu-id="25e03-1057">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1057">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1058">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1058">Yes</span></span>|  
|<span data-ttu-id="25e03-1059">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1059">Remote computer</span></span>|<span data-ttu-id="25e03-1060">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1060">No</span></span>|  
|<span data-ttu-id="25e03-1061">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1062">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1063">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, который прикрепляет его <xref:System.Messaging.MessageQueue.PeekCompleted> к делегату обработчика событий и <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается для инициации асинхронной операции просмотра в очереди, расположенной по пути ".\микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="25e03-1064">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события пример считывает сообщение и записывает его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="25e03-1065">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1066">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1067">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="25e03-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1068">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1068">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndReceive : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndReceive asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="25e03-1069">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию получения, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="25e03-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="25e03-1070">Завершает указанную асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1070">Completes the specified asynchronous receive operation.</span></span></summary>
        <returns><span data-ttu-id="25e03-1071">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1072">При возникновении <xref:System.Messaging.MessageQueue.ReceiveCompleted> события <xref:System.Messaging.MessageQueue.BeginReceive%2A> завершает операцию, инициированную <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызовом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="25e03-1073">Для этого <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> получает сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="25e03-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A>может указывать время ожидания, которое вызывает <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, если время ожидания возникает до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="25e03-1075">Если время ожидания происходит без сообщения, поступающего в очередь, последующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="25e03-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>используется для чтения (удаления из очереди) сообщения, которое вызвало <xref:System.Messaging.MessageQueue.ReceiveCompleted> возникновение события.</span><span class="sxs-lookup"><span data-stu-id="25e03-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="25e03-1077">Если вы хотите продолжить асинхронное получение сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginReceive%2A> после вызова. <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29></span><span class="sxs-lookup"><span data-stu-id="25e03-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="25e03-1078">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1079">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1079">Workgroup mode</span></span>|<span data-ttu-id="25e03-1080">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1081">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1081">Local computer</span></span>|<span data-ttu-id="25e03-1082">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1082">Yes</span></span>|  
|<span data-ttu-id="25e03-1083">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1083">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1084">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1084">Yes</span></span>|  
|<span data-ttu-id="25e03-1085">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1085">Remote computer</span></span>|<span data-ttu-id="25e03-1086">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1086">No</span></span>|  
|<span data-ttu-id="25e03-1087">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1088">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1089">В следующем примере кода демонстрируется последовательное выполнение асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="25e03-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="25e03-1090">Предполагается, что на локальном компьютере имеется очередь с именем «myQueue».</span><span class="sxs-lookup"><span data-stu-id="25e03-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="25e03-1091">Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы. `Main`</span><span class="sxs-lookup"><span data-stu-id="25e03-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="25e03-1092">`MyReceiveCompleted`обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1093">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1094">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="25e03-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1095">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1095">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Messaging.MessageQueue.Exists path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="25e03-1096">Расположение искомой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1096">The location of the queue to find.</span></span></param>
        <summary><span data-ttu-id="25e03-1097">Определяет, существует ли по указанному пути очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1097">Determines whether a Message Queuing queue exists at the specified path.</span></span></summary>
        <returns><span data-ttu-id="25e03-1098">Значение <see langword="true" />, если очередь по указанному пути существует; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1098"><see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1099"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод определяет, существует ли очередь очереди сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="25e03-1100">Метод не существует, чтобы определить, существует ли очередь с указанным именем формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="25e03-1101">Дополнительные сведения о синтаксисе имени формата и других формах синтаксиса пути см. в <xref:System.Messaging.MessageQueue.Path%2A> описании свойства.)</span><span class="sxs-lookup"><span data-stu-id="25e03-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="25e03-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29>является дорогостоящей операцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="25e03-1103">Используйте его только в том случае, если это необходимо в приложении.</span><span class="sxs-lookup"><span data-stu-id="25e03-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="25e03-1104"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод не<xref:System.Messaging.MessageQueue.FormatName%2A> поддерживает префикс.</span><span class="sxs-lookup"><span data-stu-id="25e03-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="25e03-1105">Синтаксис `path` параметра зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-1106">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-1106">Queue type</span></span>|<span data-ttu-id="25e03-1107">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-1108">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="25e03-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29>невозможно вызвать для проверки существования удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="25e03-1110">Дополнительные сведения о синтаксисе см <xref:System.Messaging.MessageQueue.Path%2A> . в описании свойства.</span><span class="sxs-lookup"><span data-stu-id="25e03-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="25e03-1111">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.Label%2A> для описания пути очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="25e03-1112">Справочник</span><span class="sxs-lookup"><span data-stu-id="25e03-1112">Reference</span></span>|<span data-ttu-id="25e03-1113">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="25e03-1114">Метка</span><span class="sxs-lookup"><span data-stu-id="25e03-1114">Label</span></span>|<span data-ttu-id="25e03-1115">Метка: [ `label` ]</span><span class="sxs-lookup"><span data-stu-id="25e03-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="25e03-1116">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1117">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1117">Workgroup mode</span></span>|<span data-ttu-id="25e03-1118">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1119">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1119">Local computer</span></span>|<span data-ttu-id="25e03-1120">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1120">Yes</span></span>|  
|<span data-ttu-id="25e03-1121">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1121">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1122">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1122">No</span></span>|  
|<span data-ttu-id="25e03-1123">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1123">Remote computer</span></span>|<span data-ttu-id="25e03-1124">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1124">No</span></span>|  
|<span data-ttu-id="25e03-1125">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1126">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1127">В следующем примере кода проверяется, существует ли очередь очереди сообщений, а затем удаляется.</span><span class="sxs-lookup"><span data-stu-id="25e03-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1128">Неправильный синтаксис параметра <paramref name="path" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1128">The <paramref name="path" /> syntax is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1129">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1129">An error occurred when accessing a Message Queuing method.</span></span>  
  
<span data-ttu-id="25e03-1130">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-1130">-or-</span></span> 
<span data-ttu-id="25e03-1131">Метод <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> вызывается на удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1132">При проверке существования очереди приложение использовало синтаксис имени формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-1132">The application used format name syntax when verifying queue existence.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.FormatName : string" Usage="System.Messaging.MessageQueue.FormatName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1133">Получает уникальное имя очереди, созданное службой очереди сообщений в момент создания очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span></span></summary>
        <value><span data-ttu-id="25e03-1134">Имя очереди, которое является уникальным в сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1134">The name for the queue, which is unique on the network.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1135"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство содержит имя формата очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="25e03-1136">Служба очереди сообщений использует имя формата для указания открываемой очереди и способа доступа к ней.</span><span class="sxs-lookup"><span data-stu-id="25e03-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="25e03-1137">В отличие от большинства характеристик очереди, имя формата не является свойством очереди сообщений очереди приложений, поэтому доступ к нему через средство управления очередями сообщений не предоставляется.</span><span class="sxs-lookup"><span data-stu-id="25e03-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="25e03-1138">Имя формата — это просто уникальное имя очереди, которое очередь сообщений создает при создании очереди или создании приложения позже.</span><span class="sxs-lookup"><span data-stu-id="25e03-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="25e03-1139">Если указать путь с помощью синтаксиса имени пути (например, `myComputer\myQueue`) вместо использования синтаксиса имени формата при чтении или записи в очередь, основной контроллер домена (который использует Active Directory) преобразует <xref:System.Messaging.MessageQueue.Path%2A> в связанный <xref:System.Messaging.MessageQueue.FormatName%2A> перед доступом к очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="25e03-1140">Если приложение работает в автономном режиме, необходимо использовать синтаксис имени формата. в противном случае основной контроллер домена не будет доступен для преобразования пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="25e03-1141">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1142">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1142">Workgroup mode</span></span>|<span data-ttu-id="25e03-1143">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1144">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1144">Local computer</span></span>|<span data-ttu-id="25e03-1145">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1145">Yes</span></span>|  
|<span data-ttu-id="25e03-1146">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1146">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1147">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1147">Yes</span></span>|  
|<span data-ttu-id="25e03-1148">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1148">Remote computer</span></span>|<span data-ttu-id="25e03-1149">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1149">Yes</span></span>|  
|<span data-ttu-id="25e03-1150">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1151">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1152">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.FormatName%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1153"><see cref="P:System.Messaging.MessageQueue.Path" /> не указывается.</span><span class="sxs-lookup"><span data-stu-id="25e03-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span></span>  
  
<span data-ttu-id="25e03-1154">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-1154">-or-</span></span> 
<span data-ttu-id="25e03-1155">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1155">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Formatter : System.Messaging.IMessageFormatter with get, set" Usage="System.Messaging.MessageQueue.Formatter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1156">Получает или задает модуль форматирования, используемый для сериализации объекта в текст сообщения или десериализации из текста сообщения, прочитанного из очереди или записанного в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1157">Объект <see cref="T:System.Messaging.IMessageFormatter" />, создающий поток, записываемый в текст сообщения или считываемый из него.</span><span class="sxs-lookup"><span data-stu-id="25e03-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span></span> <span data-ttu-id="25e03-1158">Значение по умолчанию — <see cref="T:System.Messaging.XmlMessageFormatter" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1159"><xref:System.Messaging.MessageQueue.Formatter%2A> Свойство содержит экземпляр объекта модуля форматирования, который преобразует сообщения при чтении или записи приложения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="25e03-1160">Когда приложение отправляет сообщение в очередь, модуль форматирования сериализует объект в поток и вставляет его в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="25e03-1161">При чтении из очереди модуль форматирования десериализует данные сообщения в <xref:System.Messaging.Message.Body%2A> свойство <xref:System.Messaging.Message>объекта.</span><span class="sxs-lookup"><span data-stu-id="25e03-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="25e03-1162">Объект <xref:System.Messaging.XmlMessageFormatter> является слабо связанным, поэтому при использовании этого формата нет необходимости иметь один и тот же тип объекта для отправителя и получателя.</span><span class="sxs-lookup"><span data-stu-id="25e03-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="25e03-1163"><xref:System.Messaging.ActiveXMessageFormatter> И<xref:System.Messaging.BinaryMessageFormatter> сериализуются данные в двоичное представление.</span><span class="sxs-lookup"><span data-stu-id="25e03-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="25e03-1164"><xref:System.Messaging.ActiveXMessageFormatter> Используется при отправке или получении COM-компонентов.</span><span class="sxs-lookup"><span data-stu-id="25e03-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="25e03-1165"><xref:System.Messaging.BinaryMessageFormatter>и <xref:System.Messaging.ActiveXMessageFormatter> обеспечивают более высокую пропускную способность, <xref:System.Messaging.XmlMessageFormatter>чем.</span><span class="sxs-lookup"><span data-stu-id="25e03-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="25e03-1166">Компонент <xref:System.Messaging.ActiveXMessageFormatter> обеспечивает взаимодействие с приложениями очереди сообщений Visual Basic 6,0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="25e03-1167">Когда приложение отправляет сообщения в очередь, оно <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> применяется только к тем сообщениям, которые используют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>свойства сообщений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="25e03-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="25e03-1168">При отправке <xref:System.Messaging.Message> в очередь очередь сообщений использует модуль форматирования, определенный <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> в свойстве, для сериализации тела.</span><span class="sxs-lookup"><span data-stu-id="25e03-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="25e03-1169">Класс всегда будет <xref:System.Messaging.Message> использовать для получения или просмотра сообщения из очереди. <xref:System.Messaging.MessageQueue></span><span class="sxs-lookup"><span data-stu-id="25e03-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="25e03-1170">Сообщение десериализуется с помощью <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойства.</span><span class="sxs-lookup"><span data-stu-id="25e03-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-1171">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1172">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1172">Workgroup mode</span></span>|<span data-ttu-id="25e03-1173">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1174">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1174">Local computer</span></span>|<span data-ttu-id="25e03-1175">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1175">Yes</span></span>|  
|<span data-ttu-id="25e03-1176">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1176">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1177">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1177">Yes</span></span>|  
|<span data-ttu-id="25e03-1178">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1178">Remote computer</span></span>|<span data-ttu-id="25e03-1179">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1179">No</span></span>|  
|<span data-ttu-id="25e03-1180">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1181">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1182">В следующем примере кода показано форматирование текста сообщения с помощью <xref:System.Messaging.BinaryMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="25e03-1183">В следующем примере кода показано форматирование текста сообщения с помощью <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberSignature Language="F#" Value="member this.GetAllMessages : unit -&gt; System.Messaging.Message[]" Usage="messageQueue.GetAllMessages " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1184">Возвращает все сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1184">Returns all the messages that are in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-1185">Массив типа <see cref="T:System.Messaging.Message" />, который представляет все сообщения очереди в том же порядке, в каком они располагаются в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A>Возвращает статический моментальный снимок сообщений в очереди, а не динамические ссылки на эти сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="25e03-1187">Поэтому нельзя использовать массив для изменения сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="25e03-1188">Если требуется динамическое взаимодействие с очередью в режиме реального времени (например, возможность удаления сообщений), вызовите <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> метод, который возвращает динамический список сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1189">Поскольку <xref:System.Messaging.MessageQueue.GetAllMessages%2A> возвращает копию сообщений в очереди на момент вызова метода, массив не отражает новые сообщения, поступающие в очередь или сообщения, удаленные из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="25e03-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A>Извлекает только те свойства, <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> которые не отфильтрованы свойством.</span><span class="sxs-lookup"><span data-stu-id="25e03-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="25e03-1191">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1192">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1192">Workgroup mode</span></span>|<span data-ttu-id="25e03-1193">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1194">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1194">Local computer</span></span>|<span data-ttu-id="25e03-1195">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1195">Yes</span></span>|  
|<span data-ttu-id="25e03-1196">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1196">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1197">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1197">Yes</span></span>|  
|<span data-ttu-id="25e03-1198">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1198">Remote computer</span></span>|<span data-ttu-id="25e03-1199">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1199">No</span></span>|  
|<span data-ttu-id="25e03-1200">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1201">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1202">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1203">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1203">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberSignature Language="F#" Value="abstract member GetEnumerator : unit -&gt; System.Collections.IEnumerator&#xA;override this.GetEnumerator : unit -&gt; System.Collections.IEnumerator" Usage="messageQueue.GetEnumerator " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1204">Перечисляет сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1204">Enumerates the messages in a queue.</span></span> <span data-ttu-id="25e03-1205">Параметр <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="25e03-1205"><see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span></span> <span data-ttu-id="25e03-1206">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1206"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="25e03-1207">Объект <see cref="T:System.Collections.IEnumerator" />, обеспечивающий динамическое подключение к сообщениям очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1208">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1209">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1209">Workgroup mode</span></span>|<span data-ttu-id="25e03-1210">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1211">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1211">Local computer</span></span>|<span data-ttu-id="25e03-1212">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1212">Yes</span></span>|  
|<span data-ttu-id="25e03-1213">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1213">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1214">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1214">Yes</span></span>|  
|<span data-ttu-id="25e03-1215">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1215">Remote computer</span></span>|<span data-ttu-id="25e03-1216">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1216">No</span></span>|  
|<span data-ttu-id="25e03-1217">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1218">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1219">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetMachineId : string -&gt; Guid" Usage="System.Messaging.MessageQueue.GetMachineId machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="25e03-1220">Имя компьютера, на котором расположена очередь, без двух обратных косых черт (\\\\) в начале.</span><span class="sxs-lookup"><span data-stu-id="25e03-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span></span></param>
        <summary><span data-ttu-id="25e03-1221">Получает идентификатор компьютера, на котором расположена очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span></span></summary>
        <returns><span data-ttu-id="25e03-1222">Объект <see cref="T:System.Guid" />, который представляет уникальный идентификатор компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1223">Идентификатор компьютера можно использовать в двух целях: для чтения журнала компьютера и для установки сертификатов безопасности.</span><span class="sxs-lookup"><span data-stu-id="25e03-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="25e03-1224">Однако при работе в автономном режиме вы не можете вызвать <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> удаленный компьютер, так как приложение должно иметь доступ к службе каталогов на контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="25e03-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="25e03-1225">Идентификатор компьютера (или идентификатор компьютера) — <xref:System.Guid> это сообщение, которое служба MSMQ создает при добавлении компьютера в предприятие.</span><span class="sxs-lookup"><span data-stu-id="25e03-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="25e03-1226">Служба очередей сообщений объединяет идентификатор компьютера с `Machine` ключевыми словами и `Journal` для создания имени формата журнала компьютера с синтаксисом `Machine=<computeridentifier>;Journal`.</span><span class="sxs-lookup"><span data-stu-id="25e03-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="25e03-1227">Журнал компьютера, который также называется очередью журнала, представляет собой системную очередь, в которой хранятся копии сообщений, созданных приложением, если <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойство имеет `true`значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="25e03-1228">Этот синтаксис для журнала допустим только при формировании имени формата для очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="25e03-1229">Синтаксис имени пути — `MachineName`. \\ `Journal$`</span><span class="sxs-lookup"><span data-stu-id="25e03-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="25e03-1230">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1231">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1231">Workgroup mode</span></span>|<span data-ttu-id="25e03-1232">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1233">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1233">Local computer</span></span>|<span data-ttu-id="25e03-1234">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1234">No</span></span>|  
|<span data-ttu-id="25e03-1235">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1235">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1236">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1236">No</span></span>|  
|<span data-ttu-id="25e03-1237">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1237">Remote computer</span></span>|<span data-ttu-id="25e03-1238">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1238">No</span></span>|  
|<span data-ttu-id="25e03-1239">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1240">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1241">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1242">Не удается извлечь идентификатор компьютера. Возможной причиной может быть недоступность службы каталогов: например, при работе в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="25e03-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span></span>  
  
 <span data-ttu-id="25e03-1243">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-1243">-or-</span></span>  
  
 <span data-ttu-id="25e03-1244">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1244">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1245">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1245">Creates an enumerator object for all the messages in the queue.</span></span> <span data-ttu-id="25e03-1246">Параметр <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="25e03-1246"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span></span> <span data-ttu-id="25e03-1247">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1247"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="25e03-1248">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A>создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="25e03-1250">Можно удалить из очереди сообщение в текущей позиции перечислителя, вызвав метод <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> <xref:System.Messaging.MessageEnumerator> для, который <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="25e03-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="25e03-1251">Поскольку курсор связан с динамическим списком сообщений в очереди, перечисление отражает любые изменения, внесенные в сообщения в очереди, если сообщение находится за пределами текущего положения курсора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="25e03-1252">Например, перечислитель может автоматически получить доступ к сообщениям с низким приоритетом, размещенному за пределами текущей позиции курсора, но не с более высоким приоритетом сообщением, вставленным перед этой позицией.</span><span class="sxs-lookup"><span data-stu-id="25e03-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="25e03-1253">Однако можно сбросить перечисление, таким образом переместив курсор обратно в начало списка, вызвав метод <xref:System.Messaging.MessageEnumerator.Reset%2A> <xref:System.Messaging.MessageEnumerator>для.</span><span class="sxs-lookup"><span data-stu-id="25e03-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="25e03-1254">Порядок сообщений в перечислении отражает порядок их следования в очереди, поэтому сообщения с более высоким приоритетом будут отображаться до приоритетов.</span><span class="sxs-lookup"><span data-stu-id="25e03-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="25e03-1255">Если требуется статический моментальный снимок сообщений в очереди, а не динамическое соединение с ними, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="25e03-1256">Этот метод возвращает массив <xref:System.Messaging.Message> объектов, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="25e03-1257">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1258">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1258">Workgroup mode</span></span>|<span data-ttu-id="25e03-1259">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1260">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1260">Local computer</span></span>|<span data-ttu-id="25e03-1261">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1261">Yes</span></span>|  
|<span data-ttu-id="25e03-1262">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1262">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1263">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1263">Yes</span></span>|  
|<span data-ttu-id="25e03-1264">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1264">Remote computer</span></span>|<span data-ttu-id="25e03-1265">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1265">Yes</span></span>|  
|<span data-ttu-id="25e03-1266">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1267">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1268">Следующий пример кода возвращает динамический список сообщений в очереди и подсчитывает все сообщения, для <xref:System.Messaging.Message.Priority%2A> <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>которых свойство имеет значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator2 : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator2 " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1269">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1269">Creates an enumerator object for all the messages in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-1270">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A>создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="25e03-1272">Можно удалить из очереди сообщение в текущей позиции перечислителя, вызвав метод <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> <xref:System.Messaging.MessageEnumerator> для, который <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="25e03-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="25e03-1273">Поскольку курсор связан с динамическим списком сообщений в очереди, перечисление отражает любые изменения, внесенные в сообщения в очереди, если сообщение находится за пределами текущего положения курсора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="25e03-1274">Например, перечислитель может автоматически получить доступ к сообщениям с низким приоритетом, размещенному за пределами текущей позиции курсора, но не с более высоким приоритетом сообщением, вставленным перед этой позицией.</span><span class="sxs-lookup"><span data-stu-id="25e03-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="25e03-1275">Однако можно сбросить перечисление, таким образом переместив курсор обратно в начало списка, вызвав метод <xref:System.Messaging.MessageEnumerator.Reset%2A> <xref:System.Messaging.MessageEnumerator>для.</span><span class="sxs-lookup"><span data-stu-id="25e03-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="25e03-1276">Порядок сообщений в перечислении отражает порядок их следования в очереди, поэтому сообщения с более высоким приоритетом будут отображаться до приоритетов.</span><span class="sxs-lookup"><span data-stu-id="25e03-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="25e03-1277">Если требуется статический моментальный снимок сообщений в очереди, а не динамическое соединение с ними, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="25e03-1278">Этот метод возвращает массив <xref:System.Messaging.Message> объектов, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="25e03-1279">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1280">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1280">Workgroup mode</span></span>|<span data-ttu-id="25e03-1281">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1282">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1282">Local computer</span></span>|<span data-ttu-id="25e03-1283">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1283">Yes</span></span>|  
|<span data-ttu-id="25e03-1284">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1284">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1285">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1285">Yes</span></span>|  
|<span data-ttu-id="25e03-1286">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1286">Remote computer</span></span>|<span data-ttu-id="25e03-1287">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1287">Yes</span></span>|  
|<span data-ttu-id="25e03-1288">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1289">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-1290">Создает объект перечислителя для динамического списка общих очередей сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : unit -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1291">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="25e03-1292">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление всех общих очередей сообщений в сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1293">Эта перегрузка метода <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращает перечисление всех публичных очередей, наявляющихся в сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="25e03-1294">Так как курсор связан с динамическим списком, перечисление отражает любые изменения, вносимые в список очередей для очередей, удаленных или добавленных за текущую позицию курсора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="25e03-1295">Добавление или удаление очередей, расположенных перед текущей позицией курсора, не отражается.</span><span class="sxs-lookup"><span data-stu-id="25e03-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="25e03-1296">Например, перечислитель может автоматически получить доступ к очереди, добавленной за пределами курсора, но не одну до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="25e03-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="25e03-1297">Однако можно сбросить перечисление, таким образом переместив курсор обратно в начало списка, вызвав метод <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> <xref:System.Messaging.MessageQueueEnumerator>для.</span><span class="sxs-lookup"><span data-stu-id="25e03-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="25e03-1298">В сети не определено упорядочение очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="25e03-1299">Перечислитель не упорядочивает их, например, по компьютеру, метке, общедоступному или частному состоянию или любым другим критериям, доступным для использования.</span><span class="sxs-lookup"><span data-stu-id="25e03-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="25e03-1300">Если требуется статический моментальный снимок очередей в сети, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="25e03-1301">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объектов, которые представляют очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="25e03-1302">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1303">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1303">Workgroup mode</span></span>|<span data-ttu-id="25e03-1304">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1305">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1305">Local computer</span></span>|<span data-ttu-id="25e03-1306">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1306">No</span></span>|  
|<span data-ttu-id="25e03-1307">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1307">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1308">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1308">No</span></span>|  
|<span data-ttu-id="25e03-1309">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1309">Remote computer</span></span>|<span data-ttu-id="25e03-1310">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1310">No</span></span>|  
|<span data-ttu-id="25e03-1311">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1312">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1313">В следующем примере кода выполняется перебор всех очередей сообщений в сети и проверяется путь для каждой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="25e03-1314">И, наконец, отображается число общих очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="25e03-1315">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации доступных очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span></span></param>
        <summary><span data-ttu-id="25e03-1316">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети, удовлетворяющих указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="25e03-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="25e03-1317">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление общих очередей сообщений сети, удовлетворяющих ограничениям, заданным параметром <paramref name="criteria" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1318">Эта перегрузка <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращает список всех публичных очередей в сети, удовлетворяющих критериям, определенным в критерии приложения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="25e03-1319">Можно указать критерии для включения, например, время создания или изменения очереди, имя компьютера, метка, категория или любое сочетание этих параметров.</span><span class="sxs-lookup"><span data-stu-id="25e03-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="25e03-1320">Так как курсор связан с динамическим списком, перечисление отражает любые изменения, внесенные в очередь, которая находится за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="25e03-1321">Изменения в очередях, расположенных до текущей позиции курсора, не отражаются.</span><span class="sxs-lookup"><span data-stu-id="25e03-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="25e03-1322">Например, перечислитель может автоматически получить доступ к очереди, добавленной за пределами курсора, но не одну до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="25e03-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="25e03-1323">Однако можно сбросить перечисление, таким образом переместив курсор обратно в начало списка, вызвав метод <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> <xref:System.Messaging.MessageQueueEnumerator>для.</span><span class="sxs-lookup"><span data-stu-id="25e03-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="25e03-1324">В сети не определено упорядочение очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="25e03-1325">Перечислитель не упорядочивает их, например, по компьютеру, метке, общедоступному или частному состоянию или любым другим критериям, доступным для использования.</span><span class="sxs-lookup"><span data-stu-id="25e03-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="25e03-1326">Если требуется статический моментальный снимок очередей в сети, а не динамическое подключение к ним, укажите условия для <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или вызовите. <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29></span><span class="sxs-lookup"><span data-stu-id="25e03-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="25e03-1327">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объектов, которые представляют очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="25e03-1328">Вызов <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>метода <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.Label%2A> <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> предоставляет те же <xref:System.Messaging.MessageQueue.MachineName%2A> результаты,чтоипривызовескритериямифильтрации,исоответственно.<xref:System.Messaging.MessageQueue.Category%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="25e03-1329">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1330">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1330">Workgroup mode</span></span>|<span data-ttu-id="25e03-1331">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1332">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1332">Local computer</span></span>|<span data-ttu-id="25e03-1333">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1333">No</span></span>|  
|<span data-ttu-id="25e03-1334">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1334">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1335">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1335">No</span></span>|  
|<span data-ttu-id="25e03-1336">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1336">Remote computer</span></span>|<span data-ttu-id="25e03-1337">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1337">No</span></span>|  
|<span data-ttu-id="25e03-1338">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1339">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1340">В следующем примере кода выполняется перебор очередей сообщений и отображается путь к каждой очереди, которая была создана за последний день и существует на компьютере "MyComputer".</span><span class="sxs-lookup"><span data-stu-id="25e03-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPrivateQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPrivateQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="25e03-1341">Компьютер, из которого извлекаются частные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1341">The computer from which to retrieve the private queues.</span></span></param>
        <summary><span data-ttu-id="25e03-1342">Извлекает все частные очереди на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="25e03-1342">Retrieves all the private queues on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="25e03-1343">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные частные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>Получает статический моментальный снимок очередей на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="25e03-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="25e03-1345">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1346">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1346">Workgroup mode</span></span>|<span data-ttu-id="25e03-1347">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1348">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1348">Local computer</span></span>|<span data-ttu-id="25e03-1349">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1349">Yes</span></span>|  
|<span data-ttu-id="25e03-1350">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1350">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1351">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1351">Yes</span></span>|  
|<span data-ttu-id="25e03-1352">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1352">Remote computer</span></span>|<span data-ttu-id="25e03-1353">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1353">Yes</span></span>|  
|<span data-ttu-id="25e03-1354">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1355">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1356">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1357">Значение параметра <paramref name="machineName" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="25e03-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1358">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1358">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-1359">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1359">Retrieves all the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : unit -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1360">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1360">Retrieves all the public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="25e03-1361">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1362">Используйте эту перегрузку, если требуется полный список всех общих очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="25e03-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="25e03-1363">Если требуется ограничить список по определенным критериям, таким как <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>или время последнего изменения, используйте другую перегрузку этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="25e03-1364">(В качестве альтернативы можно <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>использовать <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, или <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span><span class="sxs-lookup"><span data-stu-id="25e03-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="25e03-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A>Извлекает статический моментальный снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="25e03-1366">Для взаимодействия с динамическим списком очередей используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="25e03-1367">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1368">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1368">Workgroup mode</span></span>|<span data-ttu-id="25e03-1369">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1370">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1370">Local computer</span></span>|<span data-ttu-id="25e03-1371">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1371">No</span></span>|  
|<span data-ttu-id="25e03-1372">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1372">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1373">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1373">No</span></span>|  
|<span data-ttu-id="25e03-1374">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1374">Remote computer</span></span>|<span data-ttu-id="25e03-1375">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1375">No</span></span>|  
|<span data-ttu-id="25e03-1376">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1377">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1378">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1379">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1379">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="25e03-1380">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span></span></param>
        <summary><span data-ttu-id="25e03-1381">Извлекает все общие очереди сети, удовлетворяющие указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="25e03-1381">Retrieves all the public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="25e03-1382">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1383">Если нужно отфильтровать все общие очереди в сети по метке, категории или <xref:System.Messaging.MessageQueue> имени компьютера, класс содержит конкретные методы, которые предоставляют эту функциональность (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>и <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>соответственно).</span><span class="sxs-lookup"><span data-stu-id="25e03-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="25e03-1384">Используйте эту перегрузку, чтобы получить список всех публичных очередей в сети, отвечающих нескольким критериям (например, если требуется указать и метку, и категорию).</span><span class="sxs-lookup"><span data-stu-id="25e03-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="25e03-1385">Кроме того, можно выполнять фильтрацию по критериям <xref:System.Messaging.MessageQueue.Label%2A>сообщения <xref:System.Messaging.MessageQueue.Category%2A>, отличным <xref:System.Messaging.MessageQueue.MachineName%2A>от, и.</span><span class="sxs-lookup"><span data-stu-id="25e03-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="25e03-1386">Например, эта перегрузка используется для фильтрации по времени последнего изменения очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="25e03-1387">Просто создайте новый экземпляр <xref:System.Messaging.MessageQueueCriteria> класса, задайте соответствующие свойства в экземпляре и передайте экземпляр в `criteria` качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="25e03-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A>Извлекает статический моментальный снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="25e03-1389">Для взаимодействия с динамическим списком очередей используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="25e03-1390">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1391">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1391">Workgroup mode</span></span>|<span data-ttu-id="25e03-1392">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1393">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1393">Local computer</span></span>|<span data-ttu-id="25e03-1394">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1394">No</span></span>|  
|<span data-ttu-id="25e03-1395">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1395">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1396">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1396">No</span></span>|  
|<span data-ttu-id="25e03-1397">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1397">Remote computer</span></span>|<span data-ttu-id="25e03-1398">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1398">No</span></span>|  
|<span data-ttu-id="25e03-1399">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1400">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1401">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1402">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1402">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByCategory : Guid -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByCategory category" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category"><span data-ttu-id="25e03-1403">Класс <see cref="T:System.Guid" />, который группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="25e03-1404">Извлекает все общие очереди сети, принадлежащие к указанной категории.</span><span class="sxs-lookup"><span data-stu-id="25e03-1404">Retrieves all the public queues on the network that belong to the specified category.</span></span></summary>
        <returns><span data-ttu-id="25e03-1405">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1406">Используйте этот метод для фильтрации общих очередей по категориям.</span><span class="sxs-lookup"><span data-stu-id="25e03-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="25e03-1407"><xref:System.Messaging.MessageQueue.Category%2A> Свойство предоставляет доступ к свойству идентификатора типа Message Queuing (которое доступно для чтения и записи) конкретной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="25e03-1408">Несмотря на то, <xref:System.Guid.NewGuid%2A> что можно использовать для создания значения категории, уникального <xref:System.Guid> для всех значений, это необязательно.</span><span class="sxs-lookup"><span data-stu-id="25e03-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="25e03-1409">Значение категории должно отличаться только от других категорий, а не от всех других <xref:System.Guid> значений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="25e03-1410">Например, можно {00000000-0000-0000-0000-000000000001} назначить в <xref:System.Messaging.MessageQueue.Category%2A> качестве для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="25e03-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>Извлекает статический моментальный снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="25e03-1412">Для взаимодействия с динамическим списком очередей используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="25e03-1413">Категорию можно указать как часть, <xref:System.Messaging.MessageQueueCriteria> которую вы передаете в метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="25e03-1414">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1415">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1415">Workgroup mode</span></span>|<span data-ttu-id="25e03-1416">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1417">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1417">Local computer</span></span>|<span data-ttu-id="25e03-1418">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1418">No</span></span>|  
|<span data-ttu-id="25e03-1419">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1419">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1420">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1420">No</span></span>|  
|<span data-ttu-id="25e03-1421">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1421">Remote computer</span></span>|<span data-ttu-id="25e03-1422">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1422">No</span></span>|  
|<span data-ttu-id="25e03-1423">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1424">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1425">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByLabel : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByLabel label" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label"><span data-ttu-id="25e03-1427">Метка, которая группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1427">A label that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="25e03-1428">Извлекает все общие очереди сети с указанной меткой.</span><span class="sxs-lookup"><span data-stu-id="25e03-1428">Retrieves all the public queues on the network that carry the specified label.</span></span></summary>
        <returns><span data-ttu-id="25e03-1429">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1430">Используйте этот метод для фильтрации общих очередей по метке.</span><span class="sxs-lookup"><span data-stu-id="25e03-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="25e03-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>Извлекает статический моментальный снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="25e03-1432">Для взаимодействия с динамическим списком очередей используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="25e03-1433">Метку можно указать как часть, <xref:System.Messaging.MessageQueueCriteria> передавая методу.</span><span class="sxs-lookup"><span data-stu-id="25e03-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="25e03-1434">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1435">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1435">Workgroup mode</span></span>|<span data-ttu-id="25e03-1436">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1437">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1437">Local computer</span></span>|<span data-ttu-id="25e03-1438">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1438">No</span></span>|  
|<span data-ttu-id="25e03-1439">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1439">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1440">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1440">No</span></span>|  
|<span data-ttu-id="25e03-1441">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1441">Remote computer</span></span>|<span data-ttu-id="25e03-1442">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1442">No</span></span>|  
|<span data-ttu-id="25e03-1443">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1444">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1445">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1446">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1446">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1447">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="25e03-1448">Имя компьютера, на котором располагается набор извлекаемых общих очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1448">The name of the computer that contains the set of public queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="25e03-1449">Извлекает все общие очереди, находящиеся на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="25e03-1449">Retrieves all the public queues that reside on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="25e03-1450">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на общие очереди, находящиеся на компьютере.</span><span class="sxs-lookup"><span data-stu-id="25e03-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1451">Используйте этот метод для фильтрации общих очередей по компьютерам.</span><span class="sxs-lookup"><span data-stu-id="25e03-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="25e03-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>Извлекает статический моментальный снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="25e03-1453">Для взаимодействия с динамическим списком очередей используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="25e03-1454">Имя компьютера можно указать как часть объекта, <xref:System.Messaging.MessageQueueCriteria> передаваемого в метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="25e03-1455">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1456">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1456">Workgroup mode</span></span>|<span data-ttu-id="25e03-1457">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1458">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1458">Local computer</span></span>|<span data-ttu-id="25e03-1459">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1459">No</span></span>|  
|<span data-ttu-id="25e03-1460">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1460">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1461">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1461">No</span></span>|  
|<span data-ttu-id="25e03-1462">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1462">Remote computer</span></span>|<span data-ttu-id="25e03-1463">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1463">No</span></span>|  
|<span data-ttu-id="25e03-1464">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1465">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1466">В следующем примере кода извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1467">Параметр <paramref name="machineName" /> имеет неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="25e03-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1468">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1468">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberSignature Language="F#" Value="static member GetSecurityContext : unit -&gt; System.Messaging.SecurityContext" Usage="System.Messaging.MessageQueue.GetSecurityContext " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1469">Извлекает контекст безопасности, который служба MSMQ связывает с текущим пользователем (удостоверением потока) на момент этого вызова.</span><span class="sxs-lookup"><span data-stu-id="25e03-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span></span></summary>
        <returns><span data-ttu-id="25e03-1470">Объект <see cref="T:System.Messaging.SecurityContext" />, содержащий контекст безопасности.</span><span class="sxs-lookup"><span data-stu-id="25e03-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberSignature Language="F#" Value="member this.Id : Guid" Usage="System.Messaging.MessageQueue.Id" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1471">Получает уникальный идентификатор очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1471">Gets the unique Message Queuing identifier of the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1472">Свойство <see cref="P:System.Messaging.MessageQueue.Id" />, представляющее идентификатор сообщения, создаваемый приложением очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1473">Служба очереди сообщений задает <xref:System.Messaging.MessageQueue.Id%2A> свойство при создании очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="25e03-1474">Это свойство доступно только для общих очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="25e03-1475">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1476">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1476">Workgroup mode</span></span>|<span data-ttu-id="25e03-1477">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1478">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1478">Local computer</span></span>|<span data-ttu-id="25e03-1479">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1479">Yes</span></span>|  
|<span data-ttu-id="25e03-1480">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1480">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1481">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1481">Yes</span></span>|  
|<span data-ttu-id="25e03-1482">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1482">Remote computer</span></span>|<span data-ttu-id="25e03-1483">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1483">No</span></span>|  
|<span data-ttu-id="25e03-1484">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1485">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1486">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.Id%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1487">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1487">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteQueueSize : int64" Usage="System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1488">Указывает, что для очереди нет ограничений по размеру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1488">Specifies that no size restriction exists for a queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1489">Этот элемент часто используется при задании <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> или <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1490">В следующем примере кода показано использование <xref:System.Messaging.MessageQueue.InfiniteQueueSize> элемента.</span><span class="sxs-lookup"><span data-stu-id="25e03-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteTimeout : TimeSpan" Usage="System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1491">Указывает, что для методов считывания и получения сообщений не существует тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="25e03-1491">Specifies that no time-out exists for methods that peek or receive messages.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1492"><xref:System.Messaging.MessageQueue>поддерживает два типа извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="25e03-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="25e03-1493">Синхронные методы, <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, вызывают поток процесса для ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1494">Если указанный интервал времени равен <xref:System.Messaging.MessageQueue.InfiniteTimeout>, поток процесса остается заблокированным, пока не будет доступно новое сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="25e03-1495">С другой стороны, <xref:System.Messaging.MessageQueue.BeginPeek%2A> и <xref:System.Messaging.MessageQueue.BeginReceive%2A> (асинхронные методы) позволяют основным задачам приложения продолжать работу в отдельном потоке, пока сообщение не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1496">В следующем примере кода показано использование <xref:System.Messaging.MessageQueue.InfiniteTimeout> элемента.</span><span class="sxs-lookup"><span data-stu-id="25e03-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Label : string with get, set" Usage="System.Messaging.MessageQueue.Label" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1497">Получает или задает описание очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1497">Gets or sets the queue description.</span></span></summary>
        <value><span data-ttu-id="25e03-1498">Метка очереди сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1498">The label for the message queue.</span></span> <span data-ttu-id="25e03-1499">Значение по умолчанию — пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="25e03-1499">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1500">Максимальная длина метки очереди сообщений составляет 124 символов.</span><span class="sxs-lookup"><span data-stu-id="25e03-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="25e03-1501"><xref:System.Messaging.MessageQueue.Label%2A> Свойство не обязательно должно быть уникальным для всех очередей.</span><span class="sxs-lookup"><span data-stu-id="25e03-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="25e03-1502">Однако если несколько очередей совместно используются <xref:System.Messaging.MessageQueue.Label%2A>, то нельзя <xref:System.Messaging.MessageQueue.Send%28System.Object%29> использовать метод для передачи сообщения всем из них.</span><span class="sxs-lookup"><span data-stu-id="25e03-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="25e03-1503">Если при отправке сообщения используется синтаксис метки <xref:System.Messaging.MessageQueue.Path%2A> для свойства, будет создано исключение, <xref:System.Messaging.MessageQueue.Label%2A> если не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="25e03-1504">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1505">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1505">Workgroup mode</span></span>|<span data-ttu-id="25e03-1506">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1507">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1507">Local computer</span></span>|<span data-ttu-id="25e03-1508">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1508">Yes</span></span>|  
|<span data-ttu-id="25e03-1509">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1509">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1510">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1510">Yes</span></span>|  
|<span data-ttu-id="25e03-1511">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1511">Remote computer</span></span>|<span data-ttu-id="25e03-1512">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1512">No</span></span>|  
|<span data-ttu-id="25e03-1513">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1514">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1515">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.Label%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1516">Для метки задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1516">The label was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1517">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.LastModifyTime : DateTime" Usage="System.Messaging.MessageQueue.LastModifyTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1518">Получает время последнего изменения свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1518">Gets the last time the properties of a queue were modified.</span></span></summary>
        <value><span data-ttu-id="25e03-1519">Объект <see cref="T:System.DateTime" />, который указывает, когда свойства очереди были изменены в последний раз.</span><span class="sxs-lookup"><span data-stu-id="25e03-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1520">Время последнего изменения включает в себя время создания очереди и любое <xref:System.Messaging.MessageQueue> свойство, изменяющее очередь очереди сообщений, <xref:System.Messaging.MessageQueue.BasePriority%2A>например.</span><span class="sxs-lookup"><span data-stu-id="25e03-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="25e03-1521">Значение <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойства представляет системное время локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="25e03-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="25e03-1522">Необходимо вызвать метод <xref:System.Messaging.MessageQueue.Refresh%2A> перед <xref:System.Messaging.MessageQueue.LastModifyTime%2A> получением свойства; в противном случае время изменения, связанное с этим <xref:System.Messaging.MessageQueue> , может быть не актуальным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="25e03-1523">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1524">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1524">Workgroup mode</span></span>|<span data-ttu-id="25e03-1525">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1526">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1526">Local computer</span></span>|<span data-ttu-id="25e03-1527">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1527">Yes</span></span>|  
|<span data-ttu-id="25e03-1528">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1528">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1529">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1529">Yes</span></span>|  
|<span data-ttu-id="25e03-1530">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1530">Remote computer</span></span>|<span data-ttu-id="25e03-1531">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1531">No</span></span>|  
|<span data-ttu-id="25e03-1532">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1533">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1534">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1535">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1535">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Messaging.MessageQueue.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1536">Получает или задает имя компьютера, на котором расположена очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="25e03-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span></span></summary>
        <value><span data-ttu-id="25e03-1537">Имя компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1537">The name of the computer where the queue is located.</span></span> <span data-ttu-id="25e03-1538">По умолчанию службой Message Queuing используется значение ".", т. е. локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-1538">The Message Queuing default is ".", the local computer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1539">Компонент является неотъемлемой частью синтаксиса понятного имени очереди <xref:System.Messaging.MessageQueue.Path%2A>. <xref:System.Messaging.MessageQueue.MachineName%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="25e03-1540">В следующей таблице показан синтаксис, который следует использовать для очереди указанного типа, если необходимо указать путь очереди, используя его понятное имя.</span><span class="sxs-lookup"><span data-stu-id="25e03-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="25e03-1541">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-1541">Queue type</span></span>|<span data-ttu-id="25e03-1542">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-1543">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-1544">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="25e03-1545">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="25e03-1546">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="25e03-1547">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="25e03-1548">Очередь недоставленных транзактных сообщений на компьютере</span><span class="sxs-lookup"><span data-stu-id="25e03-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="25e03-1549">Используйте "." для локального компьютера при указании <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="25e03-1550">Для этого свойства распознается только имя компьютера, например `Server0`.</span><span class="sxs-lookup"><span data-stu-id="25e03-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="25e03-1551"><xref:System.Messaging.MessageQueue.MachineName%2A> Свойство не поддерживает формат IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="25e03-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="25e03-1552">Если определить <xref:System.Messaging.MessageQueue.Path%2A> с точки зрения <xref:System.Messaging.MessageQueue.MachineName%2A>, то приложение выдаст исключение при автономной работе, поскольку для преобразования пути требуется контроллер домена.</span><span class="sxs-lookup"><span data-stu-id="25e03-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="25e03-1553">Поэтому при работе в <xref:System.Messaging.MessageQueue.FormatName%2A> автономном режиме необходимо использовать <xref:System.Messaging.MessageQueue.Path%2A> для синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="25e03-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="25e03-1554">Свойства <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A> и<xref:System.Messaging.MessageQueue.QueueName%2A> являются связанными.</span><span class="sxs-lookup"><span data-stu-id="25e03-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="25e03-1555">Изменение свойства приводит к изменению <xref:System.Messaging.MessageQueue.Path%2A>Свойства. <xref:System.Messaging.MessageQueue.MachineName%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="25e03-1556">Он строится на основе новых <xref:System.Messaging.MessageQueue.MachineName%2A> <xref:System.Messaging.MessageQueue.QueueName%2A>и.</span><span class="sxs-lookup"><span data-stu-id="25e03-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="25e03-1557">Изменение (например, использование синтаксиса имени формата) <xref:System.Messaging.MessageQueue.MachineName%2A> сбрасывает свойства и <xref:System.Messaging.MessageQueue.QueueName%2A> для ссылки на новую очередь. <xref:System.Messaging.MessageQueue.Path%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="25e03-1558">Если свойство пусто, задается очередь журнала заданного компьютера. <xref:System.Messaging.MessageQueue.Path%2A> <xref:System.Messaging.MessageQueue.QueueName%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="25e03-1559">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1560">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1560">Workgroup mode</span></span>|<span data-ttu-id="25e03-1561">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1562">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1562">Local computer</span></span>|<span data-ttu-id="25e03-1563">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1563">Yes</span></span>|  
|<span data-ttu-id="25e03-1564">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1564">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1565">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1565">Yes</span></span>|  
|<span data-ttu-id="25e03-1566">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1566">Remote computer</span></span>|<span data-ttu-id="25e03-1567">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1567">Yes</span></span>|  
|<span data-ttu-id="25e03-1568">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1569">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1570">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.MachineName%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1571">Значение параметра <see cref="P:System.Messaging.MessageQueue.MachineName" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1571">The <see cref="P:System.Messaging.MessageQueue.MachineName" /> is <see langword="null" />.</span></span>        
<span data-ttu-id="25e03-1572">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-1572">-or-</span></span>

<span data-ttu-id="25e03-1573">Недопустимое имя компьютера. Причиной может быть неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="25e03-1573">The name of the computer is not valid, possibly because the syntax is incorrect.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1574">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1574">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumJournalSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1575">Получает или задает максимальный размер очереди журнала.</span><span class="sxs-lookup"><span data-stu-id="25e03-1575">Gets or sets the maximum size of the journal queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1576">Максимальный размер очереди журнала в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="25e03-1576">The maximum size, in kilobytes, of the journal queue.</span></span> <span data-ttu-id="25e03-1577">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1577">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>предоставляет доступ к ограничению хранилища журнала очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="25e03-1579">Он имеет смысл только в <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> том `true`случае, если имеет значения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1579">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="25e03-1580">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1580">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-1581">Таким образом, изменение <xref:System.Messaging.MessageQueue> затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-1581">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="25e03-1582">Если сообщения хранятся в журнале или очереди недоставленных сообщений, следует периодически очищать очередь для удаления сообщений, которые больше не нужны.</span><span class="sxs-lookup"><span data-stu-id="25e03-1582">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="25e03-1583">Сообщения в такой очереди подсчитывается в соответствии с квотой сообщений для компьютера, на котором находится очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1583">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="25e03-1584">(Администратор устанавливает квоту компьютера.)</span><span class="sxs-lookup"><span data-stu-id="25e03-1584">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="25e03-1585">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1585">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1586">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1586">Workgroup mode</span></span>|<span data-ttu-id="25e03-1587">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1587">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1588">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1588">Local computer</span></span>|<span data-ttu-id="25e03-1589">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1589">Yes</span></span>|  
|<span data-ttu-id="25e03-1590">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1590">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1591">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1591">Yes</span></span>|  
|<span data-ttu-id="25e03-1592">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1592">Remote computer</span></span>|<span data-ttu-id="25e03-1593">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1593">No</span></span>|  
|<span data-ttu-id="25e03-1594">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1594">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1595">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1595">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1596">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1596">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1597">Для максимального размера очереди журнала установлено недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1597">The maximum journal queue size was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1598">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1598">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumQueueSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1599">Получает или задает максимальный размер очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1599">Gets or sets the maximum size of the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1600">Максимальный размер очереди в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="25e03-1600">The maximum size, in kilobytes, of the queue.</span></span> <span data-ttu-id="25e03-1601">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1601">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1602"><xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> Предоставляет доступ к ограничению хранилища сообщений очереди сообщений, отдельно от квоты сообщений компьютера, определяемой администратором.</span><span class="sxs-lookup"><span data-stu-id="25e03-1602">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="25e03-1603">Дополнительные сведения о квоте сообщений см. в <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>разделе.</span><span class="sxs-lookup"><span data-stu-id="25e03-1603">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="25e03-1604">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1604">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-1605">Таким образом, изменение <xref:System.Messaging.MessageQueue> затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-1605">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="25e03-1606">Если предпринимается попытка превышения максимального размера очереди или квоты сообщений компьютера, сообщения могут быть потеряны.</span><span class="sxs-lookup"><span data-stu-id="25e03-1606">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="25e03-1607">По достижении квоты очереди служба очереди сообщений уведомляет очередь администрирования отправляющего приложения, чтобы указать, что очередь заполнена, выполнив возврат сообщения с отрицательным подтверждением.</span><span class="sxs-lookup"><span data-stu-id="25e03-1607">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="25e03-1608">Очередь сообщений по очереди отправляет негативные подтверждения, пока общий размер сообщений в очереди не станет меньше предела.</span><span class="sxs-lookup"><span data-stu-id="25e03-1608">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="25e03-1609">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1609">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1610">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1610">Workgroup mode</span></span>|<span data-ttu-id="25e03-1611">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1611">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1612">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1612">Local computer</span></span>|<span data-ttu-id="25e03-1613">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1613">Yes</span></span>|  
|<span data-ttu-id="25e03-1614">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1614">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1615">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1615">Yes</span></span>|  
|<span data-ttu-id="25e03-1616">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1616">Remote computer</span></span>|<span data-ttu-id="25e03-1617">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1617">No</span></span>|  
|<span data-ttu-id="25e03-1618">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1618">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1619">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1619">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1620">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1620">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1621">Максимальный размер очереди содержит отрицательное значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1621">The maximum queue size contains a negative value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1622">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MessageReadPropertyFilter : System.Messaging.MessagePropertyFilter with get, set" Usage="System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1623">Получает или задает фильтр свойств для получения и считывания сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1623">Gets or sets the property filter for receiving or peeking messages.</span></span></summary>
        <value><span data-ttu-id="25e03-1624">Объект <see cref="T:System.Messaging.MessagePropertyFilter" />, который очередь использует для фильтрации набора свойств, получаемого или считываемого ею для каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1624">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1625">Этот фильтр является набором логических значений, которые ограничивают свойства сообщения, <xref:System.Messaging.MessageQueue> получаемые или просматриваемые.</span><span class="sxs-lookup"><span data-stu-id="25e03-1625">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="25e03-1626">Когда объект <xref:System.Messaging.MessageQueue> получает или считывает сообщение из очереди сервера, он извлекает только те свойства, для <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> которых значение равно `true`.</span><span class="sxs-lookup"><span data-stu-id="25e03-1626">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="25e03-1627">Ниже показаны начальные значения <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> свойств.</span><span class="sxs-lookup"><span data-stu-id="25e03-1627">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="25e03-1628">Эти параметры идентичны вызову <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> <xref:System.Messaging.MessagePropertyFilter>в.</span><span class="sxs-lookup"><span data-stu-id="25e03-1628">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="25e03-1629">Свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-1629">Property</span></span>|<span data-ttu-id="25e03-1630">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="25e03-1630">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="25e03-1631">1024 байт</span><span class="sxs-lookup"><span data-stu-id="25e03-1631">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="25e03-1632">255 байт</span><span class="sxs-lookup"><span data-stu-id="25e03-1632">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="25e03-1633">255 байт</span><span class="sxs-lookup"><span data-stu-id="25e03-1633">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="25e03-1634">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1634">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1635">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1635">Workgroup mode</span></span>|<span data-ttu-id="25e03-1636">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1636">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1637">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1637">Local computer</span></span>|<span data-ttu-id="25e03-1638">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1638">Yes</span></span>|  
|<span data-ttu-id="25e03-1639">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1639">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1640">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1640">Yes</span></span>|  
|<span data-ttu-id="25e03-1641">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1641">Remote computer</span></span>|<span data-ttu-id="25e03-1642">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1642">Yes</span></span>|  
|<span data-ttu-id="25e03-1643">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1643">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1644">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1644">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1645">В следующем примере кода используется <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> для ограничения полученных свойств сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1645">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1646">Значение фильтра — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1646">The filter is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MulticastAddress : string with get, set" Usage="System.Messaging.MessageQueue.MulticastAddress" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1647">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1647">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-1648">Получает или задает адрес многоадресной рассылки, связанный с данной очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-1648">Gets or sets the multicast address associated with the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1649">Объект <see cref="T:System.String" />, содержащий допустимый групповой адрес (в виде, показанном ниже) или значение <see langword="null" />, которое указывает, что очередь не связана с групповым адресом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1649">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span></span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1650"><xref:System.Messaging.MessageQueue.MulticastAddress%2A> Свойство используется для связи нетранзакционной очереди с адресом многоадресной рассылки, который может использоваться при отправке сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1650">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="25e03-1651">Нельзя связать транзакционную очередь с адресом многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="25e03-1651">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="25e03-1652">Когда отправляющее приложение отправляет сообщения на адрес многоадресной рассылки, служба очереди сообщений отправляет копию сообщения в каждую очередь, связанную с этим адресом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1652">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="25e03-1653">IP-адреса многоадресной рассылки должны принадлежать классу D в диапазоне от 224.0.0.0 до 239.255.255.255, что соответствует установке первых четырех старших разрядов, равных 1110.</span><span class="sxs-lookup"><span data-stu-id="25e03-1653">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="25e03-1654">Однако только определенные диапазоны адресов в этом диапазоне являются незарезервированными и доступны для отправки многоадресных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1654">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="25e03-1655">Последний список зарезервированных адресов многоадресной рассылки см. на веб-странице [адресов многоадресной рассылки Интернета (IANA) в Интернете](https://go.microsoft.com/fwlink/?linkid=3859) .</span><span class="sxs-lookup"><span data-stu-id="25e03-1655">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](https://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="25e03-1656">Ограничения на номер порта отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="25e03-1656">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="25e03-1657">Если несколько исходных компьютеров отправляют сообщения многоадресной рассылки и требуется, чтобы конкретная очередь получала сообщения только с одного исходного компьютера, каждый исходный компьютер должен отправлять сообщения на разные комбинации IP-адреса и номера порта.</span><span class="sxs-lookup"><span data-stu-id="25e03-1657">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="25e03-1658">Чтобы отменить связь между очередью и адресом многоадресной <xref:System.Messaging.MessageQueue.MulticastAddress%2A> рассылки, задайте для свойства строку нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="25e03-1658">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="25e03-1659">Не устанавливайте значение `null`, так как это приведет к <xref:System.ArgumentNullException>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1659">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="25e03-1660">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1660">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1661">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1661">Workgroup mode</span></span>|<span data-ttu-id="25e03-1662">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1662">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1663">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1663">Local computer</span></span>|<span data-ttu-id="25e03-1664">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1664">Yes</span></span>|  
|<span data-ttu-id="25e03-1665">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1665">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1666">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1666">Yes</span></span>|  
|<span data-ttu-id="25e03-1667">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1667">Remote computer</span></span>|<span data-ttu-id="25e03-1668">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1668">No</span></span>|  
|<span data-ttu-id="25e03-1669">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1669">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1670">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1670">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-1671">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-1671">MSMQ 3.0 is not installed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Path : string with get, set" Usage="System.Messaging.MessageQueue.Path" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.RefreshProperties(System.ComponentModel.RefreshProperties.All)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1672">Получает или задает путь очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1672">Gets or sets the queue's path.</span></span> <span data-ttu-id="25e03-1673">После задания свойства <see cref="P:System.Messaging.MessageQueue.Path" /> объект <see cref="T:System.Messaging.MessageQueue" /> будет указывать на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1673">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span></span></summary>
        <value><span data-ttu-id="25e03-1674">Очередь, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1674">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-1675">Значение по умолчанию зависит от того, какой используется конструктор <see cref="M:System.Messaging.MessageQueue.#ctor" />. Значение равно либо <see langword="null" />, либо задается параметром <paramref name="path" /> конструктора.</span><span class="sxs-lookup"><span data-stu-id="25e03-1675">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1676">Синтаксис для <xref:System.Messaging.MessageQueue.Path%2A> свойства зависит от типа очереди, на которую он указывает, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-1676">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-1677">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-1677">Queue type</span></span>|<span data-ttu-id="25e03-1678">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-1678">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-1679">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-1679">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-1680">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-1680">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="25e03-1681">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-1681">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="25e03-1682">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-1682">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="25e03-1683">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="25e03-1683">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="25e03-1684">Очередь недоставленных транзактных сообщений на компьютере</span><span class="sxs-lookup"><span data-stu-id="25e03-1684">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="25e03-1685">Для представления локального компьютера используйте ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-1685">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="25e03-1686">Свойства <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A> и<xref:System.Messaging.MessageQueue.QueueName%2A> являются связанными.</span><span class="sxs-lookup"><span data-stu-id="25e03-1686">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="25e03-1687">Изменение свойства приводит к изменению <xref:System.Messaging.MessageQueue.Path%2A>Свойства. <xref:System.Messaging.MessageQueue.MachineName%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1687">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="25e03-1688">Он строится на основе новых <xref:System.Messaging.MessageQueue.MachineName%2A> <xref:System.Messaging.MessageQueue.QueueName%2A>и.</span><span class="sxs-lookup"><span data-stu-id="25e03-1688">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="25e03-1689">Изменение (например, использование синтаксиса имени формата) <xref:System.Messaging.MessageQueue.MachineName%2A> сбрасывает свойства и <xref:System.Messaging.MessageQueue.QueueName%2A> для ссылки на новую очередь. <xref:System.Messaging.MessageQueue.Path%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1689">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="25e03-1690">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-1690">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-1691">Справочник</span><span class="sxs-lookup"><span data-stu-id="25e03-1691">Reference</span></span>|<span data-ttu-id="25e03-1692">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-1692">Syntax</span></span>|<span data-ttu-id="25e03-1693">Пример</span><span class="sxs-lookup"><span data-stu-id="25e03-1693">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="25e03-1694">Название формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1694">Format name</span></span>|<span data-ttu-id="25e03-1695">`FormatName:`[ *Формат имя* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-1695">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="25e03-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="25e03-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="25e03-1697">Метка</span><span class="sxs-lookup"><span data-stu-id="25e03-1697">Label</span></span>|<span data-ttu-id="25e03-1698">`Label:`[ *Метка* ]</span><span class="sxs-lookup"><span data-stu-id="25e03-1698">`Label:` [ *label* ]</span></span>|<span data-ttu-id="25e03-1699">`Label:`селабел</span><span class="sxs-lookup"><span data-stu-id="25e03-1699">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="25e03-1700">Если при отправке сообщения используется синтаксис метки <xref:System.Messaging.MessageQueue.Path%2A> для свойства, будет создано исключение, <xref:System.Messaging.MessageQueue.Label%2A> если не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1700">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="25e03-1701">Для работы в автономном режиме необходимо использовать синтаксис имени формата, а не синтаксис понятного имени в первой таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-1701">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="25e03-1702">В противном случае создается исключение, так как основной контроллер домена (на котором размещается Active Directory) недоступен для разрешения пути к имени формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-1702">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="25e03-1703">Установка нового пути закрывает очередь сообщений и освобождает все дескрипторы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1703">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="25e03-1704">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1704">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1705">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1705">Workgroup mode</span></span>|<span data-ttu-id="25e03-1706">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1706">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1707">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1707">Local computer</span></span>|<span data-ttu-id="25e03-1708">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1708">Yes</span></span>|  
|<span data-ttu-id="25e03-1709">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1709">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1710">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1710">Yes</span></span>|  
|<span data-ttu-id="25e03-1711">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1711">Remote computer</span></span>|<span data-ttu-id="25e03-1712">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1712">Yes</span></span>|  
|<span data-ttu-id="25e03-1713">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1713">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1714">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1714">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="25e03-1715">В режиме рабочей группы можно использовать только частные очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1715">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="25e03-1716">Путь указывается с помощью `MachineName`синтаксиса \\ `Private$` \\частной очереди.`QueueName`</span><span class="sxs-lookup"><span data-stu-id="25e03-1716">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1717">В следующем примере кода создаются новые <xref:System.Messaging.MessageQueue> объекты с использованием различных типов синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="25e03-1717">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="25e03-1718">В каждом случае он отправляет сообщение в очередь, путь которой определен в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="25e03-1718">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1719">Недопустимый путь. Возможно из-за неправильного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="25e03-1719">The path is not valid, possibly because the syntax is not valid.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="25e03-1720">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1720">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="25e03-1721">Возвращает копию первого сообщения в очереди, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1721">Returns a copy of the first message in the queue without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberSignature Language="F#" Value="member this.Peek : unit -&gt; System.Messaging.Message" Usage="messageQueue.Peek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1722">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1722">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-1723">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1723">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span></span></summary>
        <returns><span data-ttu-id="25e03-1724">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1724">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1725">Используйте эту перегрузку для просмотра очереди или ожидания сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1725">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1726"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет первое сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1726">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="25e03-1727">Следовательно, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращают одно и то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1727">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-1728"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет первое сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1728">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="25e03-1729">Поэтому повторные <xref:System.Messaging.MessageQueue.Receive%2A>вызовы, следовательно, возвращают разные сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1729">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="25e03-1730">Очередь сообщений упорядочивает сообщения в очереди в соответствии с приоритетом и временем прибытия.</span><span class="sxs-lookup"><span data-stu-id="25e03-1730">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="25e03-1731">Более старое сообщение помещается перед более старым, только если оно имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="25e03-1731">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="25e03-1732">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1732">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1733">Так как эта перегрузка не задает время ожидания, приложение может ждать в течение неограниченного времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-1733">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="25e03-1734">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1734">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="25e03-1735">Кроме того, можно указать время ожидания сообщения, поступающих в очередь, с помощью перегрузки <xref:System.Messaging.MessageQueue.Peek%2A> , которая указывает время ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-1735">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="25e03-1736">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1736">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1737">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1737">Workgroup mode</span></span>|<span data-ttu-id="25e03-1738">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1738">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1739">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1739">Local computer</span></span>|<span data-ttu-id="25e03-1740">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1740">Yes</span></span>|  
|<span data-ttu-id="25e03-1741">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1741">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1742">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1742">Yes</span></span>|  
|<span data-ttu-id="25e03-1743">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1743">Remote computer</span></span>|<span data-ttu-id="25e03-1744">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1744">No</span></span>|  
|<span data-ttu-id="25e03-1745">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1745">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1746">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1746">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1747">В следующих примерах используется <xref:System.Messaging.MessageQueue.Peek%2A> метод в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1747">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="25e03-1748">В первом примере приложение ожидает, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1748">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="25e03-1749">Обратите внимание, что в первом примере нет доступа к сообщению, которое прибывает. Он просто приостанавливает обработку, пока не поступит сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1749">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="25e03-1750">Если сообщение уже существует в очереди, оно будет возвращаться немедленно.</span><span class="sxs-lookup"><span data-stu-id="25e03-1750">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="25e03-1751">Во втором примере сообщение, содержащее определяемый `Order` приложением класс, отправляется в очередь, а затем просматривается из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1751">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1752">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1752">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-1753">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1753">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Peek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-1754">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1754">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <summary><span data-ttu-id="25e03-1755">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1755">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-1756">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-1756">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-1757">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1757">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1758">Используйте эту перегрузку для просмотра очереди или ожидания указанного периода времени, пока в очереди не появится сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1758">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="25e03-1759">Метод немедленно возвращает значение, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1759">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1760"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет первое сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1760">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="25e03-1761">Следовательно, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращают одно и то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-1761">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-1762"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет первое сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1762">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="25e03-1763">Поэтому повторные <xref:System.Messaging.MessageQueue.Receive%2A>вызовы, следовательно, возвращают разные сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1763">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="25e03-1764">Очередь сообщений упорядочивает сообщения в очереди в соответствии с приоритетом и временем прибытия.</span><span class="sxs-lookup"><span data-stu-id="25e03-1764">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="25e03-1765">Более старое сообщение помещается перед более старым, только если оно имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="25e03-1765">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="25e03-1766">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1766">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1767">Поток будет заблокирован на указанный период времени или неопределенное время, если указано <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1767">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="25e03-1768">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1768">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-1769">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1770">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1770">Workgroup mode</span></span>|<span data-ttu-id="25e03-1771">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1772">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1772">Local computer</span></span>|<span data-ttu-id="25e03-1773">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1773">Yes</span></span>|  
|<span data-ttu-id="25e03-1774">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1774">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1775">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1775">Yes</span></span>|  
|<span data-ttu-id="25e03-1776">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1776">Remote computer</span></span>|<span data-ttu-id="25e03-1777">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1777">No</span></span>|  
|<span data-ttu-id="25e03-1778">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1778">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1779">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1780">В следующем примере кода используется <xref:System.Messaging.MessageQueue.Peek%2A> метод с нулевым временем ожидания, чтобы проверить, пуста ли очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1780">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1781">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1781">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1782">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1782">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-1783">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1783">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction -&gt; System.Messaging.Message" Usage="messageQueue.Peek (timeout, cursor, action)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-1784">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1784">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-1785">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-1785">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="25e03-1786">Одно из значений перечисления <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1786">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="25e03-1787">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1787">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <summary><span data-ttu-id="25e03-1788">Возвращает, не удаляя (считывает), текущее или следующее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="25e03-1788">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span></span> <span data-ttu-id="25e03-1789">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-1789">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-1790">Объект <see cref="T:System.Messaging.Message" />, представляющий сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1790">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1791">Используйте эту перегрузку для просмотра очереди или ожидания указанного периода времени, пока в очереди не появится сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1791">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="25e03-1792">Метод немедленно возвращает значение, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1792">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1793"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1793">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="25e03-1794"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1794">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="25e03-1795">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1795">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1796">Поток блокируется на указанный период времени или бессрочно, если указано <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1796">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="25e03-1797">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1797">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-1798">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1799">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1799">Workgroup mode</span></span>|<span data-ttu-id="25e03-1800">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1801">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1801">Local computer</span></span>|<span data-ttu-id="25e03-1802">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1802">Yes</span></span>|  
|<span data-ttu-id="25e03-1803">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1803">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1804">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1804">Yes</span></span>|  
|<span data-ttu-id="25e03-1805">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1805">Remote computer</span></span>|<span data-ttu-id="25e03-1806">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1806">No</span></span>|  
|<span data-ttu-id="25e03-1807">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1807">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1808">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="25e03-1809">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1809">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1810">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1810">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1811">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-1811">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="25e03-1812">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1812">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1813">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-1814">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-1814">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-1815">Считывает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-1815">Peeks a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-1816">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1816">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="25e03-1817">Считывает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-1817">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-1818">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1818">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1819">Этот метод просматривает очередь, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1819">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-1820">Если не найдено ни одного сообщения, соответствующего `correlationID` параметру, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1820">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-1821"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1821">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-1822">Два других метода позволяют просматривать сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1822">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="25e03-1823">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Peek%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1823">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-1824">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1824">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1825">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1825">Workgroup mode</span></span>|<span data-ttu-id="25e03-1826">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1826">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1827">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1827">Local computer</span></span>|<span data-ttu-id="25e03-1828">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1828">Yes</span></span>|  
|<span data-ttu-id="25e03-1829">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1829">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1830">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1830">Yes</span></span>|  
|<span data-ttu-id="25e03-1831">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1831">Remote computer</span></span>|<span data-ttu-id="25e03-1832">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1832">No</span></span>|  
|<span data-ttu-id="25e03-1833">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1833">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1834">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1834">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1835">Следующий пример кода отправляет и получает сообщение, которое содержит порядок в очередь и из нее.</span><span class="sxs-lookup"><span data-stu-id="25e03-1835">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="25e03-1836">Он специально запрашивает положительное подтверждение, когда исходное сообщение достигает или извлекается из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1836">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1837">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1837">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1838">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1838">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1839">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1839">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-1840">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1840">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-1841">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-1841">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="25e03-1842">Считывает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-1842">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-1843">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1843">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1844">Этот метод просматривает очередь, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1844">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-1845">Если не найдено ни одного сообщения, соответствующего `correlationID` параметру, а новое сообщение не поступает в очередь в течение периода, указанного `timeout` параметром, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1845">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-1846">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1846">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-1847">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1847">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1848">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> новое сообщение, чтобы проверить, `correlationId` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1848">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="25e03-1849">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1849">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-1850">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.CorrelationId%2A> которого `correlationId` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1850">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-1851"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1851">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-1852">Два других метода позволяют просматривать сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1852">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="25e03-1853">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Peek%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1853">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-1854">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1854">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1855">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1855">Workgroup mode</span></span>|<span data-ttu-id="25e03-1856">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1856">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1857">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1857">Local computer</span></span>|<span data-ttu-id="25e03-1858">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1858">Yes</span></span>|  
|<span data-ttu-id="25e03-1859">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1859">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1860">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1860">Yes</span></span>|  
|<span data-ttu-id="25e03-1861">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1861">Remote computer</span></span>|<span data-ttu-id="25e03-1862">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1862">No</span></span>|  
|<span data-ttu-id="25e03-1863">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1863">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1864">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1864">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1865">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1865">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1866">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1866">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1867">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1867">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1868">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="25e03-1868">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1869">Сообщений до истечения тайм-аута не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-1869">A message did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-1870">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-1870">-or-</span></span>  
  
 <span data-ttu-id="25e03-1871">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1871">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-1872">Возвращает копию сообщения с указанным идентификатором сообщения, не удаляя это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1872">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-1873">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1873">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="25e03-1874">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1874">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span></summary>
        <returns><span data-ttu-id="25e03-1875">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1875">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1876">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, без удаления из очереди, сообщения с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1876">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="25e03-1877">Идентификатор сообщения уникален в рамках организации очереди сообщений, поэтому в очереди имеется не более одного сообщения, которое соответствует заданному `id` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1877">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="25e03-1878">Эта перегрузка создает исключение, если в настоящий момент очередь не содержит сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-1878">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="25e03-1879">Два дополнительных метода позволяют просматривать сообщения в очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29></span><span class="sxs-lookup"><span data-stu-id="25e03-1879">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-1880"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает сообщение о подтверждении, отчете или созданном приложением ответе, созданное в результате сообщения, отправленного в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1880">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-1881">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1881">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1882">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1882">Workgroup mode</span></span>|<span data-ttu-id="25e03-1883">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1883">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1884">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1884">Local computer</span></span>|<span data-ttu-id="25e03-1885">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1885">Yes</span></span>|  
|<span data-ttu-id="25e03-1886">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1886">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1887">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1887">Yes</span></span>|  
|<span data-ttu-id="25e03-1888">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1888">Remote computer</span></span>|<span data-ttu-id="25e03-1889">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1889">No</span></span>|  
|<span data-ttu-id="25e03-1890">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1890">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1891">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1891">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1892">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1892">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1893">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1893">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1894">Нет сообщения с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1894">No message with the specified <paramref name="id" /> exists.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1895">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-1896">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1896">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-1897">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-1897">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="25e03-1898">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1898">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span> <span data-ttu-id="25e03-1899">Ожидает, пока сообщение не появится в очереди, или не возникнет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-1899">Waits until the message appears in the queue or a time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="25e03-1900">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1900">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1901">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, без удаления из очереди, сообщения с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1901">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="25e03-1902">Идентификатор сообщения уникален в рамках организации очереди сообщений, поэтому в очереди имеется не более одного сообщения, которое соответствует заданному `id` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1902">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="25e03-1903">Эта перегрузка создает исключение, если в настоящий момент очередь не содержит сообщение и новое сообщение не поступает до истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="25e03-1903">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="25e03-1904">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-1904">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-1905">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1905">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-1906">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.Id%2A> новое сообщение, чтобы проверить, `id` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1906">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="25e03-1907">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1907">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-1908">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.Id%2A> которого `id` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-1908">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-1909">Два дополнительных метода позволяют просматривать сообщения в очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29></span><span class="sxs-lookup"><span data-stu-id="25e03-1909">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-1910"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает сообщение о подтверждении, отчете или созданном приложением ответе, созданное в результате сообщения, отправленного в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-1910">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-1911">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1912">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1912">Workgroup mode</span></span>|<span data-ttu-id="25e03-1913">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1914">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1914">Local computer</span></span>|<span data-ttu-id="25e03-1915">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1915">Yes</span></span>|  
|<span data-ttu-id="25e03-1916">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1916">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1917">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1917">Yes</span></span>|  
|<span data-ttu-id="25e03-1918">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1918">Remote computer</span></span>|<span data-ttu-id="25e03-1919">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1919">No</span></span>|  
|<span data-ttu-id="25e03-1920">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1920">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1921">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1922">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-1922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-1923">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1923">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-1924">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1924">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1925">Сообщение с заданным параметром <paramref name="id" /> не существует в очереди и не поступило до истечения периода времени, установленного параметром <paramref name="timeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1925">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1926">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1926">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-1927">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1927">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-1928">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1928">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="25e03-1929">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1929">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="25e03-1930">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-1930">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span></span></param>
        <summary><span data-ttu-id="25e03-1931">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1931">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-1932">Считывает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1932">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-1933">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1933">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1934">Используйте этот метод для чтения сообщения с известным идентификатором поиска, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1934">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="25e03-1935">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1935">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1936">Свойство сообщения является уникальным для очереди, в которой находится сообщение, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `lookupId` параметру. <xref:System.Messaging.Message.LookupId%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1936">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-1937">Чтобы прочитать сообщение с указанным идентификатором уточняющего запроса и удалить его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-1937">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-1938">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1938">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1939">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1939">Workgroup mode</span></span>|<span data-ttu-id="25e03-1940">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1940">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1941">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1941">Local computer</span></span>|<span data-ttu-id="25e03-1942">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1942">Yes</span></span>|  
|<span data-ttu-id="25e03-1943">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1943">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1944">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1944">Yes</span></span>|  
|<span data-ttu-id="25e03-1945">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1945">Remote computer</span></span>|<span data-ttu-id="25e03-1946">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1946">No</span></span>|  
|<span data-ttu-id="25e03-1947">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1947">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1948">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1948">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-1949">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-1949">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1950">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1950">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1951">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1951">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : System.Messaging.MessageLookupAction * int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId (action, lookupId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="25e03-1952">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1952">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="25e03-1953">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="25e03-1953">Specify one of the following:</span></span> 
 <span data-ttu-id="25e03-1954"><see langword="MessageLookupAction.Current" />: считывает сообщение, заданное параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1954"><see langword="MessageLookupAction.Current" />: Peeks at the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="25e03-1955"><see langword="MessageLookupAction.Next" />: считывает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1955"><see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="25e03-1956"><see langword="MessageLookupAction.Previous" />: считывает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1956"><see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="25e03-1957"><see langword="MessageLookupAction.First" />: считывает первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1957"><see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span></span> <span data-ttu-id="25e03-1958">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1958">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="25e03-1959"><see langword="MessageLookupAction.Last" />: считывает последнее сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1959"><see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span></span> <span data-ttu-id="25e03-1960">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1960">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="25e03-1961">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1961">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span></span> <span data-ttu-id="25e03-1962">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1962">0 is used when accessing the first or last message in the queue.</span></span></param>
        <summary><span data-ttu-id="25e03-1963">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-1963">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-1964">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1964">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="25e03-1965">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1965">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-1966">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1966">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1967">Используйте этот метод для чтения сообщения с известным идентификатором поиска, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1967">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="25e03-1968">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1968">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1969">Свойство сообщения является уникальным для очереди, в которой находится сообщение, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `lookupId` параметру. <xref:System.Messaging.Message.LookupId%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-1969">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-1970">Чтобы прочитать сообщение с указанным идентификатором и удалить его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-1970">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-1971">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-1971">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-1972">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-1972">Workgroup mode</span></span>|<span data-ttu-id="25e03-1973">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-1973">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-1974">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1974">Local computer</span></span>|<span data-ttu-id="25e03-1975">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1975">Yes</span></span>|  
|<span data-ttu-id="25e03-1976">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1976">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-1977">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1977">Yes</span></span>|  
|<span data-ttu-id="25e03-1978">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-1978">Remote computer</span></span>|<span data-ttu-id="25e03-1979">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-1979">No</span></span>|  
|<span data-ttu-id="25e03-1980">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-1980">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-1981">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-1981">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-1982">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-1982">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-1983">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1983">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-1984">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-1984">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-1985">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1985">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberSignature Language="F#" Value="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " Usage="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-1986">Происходит, когда сообщение читается без удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1986">Occurs when a message is read without being removed from the queue.</span></span> <span data-ttu-id="25e03-1987">Это результат асинхронной операции — <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-1987">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A>используется при асинхронной обработке для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> события, когда сообщение доступно в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="25e03-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>используется для завершения операции, инициированной вызовом метода <xref:System.Messaging.MessageQueue.BeginPeek%2A> , и просмотра сообщения <xref:System.Messaging.MessageQueue.PeekCompleted> при возникновении события.</span><span class="sxs-lookup"><span data-stu-id="25e03-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="25e03-1990">При создании делегата <xref:System.Messaging.PeekCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-1990">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="25e03-1991">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="25e03-1991">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="25e03-1992">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="25e03-1992">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="25e03-1993">Дополнительные сведения о делегатах обработчиков событий см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="25e03-1993">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-1994">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, который прикрепляет его <xref:System.Messaging.MessageQueue.PeekCompleted> к делегату обработчика событий и <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается для инициации асинхронной операции просмотра в очереди, расположенной по пути ".\микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-1994">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="25e03-1995">При возникновении <xref:System.Messaging.MessageQueue.PeekCompleted> события пример считывает сообщение и записывает его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-1995">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="25e03-1996">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию просмотра.</span><span class="sxs-lookup"><span data-stu-id="25e03-1996">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberSignature Language="F#" Value="member this.Purge : unit -&gt; unit" Usage="messageQueue.Purge " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-1997">Удаляет все сообщения, содержащиеся в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-1997">Deletes all the messages contained in the queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-1998">Очистка очереди приводит к тому, что очередь сообщений устанавливает флаг изменения очереди, который влияет <xref:System.Messaging.MessageQueue.LastModifyTime%2A> на свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-1998">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="25e03-1999">Сообщения, удаленные из очереди, теряются. они не отправляются в очередь недоставленных сообщений или в очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="25e03-1999">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="25e03-2000">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2000">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2001">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2001">Workgroup mode</span></span>|<span data-ttu-id="25e03-2002">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2002">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2003">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2003">Local computer</span></span>|<span data-ttu-id="25e03-2004">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2004">Yes</span></span>|  
|<span data-ttu-id="25e03-2005">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2005">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2006">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2006">Yes</span></span>|  
|<span data-ttu-id="25e03-2007">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2007">Remote computer</span></span>|<span data-ttu-id="25e03-2008">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2008">No</span></span>|  
|<span data-ttu-id="25e03-2009">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2009">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2010">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2010">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2011">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Purge%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2011">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2012">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2012">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.QueueName : string with get, set" Usage="System.Messaging.MessageQueue.QueueName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-2013">Получает или задает понятное имя, определяющее очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2013">Gets or sets the friendly name that identifies the queue.</span></span></summary>
        <value><span data-ttu-id="25e03-2014">Имя, определяющее очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2014">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-2015">Значение <see langword="null" /> недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-2015">The value cannot be <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2016"><xref:System.Messaging.MessageQueue.MachineName%2A> Чтобы создать <xref:System.Messaging.MessageQueue.QueueName%2A> понятное<xref:System.Messaging.MessageQueue.Path%2A> имя очереди, можно объединить с параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2016">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="25e03-2017">Синтаксис для варианта <xref:System.Messaging.MessageQueue.Path%2A> понятного имени свойства зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="25e03-2017">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="25e03-2018">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-2018">Queue type</span></span>|<span data-ttu-id="25e03-2019">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="25e03-2019">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="25e03-2020">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-2020">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="25e03-2021">Частная очередь</span><span class="sxs-lookup"><span data-stu-id="25e03-2021">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="25e03-2022">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-2022">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="25e03-2023">Для представления локального компьютера используйте ".".</span><span class="sxs-lookup"><span data-stu-id="25e03-2023">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="25e03-2024"><xref:System.Messaging.MessageQueue.QueueName%2A> Изменение свойства <xref:System.Messaging.MessageQueue.Path%2A> влияет на свойство.</span><span class="sxs-lookup"><span data-stu-id="25e03-2024">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="25e03-2025">Если задать параметр <xref:System.Messaging.MessageQueue.QueueName%2A> без <xref:System.Messaging.MessageQueue.MachineName%2A> установки свойства, <xref:System.Messaging.MessageQueue.Path%2A> свойство будет иметь значение.\\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="25e03-2025">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="25e03-2026">В противном <xref:System.Messaging.MessageQueue.Path%2A> случае `MachineName`— значение \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="25e03-2026">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="25e03-2027">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2027">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2028">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2028">Workgroup mode</span></span>|<span data-ttu-id="25e03-2029">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2029">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2030">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2030">Local computer</span></span>|<span data-ttu-id="25e03-2031">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2031">Yes</span></span>|  
|<span data-ttu-id="25e03-2032">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2032">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2033">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2033">Yes</span></span>|  
|<span data-ttu-id="25e03-2034">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2034">Remote computer</span></span>|<span data-ttu-id="25e03-2035">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2035">Yes</span></span>|  
|<span data-ttu-id="25e03-2036">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2036">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2037">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2037">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2038">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.QueueName%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2038">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2039">Значение имени очереди — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2039">The queue name is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.ReadHandle : nativeint" Usage="System.Messaging.MessageQueue.ReadHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-2040">Получает собственный дескриптор, предназначенный для чтения сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2040">Gets the native handle used to read messages from the message queue.</span></span></summary>
        <value><span data-ttu-id="25e03-2041">Дескриптор собственного объекта очереди, который используется для считывания и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2041">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2042"><xref:System.Messaging.MessageQueue.ReadHandle%2A> Предоставляет собственный обработчик Windows для объекта очереди сообщений, который используется для просмотра и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2042">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="25e03-2043">При изменении пути к очереди маркер закрывается и повторно открывается с новым значением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2043">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="25e03-2044">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2044">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2045">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2045">Workgroup mode</span></span>|<span data-ttu-id="25e03-2046">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2046">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2047">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2047">Local computer</span></span>|<span data-ttu-id="25e03-2048">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2048">Yes</span></span>|  
|<span data-ttu-id="25e03-2049">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2049">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2050">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2050">Yes</span></span>|  
|<span data-ttu-id="25e03-2051">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2051">Remote computer</span></span>|<span data-ttu-id="25e03-2052">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2052">No</span></span>|  
|<span data-ttu-id="25e03-2053">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2053">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2054">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2054">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2055">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2055">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="25e03-2056">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2056">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="25e03-2057">Получает первое сообщение в очереди, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2057">Receives the first message in the queue, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberSignature Language="F#" Value="member this.Receive : unit -&gt; System.Messaging.Message" Usage="messageQueue.Receive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-2058">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2058">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-2059">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2059">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="25e03-2060">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2060">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2061">Используйте эту перегрузку для получения сообщения из очереди или ожидания сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2061">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2062"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2062">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2063">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, следующие за очередью, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2063">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="25e03-2064">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2064">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2065"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2065">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2066">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2066">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2067">Поскольку эта перегрузка <xref:System.Messaging.MessageQueue.Receive%2A> метода указывает на бесконечное время ожидания, приложение может ждать бесконечно.</span><span class="sxs-lookup"><span data-stu-id="25e03-2067">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="25e03-2068">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2068">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2069">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2069">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2070">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2070">Workgroup mode</span></span>|<span data-ttu-id="25e03-2071">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2071">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2072">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2072">Local computer</span></span>|<span data-ttu-id="25e03-2073">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2073">Yes</span></span>|  
|<span data-ttu-id="25e03-2074">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2074">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2075">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2075">Yes</span></span>|  
|<span data-ttu-id="25e03-2076">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2076">Remote computer</span></span>|<span data-ttu-id="25e03-2077">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2077">No</span></span>|  
|<span data-ttu-id="25e03-2078">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2078">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2079">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2079">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2080">Следующий пример кода получает сообщение из очереди и выводит сведения об этом сообщении на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-2080">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2081">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2081">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive transaction" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction"><span data-ttu-id="25e03-2082">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2082">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2083">Получает первое доступное в транзакционной очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2083">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-2084">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2084">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="25e03-2085">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2085">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2086">Используйте эту перегрузку для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` параметром, или дождитесь поступления сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2086">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2087"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2087">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2088">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> будут возвращать сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2088">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2089">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2089">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2090">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2090">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2091">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2091">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2092"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2092">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2093">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2093">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2094">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения в очереди, для отката с помощью <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызова метода не будет ничего делать.</span><span class="sxs-lookup"><span data-stu-id="25e03-2094">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2095">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2095">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2096">Поскольку эта перегрузка <xref:System.Messaging.MessageQueue.Receive%2A> метода указывает на бесконечное время ожидания, приложение может ждать бесконечно.</span><span class="sxs-lookup"><span data-stu-id="25e03-2096">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="25e03-2097">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2097">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2098">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2098">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2099">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2099">Workgroup mode</span></span>|<span data-ttu-id="25e03-2100">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2100">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2101">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2101">Local computer</span></span>|<span data-ttu-id="25e03-2102">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2102">Yes</span></span>|  
|<span data-ttu-id="25e03-2103">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2103">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2104">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2104">Yes</span></span>|  
|<span data-ttu-id="25e03-2105">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2105">Remote computer</span></span>|<span data-ttu-id="25e03-2106">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2106">No</span></span>|  
|<span data-ttu-id="25e03-2107">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2107">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2108">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2108">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2109">В следующем примере кода выполняется подключение к транзакционной очереди на локальном компьютере и отправка сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2109">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="25e03-2110">Затем он получает сообщение, содержащее заказ.</span><span class="sxs-lookup"><span data-stu-id="25e03-2110">It then receives the message that contains an order.</span></span> <span data-ttu-id="25e03-2111">Если обнаруживает нетранзакционную очередь, она вызывает исключение и выполняет откат транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2111">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2112">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2112">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="25e03-2113">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2113">-or-</span></span>  
  
 <span data-ttu-id="25e03-2114">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2114">The queue is non-transactional.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2115">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2115">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive transactionType" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType"><span data-ttu-id="25e03-2116">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2116">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2117">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2117">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-2118">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2118">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="25e03-2119">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2119">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2120">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` параметром, или дождитесь поступления сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2120">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2121">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2121">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2122">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2122">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2123">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2123">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2124"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2124">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2125">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> будут возвращать сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2125">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2126">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2126">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2127">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2127">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2128">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2128">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2129"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2129">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2130">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2130">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2131">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения в очереди, для отката с помощью <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызова метода не будет ничего делать.</span><span class="sxs-lookup"><span data-stu-id="25e03-2131">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2132">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2132">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2133">Поскольку эта перегрузка <xref:System.Messaging.MessageQueue.Receive%2A> метода указывает на бесконечное время ожидания, приложение может ждать бесконечно.</span><span class="sxs-lookup"><span data-stu-id="25e03-2133">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="25e03-2134">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2134">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2135">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2135">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2136">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2136">Workgroup mode</span></span>|<span data-ttu-id="25e03-2137">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2137">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2138">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2138">Local computer</span></span>|<span data-ttu-id="25e03-2139">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2139">Yes</span></span>|  
|<span data-ttu-id="25e03-2140">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2140">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2141">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2141">Yes</span></span>|  
|<span data-ttu-id="25e03-2142">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2142">Remote computer</span></span>|<span data-ttu-id="25e03-2143">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2143">No</span></span>|  
|<span data-ttu-id="25e03-2144">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2144">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2145">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2145">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2146">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2146">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2147">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2147">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2148">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2148">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2149">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2149">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Receive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2150">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2150">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="25e03-2151">Получает первое сообщение, доступное в очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2151">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2152">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2152">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2153">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2153">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2154"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронно считывать сообщение, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2154">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="25e03-2155">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, следующие за очередью, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2155">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="25e03-2156">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2156">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2157"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2157">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2158">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2158">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2159">Поток будет заблокирован на указанный период времени или неопределенное время, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` для параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2159">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2160">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2160">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2161">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2161">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2162">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2162">Workgroup mode</span></span>|<span data-ttu-id="25e03-2163">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2163">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2164">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2164">Local computer</span></span>|<span data-ttu-id="25e03-2165">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2165">Yes</span></span>|  
|<span data-ttu-id="25e03-2166">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2166">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2167">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2167">Yes</span></span>|  
|<span data-ttu-id="25e03-2168">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2168">Remote computer</span></span>|<span data-ttu-id="25e03-2169">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2169">No</span></span>|  
|<span data-ttu-id="25e03-2170">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2170">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2171">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2171">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2172">Следующий пример кода получает сообщение из очереди и выводит сведения об этом сообщении на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-2172">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="25e03-2173">В этом примере выполнение приостанавливается до пяти секунд при ожидании поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2173">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2174">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2174">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2175">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2175">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2176">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2176">-or-</span></span>  
  
 <span data-ttu-id="25e03-2177">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2177">An error occurred when accessing a Message Queuing method</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2178">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2178">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2179">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2179">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-2180">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2180">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <summary><span data-ttu-id="25e03-2181">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="25e03-2181">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="25e03-2182">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2182">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2183">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2183">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2184">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2184">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2185">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2185">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2186">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2186">-or-</span></span>  
  
 <span data-ttu-id="25e03-2187">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2187">An error occurred when accessing a Message Queuing method</span></span>  
  
 <span data-ttu-id="25e03-2188">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2188">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2189">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2189">The method is not thread safe.</span></span></threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2190">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2190">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2191">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2191">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2192">Получает первое сообщение, доступное в транзакционной очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает, пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2192">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2193">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2193">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2194">Используйте эту перегрузку для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` параметром, и возврата в течение указанного периода времени, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2194">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2195"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2195">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2196">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> будут возвращать сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2196">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2197">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2197">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2198">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2198">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2199">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2199">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2200"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2200">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2201">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2201">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2202">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения в очереди, для отката с помощью <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызова метода не будет ничего делать.</span><span class="sxs-lookup"><span data-stu-id="25e03-2202">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2203">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2203">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2204">Поток будет заблокирован на указанный период времени или неопределенное время, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` для параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2204">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2205">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2205">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2206">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2206">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2207">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2207">Workgroup mode</span></span>|<span data-ttu-id="25e03-2208">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2208">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2209">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2209">Local computer</span></span>|<span data-ttu-id="25e03-2210">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2210">Yes</span></span>|  
|<span data-ttu-id="25e03-2211">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2211">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2212">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2212">Yes</span></span>|  
|<span data-ttu-id="25e03-2213">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2213">Remote computer</span></span>|<span data-ttu-id="25e03-2214">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2214">No</span></span>|  
|<span data-ttu-id="25e03-2215">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2215">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2216">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2216">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2217">В следующем примере кода демонстрируется использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2217">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2218">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2218">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2219">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2219">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2220">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2220">-or-</span></span>  
  
 <span data-ttu-id="25e03-2221">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2221">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="25e03-2222">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2222">-or-</span></span>  
  
 <span data-ttu-id="25e03-2223">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2223">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2224">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2224">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2225">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2225">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2226">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2226">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2227">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2227">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="25e03-2228">Данный вызов является синхронным, и он ожидает, пока в очереди не появится сообщение, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2228">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2229">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2229">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2230">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` параметром, и возврата в указанный период времени, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2230">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2231">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2231">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2232">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2232">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2233">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2233">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2234"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2234">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2235">Последующие вызовы метода <xref:System.Messaging.MessageQueue.Receive%2A> будут возвращать сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2235">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2236">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2236">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2237">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2237">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2238">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2238">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2239"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2239">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2240">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2240">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2241">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения в очереди, для отката с помощью <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызова метода не будет ничего делать.</span><span class="sxs-lookup"><span data-stu-id="25e03-2241">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2242">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2242">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2243">Поток будет заблокирован на указанный период времени или неопределенное время, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` для параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2243">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2244">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2244">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2245">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2245">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2246">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2246">Workgroup mode</span></span>|<span data-ttu-id="25e03-2247">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2247">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2248">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2248">Local computer</span></span>|<span data-ttu-id="25e03-2249">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2249">Yes</span></span>|  
|<span data-ttu-id="25e03-2250">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2250">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2251">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2251">Yes</span></span>|  
|<span data-ttu-id="25e03-2252">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2252">Remote computer</span></span>|<span data-ttu-id="25e03-2253">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2253">No</span></span>|  
|<span data-ttu-id="25e03-2254">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2254">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2255">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2255">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2256">В следующем примере кода демонстрируется использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2256">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2257">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2257">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2258">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2258">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2259">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2259">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2260">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2260">-or-</span></span>  
  
 <span data-ttu-id="25e03-2261">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2261">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2262">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2262">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2263">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2263">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-2264">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2264">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2265">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2265">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2266">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="25e03-2266">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="25e03-2267">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2267">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2268">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2268">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2269">Используйте эту перегрузку для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` параметром, и возврата в течение указанного периода времени, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2269">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2270"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2270">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2271">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2271">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2272">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2272">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2273">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2273">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2274">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2274">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2275">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2275">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2276">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет какие-либо сообщения в очереди, нет никакой необходимости откатить <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызовом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2276">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2277">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2277">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2278">Поток заблокирован на указанный период времени или неопределенное время, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` для параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2278">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2279">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2279">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2280">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2280">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2281">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2281">Workgroup mode</span></span>|<span data-ttu-id="25e03-2282">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2282">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2283">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2283">Local computer</span></span>|<span data-ttu-id="25e03-2284">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2284">Yes</span></span>|  
|<span data-ttu-id="25e03-2285">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2285">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2286">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2286">Yes</span></span>|  
|<span data-ttu-id="25e03-2287">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2287">Remote computer</span></span>|<span data-ttu-id="25e03-2288">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2288">No</span></span>|  
|<span data-ttu-id="25e03-2289">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2289">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2290">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2290">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2291">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2291">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-2292">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2292">-or-</span></span> 
<span data-ttu-id="25e03-2293">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2293">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2294">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-2294">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="25e03-2295">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2295">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2296">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2296">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2297">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2297">-or-</span></span>  
  
 <span data-ttu-id="25e03-2298">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2298">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="25e03-2299">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2299">-or-</span></span>  
  
 <span data-ttu-id="25e03-2300">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2300">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2301">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2301">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="25e03-2302">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2302">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="25e03-2303">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2303">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2304">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2304">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2305">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="25e03-2305">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="25e03-2306">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2306">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2307">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2307">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2308">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` параметром, и возврата в указанный период времени, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2308">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2309">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2309">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2310">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2310">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2311">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2311">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2312"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет выполнять синхронное чтение сообщения, тем самым удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2312">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="25e03-2313">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, следующие за очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-2313">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2314">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2314">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2315">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2315">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2316">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2316">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="25e03-2317">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2317">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="25e03-2318">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет какие-либо сообщения в очереди, нет никакой необходимости откатить <xref:System.Messaging.MessageQueueTransaction.Abort%2A>вызовом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2318">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2319">Используйте вызов, <xref:System.Messaging.MessageQueue.Receive%2A> если допускается блокировка текущего потока в то время, когда он ожидает поступления сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2319">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2320">Поток заблокирован на указанный период времени или неопределенное время, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` для параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2320">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2321">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2321">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="25e03-2322">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2322">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2323">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2323">Workgroup mode</span></span>|<span data-ttu-id="25e03-2324">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2324">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2325">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2325">Local computer</span></span>|<span data-ttu-id="25e03-2326">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2326">Yes</span></span>|  
|<span data-ttu-id="25e03-2327">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2327">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2328">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2328">Yes</span></span>|  
|<span data-ttu-id="25e03-2329">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2329">Remote computer</span></span>|<span data-ttu-id="25e03-2330">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2330">No</span></span>|  
|<span data-ttu-id="25e03-2331">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2331">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2332">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2332">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2333">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2333">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2334">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="25e03-2334">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="25e03-2335">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2335">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2336">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2336">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2337">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2337">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="25e03-2338">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2338">-or-</span></span>  
  
 <span data-ttu-id="25e03-2339">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="25e03-2340">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="25e03-2340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-2341">Получает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2341">Receives a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2342">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2342">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="25e03-2343">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2343">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2344">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2344">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2345">Этот метод выполняет поиск в нетранзакционной очереди, на которую ссылается объект <xref:System.Messaging.MessageQueue> для сообщения, <xref:System.Messaging.Message.CorrelationId%2A> соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2345">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2346">Если не найдено ни одного сообщения, соответствующего `correlationID` параметру, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2346">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="25e03-2347">В противном случае сообщение удаляется из очереди и возвращается приложению.</span><span class="sxs-lookup"><span data-stu-id="25e03-2347">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="25e03-2348"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2348">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2349">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2349">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2350">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод извлекает сообщение, указывая его уникальный идентификатор. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2350">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2351">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2351">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2352"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2352">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2353">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2353">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2354">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2354">Workgroup mode</span></span>|<span data-ttu-id="25e03-2355">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2355">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2356">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2356">Local computer</span></span>|<span data-ttu-id="25e03-2357">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2357">Yes</span></span>|  
|<span data-ttu-id="25e03-2358">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2358">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2359">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2359">Yes</span></span>|  
|<span data-ttu-id="25e03-2360">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2360">Remote computer</span></span>|<span data-ttu-id="25e03-2361">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2361">No</span></span>|  
|<span data-ttu-id="25e03-2362">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2362">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2363">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2363">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2364">Следующий пример кода отправляет и получает сообщение, которое содержит порядок в очередь и из нее.</span><span class="sxs-lookup"><span data-stu-id="25e03-2364">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="25e03-2365">Он специально запрашивает положительное подтверждение, когда исходное сообщение достигает или извлекается из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2365">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2366">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2366">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2367">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2367">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2368">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2368">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2369">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2369">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2370">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2370">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2371">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2371">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2372">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2372">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2373">Этот метод выполняет поиск в транзакционной очереди, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2373">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2374">Если не найдено ни одного сообщения, соответствующего `correlationID` параметру, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2374">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="25e03-2375">В противном случае сообщение удаляется из очереди и возвращается приложению с помощью контекста внутренней транзакции, определенного `transaction` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2375">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2376">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2376">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2377">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2377">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2378"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2378">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2379">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2379">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2380">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2380">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2381">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2381">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2382"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2382">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2383">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2383">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-2384">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2384">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2385">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2385">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2386">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2386">Workgroup mode</span></span>|<span data-ttu-id="25e03-2387">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2387">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2388">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2388">Local computer</span></span>|<span data-ttu-id="25e03-2389">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2389">Yes</span></span>|  
|<span data-ttu-id="25e03-2390">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2390">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2391">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2391">Yes</span></span>|  
|<span data-ttu-id="25e03-2392">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2392">Remote computer</span></span>|<span data-ttu-id="25e03-2393">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2393">No</span></span>|  
|<span data-ttu-id="25e03-2394">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2394">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2395">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2395">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2396">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2396">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2397">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2397">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-2398">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2398">-or-</span></span> 
<span data-ttu-id="25e03-2399">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2399">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2400">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2400">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2401">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2401">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="25e03-2402">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2402">-or-</span></span>  
  
 <span data-ttu-id="25e03-2403">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2403">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2404">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2404">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2405">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2405">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2406">Получает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2406">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2407">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2407">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2408">Этот метод просматривает очередь, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2408">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2409">Если не найдено ни одного сообщения, соответствующего `correlationID` параметру, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2409">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="25e03-2410">В противном случае сообщение удаляется из очереди и возвращается приложению с помощью контекста транзакции, определенного `transactionType` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2410">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2411">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2411">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2412">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2412">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2413">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2413">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2414">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2414">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2415">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2415">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2416"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2416">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2417">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2417">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2418">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2418">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2419">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2419">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2420"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2420">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2421">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2421">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-2422">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2422">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2423">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2423">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2424">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2424">Workgroup mode</span></span>|<span data-ttu-id="25e03-2425">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2425">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2426">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2426">Local computer</span></span>|<span data-ttu-id="25e03-2427">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2427">Yes</span></span>|  
|<span data-ttu-id="25e03-2428">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2428">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2429">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2429">Yes</span></span>|  
|<span data-ttu-id="25e03-2430">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2430">Remote computer</span></span>|<span data-ttu-id="25e03-2431">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2431">No</span></span>|  
|<span data-ttu-id="25e03-2432">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2432">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2433">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2433">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2434">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2434">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2435">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2435">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2436">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2436">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2437">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2437">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2438">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2438">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2439">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2439">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2440">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2440">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="25e03-2441">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2441">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2442">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2442">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2443">Этот метод выполняет поиск в нетранзакционной очереди, на которую ссылается объект <xref:System.Messaging.MessageQueue> для сообщения, <xref:System.Messaging.Message.CorrelationId%2A> соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2443">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2444">Этот метод немедленно возвращает значение, если сообщение с идентификатором корреляции, `correlationId` заданным параметром, находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2444">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="25e03-2445">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2445">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2446">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2446">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2447">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2447">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2448">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2448">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2449">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> новое сообщение, чтобы проверить, `correlationId` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2449">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2450">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2450">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2451">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.CorrelationId%2A> которого `correlationId` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2451">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2452"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2452">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2453">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2453">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2454">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2454">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2455">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2455">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2456"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2456">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2457">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2457">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2458">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2458">Workgroup mode</span></span>|<span data-ttu-id="25e03-2459">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2459">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2460">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2460">Local computer</span></span>|<span data-ttu-id="25e03-2461">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2461">Yes</span></span>|  
|<span data-ttu-id="25e03-2462">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2462">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2463">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2463">Yes</span></span>|  
|<span data-ttu-id="25e03-2464">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2464">Remote computer</span></span>|<span data-ttu-id="25e03-2465">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2465">No</span></span>|  
|<span data-ttu-id="25e03-2466">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2466">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2467">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2467">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2468">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2468">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2469">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2469">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2470">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2470">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2471">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="25e03-2471">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2472">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2472">-or-</span></span> 
<span data-ttu-id="25e03-2473">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2473">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2474">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2474">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2475">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2475">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2476">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2476">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2477">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2477">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2478">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2478">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2479">Этот метод выполняет поиск в транзакционной очереди, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2479">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2480">Этот метод немедленно возвращает значение, если сообщение с идентификатором корреляции, `correlationId` заданным параметром, находится в очереди, с использованием контекста внутренней транзакции `transaction` , определенного параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2480">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-2481">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2481">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2482">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2482">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2483">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2483">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2484">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2484">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2485">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> новое сообщение, чтобы проверить, `correlationId` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2485">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2486">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2486">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2487">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.CorrelationId%2A> которого `correlationId` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2487">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2488">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2488">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2489">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2489">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2490"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2490">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2491">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2491">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2492">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2492">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2493">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2493">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2494"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2494">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2495">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2495">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-2496">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2496">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2497">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2497">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2498">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2498">Workgroup mode</span></span>|<span data-ttu-id="25e03-2499">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2499">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2500">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2500">Local computer</span></span>|<span data-ttu-id="25e03-2501">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2501">Yes</span></span>|  
|<span data-ttu-id="25e03-2502">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2502">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2503">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2503">Yes</span></span>|  
|<span data-ttu-id="25e03-2504">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2504">Remote computer</span></span>|<span data-ttu-id="25e03-2505">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2505">No</span></span>|  
|<span data-ttu-id="25e03-2506">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2506">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2507">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2507">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2508">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2508">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2509">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2509">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-2510">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2510">-or-</span></span> 
<span data-ttu-id="25e03-2511">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2511">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2512">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2512">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2513">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="25e03-2513">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2514">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2514">-or-</span></span> 
<span data-ttu-id="25e03-2515">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2515">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="25e03-2516">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2516">-or-</span></span> 
<span data-ttu-id="25e03-2517">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="25e03-2518">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2518">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2519">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2519">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2520">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2520">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2521">Получает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2521">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2522">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2522">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2523">Этот метод просматривает очередь, на которую ссылается <xref:System.Messaging.MessageQueue> объект, для сообщения <xref:System.Messaging.Message.CorrelationId%2A> , соответствующего указанному `correlationId` параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2523">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2524">Этот метод немедленно возвращает значение, если сообщение с идентификатором корреляции, `correlationId` заданным параметром, находится в очереди с использованием контекста транзакции, `transactionType` определенного параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2524">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="25e03-2525">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2525">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2526">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2526">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2527">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2527">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2528">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2528">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2529">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> новое сообщение, чтобы проверить, `correlationId` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2529">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2530">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2530">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2531">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.CorrelationId%2A> которого `correlationId` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2531">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="25e03-2532">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2532">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2533">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2533">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2534">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2534">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2535">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2535">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2536">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2536">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2537"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, к связанному ответу, отчету или сообщениям подтверждения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2537">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="25e03-2538">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2538">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2539">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> а метод используется для получения сообщения путем указания его уникального идентификатора. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2539">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="25e03-2540">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2540">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2541"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2541">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2542">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2542">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="25e03-2543">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2543">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2544">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2544">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2545">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2545">Workgroup mode</span></span>|<span data-ttu-id="25e03-2546">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2546">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2547">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2547">Local computer</span></span>|<span data-ttu-id="25e03-2548">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2548">Yes</span></span>|  
|<span data-ttu-id="25e03-2549">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2549">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2550">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2550">Yes</span></span>|  
|<span data-ttu-id="25e03-2551">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2551">Remote computer</span></span>|<span data-ttu-id="25e03-2552">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2552">No</span></span>|  
|<span data-ttu-id="25e03-2553">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2553">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2554">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2554">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2555">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2555">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2556">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2556">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2557">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2557">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2558">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2558">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2559">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2559">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2560">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="25e03-2560">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2561">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2561">-or-</span></span> 
<span data-ttu-id="25e03-2562">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2562">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-2563">Получает сообщение, которое соответствует заданному идентификатору, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2563">Receives the message that matches the given identifier, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2564">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2564">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="25e03-2565">Получает из нетранзакционной очереди сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="25e03-2565">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2566">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2566">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2567">Используйте этот метод для чтения сообщения с известным идентификатором и его удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2567">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="25e03-2568">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2568">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2569">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2569">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2570">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2570">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2571">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2571">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2572">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2572">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2573"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2573">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2574">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2574">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2575">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2575">Workgroup mode</span></span>|<span data-ttu-id="25e03-2576">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2576">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2577">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2577">Local computer</span></span>|<span data-ttu-id="25e03-2578">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2578">Yes</span></span>|  
|<span data-ttu-id="25e03-2579">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2579">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2580">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2580">Yes</span></span>|  
|<span data-ttu-id="25e03-2581">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2581">Remote computer</span></span>|<span data-ttu-id="25e03-2582">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2582">No</span></span>|  
|<span data-ttu-id="25e03-2583">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2583">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2584">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2584">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2585">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2585">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2586">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2586">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2587">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2587">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2588">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2588">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2589">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2589">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2590">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2590">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2591">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="25e03-2591">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2592">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2592">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2593">Этот метод используется для чтения сообщения с известным идентификатором и удаления его из очереди с использованием контекста внутренней транзакции, определенного `transaction` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2593">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-2594">Этот метод немедленно создает исключение, если сообщение не находится в очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-2594">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="25e03-2595">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2595">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2596">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2596">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2597">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2597">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2598">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2598">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2599">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2599">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2600">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2600">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2601"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2601">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2602">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2602">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="25e03-2603">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2603">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2604">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2604">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2605">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2605">Workgroup mode</span></span>|<span data-ttu-id="25e03-2606">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2606">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2607">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2607">Local computer</span></span>|<span data-ttu-id="25e03-2608">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2608">Yes</span></span>|  
|<span data-ttu-id="25e03-2609">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2609">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2610">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2610">Yes</span></span>|  
|<span data-ttu-id="25e03-2611">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2611">Remote computer</span></span>|<span data-ttu-id="25e03-2612">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2612">No</span></span>|  
|<span data-ttu-id="25e03-2613">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2613">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2614">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2614">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2615">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2615">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2616">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2616">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-2617">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2617">-or-</span></span> 
<span data-ttu-id="25e03-2618">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2618">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2619">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2619">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2620">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2620">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="25e03-2621">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2621">-or-</span></span>  
  
 <span data-ttu-id="25e03-2622">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2623">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2623">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2624">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2624">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2625">Получает сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="25e03-2625">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2626">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2626">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2627">Используйте этот метод для чтения сообщения с известным идентификатором и его удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2627">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="25e03-2628">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2628">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="25e03-2629">В противном случае сообщение удаляется из очереди и возвращается приложению с помощью контекста транзакции, определенного `transactionType` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2629">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2630">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2630">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2631">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2631">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2632">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2632">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2633">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2633">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="25e03-2634">Если сообщение с указанным идентификатором находится в очереди, отличной от связанной с данным <xref:System.Messaging.MessageQueue> экземпляром, сообщение не будет найдено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2634">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="25e03-2635">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2635">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2636">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2636">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2637">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2637">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2638">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2638">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2639">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2639">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2640"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2640">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2641">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2641">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="25e03-2642">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2642">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2643">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2643">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2644">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2644">Workgroup mode</span></span>|<span data-ttu-id="25e03-2645">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2645">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2646">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2646">Local computer</span></span>|<span data-ttu-id="25e03-2647">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2647">Yes</span></span>|  
|<span data-ttu-id="25e03-2648">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2648">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2649">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2649">Yes</span></span>|  
|<span data-ttu-id="25e03-2650">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2650">Remote computer</span></span>|<span data-ttu-id="25e03-2651">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2651">No</span></span>|  
|<span data-ttu-id="25e03-2652">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2652">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2653">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2653">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2654">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2654">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2655">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2655">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2656">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2656">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2657">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2657">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2658">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2658">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2659">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2659">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2660">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2660">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="25e03-2661">Получает сообщение, которое соответствует заданному идентификатору (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2661">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2662">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2662">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2663">Используйте этот метод для чтения сообщения с известным идентификатором и его удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2663">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="25e03-2664">Этот метод немедленно возвращает значение, если сообщение с идентификатором, указанным `id` в параметре, находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2664">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="25e03-2665">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2665">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2666">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2666">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2667">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2667">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2668">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2668">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2669">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.Id%2A> новое сообщение, чтобы проверить, `id` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2669">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="25e03-2670">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2670">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2671">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.Id%2A> которого `id` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2671">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2672">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2672">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2673">Используйте эту перегрузку, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> если допускается блокировка текущего потока при условии, что новые сообщения продолжают поступать в очередь в течение времени ожидания, заданного `timeout` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2673">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2674">Поток будет заблокирован по крайней мере в заданный период времени или неопределенно, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` параметра или если новые сообщения продолжают поступать в очередь в течение времени `timeout` ожидания, заданного параметром параметр.</span><span class="sxs-lookup"><span data-stu-id="25e03-2674">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2675">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2675">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2676">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2676">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2677">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2677">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2678"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2678">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2679">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2679">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2680">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2680">Workgroup mode</span></span>|<span data-ttu-id="25e03-2681">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2681">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2682">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2682">Local computer</span></span>|<span data-ttu-id="25e03-2683">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2683">Yes</span></span>|  
|<span data-ttu-id="25e03-2684">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2684">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2685">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2685">Yes</span></span>|  
|<span data-ttu-id="25e03-2686">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2686">Remote computer</span></span>|<span data-ttu-id="25e03-2687">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2687">No</span></span>|  
|<span data-ttu-id="25e03-2688">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2688">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2689">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2689">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2690">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2690">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2691">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2691">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2692">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2692">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2693">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2693">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2694">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2694">-or-</span></span> 
<span data-ttu-id="25e03-2695">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2695">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2696">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2696">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2697">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2697">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2698">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2698">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2699">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2699">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2700">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2700">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2701">Этот метод используется для чтения сообщения с известным идентификатором и удаления его из очереди с использованием контекста внутренней транзакции, определенного `transaction` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2701">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-2702">Этот метод немедленно возвращает значение, если сообщение с идентификатором, указанным `id` в параметре, находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2702">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="25e03-2703">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2703">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2704">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2704">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2705">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2705">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2706">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2706">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2707">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.Id%2A> новое сообщение, чтобы проверить, `id` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2707">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="25e03-2708">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2708">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2709">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.Id%2A> которого `id` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2709">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2710">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2710">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2711">Используйте эту перегрузку, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> если допускается блокировка текущего потока при условии, что новые сообщения продолжают поступать в очередь в течение времени ожидания, заданного `timeout` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2711">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2712">Поток будет заблокирован по крайней мере в заданный период времени или неопределенно, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` параметра или если новые сообщения продолжают поступать в очередь в течение `timeout` времени ожидания, заданного параметром параметр.</span><span class="sxs-lookup"><span data-stu-id="25e03-2712">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2713">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2713">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2714">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2714">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2715">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2715">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2716">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2716">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2717">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2717">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2718"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают одно и то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2718">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2719">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2719">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="25e03-2720">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2720">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2721">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2721">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2722">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2722">Workgroup mode</span></span>|<span data-ttu-id="25e03-2723">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2723">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2724">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2724">Local computer</span></span>|<span data-ttu-id="25e03-2725">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2725">Yes</span></span>|  
|<span data-ttu-id="25e03-2726">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2726">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2727">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2727">Yes</span></span>|  
|<span data-ttu-id="25e03-2728">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2728">Remote computer</span></span>|<span data-ttu-id="25e03-2729">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2729">No</span></span>|  
|<span data-ttu-id="25e03-2730">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2730">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2731">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2731">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2732">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2732">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2733">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2733">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-2734">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2734">-or-</span></span> 
<span data-ttu-id="25e03-2735">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2735">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2736">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2736">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2737">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2737">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2738">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2738">-or-</span></span> 
<span data-ttu-id="25e03-2739">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2739">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="25e03-2740">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2740">-or-</span></span> 
<span data-ttu-id="25e03-2741">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2741">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="25e03-2742">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2742">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="25e03-2743">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="25e03-2743">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2744">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2744">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2745">Получает сообщение, которое соответствует заданному идентификатору, и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="25e03-2745">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="25e03-2746">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2746">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2747">Используйте этот метод для чтения сообщения с известным идентификатором и его удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2747">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="25e03-2748">Этот метод немедленно возвращает значение, если сообщение с идентификатором, указанным `id` в параметре, находится в очереди, с использованием контекста транзакции, `transactionType` определенного параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2748">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="25e03-2749">В противном случае метод ожидает поступления нового сообщения в течение заданного периода времени.</span><span class="sxs-lookup"><span data-stu-id="25e03-2749">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="25e03-2750">Если новое сообщение не будет доставлено до истечения времени ожидания, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2750">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="25e03-2751">`timeout` Параметр не задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="25e03-2751">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="25e03-2752">Вместо этого он указывает время ожидания поступления нового сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2752">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="25e03-2753">Каждый раз, когда поступает новое сообщение, этот метод проверяет <xref:System.Messaging.Message.Id%2A> новое сообщение, чтобы проверить, `id` соответствует ли он параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2753">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="25e03-2754">В противном случае этот метод запускает период времени ожидания и ожидает поступления другого нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2754">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="25e03-2755">Таким образом, если новые сообщения продолжают поступать в течение времени ожидания, этот метод может продолжать работу в течение неограниченного времени, пока не истечет время ожидания, не прибегая новых сообщений или пока не поступит сообщение, для <xref:System.Messaging.Message.Id%2A> которого `id` соответствует параметру.</span><span class="sxs-lookup"><span data-stu-id="25e03-2755">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2756">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2756">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2757">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2757">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2758">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2758">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2759">Свойство сообщения является уникальным в рамках организации очереди сообщений, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `id` параметру. <xref:System.Messaging.Message.Id%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2759">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="25e03-2760">Если сообщение с указанным идентификатором находится в очереди, отличной от связанной с данным <xref:System.Messaging.MessageQueue> экземпляром, сообщение не будет найдено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2760">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="25e03-2761">Используйте эту перегрузку, <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> если допускается блокировка текущего потока при условии, что новые сообщения продолжают поступать в очередь в течение времени ожидания, заданного `timeout` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2761">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="25e03-2762">Поток будет заблокирован по крайней мере в заданный период времени или неопределенно, если указано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> `timeout` параметра или если новые сообщения продолжают поступать в очередь в течение времени `timeout` ожидания, заданного параметром параметр.</span><span class="sxs-lookup"><span data-stu-id="25e03-2762">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2763">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2763">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2764">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2764">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2765">Два других метода позволяют принимать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2765">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="25e03-2766">Метод возвращает первое сообщение в очереди, <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> а метод используется для получения подтверждения, отчета или созданного приложением ответного сообщения, созданного в результате сообщения, отправленного в очередь. <xref:System.Messaging.MessageQueue.Receive%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2766">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2767">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2767">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="25e03-2768"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращают то же сообщение, если в очередь не поступает сообщение с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2768">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="25e03-2769">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2769">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="25e03-2770">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения в очереди, откат транзакции будет невозможен, если транзакция была прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2770">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2771">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2771">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2772">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2772">Workgroup mode</span></span>|<span data-ttu-id="25e03-2773">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2773">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2774">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2774">Local computer</span></span>|<span data-ttu-id="25e03-2775">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2775">Yes</span></span>|  
|<span data-ttu-id="25e03-2776">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2776">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2777">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2777">Yes</span></span>|  
|<span data-ttu-id="25e03-2778">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2778">Remote computer</span></span>|<span data-ttu-id="25e03-2779">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2779">No</span></span>|  
|<span data-ttu-id="25e03-2780">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2780">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2781">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2781">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2782">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2782">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-2783">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2783">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-2784">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2784">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2785">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="25e03-2785">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="25e03-2786">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2786">-or-</span></span> 
<span data-ttu-id="25e03-2787">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2787">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2788">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2788">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-2789">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2789">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-2790">Получает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2790">Receives a specific message from the queue.</span></span> <span data-ttu-id="25e03-2791">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2791">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="25e03-2792">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2792">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="25e03-2793">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2793">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-2794">Получает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2794">Receives the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2795">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2795">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2796">Используйте этот метод для чтения сообщения с известным идентификатором уточняющего запроса и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2796">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="25e03-2797">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2797">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2798">Свойство сообщения является уникальным для очереди, в которой находится сообщение, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `lookupId` параметру. <xref:System.Messaging.Message.LookupId%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2798">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2799">Чтобы прочитать сообщение с указанным идентификатором поиска, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2799">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="25e03-2800">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2800">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2801">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2801">Workgroup mode</span></span>|<span data-ttu-id="25e03-2802">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2802">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2803">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2803">Local computer</span></span>|<span data-ttu-id="25e03-2804">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2804">Yes</span></span>|  
|<span data-ttu-id="25e03-2805">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2805">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2806">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2806">Yes</span></span>|  
|<span data-ttu-id="25e03-2807">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2807">Remote computer</span></span>|<span data-ttu-id="25e03-2808">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2808">No</span></span>|  
|<span data-ttu-id="25e03-2809">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2809">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2810">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2810">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-2811">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2811">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2812">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2812">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2813">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="25e03-2814">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2814">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="25e03-2815">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="25e03-2815">Specify one of the following:</span></span> 
 <span data-ttu-id="25e03-2816"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2816"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2817"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2817"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2818"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2818"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2819"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2819"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="25e03-2820">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2820">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="25e03-2821"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2821"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="25e03-2822">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2822">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="25e03-2823">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2823">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="25e03-2824">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2824">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2825">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2825">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2826">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2826">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-2827">Получает конкретное сообщение из транзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2827">Receives a specific message from a transactional queue.</span></span> <span data-ttu-id="25e03-2828">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2828">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2829">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="lookupId" /> и <paramref name="action" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2829">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2830">Используйте этот метод для чтения сообщения с известным идентификатором уточняющего запроса и удаления его из очереди с помощью контекста транзакции, определенного `transaction` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2830">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-2831">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2831">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2832">Свойство сообщения является уникальным для очереди, в которой находится сообщение, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `lookupId` параметру. <xref:System.Messaging.Message.LookupId%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2832">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2833">Поскольку этот метод вызывается для транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2833">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2834">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2834">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2835">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2835">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="25e03-2836">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2836">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="25e03-2837">Так <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> как не удаляет сообщения из очереди, в случае отмены транзакции будет нечего возвращаться.</span><span class="sxs-lookup"><span data-stu-id="25e03-2837">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2838">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2838">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2839">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2839">Workgroup mode</span></span>|<span data-ttu-id="25e03-2840">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2840">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2841">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2841">Local computer</span></span>|<span data-ttu-id="25e03-2842">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2842">Yes</span></span>|  
|<span data-ttu-id="25e03-2843">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2843">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2844">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2844">Yes</span></span>|  
|<span data-ttu-id="25e03-2845">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2845">Remote computer</span></span>|<span data-ttu-id="25e03-2846">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2846">No</span></span>|  
|<span data-ttu-id="25e03-2847">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2847">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2848">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2848">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-2849">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2849">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2850">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2850">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2851">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2851">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="25e03-2852">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2852">-or-</span></span>  
  
 <span data-ttu-id="25e03-2853">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="25e03-2853">The queue is non-transactional.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2854">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2854">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="25e03-2855">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2855">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="25e03-2856">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="25e03-2856">Specify one of the following:</span></span> 
 <span data-ttu-id="25e03-2857"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2857"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2858"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2858"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2859"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2859"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="25e03-2860"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2860"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="25e03-2861">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2861">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="25e03-2862"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2862"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="25e03-2863">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2863">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="25e03-2864">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2864">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="25e03-2865">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2865">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-2866">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-2866">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-2867">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="25e03-2867">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="25e03-2868">Получает из очереди определенное сообщение, используя заданный контекст транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2868">Receives a specific message from the queue, using the specified transaction context.</span></span> <span data-ttu-id="25e03-2869">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2869">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="25e03-2870">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2870">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2871">Используйте этот метод для чтения сообщения с известным идентификатором уточняющего запроса и удаления его из очереди с помощью контекста транзакции, определенного `transactionType` параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2871">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="25e03-2872">Этот метод немедленно создает исключение, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2872">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2873">Свойство сообщения является уникальным для очереди, в которой находится сообщение, поэтому в очереди должно быть не более одного сообщения, которое соответствует заданному `lookupId` параметру. <xref:System.Messaging.Message.LookupId%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2873">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="25e03-2874">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="25e03-2874">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="25e03-2875">Отсутствует контекст транзакции, связанный с сообщением, возвращенным вызовом <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2875">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="25e03-2876">Так <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> как не удаляет сообщения из очереди, в случае отмены транзакции будет нечего возвращаться.</span><span class="sxs-lookup"><span data-stu-id="25e03-2876">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="25e03-2877">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для получения сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2877">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="25e03-2878">Укажите `Single` , следует ли получить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2878">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-2879">Можно указать `None` , следует ли получить сообщение из транзакционной очереди за пределами контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-2879">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="25e03-2880">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено в очередь, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="25e03-2880">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="25e03-2881">Сообщение не удаляется навсегда из очереди до тех пор, пока транзакция не будет зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="25e03-2881">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="25e03-2882">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2882">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2883">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2883">Workgroup mode</span></span>|<span data-ttu-id="25e03-2884">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2884">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2885">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2885">Local computer</span></span>|<span data-ttu-id="25e03-2886">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2886">Yes</span></span>|  
|<span data-ttu-id="25e03-2887">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2887">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2888">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2888">Yes</span></span>|  
|<span data-ttu-id="25e03-2889">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2889">Remote computer</span></span>|<span data-ttu-id="25e03-2890">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2890">No</span></span>|  
|<span data-ttu-id="25e03-2891">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2891">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2892">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2892">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="25e03-2893">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2893">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="25e03-2894">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2894">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2895">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-2896">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2896">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span>  
  
<span data-ttu-id="25e03-2897">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-2897">-or-</span></span> 
<span data-ttu-id="25e03-2898">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2898">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberSignature Language="F#" Value="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " Usage="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-2899">Происходит, если сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2899">Occurs when a message has been removed from the queue.</span></span> <span data-ttu-id="25e03-2900">Это событие инициируется асинхронной операцией, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2900">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A>используется при асинхронной обработке для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, когда сообщение доступно в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="25e03-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>используется для завершения операции, инициированной вызовом метода <xref:System.Messaging.MessageQueue.BeginReceive%2A> , и просмотра сообщения <xref:System.Messaging.MessageQueue.ReceiveCompleted> при возникновении события.</span><span class="sxs-lookup"><span data-stu-id="25e03-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="25e03-2903">При создании делегата <xref:System.Messaging.ReceiveCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="25e03-2903">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="25e03-2904">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="25e03-2904">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="25e03-2905">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="25e03-2905">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="25e03-2906">Дополнительные сведения о делегатах обработчиков событий см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="25e03-2906">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2907">Следующий пример кода создает обработчик событий с именем `MyReceiveCompleted`, присоединяет его <xref:System.Messaging.MessageQueue.ReceiveCompleted> к делегату обработчика событий и вызывает метод <xref:System.Messaging.MessageQueue.BeginReceive%2A> , чтобы инициировать асинхронную операцию получения в очереди, расположенной по пути ".\микуеуе".</span><span class="sxs-lookup"><span data-stu-id="25e03-2907">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="25e03-2908">При возникновении <xref:System.Messaging.MessageQueue.ReceiveCompleted> события пример получает сообщение и записывает его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="25e03-2908">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="25e03-2909">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginReceive%2A> еще раз, чтобы инициировать новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2909">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberSignature Language="F#" Value="member this.Refresh : unit -&gt; unit" Usage="messageQueue.Refresh " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-2910">Обновляет свойства, представленные объектом <see cref="T:System.Messaging.MessageQueue" /> для отражения текущего состояния ресурса.</span><span class="sxs-lookup"><span data-stu-id="25e03-2910">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2911"><xref:System.Messaging.MessageQueue.Refresh%2A>синхронизирует свойства <xref:System.Messaging.MessageQueue> объекта со связанным ресурсом сервера очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2911"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="25e03-2912">Если какое бы то ни <xref:System.Messaging.MessageQueue.Label%2A> <xref:System.Messaging.MessageQueue> было свойство <xref:System.Messaging.MessageQueue.Category%2A>, такое как или, было изменено на сервере с момента создания <xref:System.Messaging.MessageQueue.Refresh%2A> , обновляет <xref:System.Messaging.MessageQueue> с помощью новой информации.</span><span class="sxs-lookup"><span data-stu-id="25e03-2912">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="25e03-2913">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2913">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2914">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2914">Workgroup mode</span></span>|<span data-ttu-id="25e03-2915">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2915">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2916">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2916">Local computer</span></span>|<span data-ttu-id="25e03-2917">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2917">Yes</span></span>|  
|<span data-ttu-id="25e03-2918">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2918">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2919">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2919">Yes</span></span>|  
|<span data-ttu-id="25e03-2920">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2920">Remote computer</span></span>|<span data-ttu-id="25e03-2921">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2921">No</span></span>|  
|<span data-ttu-id="25e03-2922">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2922">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2923">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2923">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2924">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2924">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberSignature Language="F#" Value="member this.ResetPermissions : unit -&gt; unit" Usage="messageQueue.ResetPermissions " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="25e03-2925">Присваивает списку разрешений значения по умолчанию операционной системы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2925">Resets the permission list to the operating system's default values.</span></span> <span data-ttu-id="25e03-2926">Удаляет все разрешения очередей, добавленные в список по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2926">Removes any queue permissions you have appended to the default list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2927">При вызове <xref:System.Messaging.MessageQueue.ResetPermissions%2A>метода список разрешений возвращается к значениям по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="25e03-2927">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="25e03-2928">Как правило, эта группа предоставляет всем разрешениям автора очереди и предоставляет группе все следующие права:</span><span class="sxs-lookup"><span data-stu-id="25e03-2928">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="25e03-2929">Получение свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2929">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="25e03-2930">Получение разрешений очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2930">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="25e03-2931">Запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2931">Write to the queue.</span></span>  
  
 <span data-ttu-id="25e03-2932">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2932">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2933">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2933">Workgroup mode</span></span>|<span data-ttu-id="25e03-2934">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2934">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2935">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2935">Local computer</span></span>|<span data-ttu-id="25e03-2936">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2936">Yes</span></span>|  
|<span data-ttu-id="25e03-2937">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2937">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2938">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2938">Yes</span></span>|  
|<span data-ttu-id="25e03-2939">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2939">Remote computer</span></span>|<span data-ttu-id="25e03-2940">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2940">No</span></span>|  
|<span data-ttu-id="25e03-2941">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2941">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2942">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2942">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2943">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2943">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2944">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2944">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-2945">Отправляет объект в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2945">Sends an object to a queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberSignature Language="F#" Value="member this.Send : obj -&gt; unit" Usage="messageQueue.Send obj" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-2946">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2946">The object to send to the queue.</span></span></param>
        <summary><span data-ttu-id="25e03-2947">Отправляет объект в нетранзакционную очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2947">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2948">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в очередь, на которую <xref:System.Messaging.MessageQueue>ссылается.</span><span class="sxs-lookup"><span data-stu-id="25e03-2948">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-2949">Объект, отправляемый в очередь, может быть <xref:System.Messaging.Message> или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2949">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="25e03-2950">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2950">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="25e03-2951">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-2951">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="25e03-2952">Если необходимо, чтобы сообщение было частью транзакции, содержащей другие сообщения, используйте перегрузку, которая принимает <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-2952">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="25e03-2953">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2953">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-2954">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2954">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-2955">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2955">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-2956">При отправке <xref:System.Messaging.Message>, значения свойств, заданные для <xref:System.Messaging.Message> параметра, имеют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> приоритет <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> над, а свойство сообщения имеет приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2956">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-2957">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2957">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2958">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2958">Workgroup mode</span></span>|<span data-ttu-id="25e03-2959">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2959">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2960">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2960">Local computer</span></span>|<span data-ttu-id="25e03-2961">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2961">Yes</span></span>|  
|<span data-ttu-id="25e03-2962">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2962">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2963">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2963">Yes</span></span>|  
|<span data-ttu-id="25e03-2964">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2964">Remote computer</span></span>|<span data-ttu-id="25e03-2965">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2965">No</span></span>|  
|<span data-ttu-id="25e03-2966">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2966">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2967">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2967">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2968">Следующий пример кода подключается к очереди сообщений и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2968">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="25e03-2969">В следующем примере кода класс, определяемый `Order` приложением, отправляется в очередь, а затем получает сообщение из этой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2969">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-2970">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-2970">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-2971">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-2971">-or-</span></span> 
<span data-ttu-id="25e03-2972">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-2972">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-2973">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2973">The object to send to the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-2974">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2974">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-2975">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-2975">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-2976">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в транзакционную очередь, на которую ссылается <xref:System.Messaging.MessageQueue>объект, используя контекст внутренней `transaction` транзакции, определенный параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-2976">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-2977">Объект, отправляемый в очередь, может быть <xref:System.Messaging.Message> или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-2977">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="25e03-2978">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2978">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="25e03-2979">При использовании этой перегрузки для отправки сообщения в нетранзакционную очередь сообщение может быть отправлено в очередь недоставленных сообщений без возникновения исключения.</span><span class="sxs-lookup"><span data-stu-id="25e03-2979">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="25e03-2980">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-2980">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-2981">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-2981">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-2982">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-2982">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-2983">При отправке <xref:System.Messaging.Message>, значения свойств, заданные для <xref:System.Messaging.Message> параметра, имеют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> приоритет <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> над, а свойство сообщения имеет приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2983">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-2984"><xref:System.Messaging.MessageQueueTransaction>учитывает потоковое подразделение, поэтому, если состояние апартамента `STA`—, нельзя использовать транзакцию в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="25e03-2984"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="25e03-2985">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо <xref:System.MTAThreadAttribute> применить в `Main` подподпрограмме.</span><span class="sxs-lookup"><span data-stu-id="25e03-2985">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="25e03-2986">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="25e03-2986">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="25e03-2987">Для <xref:System.MTAThreadAttribute> применения используется следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="25e03-2987">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="25e03-2988">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-2988">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-2989">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-2989">Workgroup mode</span></span>|<span data-ttu-id="25e03-2990">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-2990">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-2991">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2991">Local computer</span></span>|<span data-ttu-id="25e03-2992">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2992">Yes</span></span>|  
|<span data-ttu-id="25e03-2993">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2993">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-2994">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2994">Yes</span></span>|  
|<span data-ttu-id="25e03-2995">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-2995">Remote computer</span></span>|<span data-ttu-id="25e03-2996">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-2996">No</span></span>|  
|<span data-ttu-id="25e03-2997">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-2997">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-2998">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-2998">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-2999">В следующем примере кода строка отправляется в транзакционную очередь, а затем получает сообщение из этой очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-2999">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-3000">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3000">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3001">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-3001">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-3002">-или-</span><span class="sxs-lookup"><span data-stu-id="25e03-3002">-or-</span></span> 
<span data-ttu-id="25e03-3003">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3003">The Message Queuing application indicated an incorrect transaction use.</span></span>  
  
<span data-ttu-id="25e03-3004">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3004">-or-</span></span> 
<span data-ttu-id="25e03-3005">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3005">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-3006">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3006">The object to send to the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-3007">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-3007">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-3008">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3008">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3009">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в очередь, на которую <xref:System.Messaging.MessageQueue>ссылается объект, используя контекст `transactionType` транзакции, определенный параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-3009">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="25e03-3010">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для отправки сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3010">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="25e03-3011">Укажите `Single` , следует ли отправить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-3011">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-3012">Можно указать `None` , следует ли отправить транзакционное сообщение в поток, не являющийся транзакционным.</span><span class="sxs-lookup"><span data-stu-id="25e03-3012">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="25e03-3013">Объект, отправляемый в очередь, может быть <xref:System.Messaging.Message> или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3013">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="25e03-3014">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3014">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="25e03-3015">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3015">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-3016">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-3016">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-3017">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3017">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-3018">При отправке <xref:System.Messaging.Message>, значения свойств, заданные для <xref:System.Messaging.Message> параметра, имеют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> приоритет <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> над, а свойство сообщения имеет приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3018">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-3019">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3019">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3020">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3020">Workgroup mode</span></span>|<span data-ttu-id="25e03-3021">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3021">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3022">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3022">Local computer</span></span>|<span data-ttu-id="25e03-3023">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3023">Yes</span></span>|  
|<span data-ttu-id="25e03-3024">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3024">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3025">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3025">Yes</span></span>|  
|<span data-ttu-id="25e03-3026">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3026">Remote computer</span></span>|<span data-ttu-id="25e03-3027">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3027">No</span></span>|  
|<span data-ttu-id="25e03-3028">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3028">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3029">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3029">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3030">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3030">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-3031">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3031">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3032">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-3032">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-3033">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3033">-or-</span></span> 
<span data-ttu-id="25e03-3034">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3034">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string -&gt; unit" Usage="messageQueue.Send (obj, label)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-3035">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3035">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="25e03-3036">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3036">The label of the message.</span></span></param>
        <summary><span data-ttu-id="25e03-3037">Отправляет объект в нетранзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3037">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3038">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в очередь, на которую <xref:System.Messaging.MessageQueue>ссылается.</span><span class="sxs-lookup"><span data-stu-id="25e03-3038">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="25e03-3039">С помощью этой перегрузки можно указать строку, определяющую сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3039">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="25e03-3040">Объект <xref:System.Messaging.Message>, отправляемый в очередь, может быть, структурой, объектом данных или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3040">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="25e03-3041">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3041">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="25e03-3042">Метка сообщения отличается от метки очереди сообщений, но обе они зависят от приложения и не имеют значения, наследуемого очередью сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3042">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="25e03-3043">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3043">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="25e03-3044">Если необходимо, чтобы сообщение было частью транзакции, содержащей другие сообщения, используйте перегрузку, которая принимает <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-3044">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="25e03-3045">Перед отправкой <xref:System.Messaging.MessageQueue> сообщения необходимо указать свойстводляэтогоэкземпляра.<xref:System.Messaging.MessageQueue.Path%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-3045">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="25e03-3046">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3046">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-3047">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-3047">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-3048">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3048">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-3049">При отправке <xref:System.Messaging.Message>, значения свойств, заданные для <xref:System.Messaging.Message> параметра, имеют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> приоритет <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> над, а свойство сообщения имеет приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3049">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-3050">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3050">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3051">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3051">Workgroup mode</span></span>|<span data-ttu-id="25e03-3052">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3052">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3053">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3053">Local computer</span></span>|<span data-ttu-id="25e03-3054">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3054">Yes</span></span>|  
|<span data-ttu-id="25e03-3055">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3055">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3056">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3056">Yes</span></span>|  
|<span data-ttu-id="25e03-3057">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3057">Remote computer</span></span>|<span data-ttu-id="25e03-3058">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3058">No</span></span>|  
|<span data-ttu-id="25e03-3059">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3059">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3060">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3060">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3061">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3061">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-3062">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3062">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3063">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-3063">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-3064">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3064">-or-</span></span> 
<span data-ttu-id="25e03-3065">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3065">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, label, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-3066">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3066">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="25e03-3067">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3067">The label of the message.</span></span></param>
        <param name="transaction"><span data-ttu-id="25e03-3068">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3068">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="25e03-3069">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3069">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3070">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в транзакционную очередь, на которую ссылается <xref:System.Messaging.MessageQueue>объект, используя контекст внутренней `transaction` транзакции, определенный параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-3070">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="25e03-3071">С помощью этой перегрузки можно указать строку, определяющую сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3071">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="25e03-3072">Объект <xref:System.Messaging.Message>, отправляемый в очередь, может быть, структурой, объектом данных или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3072">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="25e03-3073">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3073">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="25e03-3074">Метка сообщения отличается от метки очереди сообщений, но обе они зависят от приложения и не имеют значения, наследуемого очередью сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3074">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="25e03-3075">При использовании этой перегрузки для отправки сообщения в нетранзакционную очередь сообщение может быть отправлено в очередь недоставленных сообщений без возникновения исключения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3075">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="25e03-3076">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3076">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-3077">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-3077">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-3078">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3078">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-3079">При отправке <xref:System.Messaging.Message>, значения свойств, заданные <xref:System.Messaging.Message> для приоритета <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> , для свойства сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеют приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3079">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="25e03-3080"><xref:System.Messaging.MessageQueueTransaction>учитывает потоковое подразделение, поэтому, если состояние апартамента `STA`—, нельзя использовать транзакцию в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="25e03-3080"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="25e03-3081">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо <xref:System.MTAThreadAttribute> применить в `Main` подподпрограмме.</span><span class="sxs-lookup"><span data-stu-id="25e03-3081">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="25e03-3082">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3082">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="25e03-3083">Для <xref:System.MTAThreadAttribute> применения используется следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="25e03-3083">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="25e03-3084">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3084">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3085">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3085">Workgroup mode</span></span>|<span data-ttu-id="25e03-3086">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3086">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3087">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3087">Local computer</span></span>|<span data-ttu-id="25e03-3088">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3088">Yes</span></span>|  
|<span data-ttu-id="25e03-3089">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3089">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3090">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3090">Yes</span></span>|  
|<span data-ttu-id="25e03-3091">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3091">Remote computer</span></span>|<span data-ttu-id="25e03-3092">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3092">No</span></span>|  
|<span data-ttu-id="25e03-3093">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3093">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3094">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3094">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3095">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3095">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-3096">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3096">The <paramref name="label" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="25e03-3097">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3097">-or-</span></span> 
<span data-ttu-id="25e03-3098">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3098">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3099">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-3099">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-3100">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3100">-or-</span></span> 
<span data-ttu-id="25e03-3101">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3101">The Message Queuing application indicated an incorrect transaction usage.</span></span>  
  
<span data-ttu-id="25e03-3102">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3102">-or-</span></span> 
<span data-ttu-id="25e03-3103">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3103">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, label, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="25e03-3104">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3104">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="25e03-3105">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3105">The label of the message.</span></span></param>
        <param name="transactionType"><span data-ttu-id="25e03-3106">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="25e03-3106">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="25e03-3107">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3107">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3108">Используйте эту перегрузку для отправки сообщения, содержащего `obj` параметр, в очередь, на которую <xref:System.Messaging.MessageQueue>ссылается объект, используя контекст `transactionType` транзакции, определенный параметром.</span><span class="sxs-lookup"><span data-stu-id="25e03-3108">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="25e03-3109">Укажите `Automatic` для параметра `transactionType` , если к потоку, который требуется использовать для отправки сообщения, уже присоединен контекст внешней транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3109">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="25e03-3110">Укажите `Single` , следует ли отправить сообщение как единую внутреннюю транзакцию.</span><span class="sxs-lookup"><span data-stu-id="25e03-3110">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="25e03-3111">Можно указать `None` , следует ли отправить транзакционное сообщение в поток, не являющийся транзакционным.</span><span class="sxs-lookup"><span data-stu-id="25e03-3111">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="25e03-3112">Объект, отправляемый в очередь, может быть <xref:System.Messaging.Message> или любым управляемым объектом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3112">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="25e03-3113">При отправке любого объекта <xref:System.Messaging.Message>, отличного от, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3113">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="25e03-3114">С помощью этой перегрузки можно указать строку, определяющую сообщение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3114">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="25e03-3115">Метка сообщения отличается от метки очереди сообщений, но обе они зависят от приложения и не имеют значения, наследуемого очередью сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3115">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="25e03-3116">Если не задать <xref:System.Messaging.MessageQueue.Formatter%2A> свойство до вызова метода <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.XmlMessageFormatter>форматер по умолчанию будет иметь значение.</span><span class="sxs-lookup"><span data-stu-id="25e03-3116">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="25e03-3117">Свойство применяется к любому объекту, <xref:System.Messaging.Message>Кроме. <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A></span><span class="sxs-lookup"><span data-stu-id="25e03-3117">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="25e03-3118">Если указать, например, метку или приоритет с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> члена, эти значения будут применяться к любому сообщению, содержащему объект, который не относится к типу <xref:System.Messaging.Message> , когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3118">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="25e03-3119">При отправке <xref:System.Messaging.Message>, значения свойств, заданные для <xref:System.Messaging.Message> параметра, имеют <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>приоритет над, а <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство сообщения имеет приоритет над <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойством очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3119">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="25e03-3120">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3120">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3121">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3121">Workgroup mode</span></span>|<span data-ttu-id="25e03-3122">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3122">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3123">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3123">Local computer</span></span>|<span data-ttu-id="25e03-3124">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3124">Yes</span></span>|  
|<span data-ttu-id="25e03-3125">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3125">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3126">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3126">Yes</span></span>|  
|<span data-ttu-id="25e03-3127">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3127">Remote computer</span></span>|<span data-ttu-id="25e03-3128">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3128">No</span></span>|  
|<span data-ttu-id="25e03-3129">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3129">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3130">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3130">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3131">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3131">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="25e03-3132">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3132">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction"><span data-ttu-id="25e03-3133">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3133">The Message Queuing application indicated an incorrect transaction usage.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="25e03-3134">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3134">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3135">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="25e03-3135">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="25e03-3136">- или -</span><span class="sxs-lookup"><span data-stu-id="25e03-3136">-or-</span></span> 
<span data-ttu-id="25e03-3137">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3137">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="25e03-3138">Добавляет разрешения в текущий набор.</span><span class="sxs-lookup"><span data-stu-id="25e03-3138">Adds permissions to the current set.</span></span> <span data-ttu-id="25e03-3139">Это позволяет контролировать, кто имеет права доступа к свойствам очереди и сообщениям в очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3139">This controls who has access rights to queue properties and messages in the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.AccessControlList -&gt; unit" Usage="messageQueue.SetPermissions dacl" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl"><span data-ttu-id="25e03-3140">Объект <see cref="T:System.Messaging.AccessControlList" />, содержащий не менее одного элемента управления доступом, в которых указаны доверенные лица и предоставляемые разрешения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3140">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span></span></param>
        <summary><span data-ttu-id="25e03-3141">Назначает права доступа к очереди на основе содержимого списка управления доступом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3141">Assigns access rights to the queue based on the contents of an access control list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3142">Используйте эту перегрузку, чтобы предоставить, отклонить или отозвать права с помощью коллекции записей управления доступом для указания сведений о доверенных лицах и разрешениях.</span><span class="sxs-lookup"><span data-stu-id="25e03-3142">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="25e03-3143">Это используется, например, для предоставления разрешений нескольким пользователям одновременно.</span><span class="sxs-lookup"><span data-stu-id="25e03-3143">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="25e03-3144">Доверенное лицо, указываемое при создании `ace` параметра, может быть отдельным пользователем, группой пользователей или компьютером.</span><span class="sxs-lookup"><span data-stu-id="25e03-3144">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="25e03-3145">Если доверенное лицо является отдельным, используйте формат `DOMAIN`. \\ `user`</span><span class="sxs-lookup"><span data-stu-id="25e03-3145">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="25e03-3146">Для доверенного лица можно указать ".", чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3146">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="25e03-3147">Разрешения, назначаемые с <xref:System.Messaging.MessageQueue.SetPermissions%2A> помощью добавления прав в существующий список.</span><span class="sxs-lookup"><span data-stu-id="25e03-3147">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="25e03-3148">По умолчанию создатель общей или частной очереди имеет полный доступ, а группа домена Everyone имеет разрешение на получение свойств очереди, получение разрешений и запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3148">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="25e03-3149">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>сведения о пользователе и разрешениях добавляются в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3149">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="25e03-3150">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> последовательно, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="25e03-3150">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="25e03-3151">Запрет <xref:System.Messaging.AccessControlEntry> на доступ — явно запрещает любые запрошенные права доступа к одному из доверенных лиц, перечисленных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="25e03-3151">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="25e03-3152">Один или несколько элементов, разрешенных <xref:System.Messaging.AccessControlEntry> доступом для доверенных лиц, указанных в маркере доступа потока, явным образом предоставляют все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3152">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="25e03-3153">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, но по-прежнему по крайней мере одно запрошенное право доступа, которое не было явно разрешено, в этом случае доступ неявно отклоняется.</span><span class="sxs-lookup"><span data-stu-id="25e03-3153">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="25e03-3154">При создании `dacl` параметра в <xref:System.Messaging.AccessControlList> коллекцию добавляются <xref:System.Messaging.AccessControlEntry> экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-3154">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="25e03-3155">При создании каждой записи контроля доступа можно указать общие или стандартные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3155">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="25e03-3156">Права на очередь могут быть любым сочетанием следующих прав:</span><span class="sxs-lookup"><span data-stu-id="25e03-3156">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="25e03-3157">Удаление</span><span class="sxs-lookup"><span data-stu-id="25e03-3157">Delete</span></span>  
  
-   <span data-ttu-id="25e03-3158">Чтение безопасности</span><span class="sxs-lookup"><span data-stu-id="25e03-3158">Read Security</span></span>  
  
-   <span data-ttu-id="25e03-3159">Безопасность записи</span><span class="sxs-lookup"><span data-stu-id="25e03-3159">Write Security</span></span>  
  
-   <span data-ttu-id="25e03-3160">Синхронизация</span><span class="sxs-lookup"><span data-stu-id="25e03-3160">Synchronize</span></span>  
  
-   <span data-ttu-id="25e03-3161">Изменение владельца</span><span class="sxs-lookup"><span data-stu-id="25e03-3161">Modify Owner</span></span>  
  
-   <span data-ttu-id="25e03-3162">Чтение</span><span class="sxs-lookup"><span data-stu-id="25e03-3162">Read</span></span>  
  
-   <span data-ttu-id="25e03-3163">Write</span><span class="sxs-lookup"><span data-stu-id="25e03-3163">Write</span></span>  
  
-   <span data-ttu-id="25e03-3164">Выполнение</span><span class="sxs-lookup"><span data-stu-id="25e03-3164">Execute</span></span>  
  
-   <span data-ttu-id="25e03-3165">Обязательно</span><span class="sxs-lookup"><span data-stu-id="25e03-3165">Required</span></span>  
  
-   <span data-ttu-id="25e03-3166">Все</span><span class="sxs-lookup"><span data-stu-id="25e03-3166">All</span></span>  
  
-   <span data-ttu-id="25e03-3167">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3167">None</span></span>  
  
 <span data-ttu-id="25e03-3168">Эти права представляют собой набор битовых флагов, которые можно комбинировать с помощью побитового оператора или.</span><span class="sxs-lookup"><span data-stu-id="25e03-3168">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="25e03-3169">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="25e03-3169">Full Control</span></span>  
  
-   <span data-ttu-id="25e03-3170">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="25e03-3170">Delete Message</span></span>  
  
-   <span data-ttu-id="25e03-3171">Получение сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3171">Receive Message</span></span>  
  
-   <span data-ttu-id="25e03-3172">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3172">Peek Message</span></span>  
  
-   <span data-ttu-id="25e03-3173">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-3173">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="25e03-3174">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3174">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3175">Задание свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3175">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3176">Получить разрешения</span><span class="sxs-lookup"><span data-stu-id="25e03-3176">Get Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3177">Настройка разрешений</span><span class="sxs-lookup"><span data-stu-id="25e03-3177">Set Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3178">Получить владение очередью</span><span class="sxs-lookup"><span data-stu-id="25e03-3178">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="25e03-3179">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3179">Write Message</span></span>  
  
 <span data-ttu-id="25e03-3180">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3180">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3181">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3181">Workgroup mode</span></span>|<span data-ttu-id="25e03-3182">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3182">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3183">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3183">Local computer</span></span>|<span data-ttu-id="25e03-3184">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3184">Yes</span></span>|  
|<span data-ttu-id="25e03-3185">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3185">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3186">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3186">Yes</span></span>|  
|<span data-ttu-id="25e03-3187">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3187">Remote computer</span></span>|<span data-ttu-id="25e03-3188">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3188">No</span></span>|  
|<span data-ttu-id="25e03-3189">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3189">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3190">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3190">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3191">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3191">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3192">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3192">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.MessageQueueAccessControlEntry -&gt; unit" Usage="messageQueue.SetPermissions ace" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace"><span data-ttu-id="25e03-3193">Объект <see cref="T:System.Messaging.MessageQueueAccessControlEntry" />, который указывает пользователя, тип доступа и тип разрешения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3193">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span></span></param>
        <summary><span data-ttu-id="25e03-3194">Назначает права доступа к очереди на основе содержимого элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="25e03-3194">Assigns access rights to the queue based on the contents of an access control entry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3195">Используйте эту перегрузку, чтобы предоставить, отклонить или отозвать права с помощью записи управления доступом для указания сведений о доверенных лицах и правах.</span><span class="sxs-lookup"><span data-stu-id="25e03-3195">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="25e03-3196">Доверенное лицо, указываемое при создании `ace` параметра, может быть отдельным пользователем, группой пользователей или компьютером.</span><span class="sxs-lookup"><span data-stu-id="25e03-3196">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="25e03-3197">Если доверенное лицо является отдельным, используйте формат `DOMAIN`. \\ `user`</span><span class="sxs-lookup"><span data-stu-id="25e03-3197">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="25e03-3198">Для доверенного лица можно указать ".", чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3198">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="25e03-3199">Разрешения, назначаемые с <xref:System.Messaging.MessageQueue.SetPermissions%2A> помощью добавления прав в существующий список.</span><span class="sxs-lookup"><span data-stu-id="25e03-3199">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="25e03-3200">По умолчанию создатель общей или частной очереди имеет полный доступ, а группа домена Everyone имеет разрешение на получение свойств очереди, получение разрешений и запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3200">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="25e03-3201">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>сведения о пользователе и разрешениях добавляются в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3201">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="25e03-3202">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> последовательно, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="25e03-3202">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="25e03-3203">Запрет <xref:System.Messaging.AccessControlEntry> на доступ — явно запрещает любые запрошенные права доступа к одному из доверенных лиц, перечисленных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="25e03-3203">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="25e03-3204">Один или несколько элементов, разрешенных <xref:System.Messaging.AccessControlEntry> доступом для доверенных лиц, указанных в маркере доступа потока, явным образом предоставляют все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3204">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="25e03-3205">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, но по-прежнему по крайней мере одно запрошенное право доступа, которое не было явно разрешено, в этом случае доступ неявно отклоняется.</span><span class="sxs-lookup"><span data-stu-id="25e03-3205">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="25e03-3206">Права на очередь, указываемые в `rights` параметре при <xref:System.Messaging.MessageQueueAccessControlEntry>создании, могут быть любым сочетанием следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="25e03-3206">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="25e03-3207">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="25e03-3207">Full Control</span></span>  
  
-   <span data-ttu-id="25e03-3208">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="25e03-3208">Delete Message</span></span>  
  
-   <span data-ttu-id="25e03-3209">Получение сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3209">Receive Message</span></span>  
  
-   <span data-ttu-id="25e03-3210">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3210">Peek Message</span></span>  
  
-   <span data-ttu-id="25e03-3211">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-3211">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="25e03-3212">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3212">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3213">Задание свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3213">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3214">Получить разрешения</span><span class="sxs-lookup"><span data-stu-id="25e03-3214">Get Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3215">Настройка разрешений</span><span class="sxs-lookup"><span data-stu-id="25e03-3215">Set Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3216">Получить владение очередью</span><span class="sxs-lookup"><span data-stu-id="25e03-3216">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="25e03-3217">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3217">Write Message</span></span>  
  
 <span data-ttu-id="25e03-3218">Параметр, заданный в конструкторе `ace` для параметра <xref:System.Messaging.MessageQueueAccessRights> , является флагом перечисления. `rights`</span><span class="sxs-lookup"><span data-stu-id="25e03-3218">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="25e03-3219">Он представляет набор битовых флагов, которые можно комбинировать с помощью побитового оператора или при построении `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-3219">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="25e03-3220">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3220">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3221">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3221">Workgroup mode</span></span>|<span data-ttu-id="25e03-3222">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3222">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3223">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3223">Local computer</span></span>|<span data-ttu-id="25e03-3224">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3224">Yes</span></span>|  
|<span data-ttu-id="25e03-3225">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3225">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3226">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3226">Yes</span></span>|  
|<span data-ttu-id="25e03-3227">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3227">Remote computer</span></span>|<span data-ttu-id="25e03-3228">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3228">No</span></span>|  
|<span data-ttu-id="25e03-3229">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3229">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3230">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3230">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3231">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3231">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3232">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3232">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights -&gt; unit" Usage="messageQueue.SetPermissions (user, rights)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="25e03-3233">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-3233">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="25e03-3234">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который показывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <paramref name="user" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3234">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <summary><span data-ttu-id="25e03-3235">Предоставляет компьютеру, группе или пользователю указанные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3235">Gives a computer, group, or user the specified access rights.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3236">Используйте эту перегрузку для предоставления указанных прав отдельному пользователю.</span><span class="sxs-lookup"><span data-stu-id="25e03-3236">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="25e03-3237">Пользователь может быть любым допустимым доверенным лицом, включая отдельных пользователей, группы пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3237">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="25e03-3238">Если пользователь является `DOMAIN` отдельным, используйте формат \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-3238">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="25e03-3239">Можно указать "." для `user` параметра, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3239">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="25e03-3240">Разрешения, назначаемые с <xref:System.Messaging.MessageQueue.SetPermissions%2A> помощью добавления прав в существующий список.</span><span class="sxs-lookup"><span data-stu-id="25e03-3240">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="25e03-3241">По умолчанию создатель общей или частной очереди имеет полный доступ, а группа домена Everyone имеет разрешение на получение свойств очереди, получение разрешений и запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3241">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="25e03-3242">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>сведения о пользователе и разрешениях добавляются в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3242">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="25e03-3243">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> последовательно, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="25e03-3243">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="25e03-3244">Запрет <xref:System.Messaging.AccessControlEntry> на доступ — явно запрещает любые запрошенные права доступа к одному из доверенных лиц, перечисленных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="25e03-3244">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="25e03-3245">Один или несколько элементов, разрешенных <xref:System.Messaging.AccessControlEntry> доступом для доверенных лиц, указанных в маркере доступа потока, явным образом предоставляют все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3245">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="25e03-3246">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, но по-прежнему по крайней мере одно запрошенное право доступа, которое не было явно разрешено, в этом случае доступ неявно отклоняется.</span><span class="sxs-lookup"><span data-stu-id="25e03-3246">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="25e03-3247">Права на очередь, указанную в `rights` параметре, могут быть любым сочетанием следующих параметров:</span><span class="sxs-lookup"><span data-stu-id="25e03-3247">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="25e03-3248">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="25e03-3248">Full Control</span></span>  
  
-   <span data-ttu-id="25e03-3249">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="25e03-3249">Delete Message</span></span>  
  
-   <span data-ttu-id="25e03-3250">Получение сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3250">Receive Message</span></span>  
  
-   <span data-ttu-id="25e03-3251">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3251">Peek Message</span></span>  
  
-   <span data-ttu-id="25e03-3252">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-3252">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="25e03-3253">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3253">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3254">Задание свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3254">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3255">Получить разрешения</span><span class="sxs-lookup"><span data-stu-id="25e03-3255">Get Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3256">Настройка разрешений</span><span class="sxs-lookup"><span data-stu-id="25e03-3256">Set Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3257">Получить владение очередью</span><span class="sxs-lookup"><span data-stu-id="25e03-3257">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="25e03-3258">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3258">Write Message</span></span>  
  
 <span data-ttu-id="25e03-3259">Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью побитового оператора или `rights` для создания параметра. <xref:System.Messaging.MessageQueueAccessRights></span><span class="sxs-lookup"><span data-stu-id="25e03-3259">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="25e03-3260">Эта перегрузка позволяет предоставлять только разрешения. Вы не можете отозвать или отклонить их.</span><span class="sxs-lookup"><span data-stu-id="25e03-3260">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="25e03-3261">Необходимо использовать другую перегрузку, чтобы явно предоставить <xref:System.Messaging.AccessControlEntryType> любой `Allow`из них.</span><span class="sxs-lookup"><span data-stu-id="25e03-3261">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="25e03-3262">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3262">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3263">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3263">Workgroup mode</span></span>|<span data-ttu-id="25e03-3264">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3264">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3265">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3265">Local computer</span></span>|<span data-ttu-id="25e03-3266">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3266">Yes</span></span>|  
|<span data-ttu-id="25e03-3267">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3267">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3268">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3268">Yes</span></span>|  
|<span data-ttu-id="25e03-3269">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3269">Remote computer</span></span>|<span data-ttu-id="25e03-3270">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3270">No</span></span>|  
|<span data-ttu-id="25e03-3271">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3271">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3272">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3272">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3273">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3273">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="25e03-3274">Значение параметра <paramref name="user" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3274">The <paramref name="user" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3275">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3275">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights * System.Messaging.AccessControlEntryType -&gt; unit" Usage="messageQueue.SetPermissions (user, rights, entryType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="25e03-3276">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="25e03-3276">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="25e03-3277">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который показывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <paramref name="user" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3277">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <param name="entryType"><span data-ttu-id="25e03-3278">Объект <see cref="T:System.Messaging.AccessControlEntryType" />, который указывает, нужно ли предоставить разрешения, отказать в предоставлении разрешений или отозвать разрешения, задаваемые параметром <paramref name="rights" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3278">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <paramref name="rights" /> parameter.</span></span></param>
        <summary><span data-ttu-id="25e03-3279">Предоставляет компьютеру, группе или пользователю указанные права доступа указанного типа управления доступом (разрешить, отказать, отозвать или задать).</span><span class="sxs-lookup"><span data-stu-id="25e03-3279">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3280">Используйте эту перегрузку для предоставления, запрета или отзыва указанных прав для отдельного пользователя.</span><span class="sxs-lookup"><span data-stu-id="25e03-3280">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="25e03-3281">Пользователь может быть любым допустимым доверенным лицом, включая отдельных пользователей, группы пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3281">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="25e03-3282">Если пользователь является `DOMAIN` отдельным, используйте формат \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="25e03-3282">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="25e03-3283">Можно указать "." для `user` параметра, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25e03-3283">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="25e03-3284">Разрешения, назначаемые с <xref:System.Messaging.MessageQueue.SetPermissions%2A> помощью добавления прав в существующий список.</span><span class="sxs-lookup"><span data-stu-id="25e03-3284">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="25e03-3285">По умолчанию создатель общей или частной очереди имеет полный доступ, а группа домена Everyone имеет разрешение на получение свойств очереди, получение разрешений и запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3285">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="25e03-3286">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>сведения о пользователе и разрешениях добавляются в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3286">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="25e03-3287">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> последовательно, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="25e03-3287">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="25e03-3288">Запрет <xref:System.Messaging.AccessControlEntry> на доступ — явно запрещает любые запрошенные права доступа к одному из доверенных лиц, перечисленных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="25e03-3288">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="25e03-3289">Один или несколько элементов, разрешенных <xref:System.Messaging.AccessControlEntry> доступом для доверенных лиц, указанных в маркере доступа потока, явным образом предоставляют все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="25e03-3289">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="25e03-3290">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, но по-прежнему по крайней мере одно запрошенное право доступа, которое не было явно разрешено, в этом случае доступ неявно отклоняется.</span><span class="sxs-lookup"><span data-stu-id="25e03-3290">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="25e03-3291">Права на очередь, указанную в `rights` параметре, могут быть любым сочетанием следующих параметров:</span><span class="sxs-lookup"><span data-stu-id="25e03-3291">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="25e03-3292">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="25e03-3292">Full Control</span></span>  
  
-   <span data-ttu-id="25e03-3293">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="25e03-3293">Delete Message</span></span>  
  
-   <span data-ttu-id="25e03-3294">Получение сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3294">Receive Message</span></span>  
  
-   <span data-ttu-id="25e03-3295">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3295">Peek Message</span></span>  
  
-   <span data-ttu-id="25e03-3296">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="25e03-3296">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="25e03-3297">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3297">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3298">Задание свойств очереди</span><span class="sxs-lookup"><span data-stu-id="25e03-3298">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="25e03-3299">Получить разрешения</span><span class="sxs-lookup"><span data-stu-id="25e03-3299">Get Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3300">Настройка разрешений</span><span class="sxs-lookup"><span data-stu-id="25e03-3300">Set Permissions</span></span>  
  
-   <span data-ttu-id="25e03-3301">Получить владение очередью</span><span class="sxs-lookup"><span data-stu-id="25e03-3301">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="25e03-3302">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="25e03-3302">Write Message</span></span>  
  
 <span data-ttu-id="25e03-3303">Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью побитового оператора или `rights` для создания параметра. <xref:System.Messaging.MessageQueueAccessRights></span><span class="sxs-lookup"><span data-stu-id="25e03-3303">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="25e03-3304">В следующей таблице показано, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3304">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3305">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3305">Workgroup mode</span></span>|<span data-ttu-id="25e03-3306">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3306">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3307">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3307">Local computer</span></span>|<span data-ttu-id="25e03-3308">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3308">Yes</span></span>|  
|<span data-ttu-id="25e03-3309">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3309">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3310">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3310">Yes</span></span>|  
|<span data-ttu-id="25e03-3311">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3311">Remote computer</span></span>|<span data-ttu-id="25e03-3312">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3312">No</span></span>|  
|<span data-ttu-id="25e03-3313">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3313">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3314">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3314">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3315">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3315">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3316">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3316">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-3317">Получает или задает объект, который используется для маршалинга вызовов обработчика событий, возникающих в результате наступления события <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или события <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3317">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span></summary>
        <value><span data-ttu-id="25e03-3318">Объект <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, представляющий объект, который выполняет маршалинг вызова обработчика событий, причиной которого стало событие <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3318">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span> <span data-ttu-id="25e03-3319">Значение по умолчанию — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3319">The default is <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3320"><xref:System.Messaging.MessageQueue.BeginReceive%2A> <xref:System.Messaging.MessageQueue.BeginPeek%2A> Событие <xref:System.Messaging.MessageQueue.ReceiveCompleted> или<xref:System.Messaging.MessageQueue.PeekCompleted> вызывается из запроса или соответственно конкретному потоку.</span><span class="sxs-lookup"><span data-stu-id="25e03-3320">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="25e03-3321">Как правило, <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> параметр задается, когда связанный компонент помещается внутрь элемента управления или формы, поскольку эти компоненты привязаны к определенному потоку.</span><span class="sxs-lookup"><span data-stu-id="25e03-3321">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="25e03-3322">Как правило, синхронизирующий объект маршалирует вызов метода в один поток.</span><span class="sxs-lookup"><span data-stu-id="25e03-3322">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.Transactional : bool" Usage="System.Messaging.MessageQueue.Transactional" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-3323">Получает значение, указывающее, принимает ли очередь только транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3323">Gets a value that indicates whether the queue accepts only transactions.</span></span></summary>
        <value><span data-ttu-id="25e03-3324">Значение <see langword="true" />, если очередь принимает только сообщения, отправляемые как часть транзакции; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3324"><see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3325">Транзакционная система обмена сообщениями относится к взаимосвязанию нескольких связанных сообщений с одной транзакцией.</span><span class="sxs-lookup"><span data-stu-id="25e03-3325">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="25e03-3326">Отправка сообщений в рамках транзакции гарантирует, что сообщения доставляются по порядку, доставляются только один раз и успешно извлекаются из очереди назначения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3326">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="25e03-3327">Если очередь является транзакционной, она принимает только сообщения, которые отправляются как часть транзакции.</span><span class="sxs-lookup"><span data-stu-id="25e03-3327">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="25e03-3328">Тем не менее, нетранзакционное сообщение может быть отправлено или получено из локальной очереди транзакций без явного использования транзакционного <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>и <xref:System.Messaging.MessageQueueTransaction.Abort%2A> синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="25e03-3328">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="25e03-3329">Если нетранзакционное сообщение отправляется в транзакционную очередь, этот компонент создает для него транзакцию с одним сообщением, за исключением случая, когда в случае ссылки на очередь на удаленном компьютере используется прямое имя формата.</span><span class="sxs-lookup"><span data-stu-id="25e03-3329">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="25e03-3330">В этом случае, если не указать контекст транзакции при отправке сообщения, одно из них не создается и сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3330">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="25e03-3331">При отправке нетранзакционного сообщения в транзакционную очередь вы не сможете выполнить откат сообщения в случае возникновения исключения.</span><span class="sxs-lookup"><span data-stu-id="25e03-3331">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="25e03-3332"><xref:System.Messaging.MessageQueueTransaction>учитывает потоковое подразделение, поэтому, если состояние апартамента `STA`—, нельзя использовать транзакцию в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="25e03-3332"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="25e03-3333">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо <xref:System.MTAThreadAttribute> применить в `Main` подподпрограмме.</span><span class="sxs-lookup"><span data-stu-id="25e03-3333">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="25e03-3334">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="25e03-3334">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="25e03-3335">Для <xref:System.MTAThreadAttribute> применения используется следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="25e03-3335">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="25e03-3336">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3336">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3337">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3337">Workgroup mode</span></span>|<span data-ttu-id="25e03-3338">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3338">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3339">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3339">Local computer</span></span>|<span data-ttu-id="25e03-3340">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3340">Yes</span></span>|  
|<span data-ttu-id="25e03-3341">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3341">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3342">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3342">Yes</span></span>|  
|<span data-ttu-id="25e03-3343">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3343">Remote computer</span></span>|<span data-ttu-id="25e03-3344">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3344">No</span></span>|  
|<span data-ttu-id="25e03-3345">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3345">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3346">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3346">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3347">В следующем примере кода выводится значение <xref:System.Messaging.MessageQueue.Transactional%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3347">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3348">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3348">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.UseJournalQueue : bool with get, set" Usage="System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_UseJournalQueue")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-3349">Получает или задает значение, указывающее, должны ли полученные сообщения копироваться в очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="25e03-3349">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span></span></summary>
        <value><span data-ttu-id="25e03-3350">Значение <see langword="true" />, если сообщения, полученные из очереди, копируются в очередь журнала; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="25e03-3350"><see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3351">Когда приложение очереди сообщений создает новую очередь приложений, оно автоматически создает связанную очередь журнала в том же расположении.</span><span class="sxs-lookup"><span data-stu-id="25e03-3351">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="25e03-3352">Очередь журнала используется для наблюдения за сообщениями, удаленными из очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3352">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="25e03-3353">Задание этого свойства изменяет очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3353">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="25e03-3354">В связи с этим <xref:System.Messaging.MessageQueue> изменение затрагивает любые другие экземпляры.</span><span class="sxs-lookup"><span data-stu-id="25e03-3354">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="25e03-3355">Очередь журнала не следит за сообщениями, удаленными из очереди, так как срок их действия истек, а также сообщения, удаленные из очереди, с помощью службы каталогов очереди сообщений (хранилище данных или Active Directory).</span><span class="sxs-lookup"><span data-stu-id="25e03-3355">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="25e03-3356">Приложения не могут передавать сообщения в очереди журнала; они ограничены доступом только для чтения к этим очередям.</span><span class="sxs-lookup"><span data-stu-id="25e03-3356">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="25e03-3357">Более того, очередь сообщений никогда не удаляет сообщения из очередей журнала.</span><span class="sxs-lookup"><span data-stu-id="25e03-3357">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="25e03-3358">Приложение, использующее очередь, должно очищать эти сообщения либо путем их получения, либо путем очистки очереди.</span><span class="sxs-lookup"><span data-stu-id="25e03-3358">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="25e03-3359">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3359">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3360">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3360">Workgroup mode</span></span>|<span data-ttu-id="25e03-3361">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3361">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3362">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3362">Local computer</span></span>|<span data-ttu-id="25e03-3363">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3363">Yes</span></span>|  
|<span data-ttu-id="25e03-3364">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3364">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3365">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3365">Yes</span></span>|  
|<span data-ttu-id="25e03-3366">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3366">Remote computer</span></span>|<span data-ttu-id="25e03-3367">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3367">No</span></span>|  
|<span data-ttu-id="25e03-3368">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3368">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3369">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3369">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="25e03-3370">В следующем примере кода получается и задается значение <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойства очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3370">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3371">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="25e03-3371">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.WriteHandle : nativeint" Usage="System.Messaging.MessageQueue.WriteHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="25e03-3372">Получает собственный дескриптор, который используется для отправки сообщений в очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="25e03-3372">Gets the native handle used to send messages to the message queue.</span></span></summary>
        <value><span data-ttu-id="25e03-3373">Дескриптор собственного объекта очереди, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3373">A handle to the native queue object that you use for sending messages to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="25e03-3374"><xref:System.Messaging.MessageQueue.WriteHandle%2A> Предоставляет собственный обработчик Windows для объекта очереди сообщений, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="25e03-3374">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="25e03-3375">При изменении пути к очереди маркер закрывается и повторно открывается с новым значением.</span><span class="sxs-lookup"><span data-stu-id="25e03-3375">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="25e03-3376">В следующей таблице показано, доступно ли это свойство в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="25e03-3376">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="25e03-3377">Режим рабочей группы</span><span class="sxs-lookup"><span data-stu-id="25e03-3377">Workgroup mode</span></span>|<span data-ttu-id="25e03-3378">Доступно</span><span class="sxs-lookup"><span data-stu-id="25e03-3378">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="25e03-3379">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3379">Local computer</span></span>|<span data-ttu-id="25e03-3380">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3380">Yes</span></span>|  
|<span data-ttu-id="25e03-3381">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3381">Local computer and direct format name</span></span>|<span data-ttu-id="25e03-3382">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3382">Yes</span></span>|  
|<span data-ttu-id="25e03-3383">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="25e03-3383">Remote computer</span></span>|<span data-ttu-id="25e03-3384">Нет</span><span class="sxs-lookup"><span data-stu-id="25e03-3384">No</span></span>|  
|<span data-ttu-id="25e03-3385">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="25e03-3385">Remote computer and direct format name</span></span>|<span data-ttu-id="25e03-3386">Да</span><span class="sxs-lookup"><span data-stu-id="25e03-3386">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="25e03-3387">Очередь сообщений недоступна для записи.</span><span class="sxs-lookup"><span data-stu-id="25e03-3387">The message queue is not available for writing.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>
