<Type Name="IEnlistmentNotification" FullName="System.Transactions.IEnlistmentNotification">
  <Metadata><Meta Name="ms.openlocfilehash" Value="ad3f85798879110148c23a99abd0f7dfebd2e9c4" /><Meta Name="ms.sourcegitcommit" Value="8ae9a18b248625c8e1851e607c00346a64849587" /><Meta Name="ms.translationtype" Value="HT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="12/17/2019" /><Meta Name="ms.locfileid" Value="75158378" /></Metadata><TypeSignature Language="C#" Value="public interface IEnlistmentNotification" />
  <TypeSignature Language="ILAsm" Value=".class public interface auto ansi abstract IEnlistmentNotification" />
  <TypeSignature Language="DocId" Value="T:System.Transactions.IEnlistmentNotification" />
  <TypeSignature Language="VB.NET" Value="Public Interface IEnlistmentNotification" />
  <TypeSignature Language="C++ CLI" Value="public interface class IEnlistmentNotification" />
  <TypeSignature Language="F#" Value="type IEnlistmentNotification = interface" />
  <AssemblyInfo>
    <AssemblyName>System.Transactions</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.1.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Transactions.Local</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.1.0</AssemblyVersion>
    <AssemblyVersion>4.0.2.0</AssemblyVersion>
  </AssemblyInfo>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="a78a9-101">Описывает интерфейс, который должен реализовать диспетчер ресурсов, чтобы предоставить обратные вызовы уведомлений о двухфазной фиксации диспетчеру транзакций при внесении в список для участия.</span><span class="sxs-lookup"><span data-stu-id="a78a9-101">Describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a78a9-102">Чтобы диспетчер ресурсов мог участвовать в транзакции, он должен быть прикреплен к транзакции через диспетчер транзакций.</span><span class="sxs-lookup"><span data-stu-id="a78a9-102">In order for a resource manager to participate in a transaction, it must enlist in the transaction through the transaction manager.</span></span> <span data-ttu-id="a78a9-103">Класс <xref:System.Transactions.Transaction> определяет набор методов, имена которых начинаются с `Enlist`, обеспечивающий данную функциональную возможность.</span><span class="sxs-lookup"><span data-stu-id="a78a9-103">The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with `Enlist` that provide this functionality.</span></span> <span data-ttu-id="a78a9-104">Различные методы `Enlist` соответствуют различным типам зачисления, которые могут использоваться диспетчером ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-104">The different `Enlist` methods correspond to the different types of enlistment that a resource manager may have.</span></span>  
  
 <span data-ttu-id="a78a9-105">Этот класс описывает интерфейс, который должен быть реализован диспетчером ресурсов, чтобы обеспечить два обратных вызова уведомлений о фиксации для диспетчера транзакций после прикрепления к участию.</span><span class="sxs-lookup"><span data-stu-id="a78a9-105">This class describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.</span></span> <span data-ttu-id="a78a9-106">Для реализации интерфейса <xref:System.Transactions.IEnlistmentNotification> для каждого диспетчера ресурсов необходимо прикрепить его с помощью метода <xref:System.Transactions.Transaction.EnlistVolatile%2A> или метода <xref:System.Transactions.Transaction.EnlistDurable%2A> класса <xref:System.Transactions.Transaction> в зависимости от того, является ли ресурс энергозависимым или устойчивым.</span><span class="sxs-lookup"><span data-stu-id="a78a9-106">For each resource manager's implementation of the <xref:System.Transactions.IEnlistmentNotification> interface, you should enlist it using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method or the <xref:System.Transactions.Transaction.EnlistDurable%2A> method of the <xref:System.Transactions.Transaction> class, depending on whether your resource is volatile or durable.</span></span> <span data-ttu-id="a78a9-107">Дополнительные сведения о зачислении и 2PC см. в разделе [прикрепление ресурсов в качестве участников транзакции](~/docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md) и [фиксация транзакции в рамках одной фазы и многоэтапной](~/docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) передачи соответственно.</span><span class="sxs-lookup"><span data-stu-id="a78a9-107">For more information on enlistment and 2PC, see [Enlisting Resources as Participants in a Transaction](~/docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md) and [Committing a Transaction in Single-Phase and Multi-Phase](~/docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) respectively.</span></span>  
  
 <span data-ttu-id="a78a9-108">Диспетчер транзакций уведомляет прикрепленный объект на разных этапах протокола фиксации двух фаз следующими методами.</span><span class="sxs-lookup"><span data-stu-id="a78a9-108">The transaction manager notifies the enlisted object at different phases of the Two Phase Commit Protocol by the following methods.</span></span>  
  
|<span data-ttu-id="a78a9-109">Метод</span><span class="sxs-lookup"><span data-stu-id="a78a9-109">Method</span></span>|<span data-ttu-id="a78a9-110">Описание</span><span class="sxs-lookup"><span data-stu-id="a78a9-110">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Transactions.IEnlistmentNotification.Prepare%2A>|<span data-ttu-id="a78a9-111">Этот метод прикрепленного объекта используется диспетчером транзакций в качестве обратного вызова во время первого этапа транзакции, когда диспетчер транзакций запрашивает у участников возможность зафиксировать транзакцию.</span><span class="sxs-lookup"><span data-stu-id="a78a9-111">This method of an enlisted object is used as a callback by the Transaction Manager during the first phase of a transaction, when the transaction manager asks participants whether they can commit the transaction.</span></span>|  
|<xref:System.Transactions.IEnlistmentNotification.Commit%2A>|<span data-ttu-id="a78a9-112">Этот метод прикрепленного объекта используется диспетчером транзакций в качестве обратного вызова во время второй фазы транзакции, если транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="a78a9-112">This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is committed.</span></span>|  
|<xref:System.Transactions.IEnlistmentNotification.Rollback%2A>|<span data-ttu-id="a78a9-113">Этот метод прикрепленного объекта используется диспетчером транзакций в качестве обратного вызова во время второй фазы транзакции, если транзакция прервана (т. е. выполняется откат).</span><span class="sxs-lookup"><span data-stu-id="a78a9-113">This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is aborted (that is, rolled back).</span></span>|  
|<xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>|<span data-ttu-id="a78a9-114">Этот метод прикрепленного объекта используется диспетчером транзакций в качестве обратного вызова во время второй фазы транзакции, если транзакция сомнительна.</span><span class="sxs-lookup"><span data-stu-id="a78a9-114">This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is in doubt.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="a78a9-115">Следует иметь в виду, что уведомления могут не отправляться последовательно или в определенном порядке.</span><span class="sxs-lookup"><span data-stu-id="a78a9-115">You should be aware that notifications might not be sent sequentially, or in a particular order.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a78a9-116">В следующем примере показана реализация этого интерфейса, а также прикрепление объекта в качестве участника транзакции с помощью метода <xref:System.Transactions.Transaction.EnlistVolatile%2A>.</span><span class="sxs-lookup"><span data-stu-id="a78a9-116">The following example shows an implementation of this interface, as well as enlisting the object as a participant in a transaction using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method.</span></span>  
  
 [!code-csharp[Tx_Enlist#1](~/samples/snippets/csharp/VS_Snippets_CFX/tx_enlist/cs/enlist.cs#1)]
 [!code-vb[Tx_Enlist#1](~/samples/snippets/visualbasic/VS_Snippets_CFX/tx_enlist/vb/enlist.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Transactions.ISinglePhaseNotification" />
    <related type="Article" href="https://msdn.microsoft.com/library/786a12c2-d530-49f4-9c59-5c973e15a11d"><span data-ttu-id="a78a9-117">Зачисление ресурсов в транзакцию в качестве участников</span><span class="sxs-lookup"><span data-stu-id="a78a9-117">Enlisting Resources as Participants in a Transaction</span></span></related>
    <related type="Article" href="https://msdn.microsoft.com/library/694ea153-e4db-41ae-96ac-9ac66dcb69a9"><span data-ttu-id="a78a9-118">Однофазная и многофазная фиксация транзакции</span><span class="sxs-lookup"><span data-stu-id="a78a9-118">Committing a Transaction in Single-Phase and Multi-Phase</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="Commit">
      <MemberSignature Language="C#" Value="public void Commit (System.Transactions.Enlistment enlistment);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void Commit(class System.Transactions.Enlistment enlistment) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Transactions.IEnlistmentNotification.Commit(System.Transactions.Enlistment)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Commit(System::Transactions::Enlistment ^ enlistment);" />
      <MemberSignature Language="F#" Value="abstract member Commit : System.Transactions.Enlistment -&gt; unit" Usage="iEnlistmentNotification.Commit enlistment" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Transactions</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Transactions.Local</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.2.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="enlistment" Type="System.Transactions.Enlistment" />
      </Parameters>
      <Docs>
        <param name="enlistment"><span data-ttu-id="a78a9-119">Объект <see cref="T:System.Transactions.Enlistment" />, используемый для передачи ответа диспетчеру транзакций.</span><span class="sxs-lookup"><span data-stu-id="a78a9-119">An <see cref="T:System.Transactions.Enlistment" /> object used to send a response to the transaction manager.</span></span></param>
        <summary><span data-ttu-id="a78a9-120">Уведомляет включенный в список объект о том, что транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="a78a9-120">Notifies an enlisted object that a transaction is being committed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a78a9-121">Диспетчер транзакций вызывает этот метод прикрепленного объекта на втором этапе обязательства, когда он указывает всем участникам зафиксировать транзакцию.</span><span class="sxs-lookup"><span data-stu-id="a78a9-121">The transaction manager calls this method of an enlisted object during the second phase of a commitment, when it instructs all participants to commit the transaction.</span></span>  
  
 <span data-ttu-id="a78a9-122">Диспетчер ресурсов должен выполнить все действия, необходимые для завершения транзакции, а затем сообщить диспетчеру транзакций о завершении, вызвав метод <xref:System.Transactions.Enlistment.Done%2A> для параметра `enlistment`.</span><span class="sxs-lookup"><span data-stu-id="a78a9-122">The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.</span></span>  
  
 <span data-ttu-id="a78a9-123">Если диспетчер ресурсов прикрепляет надежно, но не отвечает, вызывая метод <xref:System.Transactions.Enlistment.Done%2A>, диспетчер транзакций не гарантирует, что диспетчер ресурсов получил вызов <xref:System.Transactions.IEnlistmentNotification.Commit%2A>.</span><span class="sxs-lookup"><span data-stu-id="a78a9-123">If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the <xref:System.Transactions.IEnlistmentNotification.Commit%2A> call.</span></span> <span data-ttu-id="a78a9-124">Таким образом диспетчер транзакций продолжает ожидание ответа и сохраняет сведения, относящиеся к этой транзакции.</span><span class="sxs-lookup"><span data-stu-id="a78a9-124">As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.</span></span>  <span data-ttu-id="a78a9-125">Если <xref:System.Transactions.Enlistment.Done%2A> никогда не вызывается, этот фрагмент информации хранится в неопределенном объеме памяти или в ресурсе на уровне системы.</span><span class="sxs-lookup"><span data-stu-id="a78a9-125">If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.</span></span> <span data-ttu-id="a78a9-126">Это приводит к невозможности освобождения ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-126">This results in resources not being able to be reclaimed.</span></span> <span data-ttu-id="a78a9-127">В случае распределенной транзакции это может в конечном итоге заполнить журнал MSDTC, который останавливает процесс MSDTC.</span><span class="sxs-lookup"><span data-stu-id="a78a9-127">In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.</span></span> <span data-ttu-id="a78a9-128">В случае транзакции, управляемой <xref:System.Transactions>, это приводит к постепенному и непрерывному увеличению потребления памяти процессом диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-128">In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process.</span></span> <span data-ttu-id="a78a9-129">Поэтому важно вызвать метод <xref:System.Transactions.Enlistment.Done%2A> после того, как диспетчер ресурсов завершит свою работу.</span><span class="sxs-lookup"><span data-stu-id="a78a9-129">Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="InDoubt">
      <MemberSignature Language="C#" Value="public void InDoubt (System.Transactions.Enlistment enlistment);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void InDoubt(class System.Transactions.Enlistment enlistment) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Transactions.IEnlistmentNotification.InDoubt(System.Transactions.Enlistment)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void InDoubt(System::Transactions::Enlistment ^ enlistment);" />
      <MemberSignature Language="F#" Value="abstract member InDoubt : System.Transactions.Enlistment -&gt; unit" Usage="iEnlistmentNotification.InDoubt enlistment" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Transactions</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Transactions.Local</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.2.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="enlistment" Type="System.Transactions.Enlistment" />
      </Parameters>
      <Docs>
        <param name="enlistment"><span data-ttu-id="a78a9-130">Объект <see cref="T:System.Transactions.Enlistment" />, используемый для передачи ответа диспетчеру транзакций.</span><span class="sxs-lookup"><span data-stu-id="a78a9-130">An <see cref="T:System.Transactions.Enlistment" /> object used to send a response to the transaction manager.</span></span></param>
        <summary><span data-ttu-id="a78a9-131">Уведомляет включенный в список объект о сомнительном состоянии транзакции.</span><span class="sxs-lookup"><span data-stu-id="a78a9-131">Notifies an enlisted object that the status of a transaction is in doubt.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a78a9-132">Этот метод вызывается для временных ресурсов, когда диспетчер транзакций вызвал однофазную операцию фиксации в одном устойчивом ресурсе, а затем соединение с устойчивым ресурсом было потеряно до получения результата транзакции.</span><span class="sxs-lookup"><span data-stu-id="a78a9-132">This method is called for volatile resources when the transaction manager has invoked a single phase commit operation to a single durable resource, and then connection to the durable resource was lost prior to getting the transaction result.</span></span> <span data-ttu-id="a78a9-133">На этом этапе результат транзакции не может быть определен безопасно.</span><span class="sxs-lookup"><span data-stu-id="a78a9-133">At that point, the transaction outcome cannot be safely determined.</span></span>  
  
 <span data-ttu-id="a78a9-134">Поскольку <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A> считается окончательным состоянием транзакции, не следует вызывать метод <xref:System.Transactions.IEnlistmentNotification.Commit%2A> или <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> после вызова <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>.</span><span class="sxs-lookup"><span data-stu-id="a78a9-134">As <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A> is considered to be a final state for a transaction, you should not call <xref:System.Transactions.IEnlistmentNotification.Commit%2A> or <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> after calling <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a78a9-135">Реализация этого метода для временного ресурса должна выполнять любые операции восстановления или включения, которые он понимает на затронутых данных.</span><span class="sxs-lookup"><span data-stu-id="a78a9-135">Your implementation of this method for the volatile resource should perform whatever recovery or containment operation it understands on the affected data.</span></span>  <span data-ttu-id="a78a9-136">Он также должен вызвать метод <xref:System.Transactions.Enlistment.Done%2A> для параметра `enlistment`, когда он завершит свою работу.</span><span class="sxs-lookup"><span data-stu-id="a78a9-136">It must also call the <xref:System.Transactions.Enlistment.Done%2A> method on the on the `enlistment` parameter when it has finished its work.</span></span>  
  
 <span data-ttu-id="a78a9-137">Если диспетчер ресурсов прикрепляет надежно, но не отвечает, вызывая метод <xref:System.Transactions.Enlistment.Done%2A>, диспетчер транзакций не гарантирует, что диспетчер ресурсов получил вызов <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>.</span><span class="sxs-lookup"><span data-stu-id="a78a9-137">If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the <xref:System.Transactions.IEnlistmentNotification.InDoubt%2A> call.</span></span> <span data-ttu-id="a78a9-138">Таким образом диспетчер транзакций продолжает ожидание ответа и сохраняет сведения, относящиеся к этой транзакции.</span><span class="sxs-lookup"><span data-stu-id="a78a9-138">As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.</span></span>  <span data-ttu-id="a78a9-139">Если <xref:System.Transactions.Enlistment.Done%2A> никогда не вызывается, этот фрагмент информации хранится в неопределенном объеме памяти или в ресурсе на уровне системы.</span><span class="sxs-lookup"><span data-stu-id="a78a9-139">If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.</span></span> <span data-ttu-id="a78a9-140">Это приводит к невозможности освобождения ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-140">This results in resources not being able to be reclaimed.</span></span> <span data-ttu-id="a78a9-141">В случае распределенной транзакции это может в конечном итоге заполнить журнал MSDTC, который останавливает процесс MSDTC.</span><span class="sxs-lookup"><span data-stu-id="a78a9-141">In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.</span></span> <span data-ttu-id="a78a9-142">В случае транзакции, управляемой <xref:System.Transactions>, это приводит к постепенному и непрерывному увеличению потребления памяти процессом диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-142">In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process.</span></span> <span data-ttu-id="a78a9-143">Поэтому важно вызвать метод <xref:System.Transactions.Enlistment.Done%2A> после того, как диспетчер ресурсов завершит свою работу.</span><span class="sxs-lookup"><span data-stu-id="a78a9-143">Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Prepare">
      <MemberSignature Language="C#" Value="public void Prepare (System.Transactions.PreparingEnlistment preparingEnlistment);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void Prepare(class System.Transactions.PreparingEnlistment preparingEnlistment) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Transactions.IEnlistmentNotification.Prepare(System.Transactions.PreparingEnlistment)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Prepare(System::Transactions::PreparingEnlistment ^ preparingEnlistment);" />
      <MemberSignature Language="F#" Value="abstract member Prepare : System.Transactions.PreparingEnlistment -&gt; unit" Usage="iEnlistmentNotification.Prepare preparingEnlistment" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Transactions</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Transactions.Local</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.2.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="preparingEnlistment" Type="System.Transactions.PreparingEnlistment" />
      </Parameters>
      <Docs>
        <param name="preparingEnlistment"><span data-ttu-id="a78a9-144">Объект <see cref="T:System.Transactions.PreparingEnlistment" />, используемый для передачи ответа диспетчеру транзакций.</span><span class="sxs-lookup"><span data-stu-id="a78a9-144">A <see cref="T:System.Transactions.PreparingEnlistment" /> object used to send a response to the transaction manager.</span></span></param>
        <summary><span data-ttu-id="a78a9-145">Уведомляет включенный в список объект о том, что транзакция подготавливается для фиксации.</span><span class="sxs-lookup"><span data-stu-id="a78a9-145">Notifies an enlisted object that a transaction is being prepared for commitment.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a78a9-146">Диспетчер транзакций вызывает этот метод прикрепленного диспетчера ресурсов на этапе 1 обязательства, когда он запрашивает у участников возможность зафиксировать транзакцию.</span><span class="sxs-lookup"><span data-stu-id="a78a9-146">The transaction manager calls this method of an enlisted resource manager during the phase 1 of a commitment, when it asks participants whether they can commit the transaction.</span></span>  
  
 <span data-ttu-id="a78a9-147">При реализации устойчивого диспетчера ресурсов следует заносить в журнал запись подготовки на этом этапе.</span><span class="sxs-lookup"><span data-stu-id="a78a9-147">When you are implementing a durable resource manager, you should log your prepare record during this phase.</span></span> <span data-ttu-id="a78a9-148">Запись должна содержать все необходимые сведения для выполнения восстановления.</span><span class="sxs-lookup"><span data-stu-id="a78a9-148">The record should contain all the necessary information to perform recovery.</span></span> <span data-ttu-id="a78a9-149">Сюда входит свойство <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A>, которое передается диспетчеру транзакций в методе <xref:System.Transactions.TransactionManager.Reenlist%2A> во время восстановления.</span><span class="sxs-lookup"><span data-stu-id="a78a9-149">This includes the <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> property, which is passed to the transaction manager in the <xref:System.Transactions.TransactionManager.Reenlist%2A> method during recovery.</span></span> <span data-ttu-id="a78a9-150">Дополнительные сведения о восстановлении см. в разделе [выполнение восстановления](https://msdn.microsoft.com/library/d342c5c7-da64-4a4c-8e63-b52f4fbf2691).</span><span class="sxs-lookup"><span data-stu-id="a78a9-150">For more information on recovery, see [Performing Recovery](https://msdn.microsoft.com/library/d342c5c7-da64-4a4c-8e63-b52f4fbf2691).</span></span>  
  
 <span data-ttu-id="a78a9-151">Диспетчер ресурсов должен выполнить всю работу, которая должна быть завершена перед вызовом метода <xref:System.Transactions.PreparingEnlistment.Prepared%2A> параметра `preparingEnlistment`, чтобы указать его голосование за обязательства.</span><span class="sxs-lookup"><span data-stu-id="a78a9-151">Your resource manager should complete all work that must be finished before calling the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method of the `preparingEnlistment` parameter to indicate its vote for commitment.</span></span> <span data-ttu-id="a78a9-152">Перед получением уведомлений второго этапа, таких как фиксация, откат или сомнительное, следует убедиться, что это выполнено.</span><span class="sxs-lookup"><span data-stu-id="a78a9-152">You should make sure that this is accomplished before receiving any phase 2 notification such as commit, rollback or in doubt.</span></span> <span data-ttu-id="a78a9-153">Это происходит потому, что уведомления 2 этапа могут быть встроены в тот же поток, который вызвал метод <xref:System.Transactions.PreparingEnlistment.Prepared%2A> в фазе 1.</span><span class="sxs-lookup"><span data-stu-id="a78a9-153">This is because phase 2 notifications can happen inline on the same thread that called the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method in phase 1.</span></span> <span data-ttu-id="a78a9-154">Таким образом, после вызова метода <xref:System.Transactions.PreparingEnlistment.Prepared%2A> не нужно выполнять никаких действий (например, снимать блокировки), которые должны были быть выполнены перед получением уведомлений второго этапа.</span><span class="sxs-lookup"><span data-stu-id="a78a9-154">As such, you should not do any work after the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> call (for example, releasing locks) that you would expect to have completed before receiving the phase 2 notifications.</span></span>  
  
 <span data-ttu-id="a78a9-155">Можно также вызвать метод `preparingEnlistment` параметра, чтобы указать голос для отката.</span><span class="sxs-lookup"><span data-stu-id="a78a9-155">You can also call the method of the `preparingEnlistment` parameter to indicate a vote for rollback.</span></span>  
  
 <span data-ttu-id="a78a9-156">Если нужно, чтобы объект просто проработал и реагировал на ход выполнения транзакции, не участвуя в нем, реализация этого метода должна вызвать метод <xref:System.Transactions.Enlistment.Done%2A> параметра `preparingEnlistment`, когда он завершит свою работу.</span><span class="sxs-lookup"><span data-stu-id="a78a9-156">If you want the object to merely observe and react to the progress of the transaction, without participating in it, your implementation of this method should call the <xref:System.Transactions.Enlistment.Done%2A> method of the `preparingEnlistment` parameter when it has finished its work.</span></span> <span data-ttu-id="a78a9-157">При этом диспетчер ресурсов не получал уведомлений второго этапа.</span><span class="sxs-lookup"><span data-stu-id="a78a9-157">By doing so, your resource manager would not receive any phase 2 notification.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Rollback">
      <MemberSignature Language="C#" Value="public void Rollback (System.Transactions.Enlistment enlistment);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void Rollback(class System.Transactions.Enlistment enlistment) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Transactions.IEnlistmentNotification.Rollback(System.Transactions.Enlistment)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Rollback(System::Transactions::Enlistment ^ enlistment);" />
      <MemberSignature Language="F#" Value="abstract member Rollback : System.Transactions.Enlistment -&gt; unit" Usage="iEnlistmentNotification.Rollback enlistment" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Transactions</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Transactions.Local</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.2.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="enlistment" Type="System.Transactions.Enlistment" />
      </Parameters>
      <Docs>
        <param name="enlistment"><span data-ttu-id="a78a9-158">Объект <see cref="T:System.Transactions.Enlistment" />, используемый для передачи ответа диспетчеру транзакций.</span><span class="sxs-lookup"><span data-stu-id="a78a9-158">A <see cref="T:System.Transactions.Enlistment" /> object used to send a response to the transaction manager.</span></span></param>
        <summary><span data-ttu-id="a78a9-159">Уведомляет включенный в список объект о том, что выполняется откат транзакции (ее прерывание).</span><span class="sxs-lookup"><span data-stu-id="a78a9-159">Notifies an enlisted object that a transaction is being rolled back (aborted).</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a78a9-160">Диспетчер транзакций вызывает этот метод присоединяемого объекта, когда транзакция откатывается (прервана) из-за невозможности одного или нескольких участников транзакции фиксировать транзакцию.</span><span class="sxs-lookup"><span data-stu-id="a78a9-160">The transaction manager calls this method of an enlisted object when the transaction is being rolled back (aborted) due to the inability of one or more transaction participants to commit the transaction.</span></span>  
  
 <span data-ttu-id="a78a9-161">Диспетчер ресурсов должен выполнить все действия, необходимые для завершения транзакции, а затем сообщить диспетчеру транзакций о завершении, вызвав метод <xref:System.Transactions.Enlistment.Done%2A> для параметра `enlistment`.</span><span class="sxs-lookup"><span data-stu-id="a78a9-161">The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.</span></span>  
  
 <span data-ttu-id="a78a9-162">Если диспетчер ресурсов прикрепляет надежно, но не отвечает, вызывая метод <xref:System.Transactions.Enlistment.Done%2A>, диспетчер транзакций не гарантирует, что диспетчер ресурсов получил вызов <xref:System.Transactions.IEnlistmentNotification.Rollback%2A>.</span><span class="sxs-lookup"><span data-stu-id="a78a9-162">If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> call.</span></span> <span data-ttu-id="a78a9-163">Таким образом диспетчер транзакций продолжает ожидание ответа и сохраняет сведения, относящиеся к этой транзакции.</span><span class="sxs-lookup"><span data-stu-id="a78a9-163">As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.</span></span>  <span data-ttu-id="a78a9-164">Если <xref:System.Transactions.Enlistment.Done%2A> никогда не вызывается, этот фрагмент информации хранится в неопределенном объеме памяти или в ресурсе на уровне системы.</span><span class="sxs-lookup"><span data-stu-id="a78a9-164">If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.</span></span> <span data-ttu-id="a78a9-165">Это приводит к невозможности освобождения ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-165">This results in resources not being able to be reclaimed.</span></span> <span data-ttu-id="a78a9-166">В случае распределенной транзакции это может в конечном итоге заполнить журнал MSDTC, который останавливает процесс MSDTC.</span><span class="sxs-lookup"><span data-stu-id="a78a9-166">In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.</span></span> <span data-ttu-id="a78a9-167">В случае транзакции, управляемой <xref:System.Transactions>, это приводит к постепенному и непрерывному увеличению потребления памяти процессом диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="a78a9-167">In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process.</span></span> <span data-ttu-id="a78a9-168">Поэтому важно вызвать метод <xref:System.Transactions.Enlistment.Done%2A> после того, как диспетчер ресурсов завершит свою работу.</span><span class="sxs-lookup"><span data-stu-id="a78a9-168">Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
