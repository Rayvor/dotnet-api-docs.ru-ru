<Type Name="SqlBulkCopy" FullName="System.Data.SqlClient.SqlBulkCopy">
  <Metadata><Meta Name="ms.openlocfilehash" Value="4caaf2e6bb3af18f4c4cf0168456a2dbe1ee0d16" /><Meta Name="ms.sourcegitcommit" Value="055a4a82a0b08bfbdc21bd1347fb71f7fe2c099e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="08/15/2019" /><Meta Name="ms.locfileid" Value="69123646" /></Metadata><TypeSignature Language="C#" Value="public sealed class SqlBulkCopy : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlBulkCopy extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlBulkCopy" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlBulkCopy&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlBulkCopy sealed : IDisposable" />
  <TypeSignature Language="F#" Value="type SqlBulkCopy = class&#xA;    interface IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Data.SqlClient</AssemblyName>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.4.0.0</AssemblyVersion>
    <AssemblyVersion>4.5.0.0</AssemblyVersion>
    <AssemblyVersion>4.6.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary><span data-ttu-id="9c9f2-101">Позволяет эффективно выполнить массовую загрузку таблицы SQL Server с данными из другого источника.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-101">Lets you efficiently bulk load a SQL Server table with data from another source.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-102">Microsoft SQL Server включает популярную программу командной строки с именем **bcp** для перемещения данных из одной таблицы в другую, будь то один сервер или между серверами.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-102">Microsoft SQL Server includes a popular command-prompt utility named **bcp** for moving data from one table to another, whether on a single server or between servers.</span></span> <span data-ttu-id="9c9f2-103"><xref:System.Data.SqlClient.SqlBulkCopy> Класс позволяет создавать решения для управляемого кода, которые предоставляют аналогичные функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-103">The <xref:System.Data.SqlClient.SqlBulkCopy> class lets you write managed code solutions that provide similar functionality.</span></span> <span data-ttu-id="9c9f2-104">Существуют и другие способы загрузки данных в таблицу SQL Server (например, инструкции INSERT), но <xref:System.Data.SqlClient.SqlBulkCopy> они обеспечивают значительное преимущество в производительности.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-104">There are other ways to load data into a SQL Server table (INSERT statements, for example), but <xref:System.Data.SqlClient.SqlBulkCopy> offers a significant performance advantage over them.</span></span>  
  
 <span data-ttu-id="9c9f2-105">Класс <xref:System.Data.SqlClient.SqlBulkCopy> может использоваться для записи данных только в таблицы SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-105">The <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables.</span></span> <span data-ttu-id="9c9f2-106">Однако источник данных не ограничен SQL Server; любой источник данных можно использовать при условии, что данные могут быть загружены в <xref:System.Data.DataTable> экземпляр или прочитаны <xref:System.Data.IDataReader> с помощью экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-106">However, the data source is not limited to SQL Server; any data source can be used, as long as the data can be loaded to a <xref:System.Data.DataTable> instance or read with a <xref:System.Data.IDataReader> instance.</span></span>  
  
 <span data-ttu-id="9c9f2-107"><xref:System.Data.SqlClient.SqlBulkCopy>завершается ошибкой при выполнении многостраничной <xref:System.Data.DataTable> загрузки <xref:System.Data.SqlTypes.SqlDateTime> столбца типа в SQL Server столбец, тип которого является одним из типов даты и времени, добавленных в SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-107"><xref:System.Data.SqlClient.SqlBulkCopy> will fail when bulk loading a <xref:System.Data.DataTable> column of type <xref:System.Data.SqlTypes.SqlDateTime> into a SQL Server column whose type is one of the date/time types added in SQL Server 2008.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-108">Следующее приложение командной строки демонстрирует, как загружать данные при помощи класса <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-108">The following console application demonstrates how to load data using the <xref:System.Data.SqlClient.SqlBulkCopy> class.</span></span> <span data-ttu-id="9c9f2-109">В этом примере <xref:System.Data.SqlClient.SqlDataReader> используется для копирования данных из таблицы **Production. Product** из базы данных SQL Server **AdventureWorks** в аналогичную таблицу в той же базе данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-109">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-110">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-110">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-111">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-111">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-112">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-112">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-113">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-113">Performing Bulk Copy Operations</span></span></related>
    <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-114">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-114">ADO.NET Overview</span></span></related>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9c9f2-115">Инициализирует новый экземпляр класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-115">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-116">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-116">ADO.NET Overview</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connection" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
      </Parameters>
      <Docs>
        <param name="connection"><span data-ttu-id="9c9f2-117">Уже открытый экземпляр <see cref="T:System.Data.SqlClient.SqlConnection" />, который будет использоваться для выполнения массового копирования.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-117">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy operation.</span></span> <span data-ttu-id="9c9f2-118">Если в строке подключения не используется <see langword="Integrated Security = true" />, можно использовать <see cref="T:System.Data.SqlClient.SqlCredential" /> для передачи идентификатора пользователя и пароля с большей безопасностью, чем при указании идентификатора пользователя и пароля в виде текста в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-118">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <summary><span data-ttu-id="9c9f2-119">Инициализирует новый экземпляр класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />, используя открытый экземпляр <see cref="T:System.Data.SqlClient.SqlConnection" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-119">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the specified open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-120">Поскольку соединение уже открыто при <xref:System.Data.SqlClient.SqlBulkCopy> инициализации экземпляра, соединение остается открытым <xref:System.Data.SqlClient.SqlBulkCopy> после закрытия экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-120">Because the connection is already open when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is initialized, the connection remains open after the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="9c9f2-121">Если аргумент имеет значение NULL <xref:System.ArgumentNullException> , создается исключение. `connection`</span><span class="sxs-lookup"><span data-stu-id="9c9f2-121">If the `connection` argument is null, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-122">В следующем консольном приложении показано, как выполнить загрузку данных с помощью уже открытого соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-122">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="9c9f2-123">В этом примере <xref:System.Data.SqlClient.SqlDataReader> используется для копирования данных из таблицы **Production. Product** из базы данных SQL Server **AdventureWorks** в аналогичную таблицу в той же базе данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-123">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span> <span data-ttu-id="9c9f2-124">Этот пример приведен только в качестве демонстрации.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-124">This example is for demonstration purposes only.</span></span> <span data-ttu-id="9c9f2-125">Не используется `SqlBulkCopy` для перемещения данных из одной таблицы в другую в одной и той же базе данных в рабочем приложении.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-125">You would not use `SqlBulkCopy` to move data from one table to another in the same database in a production application.</span></span> <span data-ttu-id="9c9f2-126">Обратите внимание, что исходные данные не обязательно должны размещаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-126">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-127">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-127">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-128">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-128">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-129">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-129">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-130">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-130">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-131">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-131">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connectionString" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="connectionString"><span data-ttu-id="9c9f2-132">Строка, определяющая подключение, которое будет открыто для использования экземпляром <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-132">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span> <span data-ttu-id="9c9f2-133">Если в строке подключения не используется <see langword="Integrated Security = true" />, можно использовать <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> или <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> и <see cref="T:System.Data.SqlClient.SqlCredential" /> для передачи идентификатора пользователя и пароля с большей безопасностью, чем при указании идентификатора пользователя и пароля в виде текста в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-133">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <summary><span data-ttu-id="9c9f2-134">Инициализирует и открывает новый экземпляр класса<see cref="T:System.Data.SqlClient.SqlConnection" /> с использованием заданной <paramref name="connectionString" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-134">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span></span> <span data-ttu-id="9c9f2-135">Этот конструктор использует <see cref="T:System.Data.SqlClient.SqlConnection" /> для инициализации нового экземпляра класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-135">The constructor uses the <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-136">Соединение автоматически закрывается в конце операции копирования.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-136">The connection is automatically closed at the end of the bulk copy operation.</span></span>  
  
 <span data-ttu-id="9c9f2-137">Если `connectionString` имеет значение NULL <xref:System.ArgumentNullException> , создается исключение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-137">If `connectionString` is null, an <xref:System.ArgumentNullException> is thrown.</span></span> <span data-ttu-id="9c9f2-138">Если `connectionString` является пустой строкой <xref:System.ArgumentException> , создается исключение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-138">If `connectionString` is an empty string, an <xref:System.ArgumentException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-139">В следующем консольном приложении показано, как выполнить загрузку данных с помощью соединения, указанного в виде строки.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-139">The following console application demonstrates how to bulk load data by using a connection specified as a string.</span></span> <span data-ttu-id="9c9f2-140">Соединение автоматически закрывается при <xref:System.Data.SqlClient.SqlBulkCopy> закрытии экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-140">The connection is automatically closed when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="9c9f2-141">В этом примере исходные данные сначала считываются из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-141">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-142">Исходные данные не обязательно должны располагаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-142">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-143">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-143">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-144">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-144">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-145">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-145">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-146">Операции массового копирования в SQL Server</span><span class="sxs-lookup"><span data-stu-id="9c9f2-146">Bulk Copy Operations in SQL Server</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-147">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-147">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString, System.Data.SqlClient.SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String,System.Data.SqlClient.SqlBulkCopyOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String, copyOptions As SqlBulkCopyOptions)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString, System::Data::SqlClient::SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string * System.Data.SqlClient.SqlBulkCopyOptions -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connectionString, copyOptions)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
      </Parameters>
      <Docs>
        <param name="connectionString"><span data-ttu-id="9c9f2-148">Строка, определяющая подключение, которое будет открыто для использования экземпляром <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-148">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span> <span data-ttu-id="9c9f2-149">Если в строке подключения не используется <see langword="Integrated Security = true" />, можно использовать <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> или <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> и <see cref="T:System.Data.SqlClient.SqlCredential" /> для передачи идентификатора пользователя и пароля с большей безопасностью, чем при указании идентификатора пользователя и пароля в виде текста в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-149">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <param name="copyOptions"><span data-ttu-id="9c9f2-150">Комбинация значений из перечисления <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" />, определяющая, какие строки из источника данных будут скопированы в конечную таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-150">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-151">Инициализирует и открывает новый экземпляр класса<see cref="T:System.Data.SqlClient.SqlConnection" /> с использованием заданной <paramref name="connectionString" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-151">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span></span> <span data-ttu-id="9c9f2-152">Этот конструктор использует <see cref="T:System.Data.SqlClient.SqlConnection" /> для инициализации нового экземпляра класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-152">The constructor uses that <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span> <span data-ttu-id="9c9f2-153">Экземпляр <see cref="T:System.Data.SqlClient.SqlConnection" /> ведет себя соответственно установкам, заданным в параметре <paramref name="copyOptions" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-153">The <see cref="T:System.Data.SqlClient.SqlConnection" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-154">Подробные сведения обо всех параметрах копирования, описанных в <xref:System.Data.SqlClient.SqlBulkCopyOptions> разделе, можно получить.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-154">You can obtain detailed information about all the bulk copy options in the <xref:System.Data.SqlClient.SqlBulkCopyOptions> topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-155">В следующем консольном приложении демонстрируется выполнение групповой загрузки с помощью соединения, указанного в виде строки.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-155">The following console application demonstrates how to perform a bulk load by using a connection specified as a string.</span></span> <span data-ttu-id="9c9f2-156">Параметр устанавливается для использования значения в столбце Identity исходной таблицы при загрузке целевой таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-156">An option is set to use the value in the identity column of the source table when you load the destination table.</span></span> <span data-ttu-id="9c9f2-157">В этом примере исходные данные сначала считываются из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-157">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-158">Исходная и целевая таблицы содержат столбец идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-158">The source table and destination table each include an Identity column.</span></span> <span data-ttu-id="9c9f2-159">По умолчанию новое значение для столбца **идентификаторов** создается в целевой таблице для каждой добавляемой строки.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-159">By default, a new value for the **Identity** column is generated in the destination table for each row added.</span></span> <span data-ttu-id="9c9f2-160">В этом примере параметр устанавливается при открытии соединения, который заставляет процесс групповой загрузки использовать значения идентификаторов из исходной таблицы. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="9c9f2-160">In this example, an option is set when the connection is opened that forces the bulk load process to use the **Identity** values from the source table instead.</span></span> <span data-ttu-id="9c9f2-161">Чтобы увидеть, как этот параметр изменяет способ работы с массовыми нагрузками, запустите пример с помощью **dbo. Таблица Булккопидемоматчингколумнс** пуста.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-161">To see how the option changes the way the bulk load works, run the sample with the **dbo.BulkCopyDemoMatchingColumns** table empty.</span></span> <span data-ttu-id="9c9f2-162">Все строки загружаются из источника.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-162">All rows load from the source.</span></span> <span data-ttu-id="9c9f2-163">Затем снова запустите пример без очистки таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-163">Then run the sample again without emptying the table.</span></span> <span data-ttu-id="9c9f2-164">Создается исключение, и код записывает сообщение в консоль, уведомляющее о том, что строки не были добавлены из-за нарушений ограничений первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-164">An exception is thrown and the code writes a message to the console notifying you that rows weren't added because of primary key constraint violations.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-165">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-165">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-166">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-166">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-167">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-167">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-168">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-168">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-169">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-169">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlBulkCopyOptions copyOptions, System.Data.SqlClient.SqlTransaction externalTransaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions, class System.Data.SqlClient.SqlTransaction externalTransaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection, copyOptions As SqlBulkCopyOptions, externalTransaction As SqlTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlBulkCopyOptions copyOptions, System::Data::SqlClient::SqlTransaction ^ externalTransaction);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection * System.Data.SqlClient.SqlBulkCopyOptions * System.Data.SqlClient.SqlTransaction -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connection, copyOptions, externalTransaction)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
        <Parameter Name="externalTransaction" Type="System.Data.SqlClient.SqlTransaction" />
      </Parameters>
      <Docs>
        <param name="connection"><span data-ttu-id="9c9f2-170">Уже открытый экземпляр <see cref="T:System.Data.SqlClient.SqlConnection" />, который будет использоваться для выполнения массового копирования.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-170">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy.</span></span> <span data-ttu-id="9c9f2-171">Если строка подключения не использует <see langword="Integrated Security = true" />, можно использовать <see cref="T:System.Data.SqlClient.SqlCredential" /> для более безопасной передачи идентификатора пользователя и пароля, чем при указании идентификатора пользователя и пароля в строке подключения в виде текста.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-171">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <param name="copyOptions"><span data-ttu-id="9c9f2-172">Комбинация значений из перечисления <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" />, определяющая, какие строки из источника данных будут скопированы в конечную таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-172">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span></span></param>
        <param name="externalTransaction"><span data-ttu-id="9c9f2-173">Существующий экземпляр <see cref="T:System.Data.SqlClient.SqlTransaction" />, для которого будет выполняться массовое копирование.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-173">An existing <see cref="T:System.Data.SqlClient.SqlTransaction" /> instance under which the bulk copy will occur.</span></span></param>
        <summary><span data-ttu-id="9c9f2-174">Инициализирует новый экземпляр класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />, используя заданный открытый экземпляр класса <see cref="T:System.Data.SqlClient.SqlConnection" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-174">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the supplied existing open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span></span> <span data-ttu-id="9c9f2-175">Экземпляр <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> ведет себя соответственно установкам, заданным в параметре <paramref name="copyOptions" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-175">The <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span></span> <span data-ttu-id="9c9f2-176">Если задан объект <see cref="T:System.Data.SqlClient.SqlTransaction" />, не равный null, операция копирования выполняется в рамках транзакции.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-176">If a non-null <see cref="T:System.Data.SqlClient.SqlTransaction" /> is supplied, the copy operations will be performed within that transaction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-177">Если параметры включают `UseInternalTransaction` , `externalTransaction` а аргумент не равен null, выдается исключение **InvalidArgumentException** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-177">If options include `UseInternalTransaction` and the `externalTransaction` argument is not null, an **InvalidArgumentException** is thrown.</span></span>  
  
 <span data-ttu-id="9c9f2-178">Примеры, демонстрирующие использование `SqlBulkCopy` в транзакции, см. в разделе [операции транзакций и операций с массовым копированием](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-178">For examples demonstrating how to use `SqlBulkCopy` in a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-179">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-179">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-180">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-180">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="BatchSize">
      <MemberSignature Language="C#" Value="public int BatchSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BatchSize" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberSignature Language="VB.NET" Value="Public Property BatchSize As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BatchSize { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BatchSize : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-181">Количество строк в каждом пакете.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-181">Number of rows in each batch.</span></span> <span data-ttu-id="9c9f2-182">В конце каждого пакета серверу отправляется количество содержащихся в нем строк.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-182">At the end of each batch, the rows in the batch are sent to the server.</span></span></summary>
        <value><span data-ttu-id="9c9f2-183">Целочисленное значение свойства <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> или нуль, если его значение не задано.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-183">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> property, or zero if no value has been set.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-184">Выполнение пакета завершается, <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> если строки были обработаны или больше нет строк для отправки в целевой источник данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-184">A batch is complete when <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows have been processed or there are no more rows to send to the destination data source.</span></span>  
  
 <span data-ttu-id="9c9f2-185">Ноль (по умолчанию) указывает, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> что каждая операция является одним пакетом.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-185">Zero (the default) indicates that each <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is a single batch.</span></span>  
  
 <span data-ttu-id="9c9f2-186">Если экземпляр был объявлен <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> без установленного параметра, строки отправляются на серверные <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> строки за раз, но действия, связанные с транзакциями, не выполняются. <xref:System.Data.SqlClient.SqlBulkCopy></span><span class="sxs-lookup"><span data-stu-id="9c9f2-186">If the <xref:System.Data.SqlClient.SqlBulkCopy> instance has been declared without the <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> option in effect, rows are sent to the server <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows at a time, but no transaction-related action is taken.</span></span> <span data-ttu-id="9c9f2-187">Если <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> действует, каждый пакет строк вставляется как отдельная транзакция.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-187">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is in effect, each batch of rows is inserted as a separate transaction.</span></span>  
  
 <span data-ttu-id="9c9f2-188"><xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> Свойство можно задать в любое время.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-188">The <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> property can be set at any time.</span></span> <span data-ttu-id="9c9f2-189">Если уже выполняется групповое копирование, размер текущего пакета изменяется в соответствии с размером предыдущего пакета.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-189">If a bulk copy is already in progress, the current batch is sized according to the previous batch size.</span></span> <span data-ttu-id="9c9f2-190">В последующих пакетах используется новый размер.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-190">Subsequent batches use the new size.</span></span> <span data-ttu-id="9c9f2-191">Если значение <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> изначально равно нулю и изменяется в <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> то время, когда операция уже выполняется, эта операция загружает данные в виде одного пакета.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-191">If the <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> is initially zero and changed while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is already in progress, that operation loads the data as a single batch.</span></span> <span data-ttu-id="9c9f2-192">Все последующие <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> операции с тем же <xref:System.Data.SqlClient.SqlBulkCopy> экземпляром используют новый <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-192">Any subsequent <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operations on the same <xref:System.Data.SqlClient.SqlBulkCopy> instance use the new <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-193">В следующем консольном приложении показано, как выполнить загрузку данных пакетами из 50 строк.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-193">The following console application demonstrates how to bulk load data in batches of 50 rows.</span></span> <span data-ttu-id="9c9f2-194">Пример, демонстрирующий <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> работу с транзакцией, см. в разделе [операции транзакций и операций с массовым копированием](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-194">For an example illustrating how <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> works with a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 <span data-ttu-id="9c9f2-195">В этом примере исходные данные сначала считываются из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-195">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-196">Исходные данные не обязательно должны располагаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-196">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-197">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-197">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-198">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-198">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-199">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-199">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-200">Операции массового копирования в SQL Server</span><span class="sxs-lookup"><span data-stu-id="9c9f2-200">Bulk Copy Operations in SQL Server</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-201">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-201">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="BulkCopyTimeout">
      <MemberSignature Language="C#" Value="public int BulkCopyTimeout { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BulkCopyTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Property BulkCopyTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BulkCopyTimeout { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BulkCopyTimeout : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-202">Таймаут завершения операции в миллисекундах.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-202">Number of seconds for the operation to complete before it times out.</span></span></summary>
        <value><span data-ttu-id="9c9f2-203">Целочисленное значение свойства <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-203">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> property.</span></span> <span data-ttu-id="9c9f2-204">По умолчанию используется значение 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-204">The default is 30 seconds.</span></span> <span data-ttu-id="9c9f2-205">Значение 0 означает что нет ограничения; массовое копирование ждет бесконечно.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-205">A value of 0 indicates no limit; the bulk copy will wait indefinitely.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-206">Если время ожидания операции истекло, транзакция не фиксируется и все скопированные строки удаляются из целевой таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-206">If the operation does time out, the transaction is not committed and all copied rows are removed from the destination table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-207">В следующем консольном приложении показано, как изменить время ожидания до 60 секунд при выполнении групповой загрузки данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-207">The following console application demonstrates how to modify the time-out to 60 seconds when bulk loading data.</span></span>  
  
 <span data-ttu-id="9c9f2-208">В этом примере исходные данные сначала считываются из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-208">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-209">Исходные данные не обязательно должны располагаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-209">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-210">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-210">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-211">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-211">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-212">Если исходная и целевая таблицы находятся в одном экземпляре SQL Server, проще и быстрее использовать [!INCLUDE[tsql](~/includes/tsql-md.md)] `INSERT … SELECT` инструкцию для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-212">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a [!INCLUDE[tsql](~/includes/tsql-md.md)]`INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-213">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-213">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-214">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-214">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="sqlBulkCopy.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9c9f2-215">Закрывает экземпляр <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-215">Closes the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-216">После вызова метода <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> <xref:System.Data.SqlClient.SqlBulkCopy> для объекта никакая другая операция не будет выполнена.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-216">After you call a <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> on the <xref:System.Data.SqlClient.SqlBulkCopy> object, no other operation will succeed.</span></span> <span data-ttu-id="9c9f2-217">Вызовы метода будут вызывать исключение <xref:System.InvalidOperationException>. <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A></span><span class="sxs-lookup"><span data-stu-id="9c9f2-217">Calls to the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="9c9f2-218">Вызов метода из события приводит <xref:System.InvalidOperationException> к возникновению исключения. <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A></span><span class="sxs-lookup"><span data-stu-id="9c9f2-218">Calling the <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method from the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event causes an <xref:System.InvalidOperationException> to be thrown.</span></span>  
  
 <span data-ttu-id="9c9f2-219">Обратите внимание <xref:System.Data.SqlClient.SqlBulkCopy> , что открытые экземпляры закрываются неявно в конце `using` блока.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-219">Note that open <xref:System.Data.SqlClient.SqlBulkCopy> instances are closed implicitly at the end of a `using` block.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-220">В следующем примере один и тот <xref:System.Data.SqlClient.SqlBulkCopy> же экземпляр используется для добавления заказов на продажу и связанных с ними сведений в две целевые таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-220">The following example uses the same <xref:System.Data.SqlClient.SqlBulkCopy> instance to add sales orders and their associated details to two destination tables.</span></span> <span data-ttu-id="9c9f2-221">Поскольку таблицы заказов на продажу **AdventureWorks** велики, пример считывает только заказы, размещенные по определенному номеру счета, и выполняет операции полного копирования этих заказов и сведений в целевые таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-221">Because the **AdventureWorks** sales order tables are large, the sample reads only orders placed by a certain account number and bulk copies those orders and details to the destination tables.</span></span> <span data-ttu-id="9c9f2-222"><xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> Метод используется только после завершения обоих операций копирования.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-222">The <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method is used only after both bulk copy operations are complete.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-223">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-223">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-224">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-224">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-225">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-225">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-226">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-226">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-227">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-227">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ColumnMappings">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ColumnMappings As SqlBulkCopyColumnMappingCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ ColumnMappings { System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ColumnMappings : System.Data.SqlClient.SqlBulkCopyColumnMappingCollection" Usage="System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlBulkCopyColumnMappingCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-228">Возвращает коллекцию элементов <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-228">Returns a collection of <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" /> items.</span></span> <span data-ttu-id="9c9f2-229">Сопоставления столбцов определяют связи между столбцами в источнике данных и столбцами в месте назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-229">Column mappings define the relationships between columns in the data source and columns in the destination.</span></span></summary>
        <value><span data-ttu-id="9c9f2-230">Коллекция сопоставлений столбцов.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-230">A collection of column mappings.</span></span> <span data-ttu-id="9c9f2-231">По умолчанию является пустой коллекцией.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-231">By default, it is an empty collection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-232">Если источник данных и Целевая таблица имеют одинаковое число столбцов, а порядковый номер каждого исходного столбца в источнике данных совпадает с порядковым номером соответствующего целевого столбца, <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> коллекция не требуется.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-232">If the data source and the destination table have the same number of columns, and the ordinal position of each source column within the data source matches the ordinal position of the corresponding destination column, the <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection is unnecessary.</span></span> <span data-ttu-id="9c9f2-233">Однако если количество столбцов различается или порядковые номера не соответствуют друг другу, необходимо использовать <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> , чтобы убедиться, что данные скопированы в правильные столбцы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-233">However, if the column counts differ, or the ordinal positions are not consistent, you must use <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> to make sure that data is copied into the correct columns.</span></span>  
  
 <span data-ttu-id="9c9f2-234">Во время выполнения операции с массовым копированием эта коллекция может быть доступна, но ее нельзя изменить.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-234">During the execution of a bulk copy operation, this collection can be accessed, but it cannot be changed.</span></span> <span data-ttu-id="9c9f2-235">Любая попытка изменить ее вызовет исключение <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-235">Any attempt to change it will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-236">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-236">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-237">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-237">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DestinationTableName">
      <MemberSignature Language="C#" Value="public string DestinationTableName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DestinationTableName" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberSignature Language="VB.NET" Value="Public Property DestinationTableName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DestinationTableName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DestinationTableName : string with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-238">Имя целевой таблицы на сервере.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-238">Name of the destination table on the server.</span></span></summary>
        <value><span data-ttu-id="9c9f2-239">Строковое значение свойства<see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> или null, если оно не задано.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-239">The string value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property, or null if none as been supplied.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-240">Если <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> параметр не был задан при <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> вызове метода, <xref:System.ArgumentNullException> создается исключение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-240">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> has not been set when <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> is called, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
 <span data-ttu-id="9c9f2-241">Если <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> параметр изменяется <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> во время выполнения операции, это изменение не влияет на текущую операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-241">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is modified while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is running, the change does not affect the current operation.</span></span> <span data-ttu-id="9c9f2-242">Новое <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> значение используется при следующем <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> вызове метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-242">The new <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> value is used the next time a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called.</span></span>  
  
 <span data-ttu-id="9c9f2-243"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>имя состоит из трех частей (`<database>.<owningschema>.<name>`).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-243"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is a three-part name (`<database>.<owningschema>.<name>`).</span></span> <span data-ttu-id="9c9f2-244">Вы можете уточнить имя таблицы, используя ее базу данных и схему владельца, если вы решили.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-244">You can qualify the table name with its database and owning schema if you choose.</span></span> <span data-ttu-id="9c9f2-245">Однако если имя таблицы использует символ подчеркивания ("_") или другие специальные символы, необходимо заключить имя в escape-знаки, используя окружающие скобки как in (`[<database>.<owningschema>.<name_01>]`).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-245">However, if the table name uses an underscore ("_") or any other special characters, you must escape the name using surrounding brackets as in (`[<database>.<owningschema>.<name_01>]`).</span></span> <span data-ttu-id="9c9f2-246">Дополнительные сведения см. в разделе [идентификаторы баз данных](/sql/relational-databases/databases/database-identifiers).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-246">For more information, see [Database Identifiers](/sql/relational-databases/databases/database-identifiers).</span></span>  
  
 <span data-ttu-id="9c9f2-247">Можно выполнить групповое копирование данных во временную таблицу, используя значение, например `tempdb..#table` или `tempdb.<owner>.#table` для <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> свойства.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-247">You can bulk-copy data to a temporary table by using a value such as `tempdb..#table` or `tempdb.<owner>.#table` for the <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-248">В следующем консольном приложении показано, как выполнить загрузку данных с помощью уже открытого соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-248">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="9c9f2-249">Целевая таблица является таблицей в базе данных **AdventureWorks** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-249">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="9c9f2-250">В этом примере соединение сначала используется для считывания данных из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-250">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-251">Исходные данные не обязательно должны располагаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-251">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-252">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-252">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-253">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-253">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-254">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-254">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-255">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-255">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-256">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-256">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnableStreaming">
      <MemberSignature Language="C#" Value="public bool EnableStreaming { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableStreaming" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableStreaming As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableStreaming { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableStreaming : bool with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-257">Включение или отключение объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> для потоковой передачи данных из объекта <see cref="T:System.Data.IDataReader" /></span><span class="sxs-lookup"><span data-stu-id="9c9f2-257">Enables or disables a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object to stream data from an <see cref="T:System.Data.IDataReader" /> object</span></span></summary>
        <value><span data-ttu-id="9c9f2-258">Значение <see langword="true" />, если объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> может выполнить потоковую передачу данных из объекта <see cref="T:System.Data.IDataReader" />; в противном случае — значение false.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-258"><see langword="true" /> if a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object can stream data from an <see cref="T:System.Data.IDataReader" /> object; otherwise, false.</span></span> <span data-ttu-id="9c9f2-259">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-259">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-260">Если <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> имеет `true`значение ,<xref:System.Data.SqlClient.SqlBulkCopy> считывает из <xref:System.Data.IDataReader> объекта с <xref:System.Data.CommandBehavior.SequentialAccess>помощью, оптимизируя использование памяти с помощью <xref:System.Data.IDataReader> возможностей потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-260">When <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> is `true`, <xref:System.Data.SqlClient.SqlBulkCopy> reads from an <xref:System.Data.IDataReader> object using <xref:System.Data.CommandBehavior.SequentialAccess>, optimizing memory usage by using the <xref:System.Data.IDataReader> streaming capabilities.</span></span> <span data-ttu-id="9c9f2-261">Если задано значение false, то <xref:System.Data.SqlClient.SqlBulkCopy> класс загружает все данные, возвращенные <xref:System.Data.IDataReader> объектом, в память перед отправкой в SQL Server или SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-261">When it's set to false, the <xref:System.Data.SqlClient.SqlBulkCopy> class loads all the data returned by the <xref:System.Data.IDataReader> object into memory before sending it to SQL Server or SQL Azure.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NotifyAfter">
      <MemberSignature Language="C#" Value="public int NotifyAfter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 NotifyAfter" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberSignature Language="VB.NET" Value="Public Property NotifyAfter As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int NotifyAfter { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.NotifyAfter : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-262">Определяет количество строк, обрабатываемых перед генерированием уведомляющего события.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-262">Defines the number of rows to be processed before generating a notification event.</span></span></summary>
        <value><span data-ttu-id="9c9f2-263">Целочисленное значение свойства <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> или нуль, если его значение не задано.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-263">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property, or zero if the property has not been set.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-264">Это свойство предназначено для компонентов пользовательского интерфейса, которые иллюстрируют ход выполнения операции копирования.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-264">This property is designed for user interface components that illustrate the progress of a bulk copy operation.</span></span> <span data-ttu-id="9c9f2-265">Указывает число строк, которые должны быть обработаны перед созданием события уведомления.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-265">It indicates the number of rows to be processed before generating a notification event.</span></span> <span data-ttu-id="9c9f2-266"><xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> Свойство может быть задано в любое время, даже пока выполняется операция с массовым копированием.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-266">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property can be set at any time, even while a bulk copy operation is underway.</span></span> <span data-ttu-id="9c9f2-267">Изменения, внесенные во время операции копирования, вступают в силу после следующего уведомления.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-267">Changes made during a bulk copy operation take effect after the next notification.</span></span> <span data-ttu-id="9c9f2-268">Новый параметр применяется ко всем последующим операциям в том же экземпляре.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-268">The new setting applies to all subsequent operations on the same instance.</span></span>  
  
 <span data-ttu-id="9c9f2-269">Если <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> для параметра задано число меньше нуля <xref:System.ArgumentOutOfRangeException> , создается исключение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-269">If <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> is set to a number less than zero, an <xref:System.ArgumentOutOfRangeException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-270">В следующем консольном приложении показано, как выполнить загрузку данных с помощью уже открытого соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-270">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="9c9f2-271"><xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> Свойство задается таким образом, что обработчик событий вызывается после каждых 50 строк, скопированных в таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-271">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="9c9f2-272">В этом примере соединение сначала используется для считывания данных из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-272">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-273">Затем открывается второе соединение для выполнения операции копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-273">Then a second connection is opened to bulk copy the data.</span></span> <span data-ttu-id="9c9f2-274">Обратите внимание, что исходные данные не обязательно должны размещаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-274">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-275">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-275">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-276">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-276">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-277">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-277">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-278">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-278">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-279">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-279">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="SqlRowsCopied">
      <MemberSignature Language="C#" Value="public event System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied" />
      <MemberSignature Language="DocId" Value="E:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event SqlRowsCopied As SqlRowsCopiedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Data::SqlClient::SqlRowsCopiedEventHandler ^ SqlRowsCopied;" />
      <MemberSignature Language="F#" Value="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " Usage="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlRowsCopiedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9c9f2-280">Генерируется всякий раз после обработки количества строк, заданного в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-280">Occurs every time that the number of rows specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property have been processed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-281">Обратите внимание, что <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> параметры <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> и являются независимыми.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-281">Note that the settings of <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> and <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> are independent.</span></span> <span data-ttu-id="9c9f2-282"><xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> Получение события не подразумевает, что какие-либо строки были отправлены на сервер или зафиксированы.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-282">Receipt of a <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event does not imply that any rows have been sent to the server or committed.</span></span>  
  
 <span data-ttu-id="9c9f2-283">Из этого события нельзя вызывать SqlBulkCopy.<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>Close () или SqlConnection.<xref:System.Data.SqlClient.SqlConnection.Close%2A>Close ().</span><span class="sxs-lookup"><span data-stu-id="9c9f2-283">You cannot call SqlBulkCopy.Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) or SqlConnection.Close (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) from this event.</span></span> <span data-ttu-id="9c9f2-284">Это <xref:System.InvalidOperationException> вызовет исключение, <xref:System.Data.SqlClient.SqlBulkCopy> и состояние объекта не изменится.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-284">Doing this will cause an <xref:System.InvalidOperationException> being thrown, and the <xref:System.Data.SqlClient.SqlBulkCopy> object state will not change.</span></span> <span data-ttu-id="9c9f2-285">Если пользователь хочет отменить операцию из события, <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> можно использовать свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-285">If the user wants to cancel the operation from the event, the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property of the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> can be used.</span></span> <span data-ttu-id="9c9f2-286">(Примеры, в которых используется свойство, см. в <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> разделе [транзакции и операции с массовым копированием](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) .)</span><span class="sxs-lookup"><span data-stu-id="9c9f2-286">(See [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) for examples that use the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property.)</span></span>  
  
 <span data-ttu-id="9c9f2-287">Никакие действия, такие как активность транзакций, поддерживаются в соединении во время выполнения операции копирования, поэтому рекомендуется не использовать то же соединение, которое использовалось во время <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> этого события.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-287">No action, such as transaction activity, is supported in the connection during the execution of the bulk copy operation, and it is recommended that you not use the same connection used during the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event.</span></span> <span data-ttu-id="9c9f2-288">Тем не менее можно открыть другое соединение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-288">However, you can open a different connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-289">В следующем консольном приложении показано, как выполнить загрузку данных с помощью уже открытого соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-289">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="9c9f2-290"><xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> Свойство задается таким образом, что обработчик событий вызывается после каждых 50 строк, скопированных в таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-290">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="9c9f2-291">В этом примере соединение сначала используется для считывания данных из таблицы SQL Server в <xref:System.Data.SqlClient.SqlDataReader> экземпляр.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-291">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="9c9f2-292">Обратите внимание, что исходные данные не обязательно должны размещаться на SQL Server; можно использовать любой источник данных, который можно считать <xref:System.Data.IDataReader> или загрузить <xref:System.Data.DataTable>в.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-292">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-293">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-293">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-294">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-294">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-295">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-295">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-296">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-296">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-297">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-297">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.System#IDisposable#Dispose" />
      <MemberSignature Language="VB.NET" Value="Sub Dispose () Implements IDisposable.Dispose" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.IDisposable.Dispose() = IDisposable::Dispose;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9c9f2-298">Освобождает все ресурсы, используемые текущим экземпляром класса <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-298">Releases all resources used by the current instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-299">Вызовите метод `Dispose` по окончании использования класса <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-299">Call `Dispose` when you are finished using the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="9c9f2-300">Метод `Dispose` оставляет класс <xref:System.Data.SqlClient.SqlBulkCopy> в непригодном для использования состоянии.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-300">The `Dispose` method leaves the <xref:System.Data.SqlClient.SqlBulkCopy> in an unusable state.</span></span> <span data-ttu-id="9c9f2-301">После вызова `Dispose`необходимо освободить все ссылки <xref:System.Data.SqlClient.SqlBulkCopy> на, чтобы сборщик мусора мог освободить память, которую <xref:System.Data.SqlClient.SqlBulkCopy> занимают.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-301">After calling `Dispose`, you must release all references to the <xref:System.Data.SqlClient.SqlBulkCopy> so the garbage collector can reclaim the memory that the <xref:System.Data.SqlClient.SqlBulkCopy> was occupying.</span></span>  
  
 <span data-ttu-id="9c9f2-302">Дополнительные сведения см. в разделе [Очистка неуправляемых ресурсов](~/docs/standard/garbage-collection/unmanaged.md) и [Реализация метода Dispose](~/docs/standard/garbage-collection/implementing-dispose.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-302">For more information, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md) and [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9c9f2-303">Всегда вызывайте метод `Dispose` перед освобождением последней ссылки на класс <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-303">Always call `Dispose` before you release your last reference to the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="9c9f2-304">В противном случае используемые им ресурсы не будут освобождены до тех пор, пока сборщик мусора не вызовет для объекта <xref:System.Data.SqlClient.SqlBulkCopy> метод `Finalize`.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-304">Otherwise, the resources it is using will not be freed until the garbage collector calls the <xref:System.Data.SqlClient.SqlBulkCopy> object's `Finalize` method.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-305">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-305">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServer">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9c9f2-306">Копирует все строки из источника данных в таблицу назначения, заданную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-306">Copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-307">Если отключено несколько активных результирующих наборов (MARS) <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> , соединение становится занятым.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-307">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="9c9f2-308">Если режим MARS включен, можно чередовать вызовы <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> с другими командами в том же соединении.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-308">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-309">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-309">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-310">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-310">ADO.NET Overview</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As DbDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.Common.DbDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-311">Объект <see cref="T:System.Data.Common.DbDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-311">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-312">Копирует все строки из заданного массива <see cref="T:System.Data.Common.DbDataReader" /> в целевую таблицу, указанную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-312">Copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (rows As DataRow())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataRow[] -&gt; unit" Usage="sqlBulkCopy.WriteToServer rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="9c9f2-313">Массив объектов<see cref="T:System.Data.DataRow" />, подлежащих копированию в целевую таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-313">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-314">Копирует все строки из заданного массива <see cref="T:System.Data.DataRow" /> в целевую таблицу, указанную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-314">Copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-315">Пока выполняется операция с массовым копированием, связанное назначение <xref:System.Data.SqlClient.SqlConnection> занято ее обслуживанием, и для него не может быть выполнено никаких других операций.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-315">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="9c9f2-316"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> Коллекция сопоставляет<xref:System.Data.DataRow> столбцы с целевой таблицей базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-316">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataRow> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-317">В следующем консольном приложении показано, как выполнить загрузку данных из <xref:System.Data.DataRow> массива.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-317">The following console application demonstrates how to bulk load data from a <xref:System.Data.DataRow> array.</span></span> <span data-ttu-id="9c9f2-318">Целевая таблица является таблицей в базе данных **AdventureWorks** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-318">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="9c9f2-319">В этом примере <xref:System.Data.DataTable> создается во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-319">In this example, a <xref:System.Data.DataTable> is created at run time.</span></span> <span data-ttu-id="9c9f2-320">Для копирования в целевую таблицу выбирается одна строка из <xref:System.Data.DataTable> .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-320">A single row is selected from the <xref:System.Data.DataTable> to copy to the destination table.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-321">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-321">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-322">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-322">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-323">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-323">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-324">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-324">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-325">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-325">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable -&gt; unit" Usage="sqlBulkCopy.WriteToServer table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-326">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-326">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-327">Копирует все строки из заданного объекта <see cref="T:System.Data.DataTable" /> в целевую таблицу, указанную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-327">Copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-328">Все строки в <xref:System.Data.DataTable> копируются в целевую таблицу, за исключением тех, которые были удалены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-328">All rows in the <xref:System.Data.DataTable> are copied to the destination table except those that have been deleted.</span></span>  
  
 <span data-ttu-id="9c9f2-329">Пока выполняется операция с массовым копированием, связанное назначение <xref:System.Data.SqlClient.SqlConnection> занято ее обслуживанием, и для него не может быть выполнено никаких других операций.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-329">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="9c9f2-330"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> Коллекция сопоставляет<xref:System.Data.DataTable> столбцы с целевой таблицей базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-330">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-331">В следующем консольном приложении показано, как выполнить загрузку данных из <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-331">The following Console application demonstrates how to bulk load data from a <xref:System.Data.DataTable>.</span></span> <span data-ttu-id="9c9f2-332">Целевая таблица является таблицей в базе данных **AdventureWorks** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-332">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="9c9f2-333">В этом примере <xref:System.Data.DataTable> создается во время выполнения и является источником `SqlBulkCopy` операции.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-333">In this example, a <xref:System.Data.DataTable> is created at run time and is the source of the `SqlBulkCopy` operation.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-334">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-334">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-335">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-335">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-336">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-336">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-337">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-337">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-338">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-338">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As IDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.IDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-339">Объект <see cref="T:System.Data.IDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-339">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-340">Копирует все строки из заданного объекта <see cref="T:System.Data.IDataReader" /> в целевую таблицу, указанную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-340">Copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-341">Операция копирования начинается со следующей доступной строки в модуле чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-341">The copy operation starts at the next available row in the reader.</span></span> <span data-ttu-id="9c9f2-342">В большинстве случаев средство чтения было просто возвращено <xref:System.Data.IDbCommand.ExecuteReader%2A> или аналогичным вызовом, поэтому следующая доступная строка является первой строкой.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-342">Most of the time, the reader was just returned by <xref:System.Data.IDbCommand.ExecuteReader%2A> or a similar call, so the next available row is the first row.</span></span> <span data-ttu-id="9c9f2-343">Чтобы обработать несколько результатов, вызовите <xref:System.Data.IDataReader.NextResult%2A> модуль чтения данных и снова вызовите метод. <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A></span><span class="sxs-lookup"><span data-stu-id="9c9f2-343">To process multiple results, call <xref:System.Data.IDataReader.NextResult%2A> on the data reader and call <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> again.</span></span>  
  
 <span data-ttu-id="9c9f2-344">Обратите внимание <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> , что использование изменяет состояние средства чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-344">Note that using <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> modifies the state of the reader.</span></span> <span data-ttu-id="9c9f2-345">Метод будет вызываться <xref:System.Data.IDataReader.Read%2A> до тех пор, пока не вернет значение false, операция прерывается или возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-345">The method will call <xref:System.Data.IDataReader.Read%2A> until it returns false, the operation is aborted, or an error occurs.</span></span> <span data-ttu-id="9c9f2-346">Это означает, что модуль чтения данных будет находиться в другом состоянии, возможно, в конце результирующего набора после <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> завершения операции.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-346">This means that the data reader will be in a different state, probably at the end of the result set, when the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is complete.</span></span>  
  
 <span data-ttu-id="9c9f2-347">Пока выполняется операция с массовым копированием, связанное назначение <xref:System.Data.SqlClient.SqlConnection> занято ее обслуживанием, и для него не может быть выполнено никаких других операций.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-347">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="9c9f2-348"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> Коллекция сопоставляет столбцы модуля чтения данных с целевой таблицей базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-348">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the data reader columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-349">В следующем консольном приложении показано, как выполнить загрузку данных из <xref:System.Data.SqlClient.SqlDataReader>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-349">The following console application demonstrates how to bulk load data from a <xref:System.Data.SqlClient.SqlDataReader>.</span></span> <span data-ttu-id="9c9f2-350">Целевая таблица является таблицей в базе данных **AdventureWorks** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-350">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-351">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-351">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-352">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-352">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-353">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-353">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-354">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-354">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-355">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-355">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable, rowState As DataRowState)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable * System.Data.DataRowState -&gt; unit" Usage="sqlBulkCopy.WriteToServer (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-356">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-356">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="9c9f2-357">Значение из перечисления <see cref="T:System.Data.DataRowState" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-357">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="9c9f2-358">В целевую таблицу копируются только строки, состояние которых соответствует заданному.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-358">Only rows matching the row state are copied to the destination.</span></span></param>
        <summary><span data-ttu-id="9c9f2-359">Копирует только строки, соответствующие заданному состоянию строки, из заданного объекта <see cref="T:System.Data.DataTable" /> в целевую таблицу, указанную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-359">Copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-360">В целевую таблицу <xref:System.Data.DataTable> копируются только те строки, которые находятся `rowState` в состоянии, указанном в аргументе и которые не были удалены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-360">Only rows in the <xref:System.Data.DataTable> that are in the states indicated in the `rowState` argument and have not been deleted are copied to the destination table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9c9f2-361">Если <xref:System.Data.DataRowState.Deleted> указан параметр, то <xref:System.Data.DataRowState.Unchanged>любые <xref:System.Data.DataRowState.Added>строки, <xref:System.Data.DataRowState.Modified> и будут также скопированы на сервер.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-361">If <xref:System.Data.DataRowState.Deleted> is specified, any <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, and <xref:System.Data.DataRowState.Modified> rows will also be copied to the server.</span></span> <span data-ttu-id="9c9f2-362">Исключение не будет вызвано.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-362">No exception will be raised.</span></span>  
  
 <span data-ttu-id="9c9f2-363">Пока выполняется операция с массовым копированием, связанное назначение <xref:System.Data.SqlClient.SqlConnection> занято ее обслуживанием, и для него не может быть выполнено никаких других операций.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-363">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="9c9f2-364"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> Коллекция сопоставляет<xref:System.Data.DataTable> столбцы с целевой таблицей базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-364">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9c9f2-365">В следующем консольном приложении показано <xref:System.Data.DataTable> , как выполнить загрузку только тех строк в, которые соответствуют заданному состоянию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-365">The following Console application demonstrates how to bulk load only the rows in a <xref:System.Data.DataTable> that match a specified state.</span></span> <span data-ttu-id="9c9f2-366">В этом случае добавляются только неизмененные строки.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-366">In this case, only unchanged rows are added.</span></span> <span data-ttu-id="9c9f2-367">Целевая таблица является таблицей в базе данных **AdventureWorks** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-367">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="9c9f2-368">В этом примере <xref:System.Data.DataTable> создается во время выполнения, а в него добавляются три строки.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-368">In this example, a <xref:System.Data.DataTable> is created at run time and three rows are added to it.</span></span> <span data-ttu-id="9c9f2-369">Перед выполнением <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> метода выполняется изменение одной из строк.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-369">Before the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is executed, one of the rows is edited.</span></span> <span data-ttu-id="9c9f2-370"><xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> Метод вызывается `DataRowState.Unchanged` саргументом,поэтомувназначениевыполняетсяполноекопированиетолькодвух`rowState` неизмененных строк.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-370">The <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called with a `DataRowState.Unchanged` `rowState` argument, so only the two unchanged rows are bulk copied to the destination.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9c9f2-371">Этот пример не будет выполняться, если вы не создали рабочие таблицы, как описано в статье [Пример установки с помощью инструкций копирования](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-371">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="9c9f2-372">Этот код предназначен для демонстрации синтаксиса только для использования **SqlBulkCopy** .</span><span class="sxs-lookup"><span data-stu-id="9c9f2-372">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="9c9f2-373">Если исходная и целевая таблицы находятся в одном и том же экземпляре SQL Server, то проще и быстрее использовать инструкцию `INSERT … SELECT` Transact-SQL для копирования данных.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-373">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.DataRowState" />
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="9c9f2-374">Выполнение операций с массовым копированием</span><span class="sxs-lookup"><span data-stu-id="9c9f2-374">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="9c9f2-375">Общие сведения о ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9c9f2-375">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServerAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9c9f2-376">Асинхронная версия метода <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, который копирует все строки из источника данных в таблицу назначения, заданную в свойстве <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-376">An asynchronous version of <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, which copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-377">Если отключено несколько активных результирующих наборов (MARS) <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> , соединение становится занятым.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-377">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="9c9f2-378">Если режим MARS включен, можно чередовать вызовы <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> с другими командами в том же соединении.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-378">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 <span data-ttu-id="9c9f2-379">Число строк, которые откатываются при сбое, зависит от нескольких моментов.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-379">The number of rows that are rolled back when one fails depends on several things:</span></span>  
  
-   <span data-ttu-id="9c9f2-380">Если <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> задано значение.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-380">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is specified.</span></span>  
  
-   <span data-ttu-id="9c9f2-381">При наличии собственной транзакции.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-381">If you have your own transaction.</span></span>  
  
-   <span data-ttu-id="9c9f2-382">Значение <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-382">The value of <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
 <span data-ttu-id="9c9f2-383">Если при отправке данных на сервер возникла ошибка, будет выполнен откат текущего пакета (указанного параметром <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-383">When there is an error while sending data to the server, the current batch (as specified by <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) will be rolled back.</span></span> <span data-ttu-id="9c9f2-384">Если <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> параметр не указан и имеется собственная транзакция, будет выполнен откат всей транзакции (включая все предыдущие пакеты).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-384">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is not specified and you have your own transaction, the entire transaction will be rolled back (which includes all previous batches as well).</span></span>  
  
 <span data-ttu-id="9c9f2-385">Используйте <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> , чтобы выяснить, сколько строк было скопировано на сервер.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-385">Use <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> to know how many rows were copied to the server.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As DbDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-386">Объект <see cref="T:System.Data.Common.DbDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-386">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-387">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, который копирует все строки из предоставленного массива <see cref="T:System.Data.Common.DbDataReader" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-387">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-388">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-388">A task representing the asynchronous operation.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (rows As DataRow()) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="9c9f2-389">Массив объектов<see cref="T:System.Data.DataRow" />, подлежащих копированию в целевую таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-389">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-390">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, который копирует все строки из предоставленного массива <see cref="T:System.Data.DataRow" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-390">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-391">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-391">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-392">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-392">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-393">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-393">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-394">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-394">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-395">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-395">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-396">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-396">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-397">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-397">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-398">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-398">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-399"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-399"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-400">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-400">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-401">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-401">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-402">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, который копирует все строки из предоставленного <see cref="T:System.Data.DataTable" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-402">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-403">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-403">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-404">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-404">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-405">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-405">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-406">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-406">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-407">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-407">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-408">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-408">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-409">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-409">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-410">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-410">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-411"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-411"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-412">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-412">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As IDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-413">Объект <see cref="T:System.Data.IDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-413">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="9c9f2-414">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, который копирует все строки из предоставленного <see cref="T:System.Data.IDataReader" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-414">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-415">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-415">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-416">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-416">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-417">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-417">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-418">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-418">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-419">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-419">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-420">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-420">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-421">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-421">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-422">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-422">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
<span data-ttu-id="9c9f2-423">Объект <see cref="T:System.Data.IDataReader" /> был закрыт до возврата завершенного объекта <see cref="T:System.Threading.Tasks.Task" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-423">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
<span data-ttu-id="9c9f2-424">Связанное соединение объекта <see cref="T:System.Data.IDataReader" /> было закрыто до возврата завершенного объекта <see cref="T:System.Threading.Tasks.Task" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-424">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
 <span data-ttu-id="9c9f2-425"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-425"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-426">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-426">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-427">Объект <see cref="T:System.Data.Common.DbDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-427">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="9c9f2-428">Инструкция отмены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-428">The cancellation instruction.</span></span> <span data-ttu-id="9c9f2-429">Если значение этого параметра равно <see cref="P:System.Threading.CancellationToken.None" />, то этот метод эквивалентен методу <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-429">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span></span></param>
        <summary><span data-ttu-id="9c9f2-430">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, который копирует все строки из предоставленного массива <see cref="T:System.Data.Common.DbDataReader" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-430">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-431">Возвращает <see cref="T:System.Threading.Tasks.Task" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-431">Returns <see cref="T:System.Threading.Tasks.Task" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[],System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (rows, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="9c9f2-432">Массив объектов<see cref="T:System.Data.DataRow" />, подлежащих копированию в целевую таблицу.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-432">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="9c9f2-433">Инструкция отмены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-433">The cancellation instruction.</span></span> <span data-ttu-id="9c9f2-434">Если значение этого параметра равно <see cref="P:System.Threading.CancellationToken.None" />, то этот метод эквивалентен методу <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-434">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="9c9f2-435">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, который копирует все строки из предоставленного массива <see cref="T:System.Data.DataRow" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-435">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="9c9f2-436">Токен отмены можно использовать для запроса отказа от операции до истечения времени ожидания команды.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-436">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="9c9f2-437">Сведения об исключениях передаются в возвращенном объекте Task.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-437">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-438">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-438">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-439">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-439">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-440">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-440">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-441">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-441">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-442">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-442">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-443">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-443">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-444">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-444">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-445">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-445">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-446"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-446"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-447">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-447">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable, rowState As DataRowState) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-448">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-448">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="9c9f2-449">Значение из перечисления <see cref="T:System.Data.DataRowState" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-449">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="9c9f2-450">В целевую таблицу копируются только строки, состояние которых соответствует заданному.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-450">Only rows matching the row state are copied to the destination.</span></span></param>
        <summary><span data-ttu-id="9c9f2-451">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, который копирует только строки, соответствующие заданному состоянию строки в предоставленном <see cref="T:System.Data.DataTable" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-451">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-452">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-452">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-453">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-453">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-454">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-454">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-455">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-455">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-456">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-456">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-457">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-457">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-458">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-458">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-459">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-459">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-460"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-460"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-461">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-461">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-462">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-462">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="9c9f2-463">Инструкция отмены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-463">The cancellation instruction.</span></span> <span data-ttu-id="9c9f2-464">Если значение этого параметра равно <see cref="P:System.Threading.CancellationToken.None" />, то этот метод эквивалентен методу <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-464">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="9c9f2-465">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, который копирует все строки из предоставленного <see cref="T:System.Data.DataTable" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-465">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="9c9f2-466">Токен отмены можно использовать для запроса отказа от операции до истечения времени ожидания команды.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-466">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="9c9f2-467">Сведения об исключениях передаются в возвращенном объекте Task.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-467">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-468">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-468">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-469">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-469">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-470">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-470">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-471">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-471">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-472">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-472">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-473">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-473">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-474">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-474">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-475">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-475">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-476"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-476"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-477">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-477">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="9c9f2-478">Объект <see cref="T:System.Data.IDataReader" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-478">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="9c9f2-479">Инструкция отмены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-479">The cancellation instruction.</span></span> <span data-ttu-id="9c9f2-480">Если значение этого параметра равно <see cref="P:System.Threading.CancellationToken.None" />, то этот метод эквивалентен методу <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-480">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="9c9f2-481">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, который копирует все строки из предоставленного <see cref="T:System.Data.IDataReader" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-481">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="9c9f2-482">Токен отмены можно использовать для запроса отказа от операции до истечения времени ожидания команды.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-482">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="9c9f2-483">Сведения об исключениях передаются в возвращенном объекте Task.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-483">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-484">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-484">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-485">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-485">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-486">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-486">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-487">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-487">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-488">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-488">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-489">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-489">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-490">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-490">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-491">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-491">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
<span data-ttu-id="9c9f2-492">Объект <see cref="T:System.Data.IDataReader" /> был закрыт до возврата завершенного объекта <see cref="T:System.Threading.Tasks.Task" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-492">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
<span data-ttu-id="9c9f2-493">Связанное соединение объекта <see cref="T:System.Data.IDataReader" /> было закрыто до возврата завершенного объекта <see cref="T:System.Threading.Tasks.Task" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-493">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
 <span data-ttu-id="9c9f2-494"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-494"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-495">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-495">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="9c9f2-496">Объект <see cref="T:System.Data.DataTable" />, строки которого будут скопированы в таблицу назначения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-496">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="9c9f2-497">Значение из перечисления <see cref="T:System.Data.DataRowState" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-497">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="9c9f2-498">В целевую таблицу копируются только строки, состояние которых соответствует заданному.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-498">Only rows matching the row state are copied to the destination.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="9c9f2-499">Инструкция отмены.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-499">The cancellation instruction.</span></span> <span data-ttu-id="9c9f2-500">Если значение этого параметра равно <see cref="P:System.Threading.CancellationToken.None" />, то этот метод эквивалентен методу <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-500">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="9c9f2-501">Асинхронная версия метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, который копирует только строки, соответствующие заданному состоянию строки в предоставленном <see cref="T:System.Data.DataTable" /> в целевую таблицу, заданную свойством <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> объекта <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-501">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="9c9f2-502">Токен отмены можно использовать для запроса отказа от операции до истечения времени ожидания команды.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-502">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="9c9f2-503">Сведения об исключениях передаются в возвращенном объекте Task.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-503">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="9c9f2-504">Задача, представляющая асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-504">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9c9f2-505">Дополнительные сведения об асинхронном программировании в поставщике .NET Framework данных для SQL Server см. в разделе [Асинхронное программирование](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9c9f2-505">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9c9f2-506">Вызов метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> несколько раз для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-506">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-507">Вызов методов <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> и <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> для одного экземпляра до завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-507">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="9c9f2-508">Соединение разъединяется или закрывается во время выполнения метода <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-508">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span></span>  
  
<span data-ttu-id="9c9f2-509">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> был закрыт во время выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-509">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="9c9f2-510">Возвращается в объекте задачи, истекло время ожидания пула подключений.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-510">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="9c9f2-511">Возвращается в объекте задачи, объект <see cref="T:System.Data.SqlClient.SqlConnection" /> закрыт до выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-511">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="9c9f2-512"><see langword="Context Connection=true" /> задается в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-512"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="9c9f2-513">Возвращается в объекте задачи, любая ошибка, возвращенная SQL Server, которая произошла при открытии соединения.</span><span class="sxs-lookup"><span data-stu-id="9c9f2-513">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
  </Members>
</Type>
